import{_ as s,f as e,e as a,z as n}from"./app.61aff7ae.js";const y=JSON.parse('{"title":"Github Page Error","description":"","frontmatter":{},"headers":[{"level":2,"title":"Github Page报错_commonjsHelpers的问题","slug":"github-page报错-commonjshelpers的问题","link":"#github-page报错-commonjshelpers的问题","children":[{"level":3,"title":"问题描述","slug":"问题描述","link":"#问题描述","children":[]},{"level":3,"title":"原因分析","slug":"原因分析","link":"#原因分析","children":[]},{"level":3,"title":"解决问题","slug":"解决问题","link":"#解决问题","children":[]}]}],"relativePath":"notes/it/web/github-page-error.md","lastUpdated":1682480501000}'),l={name:"notes/it/web/github-page-error.md"},p=n(`<h1 id="github-page-error" tabindex="-1">Github Page Error <a class="header-anchor" href="#github-page-error" aria-hidden="true">#</a></h1><h2 id="github-page报错-commonjshelpers的问题" tabindex="-1">Github Page报错_commonjsHelpers的问题 <a class="header-anchor" href="#github-page报错-commonjshelpers的问题" aria-hidden="true">#</a></h2><h3 id="问题描述" tabindex="-1">问题描述 <a class="header-anchor" href="#问题描述" aria-hidden="true">#</a></h3><p>在使用 <code>Vitepress</code> 构建的项目时，如果用到 <code>按需引入</code> 的组件，在<a href="https://github.com/ZhongxuYang/zhongxuyang.github.io" target="_blank" rel="noreferrer">线上环境</a>会报错：</p><div class="danger custom-block"><p class="custom-block-title">报错信息</p><p>_commonjsHelpers.XXXXXX.js file generated in the assets folder to Github Pages</p><p>Hydration completed but contains mismatches when using Github pages</p></div><h3 id="原因分析" tabindex="-1">原因分析 <a class="header-anchor" href="#原因分析" aria-hidden="true">#</a></h3><blockquote><p>问题排除</p></blockquote><p>首先尝试在本地 <code>build</code> 后 <code>yarn serve</code> 运行，并不会报错。这时可以很自然的想到<code>线上打包</code>和<code>本地打包</code>的差异，合理怀疑是否是由于 <code>Node.js</code> 版本不一致造成的问题。</p><div class="info custom-block"><p class="custom-block-title"><a href="https://vitepress.vuejs.org/guide/deploying.html#netlify-vercel-aws-amplify-cloudflare-pages-render" target="_blank" rel="noreferrer">vitepress - Netlify、Vercel、AWS Amplify、Cloudflare 页面、渲染</a> 中提到：</p><p>Node Version: 14 (or above, by default it usually will be 14 or 16, but on Cloudflare Pages the default is still 12, so you may need to change that)</p></div><p>本地使用的是 <code>Node 16.x</code>，线上是通过 <a href="./github-actions.html">Github Action</a> 部署的。</p><p>先在本地切换到 <code>Node 12.x</code> 重新尝试运行：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看本地安装的所有nodejs版本</span></span>
<span class="line"><span style="color:#FFCB6B;">nvm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装指定版本</span></span>
<span class="line"><span style="color:#FFCB6B;">nvm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 切换到指定版本</span></span>
<span class="line"><span style="color:#FFCB6B;">nvm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">use</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 卸载指定版本</span></span>
<span class="line"><span style="color:#FFCB6B;">nvm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uninstall</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 显示当前版本</span></span>
<span class="line"><span style="color:#FFCB6B;">nvm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">current</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>结果显而易见，我忽略了 <code>Vite</code> 需要 <code>Node.js &gt; 14.18+, 16+</code> 才能<a href="https://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project" target="_blank" rel="noreferrer">正常运行</a>。</p><p>接下来尝试把线上环境的 <code>Node</code> 版本与切换到与本地相同，找到 <code>/.github/workflows/***.yml</code> 文件:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># ...</span></span>
<span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build-and-deploy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">runs-on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ubuntu-latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">strategy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">matrix</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">node-version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">16.x</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 配置所需node版本</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ...</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>结果依然报错，至此可以排除是 <code>Node.js</code> 的问题造成该错误。</p><blockquote><p>确认原因</p></blockquote><p>这时在 <a href="https://github.com/vuejs/vitepress/issues" target="_blank" rel="noreferrer">vitepress</a> 的 <code>issue</code> 中发现一个名为 <a href="https://github.com/vuejs/vitepress/issues/382" target="_blank" rel="noreferrer">Problems with uploading the _commonjsHelpers.XXXXXX.js file generated in the assets folder to Github Pages</a> 的bug反馈。</p><p>在这个反馈下面尤大给出了正确答案：<a href="https://github.blog/2009-12-29-bypassing-jekyll-on-github-pag" target="_blank" rel="noreferrer">Bypassing Jekyll on GitHub Pages</a></p><div class="tip custom-block"><p class="custom-block-title">_commonjsHelpers.XXXXXX.js file generated in the assets folder to Github Pages</p><p>Github Pages 默认是基于 Jekyll 构建，Jekyll 是一个将纯文本转换为静态网站的工具，它构建的网站下各种目录都是特定的以下划线开头命名的文件夹，例如 _layouts、_posts ，它会忽略掉其它的以下划线开头的文件夹和文件。</p><p>.nojekyll 就是告诉 Github Pages 当前网站不是基于 Jekyll 构建的，不要忽略掉下划线开头的文件和文件夹。</p><p>可见 .nojekyll 主要就是用于 Github Pages 这种有默认规则的网站部署平台，如果是部署在自己的服务器上，可以把它删掉。</p><p>反之，如果你的网站不是 Jekyll 构建的，要部署到 Github Pages ，并且包含下划线开头的文件或文件夹，那么你就需要在根目录添加一个 .nojekyll 空文件。</p></div><h3 id="解决问题" tabindex="-1">解决问题 <a class="header-anchor" href="#解决问题" aria-hidden="true">#</a></h3><p>如上所说，只需要在 <code>***.github.io</code> 的项目根目录中创建一个空的 <code>.nojekyll</code> 文件即可解决！🎉</p><div class="info custom-block"><p class="custom-block-title">提示</p><p>一些框架打包生成的 <code>dist</code> 文件已经为你创建好了这个空文件。例如：<code>Nuxt</code></p></div>`,23),o=[p];function t(r,c,i,d,u,b){return a(),e("div",null,o)}const m=s(l,[["render",t]]);export{y as __pageData,m as default};
