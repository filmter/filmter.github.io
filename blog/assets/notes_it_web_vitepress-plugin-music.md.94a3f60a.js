import{_ as e,f as s,e as a,z as n}from"./app.988a0367.js";const g=JSON.parse('{"title":"vitepress-plugin-music开发记录","description":"","frontmatter":{},"headers":[{"level":2,"title":"它是什么","slug":"它是什么","link":"#它是什么","children":[]},{"level":2,"title":"使用技术","slug":"使用技术","link":"#使用技术","children":[]},{"level":2,"title":"遇到问题","slug":"遇到问题","link":"#遇到问题","children":[{"level":3,"title":"使用unbuild打包时遇到的问题","slug":"使用unbuild打包时遇到的问题","link":"#使用unbuild打包时遇到的问题","children":[]},{"level":3,"title":"使用vite打包lib注意的事","slug":"使用vite打包lib注意的事","link":"#使用vite打包lib注意的事","children":[]}]},{"level":2,"title":"todo","slug":"todo","link":"#todo","children":[]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"relativePath":"notes/it/web/vitepress-plugin-music.md","lastUpdated":1681141353000}'),l={name:"notes/it/web/vitepress-plugin-music.md"},i=n(`<h1 id="vitepress-plugin-music开发记录" tabindex="-1">vitepress-plugin-music开发记录 <a class="header-anchor" href="#vitepress-plugin-music开发记录" aria-hidden="true">#</a></h1><h2 id="它是什么" tabindex="-1">它是什么 <a class="header-anchor" href="#它是什么" aria-hidden="true">#</a></h2><p><a href="https://github.com/ZhongxuYang/vitepress-plugin-music" target="_blank" rel="noreferrer">vitepress-plugin-music</a> 是为 <code>vitepress</code> 开发的拓展插件。</p><p>旨在简单的传入歌单列表数据后，即可在网站上播放音频的插件。</p><h2 id="使用技术" tabindex="-1">使用技术 <a class="header-anchor" href="#使用技术" aria-hidden="true">#</a></h2><ul><li>使用 <code>typescript</code> 开发</li><li>使用 <code>vue template</code> 模版渲染</li><li>使用 <code>vite</code> 进行打包</li></ul><h2 id="遇到问题" tabindex="-1">遇到问题 <a class="header-anchor" href="#遇到问题" aria-hidden="true">#</a></h2><h3 id="使用unbuild打包时遇到的问题" tabindex="-1">使用unbuild打包时遇到的问题 <a class="header-anchor" href="#使用unbuild打包时遇到的问题" aria-hidden="true">#</a></h3><p>本想像 <a href="https://github.com/ZhongxuYang/vitepress-plugin-nprogress" target="_blank" rel="noreferrer">vitepress-plugin-nprogress</a> 与 <a href="https://github.com/ZhongxuYang/vitepress-plugin-google-analytics" target="_blank" rel="noreferrer">vitepress-plugin-google-analytics</a> 一样，使用 <a href="https://github.com/unjs/unbuild" target="_blank" rel="noreferrer">unbuild</a> 进行打包。</p><p>但在 <code>yarn build</code> 时，遇到报错 <code>Error: Unexpected token (Note that you need plugins to import files that are not JavaScript)</code> 。应该是 <code>unbuild</code> 不能解析vue文件造成的错误，目前没有找到解决方案，对应<a href="https://github.com/unjs/unbuild/issues/80" target="_blank" rel="noreferrer">Issue</a>。</p><p>遂放弃使用 <code>unbuild</code> ，转而使用 <code>vite</code> 进行打包。毕竟是vitepress项目，可以直接使用<code>vite</code>，还可以少安装一个依赖。</p><h3 id="使用vite打包lib注意的事" tabindex="-1">使用vite打包lib注意的事 <a class="header-anchor" href="#使用vite打包lib注意的事" aria-hidden="true">#</a></h3><ol><li>配置 <a href="https://github.com/ZhongxuYang/vitepress-plugin-music/blob/main/vite.config.ts" target="_blank" rel="noreferrer">vite.config.ts</a> 的 <code>build.rollupOptions.external</code>，用来把 <code>vue</code> 依赖包的内容排除在外（因为使用本plugin的主项目一定已经安装了<code>vue</code>，可以在 <a href="./打包JavaScript库的现代化指南.html#外置框架">打包JavaScript库的现代化指南</a> 看到之所以要这样做的更详细的介绍）。</li></ol><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">rollupOptions</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">external</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="todo" tabindex="-1">todo <a class="header-anchor" href="#todo" aria-hidden="true">#</a></h2><ul><li>避免需要单独引入css，css文件混入js</li></ul><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-hidden="true">#</a></h2><ul><li><a href="https://github.com/unjs/unbuild/issues/80" target="_blank" rel="noreferrer">unbuild Issue</a></li><li><a href="https://github.com/vuejs/core/issues/5625#issuecomment-1078953150" target="_blank" rel="noreferrer">Cannot find module &#39;@babel/types&#39; or its corresponding type declarations</a></li><li><a href="https://rollupjs.org/guide/en/#external" target="_blank" rel="noreferrer">vite.config.ts build.rollupOptions.external</a></li></ul>`,18),t=[i];function r(o,p,c,d,u,h){return a(),s("div",null,t)}const v=e(l,[["render",r]]);export{g as __pageData,v as default};
