import{a as S,g as Rt,b as A,i as ut,d as G,u as Ps,e as Fs,s as Mt,w as Y,n as j,o as ft,t as Ms,f as re,v as Ge,j as B,k as C,l as z,F as Wt,m as P,p as u,q as Ft,x as T,y as V,z as K,A as Dt,B as Qt,C as $,D as Ts,N as Ss,E as dt,G as tt,H as be,I as we,J as Cs,K as Rs,L as _s,r as Je,M as Ls,O as Be,P as Ne,Q as Es}from"./vue.esm-bundler-6f0914dd.js";import{i as oe,g as $s,e as As,a as Ze,b as zs,c as Ks,o as Ds,k as Qe,r as Hs,d as Oe,s as Vs,f as Ws,h as qs,U as Pe,S as Fe,j as je,l as ae,n as Yt,m as Ie,p as Us,q as Xs,t as Ys,u as ks,v as Gs,w as Me,x as Js,y as Gt,z as ts,A as yt,B as Te,C as Zs,D as xt,E as es,F as ss,G as rs,H as os,I as st,V as Qs,J as Os,K as js,L as qt,M as Is,N as kt,O as at,P as tr,_ as it,Q as as,R as er,T as ie,W as Se,X as sr,Y as rr,Z as or,$ as q,a0 as ar,a1 as ir,a2 as nr,a3 as lr,a4 as nt,a5 as k,a6 as gt,a7 as hr,a8 as Ot,a9 as dr,aa as cr,ab as ur,ac as yr,ad as gr,ae as pr,af as Ht,ag as xr}from"./index-59ae09d4.js";const ne=i=>{let t,s;return i.type==="touchend"?(s=i.changedTouches[0].clientY,t=i.changedTouches[0].clientX):i.type.startsWith("touch")?(s=i.touches[0].clientY,t=i.touches[0].clientX):(s=i.clientY,t=i.clientX),{clientX:t,clientY:s}};var Ce=Object.create,fr=function(){function i(){}return function(t){if(!oe(t))return{};if(Ce)return Ce(t);i.prototype=t;var s=new i;return i.prototype=void 0,s}}();const mr=fr;function vr(i,t){var s=-1,e=i.length;for(t||(t=Array(e));++s<e;)t[s]=i[s];return t}var br=function(){try{var i=$s(Object,"defineProperty");return i({},"",{}),i}catch{}}();const Re=br;function wr(i,t){for(var s=-1,e=i==null?0:i.length;++s<e&&t(i[s],s,i)!==!1;);return i}function is(i,t,s){t=="__proto__"&&Re?Re(i,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):i[t]=s}var Br=Object.prototype,Nr=Br.hasOwnProperty;function ns(i,t,s){var e=i[t];(!(Nr.call(i,t)&&As(e,s))||s===void 0&&!(t in i))&&is(i,t,s)}function Jt(i,t,s,e){var o=!s;s||(s={});for(var a=-1,r=t.length;++a<r;){var n=t[a],l=e?e(s[n],i[n],n,s,i):void 0;l===void 0&&(l=i[n]),o?is(s,n,l):ns(s,n,l)}return s}function Pr(i){var t=[];if(i!=null)for(var s in Object(i))t.push(s);return t}var Fr=Object.prototype,Mr=Fr.hasOwnProperty;function Tr(i){if(!oe(i))return Pr(i);var t=Ze(i),s=[];for(var e in i)e=="constructor"&&(t||!Mr.call(i,e))||s.push(e);return s}function le(i){return zs(i)?Ks(i,!0):Tr(i)}var Sr=Ds(Object.getPrototypeOf,Object);const ls=Sr;function Cr(i,t){return i&&Jt(t,Qe(t),i)}function Rr(i,t){return i&&Jt(t,le(t),i)}var hs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_e=hs&&typeof module=="object"&&module&&!module.nodeType&&module,_r=_e&&_e.exports===hs,Le=_r?Hs.Buffer:void 0,Ee=Le?Le.allocUnsafe:void 0;function Lr(i,t){if(t)return i.slice();var s=i.length,e=Ee?Ee(s):new i.constructor(s);return i.copy(e),e}function Er(i,t){return Jt(i,Oe(i),t)}var $r=Object.getOwnPropertySymbols,Ar=$r?function(i){for(var t=[];i;)Ws(t,Oe(i)),i=ls(i);return t}:Vs;const ds=Ar;function zr(i,t){return Jt(i,ds(i),t)}function Kr(i){return qs(i,le,ds)}var Dr=Object.prototype,Hr=Dr.hasOwnProperty;function Vr(i){var t=i.length,s=new i.constructor(t);return t&&typeof i[0]=="string"&&Hr.call(i,"index")&&(s.index=i.index,s.input=i.input),s}function he(i){var t=new i.constructor(i.byteLength);return new Pe(t).set(new Pe(i)),t}function Wr(i,t){var s=t?he(i.buffer):i.buffer;return new i.constructor(s,i.byteOffset,i.byteLength)}var qr=/\w*$/;function Ur(i){var t=new i.constructor(i.source,qr.exec(i));return t.lastIndex=i.lastIndex,t}var $e=Fe?Fe.prototype:void 0,Ae=$e?$e.valueOf:void 0;function Xr(i){return Ae?Object(Ae.call(i)):{}}function Yr(i,t){var s=t?he(i.buffer):i.buffer;return new i.constructor(s,i.byteOffset,i.length)}var kr="[object Boolean]",Gr="[object Date]",Jr="[object Map]",Zr="[object Number]",Qr="[object RegExp]",Or="[object Set]",jr="[object String]",Ir="[object Symbol]",to="[object ArrayBuffer]",eo="[object DataView]",so="[object Float32Array]",ro="[object Float64Array]",oo="[object Int8Array]",ao="[object Int16Array]",io="[object Int32Array]",no="[object Uint8Array]",lo="[object Uint8ClampedArray]",ho="[object Uint16Array]",co="[object Uint32Array]";function uo(i,t,s){var e=i.constructor;switch(t){case to:return he(i);case kr:case Gr:return new e(+i);case eo:return Wr(i,s);case so:case ro:case oo:case ao:case io:case no:case lo:case ho:case co:return Yr(i,s);case Jr:return new e;case Zr:case jr:return new e(i);case Qr:return Ur(i);case Or:return new e;case Ir:return Xr(i)}}function yo(i){return typeof i.constructor=="function"&&!Ze(i)?mr(ls(i)):{}}var go="[object Map]";function po(i){return je(i)&&ae(i)==go}var ze=Yt&&Yt.isMap,xo=ze?Ie(ze):po;const fo=xo;var mo="[object Set]";function vo(i){return je(i)&&ae(i)==mo}var Ke=Yt&&Yt.isSet,bo=Ke?Ie(Ke):vo;const wo=bo;var Bo=1,No=2,Po=4,cs="[object Arguments]",Fo="[object Array]",Mo="[object Boolean]",To="[object Date]",So="[object Error]",us="[object Function]",Co="[object GeneratorFunction]",Ro="[object Map]",_o="[object Number]",ys="[object Object]",Lo="[object RegExp]",Eo="[object Set]",$o="[object String]",Ao="[object Symbol]",zo="[object WeakMap]",Ko="[object ArrayBuffer]",Do="[object DataView]",Ho="[object Float32Array]",Vo="[object Float64Array]",Wo="[object Int8Array]",qo="[object Int16Array]",Uo="[object Int32Array]",Xo="[object Uint8Array]",Yo="[object Uint8ClampedArray]",ko="[object Uint16Array]",Go="[object Uint32Array]",L={};L[cs]=L[Fo]=L[Ko]=L[Do]=L[Mo]=L[To]=L[Ho]=L[Vo]=L[Wo]=L[qo]=L[Uo]=L[Ro]=L[_o]=L[ys]=L[Lo]=L[Eo]=L[$o]=L[Ao]=L[Xo]=L[Yo]=L[ko]=L[Go]=!0;L[So]=L[us]=L[zo]=!1;function Ut(i,t,s,e,o,a){var r,n=t&Bo,l=t&No,c=t&Po;if(s&&(r=o?s(i,e,o,a):s(i)),r!==void 0)return r;if(!oe(i))return i;var d=Us(i);if(d){if(r=Vr(i),!n)return vr(i,r)}else{var h=ae(i),y=h==us||h==Co;if(Xs(i))return Lr(i,n);if(h==ys||h==cs||y&&!o){if(r=l||y?{}:yo(i),!n)return l?zr(i,Rr(r,i)):Er(i,Cr(r,i))}else{if(!L[h])return o?i:{};r=uo(i,h,n)}}a||(a=new Ys);var g=a.get(i);if(g)return g;a.set(i,r),wo(i)?i.forEach(function(b){r.add(Ut(b,t,s,b,i,a))}):fo(i)&&i.forEach(function(b,F){r.set(F,Ut(b,t,s,F,i,a))});var x=c?l?Kr:ks:l?le:Qe,f=d?void 0:x(i);return wr(f||i,function(b,F){f&&(F=b,b=i[F]),ns(r,F,Ut(b,t,s,F,i,a))}),r}var Jo=1,Zo=4;function Qo(i){return Ut(i,Jo|Zo)}const Oo=["class","style"],jo=/^on[A-Z]/,Io=(i={})=>{const{excludeListeners:t=!1,excludeKeys:s}=i,e=S(()=>((s==null?void 0:s.value)||[]).concat(Oo)),o=Rt();return o?S(()=>{var a;return Gs(Object.entries((a=o.proxy)==null?void 0:a.$attrs).filter(([r])=>!e.value.includes(r)&&!(t&&jo.test(r))))}):S(()=>({}))};function ta(i){const t=A();function s(){if(i.value==null)return;const{selectionStart:o,selectionEnd:a,value:r}=i.value;if(o==null||a==null)return;const n=r.slice(0,Math.max(0,o)),l=r.slice(Math.max(0,a));t.value={selectionStart:o,selectionEnd:a,value:r,beforeTxt:n,afterTxt:l}}function e(){if(i.value==null||t.value==null)return;const{value:o}=i.value,{beforeTxt:a,afterTxt:r,selectionStart:n}=t.value;if(a==null||r==null||n==null)return;let l=o.length;if(o.endsWith(r))l=o.length-r.length;else if(o.startsWith(a))l=a.length;else{const c=a[n-1],d=o.indexOf(c,n-1);d!==-1&&(l=d+1)}i.value.setSelectionRange(l,l)}return[s,e]}let Z;const ea=`
  height:0 !important;
  visibility:hidden !important;
  ${Js()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,sa=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function ra(i){const t=window.getComputedStyle(i),s=t.getPropertyValue("box-sizing"),e=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),o=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:sa.map(r=>`${r}:${t.getPropertyValue(r)}`).join(";"),paddingSize:e,borderSize:o,boxSizing:s}}function De(i,t=1,s){var e;Z||(Z=document.createElement("textarea"),document.body.appendChild(Z));const{paddingSize:o,borderSize:a,boxSizing:r,contextStyle:n}=ra(i);Z.setAttribute("style",`${n};${ea}`),Z.value=i.value||i.placeholder||"";let l=Z.scrollHeight;const c={};r==="border-box"?l=l+a:r==="content-box"&&(l=l-o),Z.value="";const d=Z.scrollHeight-o;if(Me(t)){let h=d*t;r==="border-box"&&(h=h+o+a),l=Math.max(h,l),c.minHeight=`${h}px`}if(Me(s)){let h=d*s;r==="border-box"&&(h=h+o+a),l=Math.min(h,l)}return c.height=`${l}px`,(e=Z.parentNode)==null||e.removeChild(Z),Z=void 0,c}const oa=Gt({id:{type:String,default:void 0},size:ts,disabled:Boolean,modelValue:{type:yt([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:yt([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Te},prefixIcon:{type:Te},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:yt([Object,Array,String]),default:()=>Zs({})}}),aa={[xt]:i=>ut(i),input:i=>ut(i),change:i=>ut(i),focus:i=>i instanceof FocusEvent,blur:i=>i instanceof FocusEvent,clear:()=>!0,mouseleave:i=>i instanceof MouseEvent,mouseenter:i=>i instanceof MouseEvent,keydown:i=>i instanceof Event,compositionstart:i=>i instanceof CompositionEvent,compositionupdate:i=>i instanceof CompositionEvent,compositionend:i=>i instanceof CompositionEvent},ia=["role"],na=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],la=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],ha=G({name:"ElInput",inheritAttrs:!1}),da=G({...ha,props:oa,emits:aa,setup(i,{expose:t,emit:s}){const e=i,o=Ps(),a=Fs(),r=S(()=>{const v={};return e.containerRole==="combobox"&&(v["aria-haspopup"]=o["aria-haspopup"],v["aria-owns"]=o["aria-owns"],v["aria-expanded"]=o["aria-expanded"]),v}),n=S(()=>[e.type==="textarea"?b.b():f.b(),f.m(g.value),f.is("disabled",x.value),f.is("exceed",I.value),{[f.b("group")]:a.prepend||a.append,[f.bm("group","append")]:a.append,[f.bm("group","prepend")]:a.prepend,[f.m("prefix")]:a.prefix||e.prefixIcon,[f.m("suffix")]:a.suffix||e.suffixIcon||e.clearable||e.showPassword,[f.bm("suffix","password-clear")]:ht.value&&wt.value},o.class]),l=S(()=>[f.e("wrapper"),f.is("focus",N.value)]),c=Io({excludeKeys:S(()=>Object.keys(r.value))}),{form:d,formItem:h}=es(),{inputId:y}=ss(e,{formItemContext:h}),g=rs(),x=os(),f=st("input"),b=st("textarea"),F=Mt(),w=Mt(),N=A(!1),p=A(!1),m=A(!1),_=A(!1),_t=A(),lt=Mt(e.inputStyle),rt=S(()=>F.value||w.value),mt=S(()=>{var v;return(v=d==null?void 0:d.statusIcon)!=null?v:!1}),Q=S(()=>(h==null?void 0:h.validateState)||""),Lt=S(()=>Q.value&&Qs[Q.value]),Et=S(()=>_.value?Os:js),vt=S(()=>[o.style,e.inputStyle]),bt=S(()=>[e.inputStyle,lt.value,{resize:e.resize}]),J=S(()=>qt(e.modelValue)?"":String(e.modelValue)),ht=S(()=>e.clearable&&!x.value&&!e.readonly&&!!J.value&&(N.value||p.value)),wt=S(()=>e.showPassword&&!x.value&&!e.readonly&&!!J.value&&(!!J.value||N.value)),M=S(()=>e.showWordLimit&&!!c.value.maxlength&&(e.type==="text"||e.type==="textarea")&&!x.value&&!e.readonly&&!e.showPassword),W=S(()=>J.value.length),I=S(()=>!!M.value&&W.value>Number(c.value.maxlength)),$t=S(()=>!!a.suffix||!!e.suffixIcon||ht.value||e.showPassword||M.value||!!Q.value&&mt.value),[At,fs]=ta(F);Is(w,v=>{if(ms(),!M.value||e.resize!=="both")return;const R=v[0],{width:O}=R.contentRect;_t.value={right:`calc(100% - ${O+15+6}px)`}});const Bt=()=>{const{type:v,autosize:R}=e;if(!(!as||v!=="textarea"||!w.value))if(R){const O=be(R)?R.minRows:void 0,Kt=be(R)?R.maxRows:void 0,ve=De(w.value,O,Kt);lt.value={overflowY:"hidden",...ve},j(()=>{w.value.offsetHeight,lt.value=ve})}else lt.value={minHeight:De(w.value).minHeight}},ms=(v=>{let R=!1;return()=>{var O;if(R||!e.autosize)return;((O=w.value)==null?void 0:O.offsetParent)===null||(v(),R=!0)}})(Bt),Nt=()=>{const v=rt.value;!v||v.value===J.value||(v.value=J.value)},Zt=async v=>{At();let{value:R}=v.target;if(e.formatter&&(R=e.parser?e.parser(R):R,R=e.formatter(R)),!m.value){if(R===J.value){Nt();return}s(xt,R),s("input",R),await j(),Nt(),fs()}},ce=v=>{s("change",v.target.value)},ue=v=>{s("compositionstart",v),m.value=!0},ye=v=>{var R;s("compositionupdate",v);const O=(R=v.target)==null?void 0:R.value,Kt=O[O.length-1]||"";m.value=!er(Kt)},ge=v=>{s("compositionend",v),m.value&&(m.value=!1,Zt(v))},vs=()=>{_.value=!_.value,zt()},zt=async()=>{var v;await j(),(v=rt.value)==null||v.focus()},bs=()=>{var v;return(v=rt.value)==null?void 0:v.blur()},pe=v=>{N.value=!0,s("focus",v)},xe=v=>{var R;N.value=!1,s("blur",v),e.validateEvent&&((R=h==null?void 0:h.validate)==null||R.call(h,"blur").catch(O=>kt()))},ws=v=>{p.value=!1,s("mouseleave",v)},Bs=v=>{p.value=!0,s("mouseenter",v)},fe=v=>{s("keydown",v)},Ns=()=>{var v;(v=rt.value)==null||v.select()},me=()=>{s(xt,""),s("change",""),s("clear"),s("input","")};return Y(()=>e.modelValue,()=>{var v;j(()=>Bt()),e.validateEvent&&((v=h==null?void 0:h.validate)==null||v.call(h,"change").catch(R=>kt()))}),Y(J,()=>Nt()),Y(()=>e.type,async()=>{await j(),Nt(),Bt()}),ft(()=>{!e.formatter&&e.parser,Nt(),j(Bt)}),t({input:F,textarea:w,ref:rt,textareaStyle:bt,autosize:Ms(e,"autosize"),focus:zt,blur:bs,select:Ns,clear:me,resizeTextarea:Bt}),(v,R)=>re((B(),C("div",Qt(u(r),{class:u(n),style:u(vt),role:v.containerRole,onMouseenter:Bs,onMouseleave:ws}),[z(" input "),v.type!=="textarea"?(B(),C(Wt,{key:0},[z(" prepend slot "),v.$slots.prepend?(B(),C("div",{key:0,class:P(u(f).be("group","prepend"))},[Ft(v.$slots,"prepend")],2)):z("v-if",!0),T("div",{class:P(u(l))},[z(" prefix slot "),v.$slots.prefix||v.prefixIcon?(B(),C("span",{key:0,class:P(u(f).e("prefix"))},[T("span",{class:P(u(f).e("prefix-inner")),onClick:zt},[Ft(v.$slots,"prefix"),v.prefixIcon?(B(),V(u(at),{key:0,class:P(u(f).e("icon"))},{default:K(()=>[(B(),V(Dt(v.prefixIcon)))]),_:1},8,["class"])):z("v-if",!0)],2)],2)):z("v-if",!0),T("input",Qt({id:u(y),ref_key:"input",ref:F,class:u(f).e("inner")},u(c),{type:v.showPassword?_.value?"text":"password":v.type,disabled:u(x),formatter:v.formatter,parser:v.parser,readonly:v.readonly,autocomplete:v.autocomplete,tabindex:v.tabindex,"aria-label":v.label,placeholder:v.placeholder,style:v.inputStyle,form:e.form,onCompositionstart:ue,onCompositionupdate:ye,onCompositionend:ge,onInput:Zt,onFocus:pe,onBlur:xe,onChange:ce,onKeydown:fe}),null,16,na),z(" suffix slot "),u($t)?(B(),C("span",{key:1,class:P(u(f).e("suffix"))},[T("span",{class:P(u(f).e("suffix-inner")),onClick:zt},[!u(ht)||!u(wt)||!u(M)?(B(),C(Wt,{key:0},[Ft(v.$slots,"suffix"),v.suffixIcon?(B(),V(u(at),{key:0,class:P(u(f).e("icon"))},{default:K(()=>[(B(),V(Dt(v.suffixIcon)))]),_:1},8,["class"])):z("v-if",!0)],64)):z("v-if",!0),u(ht)?(B(),V(u(at),{key:1,class:P([u(f).e("icon"),u(f).e("clear")]),onMousedown:Ts(u(Ss),["prevent"]),onClick:me},{default:K(()=>[$(u(tr))]),_:1},8,["class","onMousedown"])):z("v-if",!0),u(wt)?(B(),V(u(at),{key:2,class:P([u(f).e("icon"),u(f).e("password")]),onClick:vs},{default:K(()=>[(B(),V(Dt(u(Et))))]),_:1},8,["class"])):z("v-if",!0),u(M)?(B(),C("span",{key:3,class:P(u(f).e("count"))},[T("span",{class:P(u(f).e("count-inner"))},dt(u(W))+" / "+dt(u(c).maxlength),3)],2)):z("v-if",!0),u(Q)&&u(Lt)&&u(mt)?(B(),V(u(at),{key:4,class:P([u(f).e("icon"),u(f).e("validateIcon"),u(f).is("loading",u(Q)==="validating")])},{default:K(()=>[(B(),V(Dt(u(Lt))))]),_:1},8,["class"])):z("v-if",!0)],2)],2)):z("v-if",!0)],2),z(" append slot "),v.$slots.append?(B(),C("div",{key:1,class:P(u(f).be("group","append"))},[Ft(v.$slots,"append")],2)):z("v-if",!0)],64)):(B(),C(Wt,{key:1},[z(" textarea "),T("textarea",Qt({id:u(y),ref_key:"textarea",ref:w,class:u(b).e("inner")},u(c),{tabindex:v.tabindex,disabled:u(x),readonly:v.readonly,autocomplete:v.autocomplete,style:u(bt),"aria-label":v.label,placeholder:v.placeholder,form:e.form,onCompositionstart:ue,onCompositionupdate:ye,onCompositionend:ge,onInput:Zt,onFocus:pe,onBlur:xe,onChange:ce,onKeydown:fe}),null,16,la),u(M)?(B(),C("span",{key:0,style:tt(_t.value),class:P(u(f).e("count"))},dt(u(W))+" / "+dt(u(c).maxlength),7)):z("v-if",!0)],64))],16,ia)),[[Ge,v.type!=="hidden"]])}});var ca=it(da,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const ua=ie(ca),ya=Gt({color:{type:yt(Object),required:!0},vertical:{type:Boolean,default:!1}});let jt=!1;function Ct(i,t){if(!as)return;const s=function(a){var r;(r=t.drag)==null||r.call(t,a)},e=function(a){var r;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",e),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",e),document.onselectstart=null,document.ondragstart=null,jt=!1,(r=t.end)==null||r.call(t,a)},o=function(a){var r;jt||(a.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",e),document.addEventListener("touchmove",s),document.addEventListener("touchend",e),jt=!0,(r=t.start)==null||r.call(t,a))};i.addEventListener("mousedown",o),i.addEventListener("touchstart",o)}const ga=i=>{const t=Rt(),s=Mt(),e=Mt();function o(r){r.target!==s.value&&a(r)}function a(r){if(!e.value||!s.value)return;const l=t.vnode.el.getBoundingClientRect(),{clientX:c,clientY:d}=ne(r);if(i.vertical){let h=d-l.top;h=Math.max(s.value.offsetHeight/2,h),h=Math.min(h,l.height-s.value.offsetHeight/2),i.color.set("alpha",Math.round((h-s.value.offsetHeight/2)/(l.height-s.value.offsetHeight)*100))}else{let h=c-l.left;h=Math.max(s.value.offsetWidth/2,h),h=Math.min(h,l.width-s.value.offsetWidth/2),i.color.set("alpha",Math.round((h-s.value.offsetWidth/2)/(l.width-s.value.offsetWidth)*100))}}return{thumb:s,bar:e,handleDrag:a,handleClick:o}},pa=(i,{bar:t,thumb:s,handleDrag:e})=>{const o=Rt(),a=st("color-alpha-slider"),r=A(0),n=A(0),l=A();function c(){if(!s.value||i.vertical)return 0;const w=o.vnode.el,N=i.color.get("alpha");return w?Math.round(N*(w.offsetWidth-s.value.offsetWidth/2)/100):0}function d(){if(!s.value)return 0;const w=o.vnode.el;if(!i.vertical)return 0;const N=i.color.get("alpha");return w?Math.round(N*(w.offsetHeight-s.value.offsetHeight/2)/100):0}function h(){if(i.color&&i.color.value){const{r:w,g:N,b:p}=i.color.toRgb();return`linear-gradient(to right, rgba(${w}, ${N}, ${p}, 0) 0%, rgba(${w}, ${N}, ${p}, 1) 100%)`}return""}function y(){r.value=c(),n.value=d(),l.value=h()}ft(()=>{if(!t.value||!s.value)return;const w={drag:N=>{e(N)},end:N=>{e(N)}};Ct(t.value,w),Ct(s.value,w),y()}),Y(()=>i.color.get("alpha"),()=>y()),Y(()=>i.color.value,()=>y());const g=S(()=>[a.b(),a.is("vertical",i.vertical)]),x=S(()=>a.e("bar")),f=S(()=>a.e("thumb")),b=S(()=>({background:l.value})),F=S(()=>({left:Se(r.value),top:Se(n.value)}));return{rootKls:g,barKls:x,barStyle:b,thumbKls:f,thumbStyle:F,update:y}},xa="ElColorAlphaSlider",fa=G({name:xa}),ma=G({...fa,props:ya,setup(i,{expose:t}){const s=i,{bar:e,thumb:o,handleDrag:a,handleClick:r}=ga(s),{rootKls:n,barKls:l,barStyle:c,thumbKls:d,thumbStyle:h,update:y}=pa(s,{bar:e,thumb:o,handleDrag:a});return t({update:y,bar:e,thumb:o}),(g,x)=>(B(),C("div",{class:P(u(n))},[T("div",{ref_key:"bar",ref:e,class:P(u(l)),style:tt(u(c)),onClick:x[0]||(x[0]=(...f)=>u(r)&&u(r)(...f))},null,6),T("div",{ref_key:"thumb",ref:o,class:P(u(d)),style:tt(u(h))},null,6)],2))}});var va=it(ma,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const ba=G({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(i){const t=st("color-hue-slider"),s=Rt(),e=A(),o=A(),a=A(0),r=A(0),n=S(()=>i.color.get("hue"));Y(()=>n.value,()=>{y()});function l(g){g.target!==e.value&&c(g)}function c(g){if(!o.value||!e.value)return;const f=s.vnode.el.getBoundingClientRect(),{clientX:b,clientY:F}=ne(g);let w;if(i.vertical){let N=F-f.top;N=Math.min(N,f.height-e.value.offsetHeight/2),N=Math.max(e.value.offsetHeight/2,N),w=Math.round((N-e.value.offsetHeight/2)/(f.height-e.value.offsetHeight)*360)}else{let N=b-f.left;N=Math.min(N,f.width-e.value.offsetWidth/2),N=Math.max(e.value.offsetWidth/2,N),w=Math.round((N-e.value.offsetWidth/2)/(f.width-e.value.offsetWidth)*360)}i.color.set("hue",w)}function d(){if(!e.value)return 0;const g=s.vnode.el;if(i.vertical)return 0;const x=i.color.get("hue");return g?Math.round(x*(g.offsetWidth-e.value.offsetWidth/2)/360):0}function h(){if(!e.value)return 0;const g=s.vnode.el;if(!i.vertical)return 0;const x=i.color.get("hue");return g?Math.round(x*(g.offsetHeight-e.value.offsetHeight/2)/360):0}function y(){a.value=d(),r.value=h()}return ft(()=>{if(!o.value||!e.value)return;const g={drag:x=>{c(x)},end:x=>{c(x)}};Ct(o.value,g),Ct(e.value,g),y()}),{bar:o,thumb:e,thumbLeft:a,thumbTop:r,hueValue:n,handleClick:l,update:y,ns:t}}});function wa(i,t,s,e,o,a){return B(),C("div",{class:P([i.ns.b(),i.ns.is("vertical",i.vertical)])},[T("div",{ref:"bar",class:P(i.ns.e("bar")),onClick:t[0]||(t[0]=(...r)=>i.handleClick&&i.handleClick(...r))},null,2),T("div",{ref:"thumb",class:P(i.ns.e("thumb")),style:tt({left:i.thumbLeft+"px",top:i.thumbTop+"px"})},null,6)],2)}var Ba=it(ba,[["render",wa],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const Na=Gt({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:ts,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:yt(Array)},validateEvent:{type:Boolean,default:!0}}),Pa={[xt]:i=>ut(i)||qt(i),[sr]:i=>ut(i)||qt(i),activeChange:i=>ut(i)||qt(i)},gs=Symbol("colorPickerContextKey"),He=function(i,t,s){return[i,t*s/((i=(2-t)*s)<1?i:2-i)||0,i/2]},Fa=function(i){return typeof i=="string"&&i.includes(".")&&Number.parseFloat(i)===1},Ma=function(i){return typeof i=="string"&&i.includes("%")},pt=function(i,t){Fa(i)&&(i="100%");const s=Ma(i);return i=Math.min(t,Math.max(0,Number.parseFloat(`${i}`))),s&&(i=Number.parseInt(`${i*t}`,10)/100),Math.abs(i-t)<1e-6?1:i%t/Number.parseFloat(t)},Ve={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Xt=i=>{i=Math.min(Math.round(i),255);const t=Math.floor(i/16),s=i%16;return`${Ve[t]||t}${Ve[s]||s}`},We=function({r:i,g:t,b:s}){return Number.isNaN(+i)||Number.isNaN(+t)||Number.isNaN(+s)?"":`#${Xt(i)}${Xt(t)}${Xt(s)}`},It={A:10,B:11,C:12,D:13,E:14,F:15},ot=function(i){return i.length===2?(It[i[0].toUpperCase()]||+i[0])*16+(It[i[1].toUpperCase()]||+i[1]):It[i[1].toUpperCase()]||+i[1]},Ta=function(i,t,s){t=t/100,s=s/100;let e=t;const o=Math.max(s,.01);s*=2,t*=s<=1?s:2-s,e*=o<=1?o:2-o;const a=(s+t)/2,r=s===0?2*e/(o+e):2*t/(s+t);return{h:i,s:r*100,v:a*100}},qe=(i,t,s)=>{i=pt(i,255),t=pt(t,255),s=pt(s,255);const e=Math.max(i,t,s),o=Math.min(i,t,s);let a;const r=e,n=e-o,l=e===0?0:n/e;if(e===o)a=0;else{switch(e){case i:{a=(t-s)/n+(t<s?6:0);break}case t:{a=(s-i)/n+2;break}case s:{a=(i-t)/n+4;break}}a/=6}return{h:a*360,s:l*100,v:r*100}},Pt=function(i,t,s){i=pt(i,360)*6,t=pt(t,100),s=pt(s,100);const e=Math.floor(i),o=i-e,a=s*(1-t),r=s*(1-o*t),n=s*(1-(1-o)*t),l=e%6,c=[s,r,a,a,n,s][l],d=[n,s,s,r,a,a][l],h=[a,a,n,s,s,r][l];return{r:Math.round(c*255),g:Math.round(d*255),b:Math.round(h*255)}};class Tt{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const s in t)we(t,s)&&(this[s]=t[s]);t.value?this.fromString(t.value):this.doOnChange()}set(t,s){if(arguments.length===1&&typeof t=="object"){for(const e in t)we(t,e)&&this.set(e,t[e]);return}this[`_${t}`]=s,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Pt(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const s=(e,o,a)=>{this._hue=Math.max(0,Math.min(360,e)),this._saturation=Math.max(0,Math.min(100,o)),this._value=Math.max(0,Math.min(100,a)),this.doOnChange()};if(t.includes("hsl")){const e=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,a)=>a>2?Number.parseFloat(o):Number.parseInt(o,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:o,s:a,v:r}=Ta(e[0],e[1],e[2]);s(o,a,r)}}else if(t.includes("hsv")){const e=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,a)=>a>2?Number.parseFloat(o):Number.parseInt(o,10));e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3&&s(e[0],e[1],e[2])}else if(t.includes("rgb")){const e=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,a)=>a>2?Number.parseFloat(o):Number.parseInt(o,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:o,s:a,v:r}=qe(e[0],e[1],e[2]);s(o,a,r)}}else if(t.includes("#")){const e=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(e))return;let o,a,r;e.length===3?(o=ot(e[0]+e[0]),a=ot(e[1]+e[1]),r=ot(e[2]+e[2])):(e.length===6||e.length===8)&&(o=ot(e.slice(0,2)),a=ot(e.slice(2,4)),r=ot(e.slice(4,6))),e.length===8?this._alpha=ot(e.slice(6))/255*100:(e.length===3||e.length===6)&&(this._alpha=100);const{h:n,s:l,v:c}=qe(o,a,r);s(n,l,c)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:s,_value:e,_alpha:o,format:a}=this;if(this.enableAlpha)switch(a){case"hsl":{const r=He(t,s/100,e/100);this.value=`hsla(${t}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(s)}%, ${Math.round(e)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${We(Pt(t,s,e))}${Xt(o*255/100)}`;break}default:{const{r,g:n,b:l}=Pt(t,s,e);this.value=`rgba(${r}, ${n}, ${l}, ${this.get("alpha")/100})`}}else switch(a){case"hsl":{const r=He(t,s/100,e/100);this.value=`hsl(${t}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(s)}%, ${Math.round(e)}%)`;break}case"rgb":{const{r,g:n,b:l}=Pt(t,s,e);this.value=`rgb(${r}, ${n}, ${l})`;break}default:this.value=We(Pt(t,s,e))}}}const Sa=G({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(i){const t=st("color-predefine"),{currentColor:s}=Cs(gs),e=A(a(i.colors,i.color));Y(()=>s.value,r=>{const n=new Tt;n.fromString(r),e.value.forEach(l=>{l.selected=n.compare(l)})}),Rs(()=>{e.value=a(i.colors,i.color)});function o(r){i.color.fromString(i.colors[r])}function a(r,n){return r.map(l=>{const c=new Tt;return c.enableAlpha=!0,c.format="rgba",c.fromString(l),c.selected=c.value===n.value,c})}return{rgbaColors:e,handleSelect:o,ns:t}}}),Ca=["onClick"];function Ra(i,t,s,e,o,a){return B(),C("div",{class:P(i.ns.b())},[T("div",{class:P(i.ns.e("colors"))},[(B(!0),C(Wt,null,_s(i.rgbaColors,(r,n)=>(B(),C("div",{key:i.colors[n],class:P([i.ns.e("color-selector"),i.ns.is("alpha",r._alpha<100),{selected:r.selected}]),onClick:l=>i.handleSelect(n)},[T("div",{style:tt({backgroundColor:r.value})},null,4)],10,Ca))),128))],2)],2)}var _a=it(Sa,[["render",Ra],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const La=G({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(i){const t=st("color-svpanel"),s=Rt(),e=A(0),o=A(0),a=A("hsl(0, 100%, 50%)"),r=S(()=>{const c=i.color.get("hue"),d=i.color.get("value");return{hue:c,value:d}});function n(){const c=i.color.get("saturation"),d=i.color.get("value"),h=s.vnode.el,{clientWidth:y,clientHeight:g}=h;o.value=c*y/100,e.value=(100-d)*g/100,a.value=`hsl(${i.color.get("hue")}, 100%, 50%)`}function l(c){const h=s.vnode.el.getBoundingClientRect(),{clientX:y,clientY:g}=ne(c);let x=y-h.left,f=g-h.top;x=Math.max(0,x),x=Math.min(x,h.width),f=Math.max(0,f),f=Math.min(f,h.height),o.value=x,e.value=f,i.color.set({saturation:x/h.width*100,value:100-f/h.height*100})}return Y(()=>r.value,()=>{n()}),ft(()=>{Ct(s.vnode.el,{drag:c=>{l(c)},end:c=>{l(c)}}),n()}),{cursorTop:e,cursorLeft:o,background:a,colorValue:r,handleDrag:l,update:n,ns:t}}}),Ea=T("div",null,null,-1),$a=[Ea];function Aa(i,t,s,e,o,a){return B(),C("div",{class:P(i.ns.b()),style:tt({backgroundColor:i.background})},[T("div",{class:P(i.ns.e("white"))},null,2),T("div",{class:P(i.ns.e("black"))},null,2),T("div",{class:P(i.ns.e("cursor")),style:tt({top:i.cursorTop+"px",left:i.cursorLeft+"px"})},$a,6)],6)}var za=it(La,[["render",Aa],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const Ka=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],Da=G({name:"ElColorPicker"}),Ha=G({...Da,props:Na,emits:Pa,setup(i,{expose:t,emit:s}){const e=i,{t:o}=rr(),a=st("color"),{formItem:r}=es(),n=rs(),l=os(),{inputId:c,isLabeledByFormItem:d}=ss(e,{formItemContext:r}),h=A(),y=A(),g=A(),x=A();let f=!0;const b=Je(new Tt({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue})),F=A(!1),w=A(!1),N=A(""),p=S(()=>!e.modelValue&&!w.value?"transparent":rt(b,e.showAlpha)),m=S(()=>!e.modelValue&&!w.value?"":b.value),_=S(()=>d.value?void 0:e.label||o("el.colorpicker.defaultLabel")),_t=S(()=>d.value?r==null?void 0:r.labelId:void 0),lt=S(()=>[a.b("picker"),a.is("disabled",l.value),a.bm("picker",n.value)]);function rt(M,W){if(!(M instanceof Tt))throw new TypeError("color should be instance of _color Class");const{r:I,g:$t,b:At}=M.toRgb();return W?`rgba(${I}, ${$t}, ${At}, ${M.get("alpha")/100})`:`rgb(${I}, ${$t}, ${At})`}function mt(M){F.value=M}const Q=or(mt,100);function Lt(){l.value||mt(!0)}function Et(){Q(!1),vt()}function vt(){j(()=>{e.modelValue?b.fromString(e.modelValue):(b.value="",j(()=>{w.value=!1}))})}function bt(){l.value||Q(!F.value)}function J(){b.fromString(N.value)}function ht(){const M=b.value;s(xt,M),s("change",M),e.validateEvent&&(r==null||r.validate("change").catch(W=>kt())),Q(!1),j(()=>{const W=new Tt({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue});b.compare(W)||vt()})}function wt(){Q(!1),s(xt,null),s("change",null),e.modelValue!==null&&e.validateEvent&&(r==null||r.validate("change").catch(M=>kt())),vt()}return ft(()=>{e.modelValue&&(N.value=m.value)}),Y(()=>e.modelValue,M=>{M?M&&M!==b.value&&(f=!1,b.fromString(M)):w.value=!1}),Y(()=>m.value,M=>{N.value=M,f&&s("activeChange",M),f=!0}),Y(()=>b.value,()=>{!e.modelValue&&!w.value&&(w.value=!0)}),Y(()=>F.value,()=>{j(()=>{var M,W,I;(M=h.value)==null||M.update(),(W=y.value)==null||W.update(),(I=g.value)==null||I.update()})}),Ls(gs,{currentColor:m}),t({color:b,show:Lt,hide:Et}),(M,W)=>(B(),V(u(lr),{ref_key:"popper",ref:x,visible:F.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[u(a).be("picker","panel"),u(a).b("dropdown"),M.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${u(a).namespace.value}-zoom-in-top`,persistent:""},{content:K(()=>[re((B(),C("div",null,[T("div",{class:P(u(a).be("dropdown","main-wrapper"))},[$(Ba,{ref_key:"hue",ref:h,class:"hue-slider",color:u(b),vertical:""},null,8,["color"]),$(za,{ref:"svPanel",color:u(b)},null,8,["color"])],2),M.showAlpha?(B(),V(va,{key:0,ref_key:"alpha",ref:g,color:u(b)},null,8,["color"])):z("v-if",!0),M.predefine?(B(),V(_a,{key:1,ref:"predefine",color:u(b),colors:M.predefine},null,8,["color","colors"])):z("v-if",!0),T("div",{class:P(u(a).be("dropdown","btns"))},[T("span",{class:P(u(a).be("dropdown","value"))},[$(u(ua),{modelValue:N.value,"onUpdate:modelValue":W[0]||(W[0]=I=>N.value=I),"validate-event":!1,size:"small",onKeyup:Be(J,["enter"]),onBlur:J},null,8,["modelValue","onKeyup"])],2),$(u(q),{class:P(u(a).be("dropdown","link-btn")),text:"",size:"small",onClick:wt},{default:K(()=>[Ne(dt(u(o)("el.colorpicker.clear")),1)]),_:1},8,["class"]),$(u(q),{plain:"",size:"small",class:P(u(a).be("dropdown","btn")),onClick:ht},{default:K(()=>[Ne(dt(u(o)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[u(ar),Et]])]),default:K(()=>[T("div",{id:u(c),class:P(u(lt)),role:"button","aria-label":u(_),"aria-labelledby":u(_t),"aria-description":u(o)("el.colorpicker.description",{color:M.modelValue||""}),tabindex:M.tabindex,onKeydown:Be(bt,["enter"])},[u(l)?(B(),C("div",{key:0,class:P(u(a).be("picker","mask"))},null,2)):z("v-if",!0),T("div",{class:P(u(a).be("picker","trigger")),onClick:bt},[T("span",{class:P([u(a).be("picker","color"),u(a).is("alpha",M.showAlpha)])},[T("span",{class:P(u(a).be("picker","color-inner")),style:tt({backgroundColor:u(p)})},[re($(u(at),{class:P([u(a).be("picker","icon"),u(a).is("icon-arrow-down")])},{default:K(()=>[$(u(ir))]),_:1},8,["class"]),[[Ge,M.modelValue||w.value]]),!M.modelValue&&!w.value?(B(),V(u(at),{key:0,class:P([u(a).be("picker","empty"),u(a).is("icon-close")])},{default:K(()=>[$(u(nr))]),_:1},8,["class"])):z("v-if",!0)],6)],2)],2)],42,Ka)]),_:1},8,["visible","popper-class","transition"]))}});var Va=it(Ha,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const te=ie(Va),Wa=Gt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:yt(String),default:"solid"}}),qa=G({name:"ElDivider"}),Ua=G({...qa,props:Wa,setup(i){const t=i,s=st("divider"),e=S(()=>s.cssVar({"border-style":t.borderStyle}));return(o,a)=>(B(),C("div",{class:P([u(s).b(),u(s).m(o.direction)]),style:tt(u(e)),role:"separator"},[o.$slots.default&&o.direction!=="vertical"?(B(),C("div",{key:0,class:P([u(s).e("text"),u(s).is(o.contentPosition)])},[Ft(o.$slots,"default")],2)):z("v-if",!0)],6))}});var Xa=it(Ua,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const ee=ie(Xa);class Ya extends nt{constructor(t,s){super(),this.x=0,this.y=0,this.w=20,this.h=14,this.fillStyle="#eeb174",this.strokeStyle="#333",this.ctx=t,this.analysisOptions(s)}analysisOptions(t){t.x&&(this.x=t.x),t.y&&(this.y=t.y),t.w&&(this.w=t.w),t.h&&(this.h=t.h),t.fillStyle&&(this.fillStyle=t.fillStyle),t.strokeStyle&&(this.strokeStyle=t.strokeStyle),t.tiggerFunc&&(this.tiggerFunc=t.tiggerFunc)}draw(){const{ctx:t,x:s,y:e,w:o,h:a,fillStyle:r,strokeStyle:n}=this;t.save(),t.fillStyle=r,t.strokeStyle=n,t.lineWidth=3,t.beginPath(),t.arc(s+o/2,e-3,o/3,0,Math.PI,!0),t.stroke(),t.drawRoundedRect(s,e,o,a,2,2,2,2,!0,!0,!1,!1),t.restore()}containsPoint(t,s=!1){var y;const{x:e,y:o,w:a,h:r}=this,{x:n,y:l}=t,c=this.getImageLines({tl:{x:e,y:o},tr:{x:e+a,y:o},bl:{x:e,y:o+r},br:{x:e+a,y:o+r}}),h=!!(this.findCrossPoints(n,l,c)%2);return h&&s&&((y=this.tiggerFunc)==null||y.call(this)),h}}const ka=function(i){return i.length===4&&(i=i.slice(0,2)+i.slice(1,2)+i.slice(2,3)+i.slice(2,3)+i.slice(3,4)+i.slice(3,4)),"rgb("+parseInt("0x"+i.slice(1,3))+","+parseInt("0x"+i.slice(3,5))+","+parseInt("0x"+i.slice(5,7))+")"},Ga=function(i){const s=(i.includes("rgb")?i:ka(i)).replace(/rgb\(|rgba\(|\)/g,"").split(",");return .213*s[0]+.715*s[1]+.072*s[2]>255/2};class ct extends nt{constructor(t,s){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=16,this.padding=10,this.attrHeight=16,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.bgColor="#FFFFFF",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s,y:e,width:o,height:a,id:r,enName:n,cnName:l,type:c,attributes:d,bgC:h,bdC:y,quotePrimaryKey:g,physicalTables:x,manualChange:f}=t;k(s)&&(this.x=s),k(e)&&(this.y=e),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),k(o)&&(this.width=o),k(a)&&(this.height=a),c&&(this.type=c),d&&(this.attributes=d,this.attributesPartition()),h&&(this.bgColor=h),y&&(this.borderColor=y),gt(g)&&(this.quotePrimaryKey=g),gt(x)&&(this.physicalTables=x),gt(f)&&(this.manualChange=f)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t,s=!1){const{x:e,y:o}=t,{x:a,y:r,width:n,height:l,attrHeight:c,titleHeight:d,attributes:h}=this,y=this.getImageLines({tl:{x:a,y:r},tr:{x:a+n,y:r},bl:{x:a,y:r+l},br:{x:a+n,y:r+l}});return!!(this.findCrossPoints(e,o,y)%2)}draw(t){this.updateOptions(t),this.drawContainer(),this.drawTitle(),this.drawbody()}drawContainer(){const{ctx:t,x:s,y:e,width:o,height:a,enName:r,cnName:n,type:l,attributes:c,bgColor:d,borderColor:h,textColor:y,quotePrimaryKey:g,physicalTables:x}=this;if(t.save(),t.strokeStyle=h,t.fillStyle=d,["exclusive","inclusive"].includes(l))t.beginPath(),t.arc(s+o/2,e+o/2,o/2,0,Math.PI,!0),t.closePath(),t.fill(),t.stroke(),l==="exclusive"&&(t.moveTo(s+12,e+6),t.lineTo(s+o-12,e+a-3),t.moveTo(s+o-12,e+6),t.lineTo(s+12,e+a-3),t.stroke());else{const f=g?4:0;t.drawRoundedRect(s,e,o,a,f,f,f,f,!0,!0,x,!0)}t.restore()}drawDataType(t,s,e){const o=t==null?void 0:t.toLocaleUpperCase();let a;if(o in hr?a=Ot.get("date"):o in dr?a=Ot.get("number"):o in cr&&(a=Ot.get("string")),!a)return!1;const{ctx:r}=this;r.drawImage(a,s-6,e-2)}drawTitle(){const{ctx:t,textColor:s,enName:e,width:o,x:a,y:r,titleHeight:n,fontSize:l}=this;t.save(),t.font=`${l}px`,t.fillStyle=s,t.textAlign="left",t.textBaseline="top",t.fillText(t.fittingString(e,o-14),a,r-n),t.restore()}drawbody(){const{ctx:t,x:s,y:e,bgColor:o,fontSize:a,padding:r,attrHeight:n,attributesPrimary:l,attributesPrimaryNon:c}=this;t.save(),t.font=`${a}px`,t.fillStyle=Ga(o)?"#000":"#fff",t.textAlign="left",t.textBaseline="top";const d=r+s;let h=e+r-n;for(let y=0;y<l.length;y++){const g=l[y];h=this.drawAttrRow(g,d,h)}h=this.drawSplitLine(h);for(let y=0;y<c.length;y++){const g=c[y];h=this.drawAttrRow(g,d,h)}t.restore()}drawAttrRow(t,s,e){var f;const{ctx:o,attrHeight:a,padding:r,fontSize:n,x:l,y:c,width:d,height:h}=this;if(e+=a,e+16>h+c)return;const y=t.foreignKey?"(FK)":"",g=o.fittingString(t.attrName+y,d-(s-l)-r);o.fillText(g,s,e);const x=s+o.measureText(g).width;if(this.drawIcons(t.icons,x,e),(f=t.children)!=null&&f.length){const b=this.expandAttrs.includes(t);this.drawTreeExpandArrow.call(this,{x:s,y:e,size:n,expand:b}),b&&t.children.forEach(F=>{e=this.drawAttrRow(F,s+10,e)})}return e}drawIcons(t=[],s,e){const{fontSize:o,x:a,width:r,padding:n}=this;for(let l=0;l<t.length;l++){const c=t[l],d=s+o*.7+l*(o*1.2);if(d+o/2*3>a+r+n)return;this.drawIcon(c,d,e)}}drawIcon(t,s,e){const{ctx:o,attrHeight:a,fontSize:r}=this;o.save(),o.beginPath(),o.strokeStyle=t.bdC||"#0C64EB",o.fillStyle=t.bgC||"#ECF5FF",o.arc(s,e+Math.floor(a/2)-1,r/2,0,2*Math.PI),o.fill(),o.stroke(),o.fillStyle=t.color||"#0C64EB",o.font=`${Math.ceil(r/1.2)}px Arial`,o.textAlign="center",o.fillText(t.text,s,e+(a-r)/2+1),o.restore()}drawSplitLine(t){const{ctx:s,attributesPrimary:e,attrHeight:o,x:a,y:r,width:n,height:l}=this;return t+=(e.length?1:2)*o,s.save(),t<l+r&&(s.beginPath(),s.strokeStyle="#000",s.moveTo(a+.5,t+o/3+.5),s.lineTo(a+n+.5,t+o/3+.5),s.stroke()),s.restore(),t}drawTreeExpandArrow({x:t,y:s,size:e,expand:o}){const{ctx:a}=this;a.save(),a.beginPath(),a.translate(t-4,s+e/2),o&&a.rotate(90*Math.PI/180),a.moveTo(-2,-4),a.lineTo(-2,4),a.lineTo(2,0),a.fill(),a.restore()}drawFocusAttr({attrItem:t,finalText:s,curX:e,curY:o,fullWidth:a,nodePadding:r}){var h,y;const{ctx:n,attrFocusStyle:l}=this,c=(h=t==null?void 0:t.children)!=null&&h.length?e:e-r/2,d=(y=t==null?void 0:t.children)!=null&&y.length?a-r/2:a;n.save(),n.fillStyle=l.backgroundColor,n.fillRect(c,o-1,d,16),n.fillStyle=l.color,n.fillText(s,e,o),n.restore()}attributesPartition(){this.attributesPrimary=[],this.attributesPrimaryNon=[];const{attributes:t,attributesPrimary:s,attributesPrimaryNon:e}=this;for(let o=0;o<t.length;o++){const a=t[o];a.primaryKey?s.push(a):e.push(a)}}calcBoundingBox(){const{x:t,y:s,width:e,height:o}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+o],[t+e,s+o]]}}class St extends nt{constructor(t,s){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=16,this.padding=10,this.attrHeight=16,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=t,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(t){if(!t)return;const{x:s,y:e,width:o,height:a,id:r,enName:n,cnName:l,type:c,attributes:d,bgC:h,bdC:y,quotePrimaryKey:g,physicalTables:x,manualChange:f}=t;k(s)&&(this.x=s),k(e)&&(this.y=e),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),k(o)&&(this.width=o),k(a)&&(this.height=a),c&&(this.type=c),h&&(this.bgColor=h),y&&(this.borderColor=y),gt(g)&&(this.quotePrimaryKey=g),gt(x)&&(this.physicalTables=x),gt(f)&&(this.manualChange=f)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t,s=!1){const{x:e,y:o}=t,{x:a,y:r,width:n,height:l,attrHeight:c,titleHeight:d,attributes:h}=this,y=this.getImageLines({tl:{x:a,y:r},tr:{x:a+n,y:r},bl:{x:a,y:r+l},br:{x:a+n,y:r+l}});return!!(this.findCrossPoints(e,o,y)%2)}draw(t){this.analysisOptions(t),this.drawRect()}drawRect(){const{ctx:t,x:s,y:e,width:o,height:a,enName:r,cnName:n,type:l,attributes:c,bgColor:d,borderColor:h,textColor:y,quotePrimaryKey:g,physicalTables:x}=this;t.save(),t.lineWidth=2.5,t.strokeStyle=h||"#000000",t.fillStyle=d||"#ffffff",t.drawRoundedRect(s,e,o,a,0,0,0,0,!!d,!0,!1,!1),t.restore()}drawAttrRow(t,s,e){const{ctx:o,attrHeight:a,padding:r,fontSize:n,x:l,y:c,width:d,height:h}=this;if(e+=a,!(e+16>h+c))return e}calcBoundingBox(){const{x:t,y:s,width:e,height:o}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+o],[t+e,s+o]]}}const Ue=(i,t,s=0)=>{const{x:e,y:o}=i,a=s||0,r=s||0;for(let n=0;n<t.length-1;n++){const l=t[n],c=t[n+1],d=l.y-c.y,h=c.x-l.x,y=l.x*c.y-c.x*l.y;if(Math.abs(d*e+h*o+y)/Math.sqrt(d*d+h*h)<=a&&e>=Math.min(l.x,c.x)-a&&e<=Math.max(l.x,c.x)+a&&o>=Math.min(l.y,c.y)-r&&o<=Math.max(l.y,c.y)+r)return n}return!1};class et extends nt{constructor(t,s){super(),this.pos=[],this.lineWidth=1,this.strokeStyle="#000000",this.ctx=t,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(t){if(!t)return;const{pos:s,type:e,from:o,to:a,id:r,lineWidth:n,numLineTypes:l,strokeStyle:c}=t;r&&(this.id=r),o&&(this.from=o),a&&(this.to=a),s&&(this.pos=s),e&&(this.type=e),l&&(this.numLineTypes=l),n&&(this.lineWidth=n),c&&(this.strokeStyle=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}draw(t){this.analysisOptions(t),this.drawLine(),this.drawEnds(),this.drawNote()}containsPoint(t,s){const{pos:e}=this;return k(Ue(t,e,5))}getIndexInPos(t){return Ue(t,this.pos,5)}drawLine(){const{ctx:t,strokeStyle:s,lineWidth:e,type:o,pos:a}=this;t.save(),t.strokeStyle=s,t.lineWidth=e,o==="foreignKey"&&t.setLineDash([8,5]),a.forEach((r,n)=>{n===0?(t.beginPath(),t.moveTo(r.x,r.y)):t.lineTo(r.x,r.y)}),t.stroke(),t.restore()}drawEnds(){const{ctx:t,pos:s,strokeStyle:e,lineWidth:o,numLineTypes:a}=this,r=15,n=s.length||0;if(!(n<2)){if(t.save(),t.beginPath(),t.setLineDash([0,0]),t.strokeStyle=e,t.lineWidth=o,s[0].x===s[1].x){const l=s[1].y-s[0].y,c=Math.abs(l)<10?l<0?s[0].y-1:s[0].y+1:l<0?s[0].y-10:s[0].y+10;t.moveTo(s[0].x-r/2,c),t.lineTo(s[0].x+r/2,c)}else{const l=s[1].x-s[0].x,c=Math.abs(l)<10?l<0?s[0].x-1:s[0].x+1:l<0?s[0].x-10:s[0].x+10;t.moveTo(c,s[0].y-r/2),t.lineTo(c,s[0].y+r/2)}if(s[n-2].x===s[n-1].x){const l=s[n-1].y-s[n-2].y,c=Math.abs(l)<10?l<0?s[n-1].y+1:s[n-1].y-1:l<0?s[n-1].y+10:s[n-1].y-10;if(t.moveTo(s[n-1].x-r/2,c),t.lineTo(s[n-1].x+r/2,c),t.stroke(),[1,2].includes(a)&&(t.moveTo(s[n-1].x-r/2,s[n-1].y),t.lineTo(s[n-1].x,c),t.lineTo(s[n-1].x+r/2,s[n-1].y),t.stroke()),[1,4].includes(a)){t.beginPath();const d=s[n-1].x,h=l<0?c+r/2:c-r/2;t.arc(d,h,(r-2)/2,0,360,!1),t.fillStyle="#fff",t.fill(),t.stroke()}}else{const l=s[n-1].x-s[n-2].x,c=Math.abs(l)<10?l<0?s[n-1].x+1:s[n-1].x-1:l<0?s[n-1].x+10:s[n-1].x-10;if(t.moveTo(c,s[n-1].y-r/2),t.lineTo(c,s[n-1].y+r/2),t.stroke(),[1,2].includes(a)&&(t.moveTo(s[n-1].x,s[n-1].y-r/2),t.lineTo(c,s[n-1].y),t.lineTo(s[n-1].x,s[n-1].y+r/2),t.stroke()),[1,4].includes(a)){t.beginPath();const d=l<0?c+r/2:c-r/2,h=s[n-1].y;t.arc(d,h,(r-2)/2,0,360,!1),t.fillStyle="#fff",t.fill(),t.stroke()}}t.restore()}}drawNote(){const{ctx:t,pos:s,remark:e}=this;if(!e)return;const o=Math.floor(s.length/2)-1;let a,r,n;s[o].y===s[o+1].y?(n=!1,a=Math.abs(s[o+1].x-s[o].x)/2+Math.min(s[o+1].x,s[o].x),r=s[o].y-10):(n=!0,a=s[o].x+10,r=Math.abs(s[o+1].y-s[o].y)/2+Math.min(s[o+1].y,s[o].y)-t.measureText(e).width/2),t.textAlign="center",n?t.fillRowText(e,a,r,16,16):t.fillText(e,a,r)}calcBoundingBox(){const{pos:t}=this,s=[],e=[];for(let o=0;o<t.length;o++){const a=t[o];s.push(a.x),e.push(a.y)}this.boundingBox=[[Math.min(...s),Math.min(...e)],[Math.max(...s),Math.max(...e)]]}}class Ja{constructor(t=20){this.history=[],this.currentIndex=-1,this.maxSteps=t,this.compressTime=200}push(t){typeof t=="function"&&(t={reverse:t}),t.time||(t.time=new Date),this.history.splice(this.currentIndex+1),this.history.push(t),this.currentIndex++,this.history.length>this.maxSteps&&(this.history.splice(0,1),this.currentIndex--)}canMerge(t,s){const o=Number(s.time)-Number(t.time)<=this.compressTime,a=t.targetId===s.targetId,r=t.operationType===s.operationType;return o&&a&&r}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.history.length-1}undo(){if(this.canUndo()){const t=this.history[this.currentIndex];return this.currentIndex--,t}return null}redo(){return this.canRedo()?(this.currentIndex++,this.history[this.currentIndex]):null}clear(){this.history=[],this.currentIndex=-1}getHistory(){return this.history}getCurrentIndex(){return this.currentIndex}getMaxSteps(){return this.maxSteps}setMaxSteps(t){this.maxSteps=t,this.history.length>this.maxSteps&&(this.history.splice(0,this.history.length-this.maxSteps),this.currentIndex-=this.history.length-this.maxSteps)}}const Za=(i,t=-1/0,s=1/0)=>Math.max(Math.min(i,s),t);class de extends nt{constructor(t,s){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.borderColor="#0C64EB",this.textColor="#0C64EB",this.bgColor="#D0E2FF",this.borderWidth=1,this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,id:o,borderColor:a,textColor:r,bgColor:n,borderWidth:l,content:c}=t;k(s)&&(this.x=s),k(e)&&(this.y=e),o&&(this.id=o),a&&(this.borderColor=a),r&&(this.textColor=r),n&&(this.bgColor=n),k(l)&&(this.borderWidth=l),c&&(this.content=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t,s=!1){const{x:e,y:o}=t,{x:a,y:r,width:n,height:l}=this;return e>=a&&e<=a+n&&o>=r&&o<=r+l}draw(t){this.updateOptions(t);const{ctx:s,content:e,x:o,y:a,textColor:r}=this;s.save(),s.textBaseline="top",s.fillStyle=r,s.fillText(e,o,a),s.restore()}calcBoundingBox(){const{x:t,y:s,ctx:e,content:o}=this,a=e.measureText(o),r=this.width=a.width,n=this.height=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;this.boundingBox=[[t,s],[t+r,s],[t,s+n],[t+r,s+n]]}}class Qa extends nt{constructor(t,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=1,this.borderColor="blue",this.targetWidth=6,this.targetBgColor="#FFFFFF",this.targetBdColor="#B4B4B4",this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,width:o,height:a,targetBgColor:r,targetBdColor:n,bdC:l,lineWidth:c}=t;s&&(this.x=s),e&&(this.y=e),o&&(this.width=o),a&&(this.height=a),r&&(this.targetBgColor=r),n&&(this.targetBdColor=n),l&&(this.borderColor=l),c&&(this.lineWidth=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t,s=!1){return!1}draw(t){this.updateOptions(t),this.drawBorder(),this.drawTargets()}drawBorder(){const{ctx:t,borderColor:s,lineWidth:e,x:o,y:a,width:r,height:n}=this;t.save(),t.lineWidth=e,t.strokeStyle=s,t.strokeRect(o,a,r,n),t.restore()}drawTargets(){const{ctx:t,targetBdColor:s,targetBgColor:e,targetWidth:o,x:a,y:r,width:n,height:l}=this,c=o/2,d=a-c,h=r-c;t.save(),t.strokeStyle=s,t.fillStyle=e,t.fillRect(d,h,o,o),t.fillRect(d,h+l/2,o,o),t.fillRect(d,h+l,o,o),t.fillRect(d+n/2,h,o,o),t.fillRect(d+n/2,h+l,o,o),t.fillRect(d+n,h,o,o),t.fillRect(d+n,h+l/2,o,o),t.fillRect(d+n,h+l,o,o),t.strokeRect(d,h,o,o),t.strokeRect(d,h+l/2,o,o),t.strokeRect(d,h+l,o,o),t.strokeRect(d+n/2,h,o,o),t.strokeRect(d+n/2,h+l,o,o),t.strokeRect(d+n,h,o,o),t.strokeRect(d+n,h+l/2,o,o),t.strokeRect(d+n,h+l,o,o),t.restore()}calcBoundingBox(){const{x:t,y:s,width:e,height:o}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+o],[t+e,s+o]]}}class Oa extends nt{constructor(t,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.borderColor="blue",this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,width:o,height:a,bdC:r}=t;s&&(this.x=s),e&&(this.y=e),o&&(this.width=o),a&&(this.height=a),r&&(this.borderColor=r)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t,s=!1){return!1}draw(t){this.updateOptions(t),this.drawBorder()}drawBorder(){const{ctx:t,borderColor:s,x:e,y:o,width:a,height:r}=this;t.save(),t.strokeStyle=s,t.strokeRect(e,o,a,r),t.restore()}calcBoundingBox(){const{x:t,y:s,width:e,height:o}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+o],[t+e,s+o]]}}var U=(i=>(i.addNode="addNode",i.primaryKey="primaryKey",i.foreignKey="foreignKey",i.branchLine="branchLine",i.addMark="addMark",i.addNote="addNote",i.copy="copy",i))(U||{}),D=(i=>(i.NONE="",i.LT="LT",i.TM="TM",i.RT="RT",i.LM="LM",i.RM="RM",i.LB="LB",i.BM="BM",i.RB="RB",i))(D||{}),E=(i=>(i.default="default",i.none="none",i.wait="wait",i.progress="progress",i.crosshair="crosshair",i.cell="cell",i.text="text",i.move="move",i.colResize="col-resize",i.rowResize="row-resize",i.ewResize="ew-resize",i.nsResize="ns-resize",i.neswResize="nesw-resize",i.nwseResize="nwse-resize",i.copy="copy",i.help="help",i.grab="grab",i.grabbing="grabbing",i.pointer="pointer",i.notAllowed="not-allowed",i.zoomIn="zoom-in",i.zoomOut="zoom-out",i.contextMenu="context-menu",i))(E||{});const ps=(i,t)=>{const{x:s,y:e,width:o,height:a}=i,r=s+o/2,n=e+a/2,l=s+o,c=e+a,d=5;let h=D.NONE;return Math.abs(s-t.x)<=d&&Math.abs(e-t.y)<=d?h=D.LT:Math.abs(r-t.x)<=d&&Math.abs(e-t.y)<=d?h=D.TM:Math.abs(l-t.x)<=d&&Math.abs(e-t.y)<=d?h=D.RT:Math.abs(s-t.x)<=d&&Math.abs(n-t.y)<=d?h=D.LM:Math.abs(l-t.x)<=d&&Math.abs(n-t.y)<=d?h=D.RM:Math.abs(s-t.x)<=d&&Math.abs(c-t.y)<=d?h=D.LB:Math.abs(r-t.x)<=d&&Math.abs(c-t.y)<=d?h=D.BM:Math.abs(l-t.x)<=d&&Math.abs(c-t.y)<=d&&(h=D.RB),h},ja=function(i,t){const s=()=>{const{eventObj:d}=this,h={x:t.x-d.targetOffsetX-d.target.x,y:t.y-d.targetOffsetY-d.target.y},y={x:d.target.x+h.x,y:d.target.y+h.y};this.markMap.get(d.target.id).updateOptions(y),this.emit("mark:move",this.markMap.get(d.target.id)),this.update()},e=()=>{const{eventObj:d}=this,h={x:t.x-d.targetOffsetX-d.target.x,y:t.y-d.targetOffsetY-d.target.y},y={x:d.target.x+h.x,y:d.target.y+h.y};this.noteMap.get(d.target.id).updateOptions(y),this.emit("note:move",d.target),this.update()},o=()=>{const{eventObj:d}=this,{x:h,y}=t;d.target.type==="mark"?this.resizeNode(h,y,d,null):this.resizeNode(h,y,d),this.update()},a=()=>{const{focusTarget:d,eventObj:h,nodeRelatedLineMap:y}=this,g={x:t.x-h.targetOffsetX-h.target.x,y:t.y-h.targetOffsetY-h.target.y};d.forEach(x=>{const f={x:x.x+g.x,y:x.y+g.y};y.has(x.id)&&[...y.get(x.id).from,...y.get(x.id).to].forEach(F=>{F.from===F.to?this.moveLineForSameNode(F,{target:x}):this.moveLineForNode(F,{target:x},f)}),this.nodeMap.get(x.id).updateOptions(f),this.emit("node:move",x)}),this.update()},r=()=>{const{eventObj:d}=this,h=d.target.getIndexInPos(d.lastEvLoc);d.targetLineStartPointIdx=h,d.lastEvLoc=t,h!==!1&&(this.moveLineForLine(d,t),this.update())};return{changeMouseCursor:()=>{const{editType:d,renderElements:h}=this,g={[U.addNode]:E.cell,[U.primaryKey]:E.crosshair,[U.foreignKey]:E.crosshair,[U.branchLine]:E.crosshair,[U.addMark]:E.cell,[U.addNote]:E.text,[U.copy]:E.copy}[d];if(g)return this.canvas.eventEl.style.cursor=g||E.default;let x=null,f=E.default;for(let b=h.length-1;b>=0;b--){const F=h[b],w=F.containsPoint(t)||ps(F,t);if(w){x=F,f=w===D.LT?E.nwseResize:w===D.TM?E.nsResize:w===D.RT?E.neswResize:w===D.LM||w===D.RM?E.ewResize:w===D.LB?E.neswResize:w===D.BM?E.nsResize:w===D.RB?E.nwseResize:E.move;break}}this.hoverTarget=x,this.canvas.eventEl.style.cursor=f,this.updateEventCanvas()},moveCanvas:()=>{this.canvas.setTranslate(i),this.canvas.clearEventCanvas();const d=this.canvas.getTranslate();this.emit("graph:move",d),this.update()},moveElement:()=>{const{focusTarget:d,eventObj:h}=this,y=!!h.targetDirection,g=h.target instanceof ct,x=h.target instanceof et,f=h.target instanceof St,b=h.target instanceof de;if(y)return o();if(g)return a();if(x)return r();if(f)return s();if(b)return e()}}},Ia=function(i,t){const{x:s,y:e}=t;return{execTask:()=>{var c,d,h,y,g;const{editType:r,defaultWidth:n,defaultHeight:l}=this;switch(r){case U.copy:const x={x:s-((d=(c=this.copyTarget)==null?void 0:c[0])==null?void 0:d.x),y:e-((y=(h=this.copyTarget)==null?void 0:h[0])==null?void 0:y.y)},f=this.copyTarget.filter(N=>!!N.attributes).map(N=>(N.x=N.x+x.x,N.y=N.y+x.y,N));(g=this.externalFn)==null||g.handlePaste(f),this.editType="",this.canvas.eventEl.style.cursor=E.default,this.update();break;case U.addNode:const b=Object.assign(this.addNodeDefaultAttr,{x:s-n/2,y:e-l/2,width:n,height:l});this.externalFn.addNode(b),this.addNodeDefaultAttr={},this.editType="",this.canvas.eventEl.style.cursor=E.default,this.update();break;case U.addMark:const F={key:this.createKey(),x:s,y:e,width:n,height:l,type:"mark"};this.externalFn.addMark(F),this.editType="",this.canvas.eventEl.style.cursor=E.default,this.update();break;case U.addNote:const w={key:this.createKey(),x:s,y:e,text:"",type:"note"};this.externalFn.addNote(w),this.editType="",this.canvas.eventEl.style.cursor=E.default;break}},setEventTarget:r=>{const{metaKey:n,shiftKey:l,ctrlKey:c}=r,{renderElements:d,focusTarget:h,eventObj:y}=this;!c&&!n&&h.clear(),this.canvas.eventEl.style.cursor=E.grabbing;for(let g=0;g<d.length;g++){const x=d[g],f=ps(x,t);if(x.containsPoint(t,!1)||f){y.target=x,x instanceof et?(h.clear(),y.lastEvLoc=t):(x instanceof ct||x instanceof de||x instanceof St)&&(y.targetOffsetX=t.x-x.x,y.targetOffsetY=t.y-x.y,y.targetDirection=f),h.add(x);break}}this.update()}}},ti=function(i,t){return{resetMouseState:()=>{this.canvas.eventEl.style.cursor=E.default,this.eventObj={target:null,targetDirection:D.NONE,targetOffsetX:0,targetOffsetY:0}}}};class ei extends ur{constructor(t){super(),this._data={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},this.eventObj={target:null,targetDirection:D.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}},this.useRightMenu=!1,this.rightMenuConfig=[],this.bufferWidth=40,this.chooseTargets=[],this.imgList={},this.editable=1,this.showLockIcon=!0,this.defaultWidth=100,this.defaultHeight=50,this.focusTarget=new Set,this.useAttrFocus=!1,this.expandAttrs=[],this.analysisOptions(t),this.mountCanvas(),this.mountCanvasEvents(),this.mountPlugins(),this.update()}analysisOptions(t){const{el:s,data:e,externalFn:o,editable:a,fontFamily:r,rightMenu:n,useRightMenu:l=!1,useAttrFocus:c=!1,useThumbnail:d=!1}=t;this.el=s,this.editable=a||1,this.fontFamily=r,this.rightMenuConfig=n,this.useRightMenu=l,this.useAttrFocus=c,this.useThumbnail=d,this.externalFn=o}destroy(){this.unmountPlugins(),this.unmountCanvasEvents(),this.canvas.destroy()}mountCanvas(){this.canvas=new yr({mountEl:this.el,backgroundType:gr.Checker}),this.cacheCtx=this.canvas.cacheCtx}mountPlugins(){this.history=new Ja,this.plugins=new pr,this.useThumbnail&&this.plugins.use(Ht.Thumbnail,{mountEl:this.el,mainCanvas:this.canvas}),this.useRightMenu&&this.plugins.use(Ht.RightMenu,this.el,this.rightMenuConfig)}unmountPlugins(){this.plugins.destroy()}mountCanvasEvents(){this._bindEventMousedown=this.onMouseDown.bind(this),this._bindEventMousemove=this.onMouseMove.bind(this),this._bindEventMouseup=this.onMouseUp.bind(this),this._bindEventResize=this.onResize.bind(this),this._bindEventWheel=this.onWheel.bind(this),this._bindEventContextmenu=this.onContextmenu.bind(this),this._bindEventUndo=this.onUndo.bind(this),this._bindEventRedo=this.onRedo.bind(this),this.canvas.on("canvas:resize",this._bindEventResize),this.canvas.on("canvas:wheel",this._bindEventWheel),this.canvas.on("canvas:mouseup",this._bindEventMouseup),this.canvas.on("canvas:mousedown",this._bindEventMousedown),this.canvas.on("canvas:mousemove",this._bindEventMousemove),this.canvas.on("canvas:contextmenu",this._bindEventContextmenu),this.canvas.on("canvas:undo",this._bindEventUndo),this.canvas.on("canvas:redo",this._bindEventRedo)}unmountCanvasEvents(){this.canvas.off("canvas:resize",this._bindEventResize),this.canvas.off("canvas:wheel",this._bindEventWheel),this.canvas.off("canvas:mouseup",this._bindEventMouseup),this.canvas.off("canvas:mousedown",this._bindEventMousedown),this.canvas.off("canvas:mousemove",this._bindEventMousemove),this.canvas.off("canvas:contextmenu",this._bindEventContextmenu),this.canvas.off("canvas:undo",this._bindEventUndo),this.canvas.off("canvas:redo",this._bindEventRedo)}onUndo(t){const s=this.history.undo();s==null||s.reverse(),s||console.warn("撤无可撤")}onRedo(t){const s=this.history.redo();s==null||s.reverse(),s||console.warn("恢无可恢")}onMouseUp(t,s){const{resetMouseState:e}=ti.call(this,t,s);e()}onMouseDown(t,s){const{editType:e}=this,{execTask:o,setEventTarget:a}=Ia.call(this,t,s);if(e)return o();a(t)}onMouseMove(t,s){const{canvas:e,eventObj:o}=this,{changeMouseCursor:a,moveCanvas:r,moveElement:n}=ja.call(this,t,s),l=!e.isMouseDown,c=e.isMouseDown&&!o.target,d=e.isMouseDown&&o.target;if(l)return a();if(c)return r();if(d){const h=[...this.focusTarget].map(y=>{const g={target:y,originValue:{}};return y.x&&(g.originValue.x=y.x),y.y&&(g.originValue.y=y.y),y.width&&(g.originValue.width=y.width),y.height&&(g.originValue.height=y.height),y.pos&&(g.originValue.pos=Qo(y.pos)),g});return this.history.push(()=>{this.focusTarget.clear(),h.map(y=>this.focusTarget.add(y.target));for(let y=0;y<h.length;y++){const{target:g,originValue:x}=h[y];g.updateOptions(x),g instanceof ct&&this.emit("node:move",g),g instanceof et&&this.emit("line:move",g)}this.update()}),n()}}onContextmenu(t){if(!this.useRightMenu)return;const{clientX:s,clientY:e,view:{innerWidth:o,innerHeight:a}}=t;this.plugins.get(Ht.RightMenu).show({top:e,left:s,innerWidth:o,innerHeight:a}),this.emit("graph:contextmenu",t)}onWheel(t){const{deltaY:s,deltaX:e,ctrlKey:o,shiftKey:a}=t;if(Math.abs(s)>2||Math.abs(e)>2)if(o){const n=this.canvas.zoomRate,l=Math.floor(Za(n*100+s,10,200));this.zoom(l)}else{const n=this.canvas.getTranslate();this.canvas.setTranslate({x:n.x-e,y:n.y-s}),this.update()}}onResize(){this.update()}initNodes(){const{_data:{nodeDataArray:t},nodeRelatedLineMap:s}=this;if(t!=null&&t.length)for(let e=0;e<t.length;e++){const o=t[e];let a=this.nodeMap.get(o.key);a||(a=new ct(this.canvas.cacheCtx,{id:o.key,enName:o.tableName,cnName:o.cnName,type:o.type,x:o.x,y:o.y,width:o.width,height:o.height,attributes:o.attributes,bdC:o.bdC,bgC:o.bgC,quotePrimaryKey:o.quotePrimaryKey,physicalTables:o.physicalTables}),this.nodeMap.set(o.key,a),s.has(o.key)||s.set(o.key,{from:new Set,to:new Set}))}}renderNodes(){const{nodeMap:t,_data:s,renderElements:e}=this,o=s.nodeDataArray;for(let a=0;a<o.length;a++){const r=o[a],n=t.get(r.key);n.updateOptions(r),this.canvas.isVisible(n.boundingBox)&&(e.push(n),n.draw())}}renderLines(){const{lineMap:t,_data:s,renderElements:e,nodeRelatedLineMap:o}=this,a=s.linkDataArray;for(let r=0;r<a.length;r++){const n=a[r];let l=t.get(n.key);l?l.updateOptions(n):(l=new et(this.canvas.cacheCtx,{pos:n.pos,type:n.type,from:n.from,to:n.to,id:n.key,numLineTypes:n.numLineTypes}),this.lineMap.set(n.key,l)),o.has(l.from)||o.set(l.from,{from:new Set,to:new Set}),o.has(l.to)||o.set(l.to,{from:new Set,to:new Set}),o.get(l.from).from.add(l),o.get(l.to).to.add(l),this.canvas.isVisible(l.boundingBox)&&(e.push(l),l.draw())}}renderNote(){const{_data:{noteDataArray:t},noteMap:s,renderElements:e}=this;for(let o=0;o<t.length;o++){const a=t[o];let r=s.get(a.key);r?r.updateOptions(a):(r=new de(this.canvas.cacheCtx,{id:a.key,content:a.text,textColor:a.color,x:a.x,y:a.y}),this.noteMap.set(a.key,r)),this.canvas.isVisible(r.boundingBox)&&(e.push(r),r.draw())}}update(t){this.renderElements=[],t&&(this._data=t,this.lineMap=new Map,this.markMap=new Map,this.noteMap=new Map,this.nodeMap=new Map,this.nodeRelatedLineMap=new Map,this.focusTarget.clear(),this.initNodes()),this.canvas.clearCacheCanvas();const s=this.cacheCtx;s.font="15px "+this.fontFamily,s.save(),this._drawMarks(),this.renderLines(),this.renderNodes(),this.renderNote(),s.restore(),this.editable===2&&this.showLockIcon&&this._drawLock(),this.canvas.update(),this.updateEventCanvas(),this.updateThumbnail()}async updateThumbnail(){const{_data:{nodeDataArray:t}}=this,s=this.plugins.get(Ht.Thumbnail);if(!s)return!1;await xr();const{width:e,height:o}=this.canvas.getRenderSize();let a=0,r=0,n=e,l=o;for(let c=0;c<t.length;c++){const d=t[c],{x:h,y,width:g,height:x}=d;h<a&&(a=h),y<r&&(r=y),h+g>n&&(n=h+g),y+x>l&&(l=y+x)}s.draw(a,r,n,l,c=>{for(let d=0;d<t.length;d++){const h=t[d],{x:y,y:g,width:x,height:f,bgC:b,bdC:F}=h;c.save(),c.fillStyle=b||"#fff",c.fillRect(y,g,x,f),c.strokeStyle=F||"#000",c.strokeRect(y,g,x,f),c.restore()}})}updateEventCanvas(){this.canvas.clearEventCanvas(),this.drawFocusElement(),this.drawHoverElement()}drawFocusElement(){const{canvas:t,focusTarget:s}=this;s.forEach(e=>{e instanceof ct?new Qa(t.eventCtx,{x:e.x,y:e.y,width:e.width,height:e.height}).draw():e instanceof et?new et(t.eventCtx,{...e,lineWidth:3,strokeStyle:"blue"}).draw():e instanceof St&&new St(t.eventCtx,{...e}).draw()})}drawHoverElement(){const{canvas:t,hoverTarget:s,focusTarget:e}=this,o=e.has(s);!s||o||(s instanceof ct?new Oa(t.eventCtx,{x:s.x,y:s.y,width:s.width,height:s.height}).draw():s instanceof et&&new et(t.eventCtx,{...s,lineWidth:2,strokeStyle:"blue"}).draw())}copy(){if(!this.focusTarget.size)return;const t=JSON.parse(JSON.stringify([...this.focusTarget])),{handleCopy:s}=this.externalFn;if(!((s==null?void 0:s(t,this.copyTarget))!==!1))return!1;this.copyTarget=t,this.editType=U.copy,this.el.style.cursor=E.copy}setEditable(t){this.editable=t,this.update()}_drawLock(){new Ya(this.canvas.cacheCtx,{x:this.canvas.width-40,y:25}).draw()}_checkLinePos(t){var n,l;if(((n=t.pos)==null?void 0:n.length)<2||((l=t.pos)==null?void 0:l.length)>4)return this.mergeLines([t]);const e=this.nodeMap.get(t.from),o=this.nodeMap.get(t.to),a=this.getPointBelongBord(e,t.pos[0]),r=this.getPointBelongBord(o,t.pos[t.pos.length-1]);if(a&&r)return!0;this.mergeLines([t])}_drawFocus(t,s,e,o){const a=this.cacheCtx;a.save(),a.fillStyle="#fff",a.strokeStyle="#B4B4B4",a.shadowColor="#DADADA",a.shadowBlur=5,a.fillRect(t-3,s-3,6,6),a.fillRect(t+e/2-3,s-3,6,6),a.fillRect(t+e-3,s-3,6,6),a.fillRect(t-3,s+o/2-3,6,6),a.fillRect(t+e-3,s+o/2-3,6,6),a.fillRect(t-3,s+o-3,6,6),a.fillRect(t+e/2-3,s+o-3,6,6),a.fillRect(t+e-3,s+o-3,6,6),a.strokeRect(t-3,s-3,6,6),a.strokeRect(t+e/2-3,s-3,6,6),a.strokeRect(t+e-3,s-3,6,6),a.strokeRect(t-3,s+o/2-3,6,6),a.strokeRect(t+e-3,s+o/2-3,6,6),a.strokeRect(t-3,s+o-3,6,6),a.strokeRect(t+e/2-3,s+o-3,6,6),a.strokeRect(t+e-3,s+o-3,6,6),a.restore()}_drawTitle(t,s,e,o){const a=this.cacheCtx;a.save(),a.font="15px "+this.fontFamily,a.fillStyle="#000",a.textAlign="left",a.textBaseline="top",a.fillText(a.fittingString(t,s-14),e,o-24),a.restore()}_loadImg(t){const s=this,e=new Image;e.src=t.checkoutInfo.imgUrl,e.onload=function(){s.imgList[t.key]=e,s.update()}}_drawIcon(t,s,e,o,a){const r=this.cacheCtx;r.save(),r.beginPath(),r.strokeStyle=a,r.lineWidth=3,r.arc(e+s-6,o-18,9,0,2*Math.PI),r.clip(),r.drawImage(t,e+s-15,o-27,18,18),r.stroke(),r.restore()}_drawMarks(){var e;const t=this,s=this._data;(e=s==null?void 0:s.markDataArray)==null||e.forEach(o=>{let a=o.width,r=o.height,n=Number(o.x),l=Number(o.y);const c=o;let d=this.markMap.get(c.key);d?d.updateOptions(c):(d=new St(this.canvas.cacheCtx,{id:c.key,x:n,y:l,width:a,height:r}),this.markMap.set(c.key,d)),this.canvas.isVisible(d.boundingBox)&&(this.renderElements.push(d),d.draw()),t.focusTarget.has(d)&&t._drawFocus(n,l,a,r)})}_drawNote(){var o;const t=this.cacheCtx,s=this,e=this._data;(o=e==null?void 0:e.noteDataArray)==null||o.forEach(a=>{let r=t.measureText(a.text).width,n=16,l=Number(a.x),c=Number(a.y);t.save(),t.font="15px "+this.fontFamily,t.fillStyle=a.color||"#000",t.textAlign="left",t.textBaseline="top",t.fillText(a.text,l,c),t.restore(),s.focusTarget.has(a)&&s._drawFocus(l,c-2,r,n)})}zoom(t){const s=t/100;this.canvas.zoom(s),this.update(),this.emit("graph:zoom",this.canvas.zoomRate)}getPointBelongBord(t,s){if(s.x===t.x)return"L";if(s.x===t.x+t.width)return"R";if(s.y===t.y)return"T";if(s.y===t.y+t.height)return"B";console.error("getPointBelongBord未找到匹配边，detail:",t,JSON.parse(JSON.stringify(t)),JSON.parse(JSON.stringify(s)))}resizeNode(t,s,e,o=50){if(["exclusive","inclusive"].includes(e.target.type))return;const a=this,r={x:e.target.x,y:e.target.y,width:e.target.width,height:e.target.height};if(e.targetDirection==="LT"){const l=e.target.width+e.target.x-t,c=e.target.height+e.target.y-s;e.target.updateOptions({x:l<o?e.target.x:t,y:c<o?e.target.y:s,width:l<o?e.target.width:l,height:c<o?e.target.height:c}),n()}else if(e.targetDirection==="TM"){const l=e.target.height+e.target.y-s;e.target.updateOptions({y:l<o?e.target.y:s,height:l<o?e.target.height:l}),n()}else if(e.targetDirection==="RT"){const l=t-e.target.x,c=e.target.height+e.target.y-s;e.target.updateOptions({y:c<o?e.target.y:s,width:l<o?e.target.width:l,height:c<o?e.target.height:c}),n()}else if(e.targetDirection==="LM"){const l=e.target.width+e.target.x-t;e.target.updateOptions({x:l<o?e.target.x:t,width:l<o?e.target.width:l}),n()}else if(e.targetDirection==="RM"){const l=t-e.target.x;e.target.updateOptions({width:l<o?e.target.width:l}),n()}else if(e.targetDirection==="LB"){const l=e.target.width+e.target.x-t,c=s-e.target.y;e.target.updateOptions({x:l<o?e.target.x:t,width:l<o?e.target.width:l,height:c<o?e.target.height:c}),n()}else if(e.targetDirection==="BM"){const l=s-e.target.y;e.target.updateOptions({height:l<o?e.target.height:l}),n()}else if(e.targetDirection==="RB"){const l=t-e.target.x,c=s-e.target.y;e.target.updateOptions({width:l<o?e.target.width:l,height:c<o?e.target.height:c}),n()}e.target.type==="mark"?this.emit("mark:resize",e.target):this.emit("node:resize",e.target);function n(){if(!o)return;a.nodeMap.get(e.target.id).updateOptions(e.target);const l=a.nodeRelatedLineMap.get(e.target.id);[...l.from,...l.to].forEach(d=>{const h=d.from!==d.to,y=l.from.has(d)?0:d.pos.length-1;h&&c(d,y),h?a.moveLineForNode(d,e,e.target):a.moveLineForSameNode(d,e)});function c(d,h){d.pos[h].x===r.x?(d.pos[h].x=e.target.x,d.pos[h].y=d.pos[h].y<e.target.y?e.target.y+1:d.pos[h].y>e.target.y+e.target.height?e.target.y+e.target.height-1:d.pos[h].y):d.pos[h].x===r.x+r.width?(d.pos[h].x=e.target.x+e.target.width,d.pos[h].y=d.pos[h].y<e.target.y?e.target.y+1:d.pos[h].y>e.target.y+e.target.height?e.target.y+e.target.height-1:d.pos[h].y):d.pos[h].y===r.y?(d.pos[h].x=d.pos[h].x<=e.target.x?e.target.x+1:d.pos[h].x>=e.target.x+e.target.width?e.target.x+e.target.width-1:d.pos[h].x,d.pos[h].y=e.target.y):d.pos[h].y===r.y+r.height&&(d.pos[h].x=d.pos[h].x<=e.target.x?e.target.x+1:d.pos[h].x>=e.target.x+e.target.width?e.target.x+e.target.width-1:d.pos[h].x,d.pos[h].y=e.target.y+e.target.height)}}}getNodePosFromBoreder(t,s){let e={};switch(s){case"T":e={start:{x:t.x,y:t.y},end:{x:t.x+t.width,y:t.y}};break;case"B":e={start:{x:t.x,y:t.y+t.height},end:{x:t.x+t.width,y:t.y+t.height}};break;case"L":e={start:{x:t.x,y:t.y},end:{x:t.x,y:t.y+t.height}};break;case"R":e={start:{x:t.x+t.width,y:t.y},end:{x:t.x+t.width,y:t.y+t.height}};break}return e}moveLineForNode(t,s,e){const o=t.pos.length-1,a={x:e.x-s.target.x,y:e.y-s.target.y},r=this.nodeMap.get(t.from),n=this.nodeMap.get(t.to),l=this.getPointBelongBord(r,t.pos[0]),c=this.getPointBelongBord(n,t.pos[o]);(!l||!c)&&this.mergeLines([t]);const d=s.target.id===r.id;if(d?(t.pos[0].x=e.x+(t.pos[0].x-s.target.x),t.pos[0].y=e.y+(t.pos[0].y-s.target.y)):(t.pos[o].x=e.x+(t.pos[o].x-s.target.x),t.pos[o].y=e.y+(t.pos[o].y-s.target.y)),o===1)t.pos.splice(1,0,{x:t.pos[0].x,y:t.pos[0].y},{x:t.pos[0].x,y:t.pos[0].y});else if(o===2)if(l==="R"&&c==="B"){if(this.getNodePosFromBoreder(n,"B").start.y<t.pos[0].y)t.pos[1]={x:t.pos[2].x,y:t.pos[0].y};else{const h=this.getNodePosFromBoreder(r,"R").start.x<this.getNodePosFromBoreder(n,"L").start.x?this.getNodePosFromBoreder(n,"L").start.x:this.getNodePosFromBoreder(n,"R").start.x;t.pos[1]={x:h+(d?0:a.x),y:t.pos[0].y+a.y},t.pos.splice(2)}t.pos[2]&&t.pos[2].x<=t.pos[0].x&&(t.pos[0]={x:t.pos[0].x-1,y:r.y+(d?a.y:0)},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2))}else l==="B"&&c==="R"?(r.y+r.height<t.pos[1].y?t.pos[1]={x:t.pos[0].x,y:t.pos[2].y}:["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},t.pos[2]={x:n.x+Math.floor(n.width/2)+(d?0:a.x),y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(d?0:a.y)}):(t.pos[0]={x:r.x+(s.target.id===r.id?a.x:0),y:t.pos[1].y},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2)),t.pos[1].x<n.x+n.width&&(t.pos[1].y=n.y+(s.target.id===n.id?a.y:0),t.pos.splice(2))):l==="L"&&c==="B"?(this.getNodePosFromBoreder(n,"B").start.y<t.pos[0].y?t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}:(t.pos[1]={x:n.x+n.width+(s.target.id===n.id?a.x:0),y:t.pos[0].y},t.pos.splice(2)),t.pos[1].x>=s.target.x&&this.getNodePosFromBoreder(n,"B").start.y<this.getNodePosFromBoreder(r,"T").start.y&&(t.pos[0]={x:t.pos[0].x+(d?a.x:0)-1,y:r.y+(d?a.y:0)},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2))):l==="B"&&c==="L"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x>n.x&&(t.pos[1].y=n.y+(s.target.id===n.id?a.y:0),t.pos.splice(2)),t.pos[1].y<t.pos[0].y&&(["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},t.pos[2]={x:n.x+Math.floor(n.width/2)+(d?0:a.x),y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(d?0:a.y)}):(t.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(s.target.id===r.id?a.x:0),t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?a.y:0),t.pos.splice(0,1)))):l==="R"&&c==="T"?(t.pos[1].x=t.pos[2].x,t.pos[1].y=t.pos[0].y,t.pos[1].x<t.pos[0].x&&(t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?a.y:0),t.pos.splice(0,1)),t.pos[2]&&t.pos[1].y>t.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(d?a.y:0)},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[2].x,y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:n.y+(d?0:a.y)}):(t.pos[1].x=n.x+(d?0:a.x),t.pos[1].y=n.y+(d?0:a.y),t.pos.splice(2)))):l==="T"&&c==="R"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x<t.pos[2].x&&(t.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(s.target.id===n.id?a.y:0),t.pos.splice(2)),t.pos[0].y<t.pos[1].y&&(t.pos[1].x=r.x+(s.target.id===r.id?a.x:0),t.pos[1].y=r.y+(s.target.id===r.id?a.y:0),t.pos.splice(0,1))):l==="T"&&c==="L"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x>t.pos[2].x&&(t.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(s.target.id===n.id?a.y:0),t.pos.splice(2)),t.pos[1].y>t.pos[0].y&&(t.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(s.target.id===r.id?a.x:0),t.pos.splice(0,1))):l==="L"&&c==="T"&&(t.pos[1].x=t.pos[2].x,t.pos[1].y=t.pos[0].y,t.pos[1].y>t.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(d?a.y:0)},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[2].x,y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:n.y+(d?0:a.y)}):(t.pos[1].x=this.getNodePosFromBoreder(n,"R").start.x+(s.target.id===n.id?a.x:0),t.pos.splice(2))),t.pos[1].x>t.pos[0].x&&(t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?a.y:0),t.pos.splice(0,1)));else if(o===3){const h=Math.floor(Math.abs(t.pos[0].x-t.pos[o].x)/2),y=Math.floor(Math.abs(t.pos[0].y-t.pos[o].y)/2);if(l==="B"&&c==="B")if(this.getNodePosFromBoreder(r,"T").start.y<this.getNodePosFromBoreder(n,"B").start.y)if(this.getNodePosFromBoreder(r,"B").start.y<t.pos[1].y){const g=t.pos[2].y-n.y-n.height+t.pos[3].y;t.pos[1]={x:t.pos[0].x,y:g},t.pos[2]={x:t.pos[3].x,y:g}}else{const g=r.x+r.width>t.pos[3].x?r.x:r.x+r.width,x=t.pos[2].y-n.y-n.height+t.pos[3].y;t.pos[0]={x:g+(s.target.id===r.id?a.x:0),y:x},t.pos[1]={x:t.pos[3].x,y:x},t.pos[2]={x:t.pos[3].x,y:t.pos[3].y},t.pos.splice(3)}else["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:r.y+r.height+20},t.pos[2]={x:t.pos[3].x,y:t.pos[1].y}):(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y-r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+Math.floor((r.y-n.y-n.height)/2)},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+Math.floor((r.y-n.y-n.height)/2)});else if(l==="B"&&c==="T")r.y+r.height<n.y?(t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+y},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+y}):r.y+r.height>=n.y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y-r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[3].x,y:t.pos[1].y}):(t.pos[1]={x:t.pos[0].x,y:n.y+n.height+20},t.pos[2]={x:t.pos[3].x,y:n.y+n.height+20},t.pos[3]={x:t.pos[3].x,y:t.pos[3].y+n.height}));else if(l==="T"&&c==="T")if(["exclusive","inclusive"].includes(r.type)||["exclusive","inclusive"].includes(n.type)){let g=t.pos[1].y+a.y>Math.min(r.y,n.y)-20?Math.min(r.y,n.y)-20:t.pos[1].y+a.y;t.pos[1]={x:t.pos[0].x,y:g},t.pos[2]={x:t.pos[3].x,y:g}}else t.pos[1].y<s.target.y?(t.pos[1]={x:t.pos[0].x,y:t.pos[1].y},t.pos[2]={x:t.pos[3].x,y:t.pos[2].y}):(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y+r.height},t.pos[1]={x:t.pos[0].x,y:Math.max(r.y+r.height,n.y+n.height)+20},t.pos[2]={x:t.pos[3].x,y:Math.max(r.y+r.height,n.y+n.height)+20},t.pos[3]={x:t.pos[3].x,y:t.pos[3].y+n.height});else l==="T"&&c==="B"?r.y>n.y+n.height?(t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-y},t.pos[2]={x:t.pos[3].x,y:t.pos[3].y+y}):r.y<=n.y+n.height&&(console.log("B->B"),t.pos[0]={x:t.pos[0].x,y:t.pos[0].y+r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+20},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+20}):l==="L"&&c==="L"?(s.target.id===n.id?(t.pos[2]={x:e.x-(n.x-t.pos[2].x),y:t.pos[3].y},t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}):t.pos[1]={x:t.pos[2].x,y:t.pos[0].y},t.pos[1].x>r.x&&t.pos[1].x<r.x+r.width&&(t.pos.splice(0,1),++t.pos[0].x,t.pos[0].y=(t.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(s.target.id===r.id?a.y:0))):l==="L"&&c==="R"?r.x>n.x+n.width?(t.pos[1]={x:t.pos[0].x-h,y:t.pos[0].y},t.pos[2]={x:t.pos[1].x,y:t.pos[3].y}):(t.pos[0]={x:t.pos[0].x+r.width,y:t.pos[0].y},t.pos[1]={x:t.pos[0].x+20,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+20,y:t.pos[3].y}):l==="R"&&c==="L"?r.x+r.width<n.x?(t.pos[1]={x:t.pos[0].x+h,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+h,y:t.pos[3].y}):(t.pos[1]={x:t.pos[0].x+n.width+20,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+n.width+20,y:t.pos[3].y},t.pos[3]={x:t.pos[3].x+n.width,y:t.pos[3].y}):l==="R"&&c==="R"&&(s.target.id===n.id?(t.pos[2]={x:e.x-(n.x-t.pos[2].x),y:t.pos[3].y},t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}):t.pos[1]={x:t.pos[2].x,y:t.pos[0].y},t.pos[1].x>r.x&&t.pos[1].x<r.x+r.width&&(t.pos.splice(0,1),--t.pos[0].x,t.pos[0].y=(t.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(s.target.id===r.id?a.y:0)))}this.emit("line:move",t)}moveLineForSameNode(t,s){const a=t.pos[1].x-t.pos[0].x,r=t.pos[2].y-t.pos[1].y;t.pos[0]={x:s.target.x+s.target.width,y:s.target.y+s.target.height-20},t.pos[4]={x:s.target.x+s.target.width-20,y:s.target.y+s.target.height},t.pos[1]={x:t.pos[0].x+a,y:t.pos[0].y},t.pos[2]={x:t.pos[1].x,y:t.pos[1].y+r},t.pos[3]={x:t.pos[4].x,y:t.pos[2].y},this.emit("line:move",t)}moveLineForLine(t,s){var d;let e,o,a=0,r=t.target.pos,n=r.length-1;if((d=this._data.nodeDataArray)==null||d.forEach(h=>{h.key===t.target.from&&(e=h,a++),h.key===t.target.to&&(o=h,a++)}),["exclusive","inclusive"].includes(e.type)){if(t.targetLineStartPointIdx===0&&r[t.targetLineStartPointIdx].x===r[t.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(e,"L").start.x>=s.x||this.getNodePosFromBoreder(e,"R").start.x<=s.x)||t.targetLineStartPointIdx===1&&r[t.targetLineStartPointIdx].y===r[t.targetLineStartPointIdx+1].y&&this.getNodePosFromBoreder(e,"B").start.y>=s.y||t.targetLineStartPointIdx===2&&r[t.targetLineStartPointIdx].x===r[t.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(o,"L").start.x>=s.x||this.getNodePosFromBoreder(o,"R").start.x<=s.x))return}else if(["exclusive","inclusive"].includes(o.type)&&(n===1||n===2&&t.targetLineStartPointIdx===1||n===2&&t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(o,"T").start.y<s.y||n===3&&t.targetLineStartPointIdx===2||n===3&&t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(o,"T").start.y<s.y||n===3&&t.targetLineStartPointIdx===0&&(this.getNodePosFromBoreder(e,"L").start.x>=s.x||this.getNodePosFromBoreder(e,"R").start.x<=s.x)))return;n===1?r[0].y===r[1].y?(r[0].y=s.y,r[1].y=s.y,(this.getNodePosFromBoreder(e,"T").start.y>s.y||this.getNodePosFromBoreder(e,"B").start.y<s.y)&&(r[0].x=e.x+e.width/2,r.unshift({x:e.x+e.width/2,y:this.getNodePosFromBoreder(e,"T").start.y>s.y?e.y:e.y+e.height})),(this.getNodePosFromBoreder(o,"T").start.y>s.y||this.getNodePosFromBoreder(o,"B").start.y<s.y)&&(r[r.length-1].x=o.x+o.width/2,r.push({x:o.x+o.width/2,y:this.getNodePosFromBoreder(o,"T").start.y>s.y?o.y:o.y+o.height}))):(r[0].x=s.x,r[1].x=s.x,(this.getNodePosFromBoreder(e,"L").start.x>s.x||this.getNodePosFromBoreder(e,"R").start.x<s.x)&&(r[0].y=e.y+e.height/2,r.unshift({x:this.getNodePosFromBoreder(e,"R").start.x<s.x?e.x+e.width:e.x,y:e.y+e.height/2})),(this.getNodePosFromBoreder(o,"L").start.x>s.x||this.getNodePosFromBoreder(o,"R").start.x<s.x)&&(r[r.length-1].y=o.y+o.height/2,r.push({x:this.getNodePosFromBoreder(o,"R").start.x<s.x?o.x+o.width:o.x,y:o.y+o.height/2}))):n===2?r[t.targetLineStartPointIdx].y===r[t.targetLineStartPointIdx+1].y?(r[t.targetLineStartPointIdx].y=s.y,r[t.targetLineStartPointIdx+1].y=s.y,(this.getNodePosFromBoreder(e,"B").start.y<s.y||this.getNodePosFromBoreder(e,"T").start.y>s.y)&&t.targetLineStartPointIdx===0&&(r[t.targetLineStartPointIdx].x=e.x+e.width/2,r.unshift({x:e.x+e.width/2,y:this.getNodePosFromBoreder(e,"T").start.y>s.y?e.y:e.y+e.height})),(this.getNodePosFromBoreder(o,"B").start.y<s.y||this.getNodePosFromBoreder(o,"T").start.y>s.y)&&t.targetLineStartPointIdx===1&&(r[t.targetLineStartPointIdx+1].x=o.x+o.width/2,r.push({x:o.x+o.width/2,y:this.getNodePosFromBoreder(o,"T").start.y>s.y?o.y:o.y+o.height})),t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(e,"B").start.y>s.y&&this.getNodePosFromBoreder(e,"T").start.y<s.y&&(r.splice(0,1),r[0].x=o.x>e.x?e.x+e.width:e.x),t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(o,"B").start.y>s.y&&this.getNodePosFromBoreder(o,"T").start.y<s.y&&(r.splice(r.length-1,1),r[r.length-1].x=e.x>o.x?o.x+o.width:o.x)):(r[t.targetLineStartPointIdx].x=s.x,r[t.targetLineStartPointIdx+1].x=s.x,(this.getNodePosFromBoreder(e,"L").start.x>s.x||this.getNodePosFromBoreder(e,"R").start.x<s.x)&&t.targetLineStartPointIdx===0&&(r[t.targetLineStartPointIdx].y=e.y+e.height/2,r.unshift({x:this.getNodePosFromBoreder(e,"L").start.x>s.x?e.x:e.x+e.width,y:e.y+e.height/2})),(this.getNodePosFromBoreder(o,"L").start.x>s.x||this.getNodePosFromBoreder(o,"R").start.x<s.x)&&t.targetLineStartPointIdx===1&&(r[t.targetLineStartPointIdx+1].y=o.y+o.height/2,r.push({x:this.getNodePosFromBoreder(o,"L").start.x>s.x?o.x:o.x+o.width,y:o.y+o.height/2})),t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(e,"L").start.x<s.x&&this.getNodePosFromBoreder(e,"R").start.x>s.x&&(r.splice(0,1),r[0].y=o.y>e.y?e.y+e.height:e.y),t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(o,"L").start.x<s.x&&this.getNodePosFromBoreder(o,"R").start.x>s.x&&(r.splice(r.length-1,1),r[r.length-1].y=e.y>o.y?o.y+o.height:o.y)):n===3&&(r[t.targetLineStartPointIdx].y===r[t.targetLineStartPointIdx+1].y?(r[t.targetLineStartPointIdx].y=s.y,r[t.targetLineStartPointIdx+1].y=s.y,t.targetLineStartPointIdx===0?l(r)?r[0].y<this.getNodePosFromBoreder(e,"T").start.y?(r[0]={x:this.getNodePosFromBoreder(e,"T").start.x+e.width/2,y:e.y},r[1]={x:r[0].x,y:s.y},s.y<this.getNodePosFromBoreder(o,"T").start.y||s.y>this.getNodePosFromBoreder(o,"B").start.y?(r[2]={x:this.getNodePosFromBoreder(o,"L").start.x+o.width/2,y:s.y},r[3]={x:r[2].x,y:s.y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y}):(r[2]={x:r[1].x<this.getNodePosFromBoreder(o,"R").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:s.y},r.splice(3))):r[0].y>this.getNodePosFromBoreder(e,"B").start.y&&(r[0]={x:this.getNodePosFromBoreder(e,"T").start.x+e.width/2,y:this.getNodePosFromBoreder(e,"B").start.y},r[1]={x:r[0].x,y:s.y},s.y<this.getNodePosFromBoreder(o,"T").start.y||s.y>this.getNodePosFromBoreder(o,"B").start.y?(r[2]={x:this.getNodePosFromBoreder(o,"L").start.x+o.width/2,y:s.y},r[3]={x:r[2].x,y:s.y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y}):(r[2]={x:r[1].x<this.getNodePosFromBoreder(o,"R").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:s.y},r.splice(3))):s.y<this.getNodePosFromBoreder(e,"T").start.y?(r[0].y=this.getNodePosFromBoreder(e,"T").start.y,r[1].y=this.getNodePosFromBoreder(e,"T").start.y):s.y>this.getNodePosFromBoreder(e,"B").start.y&&(r[0].y=this.getNodePosFromBoreder(e,"B").start.y,r[1].y=this.getNodePosFromBoreder(e,"B").start.y):t.targetLineStartPointIdx===r.length-2?l(r)?r[3].y<this.getNodePosFromBoreder(o,"T").start.y?(r[3]={x:this.getNodePosFromBoreder(o,"T").start.x+o.width/2,y:o.y},r[2]={x:r[3].x,y:s.y},s.y<this.getNodePosFromBoreder(e,"T").start.y||s.y>this.getNodePosFromBoreder(e,"B").start.y?(r[1]={x:this.getNodePosFromBoreder(e,"L").start.x+e.width/2,y:s.y},r[0]={x:r[1].x,y:s.y<this.getNodePosFromBoreder(e,"T").start.y?this.getNodePosFromBoreder(e,"T").start.y:this.getNodePosFromBoreder(e,"B").start.y}):(r[1]={x:r[2].x>this.getNodePosFromBoreder(e,"R").start.x?this.getNodePosFromBoreder(e,"R").start.x:this.getNodePosFromBoreder(e,"L").start.x,y:s.y},r.splice(0,1))):r[3].y>this.getNodePosFromBoreder(o,"B").start.y&&(r[3]={x:this.getNodePosFromBoreder(o,"L").start.x+o.width/2,y:this.getNodePosFromBoreder(o,"B").start.y},r[2]={x:r[3].x,y:s.y},s.y<this.getNodePosFromBoreder(e,"T").start.y||s.y>this.getNodePosFromBoreder(e,"B").start.y?(r[1]={x:this.getNodePosFromBoreder(e,"L").start.x+e.width/2,y:s.y},r[0]={x:r[1].x,y:s.y<this.getNodePosFromBoreder(e,"T").start.y?this.getNodePosFromBoreder(e,"T").start.y:this.getNodePosFromBoreder(e,"B").start.y}):(r[1]={x:r[2].x>this.getNodePosFromBoreder(e,"R").start.x?this.getNodePosFromBoreder(e,"R").start.x:this.getNodePosFromBoreder(e,"L").start.x,y:s.y},r.splice(0,1))):s.y<this.getNodePosFromBoreder(o,"T").start.y?(r[2].y=this.getNodePosFromBoreder(o,"T").start.y,r[3].y=this.getNodePosFromBoreder(o,"T").start.y):s.y>this.getNodePosFromBoreder(o,"B").start.y&&(r[2].y=this.getNodePosFromBoreder(o,"B").start.y,r[3].y=this.getNodePosFromBoreder(o,"B").start.y):(s.y>this.getNodePosFromBoreder(e,"T").start.y&&s.y<this.getNodePosFromBoreder(e,"B").start.y&&(r.splice(0,1),r[0].x=r[1].x<this.getNodePosFromBoreder(e,"L").start.x?this.getNodePosFromBoreder(e,"L").start.x:this.getNodePosFromBoreder(e,"R").start.x),s.y>this.getNodePosFromBoreder(o,"T").start.y&&s.y<this.getNodePosFromBoreder(o,"B").start.y&&(r[r.length-2].x=r[r.length-3].x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,r.splice(r.length-1)))):(r[t.targetLineStartPointIdx].x=s.x,r[t.targetLineStartPointIdx+1].x=s.x,t.targetLineStartPointIdx===0?c(r)?r[0].x<this.getNodePosFromBoreder(e,"L").start.x?(r[0]={x:this.getNodePosFromBoreder(e,"L").start.x,y:this.getNodePosFromBoreder(e,"L").start.y+e.height/2},r[1]={x:s.x,y:r[0].y},s.x<this.getNodePosFromBoreder(o,"L").start.x||s.x>this.getNodePosFromBoreder(o,"R").start.x?(r[2]={x:s.x,y:this.getNodePosFromBoreder(o,"T").start.y+o.height/2},r[3]={x:s.x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:r[2].y}):(r[2]={x:s.x,y:r[1].y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y},r.splice(3))):r[0].x>this.getNodePosFromBoreder(e,"R").start.x&&(r[0]={x:this.getNodePosFromBoreder(e,"R").start.x,y:this.getNodePosFromBoreder(e,"R").start.y+e.height/2},r[1]={x:s.x,y:r[0].y},s.x<this.getNodePosFromBoreder(o,"L").start.x||s.x>this.getNodePosFromBoreder(o,"R").start.x?(r[2]={x:s.x,y:this.getNodePosFromBoreder(o,"T").start.y+o.height/2},r[3]={x:s.x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:r[2].y}):(r[2]={x:s.x,y:r[1].y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y},r.splice(3))):s.x<this.getNodePosFromBoreder(e,"L").start.x?(r[0].x=this.getNodePosFromBoreder(e,"L").start.x+1,r[1].x=this.getNodePosFromBoreder(e,"L").start.x+1):s.x>this.getNodePosFromBoreder(e,"R").start.x&&(r[0].x=this.getNodePosFromBoreder(e,"R").start.x-1,r[1].x=this.getNodePosFromBoreder(e,"R").start.x-1):t.targetLineStartPointIdx===r.length-2?c(r)?r[3].x<this.getNodePosFromBoreder(o,"L").start.x?(r[3]={x:this.getNodePosFromBoreder(o,"L").start.x,y:this.getNodePosFromBoreder(o,"L").start.y+o.height/2},r[2]={x:s.x,y:r[3].y},s.x<this.getNodePosFromBoreder(e,"L").start.x||s.x>this.getNodePosFromBoreder(e,"R").start.x?(r[1]={x:s.x,y:this.getNodePosFromBoreder(e,"T").start.y+e.height/2},r[0]={x:s.x<this.getNodePosFromBoreder(e,"L").start.x?this.getNodePosFromBoreder(e,"L").start.x:this.getNodePosFromBoreder(e,"R").start.x,y:r[1].y}):(r[1]={x:s.x,y:r[2].y>this.getNodePosFromBoreder(e,"B").start.y?this.getNodePosFromBoreder(e,"B").start.y:this.getNodePosFromBoreder(e,"T").start.y},r.splice(0,1))):r[3].x>this.getNodePosFromBoreder(o,"R").start.x&&(r[3]={x:this.getNodePosFromBoreder(o,"R").start.x,y:this.getNodePosFromBoreder(o,"R").start.y+o.height/2},r[2]={x:s.x,y:r[3].y},s.x<this.getNodePosFromBoreder(e,"L").start.x||s.x>this.getNodePosFromBoreder(e,"R").start.x?(r[1]={x:s.x,y:this.getNodePosFromBoreder(e,"T").start.y+e.height/2},r[0]={x:s.x<this.getNodePosFromBoreder(e,"L").start.x?this.getNodePosFromBoreder(e,"L").start.x:this.getNodePosFromBoreder(e,"R").start.x,y:r[1].y}):(r[1]={x:s.x,y:r[2].y>this.getNodePosFromBoreder(e,"B").start.y?this.getNodePosFromBoreder(e,"B").start.y:this.getNodePosFromBoreder(e,"T").start.y},r.splice(0,1))):s.x<this.getNodePosFromBoreder(o,"L").start.x?(r[2].x=this.getNodePosFromBoreder(o,"L").start.x+1,r[3].x=this.getNodePosFromBoreder(o,"L").start.x+1):s.x>this.getNodePosFromBoreder(o,"R").start.x&&(r[2].x=this.getNodePosFromBoreder(o,"R").start.x-1,r[3].x=this.getNodePosFromBoreder(o,"R").start.x-1):(s.x>this.getNodePosFromBoreder(e,"L").start.x&&s.x<this.getNodePosFromBoreder(e,"R").start.x&&(r.splice(0,1),r[0].y=r[1].y<this.getNodePosFromBoreder(e,"T").start.y?this.getNodePosFromBoreder(e,"T").start.y:this.getNodePosFromBoreder(e,"B").start.y),s.x>this.getNodePosFromBoreder(o,"L").start.x&&s.x<this.getNodePosFromBoreder(o,"R").start.x&&(r[r.length-2].y=r[r.length-3].y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y,r.splice(r.length-1)))),r.length===4&&r[1].x===r[2].x&&r[1].y===r[2].y&&r.splice(1,2));function l(h){let y=0;for(let g=0,x=h.length-1;g<x;g++)y+=Math.abs(h[g].x-h[g+1].x);return y===Math.abs(h[0].x-h[h.length-1].x)}function c(h){let y=0;for(let g=0,x=h.length-1;g<x;g++)y+=Math.abs(h[g].y-h[g+1].y);return y===Math.abs(h[0].y-h[h.length-1].y)}this.emit("line:move",t.target)}addNode(t){this.addNodeDefaultAttr=t,this.editType="addNode"}packNodeInfo(t,s){const{x:e,y:o}=this.transLoc(s);return Object.assign(t,{x:e,y:o+24,width:50,height:50})}getOverlapNode(t){const s=this._data;this.transLoc(t);for(let e=0,o=s.nodeDataArray.length;e<o;e++){const a=Number(s.nodeDataArray[e].width)||100,r=Number(s.nodeDataArray[e].height)||50,n=Number(s.nodeDataArray[e].x),l=Number(s.nodeDataArray[e].y);if(n>n&&n<a+n&&l>l&&l<r+l)return s.nodeDataArray[e]}}transLoc(t){const s=this.canvas.getTranslate(),e=this.canvas.zoomRate,o=Math.floor((t.x+s.x)/e),a=Math.floor((t.y+s.y)/e);return{x:o,y:a}}addLine(t){this.editType=t}addMark(){this.editType="addMark"}addNote(){this.editType="addNote"}addRemark(t=""){var s;(s=this.focusTarget)==null||s.forEach(e=>{e.remark=t}),this.update()}changeColor(t,s){var e;(e=this.focusTarget)==null||e.forEach(o=>{o.attributes?s!=="color"?o[s]=t:console.log("修改的是属性文字颜色, 逻辑待完善."):o.type==="mark"?o[s]=t:o.type==="note"&&(o.color=t)}),this.update()}createLineInfo(t,s){let e=this.chooseTargets,o=this.getNodePosFromBoreder(e[0],"L"),a=this.getNodePosFromBoreder(e[1],"L"),r=[];if(e[0].key===e[1].key)r[0]={x:e[0].x+e[0].width,y:e[0].y+e[0].height-20},r[1]={x:e[0].x+e[0].width+20,y:e[0].y+e[0].height-20},r[2]={x:e[0].x+e[0].width+20,y:e[0].y+e[0].height+20},r[3]={x:e[0].x+e[0].width-20,y:e[0].y+e[0].height+20},r[4]={x:e[0].x+e[0].width-20,y:e[0].y+e[0].height};else if(["exclusive","inclusive"].includes(e[0].type))o.end.y<a.start.y?(r[0]={x:o.end.x+Math.floor(e[0].width/2),y:o.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((a.start.y-o.end.y)/2)},r[2]={x:a.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:a.start.y}):(r[0]={x:o.end.x+Math.floor(e[0].width/2),y:o.end.y},r[1]={x:r[0].x,y:Math.max(o.end.y,a.start.y)+20},r[2]={x:a.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:a.end.y});else if(["exclusive","inclusive"].includes(e[1].type))o.end.y<a.start.y?(r[0]={x:o.end.x+Math.floor(e[0].width/2),y:o.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((a.start.y-o.end.y)/2)},r[2]={x:a.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:a.start.y}):(r[0]={x:o.end.x+Math.floor(e[0].width/2),y:o.start.y},r[1]={x:r[0].x,y:Math.min(o.end.y,a.start.y)-20},r[2]={x:a.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:a.start.y});else if(this.getNodePosFromBoreder(e[0],"R").start.x<this.getNodePosFromBoreder(e[1],"L").start.x)if((a.start.y-o.end.y)*(a.end.y-o.start.y)<0){let n=Math.max(o.start.y,a.start.y)+Math.abs(Math.floor((Math.min(o.end.y,a.end.y)-Math.max(o.start.y,a.start.y))/2));r[0]={x:this.getNodePosFromBoreder(e[0],"R").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x,y:n}}else o.start.y>a.end.y?(r[0]={x:o.start.x+Math.floor(e[0].width/2),y:o.start.y},r[1]={x:r[0].x,y:a.start.y+Math.floor(e[1].height/2)},r[2]={x:a.start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(e[0],"R").start.x,y:o.start.y+Math.floor(e[0].height/2)},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x+Math.floor(e[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(e[1],"L").start.y});else if(this.getNodePosFromBoreder(e[0],"L").start.x>this.getNodePosFromBoreder(e[1],"R").start.x)if((a.start.y-o.end.y)*(a.end.y-o.start.y)<0){let n=Math.max(o.start.y,a.start.y)+Math.abs(Math.floor((Math.min(o.end.y,a.end.y)-Math.max(o.start.y,a.start.y))/2));r[0]={x:this.getNodePosFromBoreder(e[0],"L").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(e[1],"R").start.x,y:n}}else o.start.y>a.end.y?(r[0]={x:o.start.x+Math.floor(e[0].width/2),y:o.start.y},r[1]={x:r[0].x,y:a.start.y+Math.floor(e[1].height/2)},r[2]={x:this.getNodePosFromBoreder(e[1],"R").start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(e[0],"L").start.x,y:o.start.y+Math.floor(e[0].height/2)},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x+Math.floor(e[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(e[1],"L").start.y});else if(o.start.y>a.end.y){let n=Math.max(o.start.x,a.start.x),l=Math.min(this.getNodePosFromBoreder(e[0],"R").start.x,this.getNodePosFromBoreder(e[1],"R").start.x),c=n+Math.floor((l-n)/2);r[0]={x:c,y:o.start.y},r[1]={x:c,y:a.end.y}}else{let n=Math.max(o.start.x,a.start.x),l=Math.min(this.getNodePosFromBoreder(e[0],"R").start.x,this.getNodePosFromBoreder(e[1],"R").start.x),c=n+Math.floor((l-n)/2);r[0]={x:c,y:o.end.y},r[1]={x:c,y:a.start.y}}if(r.length){const n={};return s?(s.pos=r,Object.assign(n,s)):Object.assign(n,{key:this.createKey(),from:e[0].key,to:e[1].key,pos:r,type:t}),n}else console.error("createLine方法错误：未生成对应关键点坐标")}createLine(t,s){const e=this.createLineInfo(t,s);["primaryKey","foreignKey"].includes(t)&&this.externalFn.addLine(e)}mergeLine(t,s){const e=this.createLineInfo(t,s);return Object.assign(s,e)}createBranchLine(){let t=[].concat(this.chooseTargets),s=this.getNodePosFromBoreder(t[0],"L"),e=this.getNodePosFromBoreder(t[1],"L");if(["inclusive","exclusive"].includes(t[1].type))this.$message({message:"未将对象引用设置到对象的实例。",type:"error",showClose:!0});else if(["inclusive","exclusive"].includes(t[0].type)){const o=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({fromFilter:o})}else{const o=s.end.y+50<e.start.y?{x:s.start.x+Math.floor(t[0].width/2)-20,y:s.end.y+Math.floor((e.start.y-s.end.y)/2)-10}:{x:e.start.x+Math.floor(t[1].width/2)-20,y:Math.min(s.start.y,e.start.y)-50},a={key:this.createKey(),x:o.x,y:o.y,width:40,height:20,type:"exclusive",fromKey:t[0].key};this.chooseTargets=[t[0],a];const r=this.createLine("toFilter");this.chooseTargets=[a,t[1]];const n=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({filter:a,toFilter:r,fromFilter:n}),this.chooseTargets=[]}}getNodeWithKey(t){for(const s of this._data.nodeDataArray)if(s.key===t)return s}createLines(t){for(const s of t){const e=this.getNodeWithKey(s.from),o=this.getNodeWithKey(s.to);e&&o&&(this.chooseTargets=[e,o],this.createLine(s.type,s))}this.chooseTargets=[],this.update()}mergeLines(t){const s=[];for(const e of t){const o=this.getNodeWithKey(e.from),a=this.getNodeWithKey(e.to);o&&a&&(this.chooseTargets=[o,a],s.push(this.mergeLine(e.type,e)))}return this.chooseTargets=[],s}createKey(){return+new Date+""+Math.floor(Math.random()*1e5)}$message(t){this.externalFn.$message&&this.externalFn.$message(t)}}const se="http://himg.bdimg.com/sys/portrait/item/2610e8b5b0e5a4b1e69ca8e69893fc0b.jpg",H={nodeDataArray:[{key:"q000",x:100,y:100,width:100,height:100,bgC:"#FF8080",bdC:"red",tableName:"Entity1",physicalTables:!0,quotePrimaryKey:!0,attributes:[{attrName:"attr1",primaryKey:!0,foreignKey:!0,icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"L",bdC:"green"}]},{attrName:"attr2",primaryKey:!0},{attrName:"属性名3",primaryKey:!0,children:[{attrName:"属性名3-1",primaryKey:!0,foreignKey:!0,children:[{attrName:"属性名3-1-1",primaryKey:!0,foreignKey:!0,children:[{attrName:"属性名3-1-1-1",primaryKey:!0,foreignKey:!0}],icons:[{text:"A",bdC:"green"}]}]},{attrName:"属性名3-2",primaryKey:!0,foreignKey:!0},{attrName:"属性名3-3",primaryKey:!0,foreignKey:!0}]},{attrName:"attr4",primaryKey:!1,foreignKey:!0,icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"标"}]},{attrName:"attr5",primaryKey:!1},{attrName:"attr6",primaryKey:!1,icons:[{text:"A",bdC:"green"}]}],checkoutInfo:{operator:1,imgUrl:se}},{key:"q111",x:400,y:100,width:50,height:100,bgC:"#8080FF",tableName:"表2",attributes:[{attrName:"属性名1",primaryKey:!0,foreignKey:!1},{attrName:"属性名2",primaryKey:!0},{attrName:"属性名3",primaryKey:!0}],checkoutInfo:{operator:2,imgUrl:se}},{key:"q222",x:100,y:400,width:50,height:100,bgC:"#FFFF80",tableName:"Entity3",attributes:[{attrName:"属性名1",primaryKey:!1,foreignKey:!1},{attrName:"属性名2",primaryKey:!1}],checkoutInfo:{operator:2,imgUrl:se}},{key:"q444",x:100,y:250,width:40,height:20,type:"inclusive"},{key:"q555",x:705,y:92,width:260,height:100,tableName:"Entity inside",type:"inside"},{key:"q666",x:600,y:280,width:260,height:100,tableName:"Entity discribe",type:"explain",attributes:[{label:"说明",content:"表示与银行有利害关系，以及银行希望保留其信息"},{label:"示例",content:"个人 组织 客户"},{label:"所属部门",content:"数据研究院"},{label:"负责人",content:"杨中旭"}]},{key:"test",x:2999,y:2999,width:260,height:100,tableName:"Entity away",type:"inside"},{key:"test",x:-2999,y:-2999,width:260,height:100,tableName:"Entity away",type:"inside"}],linkDataArray:[{key:1,from:"q000",to:"q111",pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1,remark:"主键"},{key:3,from:"q111",to:"q222",pos:[{x:400,y:150},{x:300,y:150},{x:300,y:450},{x:150,y:450}],type:"foreignKey",numLineTypes:1},{key:4,from:"q000",to:"q444",pos:[{x:120,y:200},{x:120,y:250}],type:"toFilter",numLineTypes:2},{key:5,from:"q444",to:"q222",pos:[{x:120,y:270},{x:120,y:400}],type:"fromFilter",numLineTypes:4},{key:6,from:"q555",to:"q666",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"}],markDataArray:[],noteDataArray:[{key:"157837643603536658",x:525,y:408,text:"啦啦啦啦啦111",type:"note",color:"#0000ff"}]},si=[[{icon:"",value:"copy",label:"复制"},{icon:"",value:"extend-copy",label:"继承复制"},{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"parent",label:"显示父级关联",children:[{icon:"",value:"level-2",label:"显示2级"},{icon:"",value:"level-all",label:"显示全部"},{icon:"",value:"level-1",label:"显示1级"}]}],[{icon:"",value:"auto-size",label:"自适应大小"},{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}],{icon:"",value:"delete",label:"删除"}],X=""+new URL("symbol-defs-a40770d4.svg",import.meta.url).href,ri={class:"erg"},oi={class:"toobar"},ai=["xlink:href"],ii=["xlink:href"],ni=["xlink:href"],li=["xlink:href"],hi=["xlink:href"],di=["xlink:href"],ci=["xlink:href"],ui=["xlink:href"],yi=["xlink:href"],gi=["xlink:href"],pi=["xlink:href"],xi=["xlink:href"],fi=T("div",{id:"canvas",class:"canvas"},null,-1),xs=G({__name:"Erg",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:1}},setup(i){const t=i;let s;const e=new Map,o=new Map,a=new Map,r=new Map,n=Je({scale:100,bgC:"",bdC:"",color:"",lock:1}),l=()=>{for(let p=0;p<H.nodeDataArray.length;p++){const m=H.nodeDataArray[p];e.set(m.key,m)}for(let p=0;p<H.linkDataArray.length;p++){const m=H.linkDataArray[p];o.set(m.key,m)}for(let p=0;p<H.noteDataArray.length;p++){const m=H.noteDataArray[p];a.set(m.key,m)}for(let p=0;p<H.markDataArray.length;p++){const m=H.markDataArray[p];r.set(m.key,m)}},c=()=>{s=new ei({el:document.getElementById("canvas"),fontFamily:"-apple-system, Noto Sans, Helvetica Neue, Helvetica, Nimbus Sans L, Arial, Liberation Sans, PingFang SC, Hiragino Sans GB, Noto Sans CJK SC, Source Han Sans SC, Source Han Sans CN, Microsoft YaHei, Wenquanyi Micro Hei, WenQuanYi Zen Hei, ST Heiti, SimHei, WenQuanYi Zen Hei Sharp, sans-serif",editable:n.lock,externalFn:{addNode:function(p){const m=prompt("请输入表名：");m&&(p.tableName=m,H.nodeDataArray.push(p))},delNode:function(p){console.log(p)},addLine:function(p){console.log("添加线了"),p.numLineTypes=2,H.linkDataArray.push(p)},delLine:function(p){console.log(p)},addFilter:function(p){p.filter&&H.nodeDataArray.push(p.filter),p.toFilter&&H.linkDataArray.push(p.toFilter),H.linkDataArray.push(p.fromFilter)},delFilter:function(p){console.log(p)},addMark:function(p){H.markDataArray.push(p),r.set(p.key,p)},delMark:function(p){console.log(p)},addNote:function(p){const m=prompt("请输入备注内容：");m&&(p.text=m,H.noteDataArray.push(p))},delNote:function(p){console.log(p)},$message:function(p){console.log(p.message)},handleCopy(p,m){return console.log(p,m),!0},handlePaste(p){H.nodeDataArray.push(...p)},handleContextMenu(p,m){switch(console.log("菜单点击触发：",p,m),m){case"remark":const _=prompt("请输入备注内容：");if(!_)return;s.addRemark(_);break}}},useThumbnail:t.useThumbnail,useAttrFocus:t.useAttrFocus,useRightMenu:t.useRightMenu,rightMenu:si}),s.update(H),s.on("node:move",p=>{const m=e.get(p.id);m.x=p.x,m.y=p.y,m.width=p.width,m.height=p.height}),s.on("node:resize",p=>{const m=e.get(p.id);m.x=p.x,m.y=p.y,m.width=p.width,m.height=p.height}),s.on("line:move",p=>{const m=o.get(p.id);m.pos=p.pos}),s.on("note:move",p=>{const m=a.get(p.id);m.x=p.x,m.y=p.y}),s.on("mark:move",p=>{const m=r.get(p.id);m.x=p.x,m.y=p.y,m.width=p.width,m.height=p.height}),s.on("mark:resize",p=>{const m=r.get(p.id);m.x=p.x,m.y=p.y,m.width=p.width,m.height=p.height})},d=()=>{s.destroy()},h=p=>{n.scale>20&&(n.scale+=p),s.zoom(n.scale)},y=()=>{s.addNode({key:s.createKey(),attributes:[]})},g=p=>{s.addLine(p)},x=()=>{s.addMark()},f=()=>{s.addNote()},b=(p,m)=>{s.changeColor(p,m)},F=()=>{n.lock=n.lock===1?2:1,s.setEditable(n.lock)},w=()=>{s.copy()},N=()=>{const p=[{from:0,to:1,pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1}];s.createLines(p)};return ft(()=>{l(),c()}),Es(d),(p,m)=>(B(),C("div",ri,[T("div",oi,[$(u(q),{size:"small",circle:"",title:"新增实体",onClick:y},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-add`},null,8,ai)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"复制",onClick:w},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#copy`},null,8,ii)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"新增主键",onClick:m[0]||(m[0]=_=>g("primaryKey"))},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-primary`},null,8,ni)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"新增非主键",onClick:m[1]||(m[1]=_=>g("foreignKey"))},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-foreign`},null,8,li)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"新增过滤器",onClick:m[2]||(m[2]=_=>g("branchLine"))},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-subtype`},null,8,hi)]))]),_:1}),$(u(ee),{direction:"vertical"}),$(u(q),{size:"small",circle:"",title:"新增框",onClick:x},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-square`},null,8,di)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"新增备注",onClick:f},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#icon-tool-text`},null,8,ci)]))]),_:1}),$(u(ee),{direction:"vertical"}),n.lock===1?(B(),V(u(q),{key:0,size:"small",circle:"",title:"只读",onClick:F},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#lock`},null,8,ui)]))]),_:1})):(B(),V(u(q),{key:1,size:"small",circle:"",title:"编辑",onClick:F},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#unlock`},null,8,yi)]))]),_:1})),$(u(q),{size:"small",circle:"",title:"批量创建连线",onClick:N},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#copy`},null,8,gi)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"放大",onClick:m[3]||(m[3]=_=>h(20))},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#plus-circle`},null,8,pi)]))]),_:1}),$(u(q),{size:"small",circle:"",title:"缩小",onClick:m[4]||(m[4]=_=>h(-20))},{icon:K(()=>[(B(),C("svg",null,[T("use",{"xlink:href":`${u(X)}#minus-circle`},null,8,xi)]))]),_:1}),$(u(ee),{direction:"vertical"}),$(u(te),{modelValue:n.bgc,"onUpdate:modelValue":m[5]||(m[5]=_=>n.bgc=_),size:"small",onChange:m[6]||(m[6]=_=>b(_,"bgC"))},null,8,["modelValue"]),$(u(te),{modelValue:n.bdC,"onUpdate:modelValue":m[7]||(m[7]=_=>n.bdC=_),size:"small",onChange:m[8]||(m[8]=_=>b(_,"bdC"))},null,8,["modelValue"]),$(u(te),{modelValue:n.color,"onUpdate:modelValue":m[9]||(m[9]=_=>n.color=_),size:"small",onChange:m[10]||(m[10]=_=>b(_,"color"))},null,8,["modelValue"])]),fi]))}});xs.__docgenInfo={exportName:"default",displayName:"Erg",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"number"},defaultValue:{func:!1,value:"1"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/Erg.vue"]};const wi={title:"Example/Erg",component:xs,argTypes:{editable:{control:"select",options:[1,2,3]}},args:{useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:!0}},Vt={};var Xe,Ye,ke;Vt.parameters={...Vt.parameters,docs:{...(Xe=Vt.parameters)==null?void 0:Xe.docs,source:{originalSource:"{}",...(ke=(Ye=Vt.parameters)==null?void 0:Ye.docs)==null?void 0:ke.source}}};const Bi=["Primary"];export{Vt as Primary,Bi as __namedExportsOrder,wi as default};
//# sourceMappingURL=Erg.stories-d0335cf7.js.map
