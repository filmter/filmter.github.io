import{a as M,g as Et,b as L,i as pt,d as q,u as Ds,e as zs,s as Ct,w as W,n as k,o as bt,t as Ks,f as le,v as es,j as b,k as T,l as E,F as qt,m as B,p as u,q as St,x as N,y as z,z as $,A as Wt,B as ee,C as _,D as Hs,N as Vs,E as gt,G as tt,H as Me,I as Te,J as Ws,K as Us,L as qs,r as ss,M as Xs,O as Se,P as Ce,Q as Ys}from"./vue.esm-bundler-6f0914dd.js";import{i as _t,g as Gs,e as Js,a as rs,b as ks,c as Zs,S as Jt,d as he,f as os,h as as,o as Qs,k as is,r as Os,j as ns,s as js,l as Is,U as Re,m as ls,n as de,p as kt,q as hs,t as tr,u as er,v as sr,w as ce,x as ds,y as rr,z as cs,A as or,B as ar,C as _e,D as ir,E as jt,F as us,G as xt,H as Le,I as nr,J as vt,K as ys,L as gs,M as ps,N as xs,O as ot,V as lr,P as hr,Q as dr,R as Xt,T as cr,W as Zt,X as nt,Y as ur,_ as ht,Z as fs,$ as yr,a0 as ue,a1 as Ee,a2 as gr,a3 as pr,a4 as xr,a5 as H,a6 as fr,a7 as mr,a8 as vr,a9 as br,aa as dt,ab as U,ac as ft,ad as wr,ae as se,af as Br,ag as Pr,ah as Nr,ai as re,aj as Fr,ak as Mr,al as Tr,am as Sr,an as st,ao as Cr}from"./index-203f70dd.js";const ye=i=>{let t,s;return i.type==="touchend"?(s=i.changedTouches[0].clientY,t=i.changedTouches[0].clientX):i.type.startsWith("touch")?(s=i.touches[0].clientY,t=i.touches[0].clientX):(s=i.clientY,t=i.clientX),{clientX:t,clientY:s}};function Rr(i){return i}var $e=Object.create,_r=function(){function i(){}return function(t){if(!_t(t))return{};if($e)return $e(t);i.prototype=t;var s=new i;return i.prototype=void 0,s}}();const Lr=_r;function Er(i,t,s){switch(s.length){case 0:return i.call(t);case 1:return i.call(t,s[0]);case 2:return i.call(t,s[0],s[1]);case 3:return i.call(t,s[0],s[1],s[2])}return i.apply(t,s)}function $r(i,t){var s=-1,e=i.length;for(t||(t=Array(e));++s<e;)t[s]=i[s];return t}var Ar=800,Dr=16,zr=Date.now;function Kr(i){var t=0,s=0;return function(){var e=zr(),a=Dr-(e-s);if(s=e,a>0){if(++t>=Ar)return arguments[0]}else t=0;return i.apply(void 0,arguments)}}function Hr(i){return function(){return i}}var Vr=function(){try{var i=Gs(Object,"defineProperty");return i({},"",{}),i}catch{}}();const Qt=Vr;var Wr=Qt?function(i,t){return Qt(i,"toString",{configurable:!0,enumerable:!1,value:Hr(t),writable:!0})}:Rr;const Ur=Wr;var qr=Kr(Ur);const Xr=qr;function Yr(i,t){for(var s=-1,e=i==null?0:i.length;++s<e&&t(i[s],s,i)!==!1;);return i}function ms(i,t,s){t=="__proto__"&&Qt?Qt(i,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):i[t]=s}var Gr=Object.prototype,Jr=Gr.hasOwnProperty;function ge(i,t,s){var e=i[t];(!(Jr.call(i,t)&&Js(e,s))||s===void 0&&!(t in i))&&ms(i,t,s)}function It(i,t,s,e){var a=!s;s||(s={});for(var o=-1,r=t.length;++o<r;){var n=t[o],l=e?e(s[n],i[n],n,s,i):void 0;l===void 0&&(l=i[n]),a?ms(s,n,l):ge(s,n,l)}return s}var Ae=Math.max;function kr(i,t,s){return t=Ae(t===void 0?i.length-1:t,0),function(){for(var e=arguments,a=-1,o=Ae(e.length-t,0),r=Array(o);++a<o;)r[a]=e[t+a];a=-1;for(var n=Array(t+1);++a<t;)n[a]=e[a];return n[t]=s(r),Er(i,this,n)}}function Zr(i){var t=[];if(i!=null)for(var s in Object(i))t.push(s);return t}var Qr=Object.prototype,Or=Qr.hasOwnProperty;function jr(i){if(!_t(i))return Zr(i);var t=rs(i),s=[];for(var e in i)e=="constructor"&&(t||!Or.call(i,e))||s.push(e);return s}function pe(i){return ks(i)?Zs(i,!0):jr(i)}var De=Jt?Jt.isConcatSpreadable:void 0;function Ir(i){return he(i)||os(i)||!!(De&&i&&i[De])}function vs(i,t,s,e,a){var o=-1,r=i.length;for(s||(s=Ir),a||(a=[]);++o<r;){var n=i[o];t>0&&s(n)?t>1?vs(n,t-1,s,e,a):as(a,n):e||(a[a.length]=n)}return a}function to(i){var t=i==null?0:i.length;return t?vs(i,1):[]}function eo(i){return Xr(kr(i,void 0,to),i+"")}var so=Qs(Object.getPrototypeOf,Object);const bs=so;function ro(i,t){return i&&It(t,is(t),i)}function oo(i,t){return i&&It(t,pe(t),i)}var ws=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ze=ws&&typeof module=="object"&&module&&!module.nodeType&&module,ao=ze&&ze.exports===ws,Ke=ao?Os.Buffer:void 0,He=Ke?Ke.allocUnsafe:void 0;function io(i,t){if(t)return i.slice();var s=i.length,e=He?He(s):new i.constructor(s);return i.copy(e),e}function no(i,t){return It(i,ns(i),t)}var lo=Object.getOwnPropertySymbols,ho=lo?function(i){for(var t=[];i;)as(t,ns(i)),i=bs(i);return t}:js;const Bs=ho;function co(i,t){return It(i,Bs(i),t)}function uo(i){return Is(i,pe,Bs)}var yo=Object.prototype,go=yo.hasOwnProperty;function po(i){var t=i.length,s=new i.constructor(t);return t&&typeof i[0]=="string"&&go.call(i,"index")&&(s.index=i.index,s.input=i.input),s}function xe(i){var t=new i.constructor(i.byteLength);return new Re(t).set(new Re(i)),t}function xo(i,t){var s=t?xe(i.buffer):i.buffer;return new i.constructor(s,i.byteOffset,i.byteLength)}var fo=/\w*$/;function mo(i){var t=new i.constructor(i.source,fo.exec(i));return t.lastIndex=i.lastIndex,t}var Ve=Jt?Jt.prototype:void 0,We=Ve?Ve.valueOf:void 0;function vo(i){return We?Object(We.call(i)):{}}function bo(i,t){var s=t?xe(i.buffer):i.buffer;return new i.constructor(s,i.byteOffset,i.length)}var wo="[object Boolean]",Bo="[object Date]",Po="[object Map]",No="[object Number]",Fo="[object RegExp]",Mo="[object Set]",To="[object String]",So="[object Symbol]",Co="[object ArrayBuffer]",Ro="[object DataView]",_o="[object Float32Array]",Lo="[object Float64Array]",Eo="[object Int8Array]",$o="[object Int16Array]",Ao="[object Int32Array]",Do="[object Uint8Array]",zo="[object Uint8ClampedArray]",Ko="[object Uint16Array]",Ho="[object Uint32Array]";function Vo(i,t,s){var e=i.constructor;switch(t){case Co:return xe(i);case wo:case Bo:return new e(+i);case Ro:return xo(i,s);case _o:case Lo:case Eo:case $o:case Ao:case Do:case zo:case Ko:case Ho:return bo(i,s);case Po:return new e;case No:case To:return new e(i);case Fo:return mo(i);case Mo:return new e;case So:return vo(i)}}function Wo(i){return typeof i.constructor=="function"&&!rs(i)?Lr(bs(i)):{}}var Uo="[object Map]";function qo(i){return ls(i)&&de(i)==Uo}var Ue=kt&&kt.isMap,Xo=Ue?hs(Ue):qo;const Yo=Xo;var Go="[object Set]";function Jo(i){return ls(i)&&de(i)==Go}var qe=kt&&kt.isSet,ko=qe?hs(qe):Jo;const Zo=ko;var Qo=1,Oo=2,jo=4,Ps="[object Arguments]",Io="[object Array]",ta="[object Boolean]",ea="[object Date]",sa="[object Error]",Ns="[object Function]",ra="[object GeneratorFunction]",oa="[object Map]",aa="[object Number]",Fs="[object Object]",ia="[object RegExp]",na="[object Set]",la="[object String]",ha="[object Symbol]",da="[object WeakMap]",ca="[object ArrayBuffer]",ua="[object DataView]",ya="[object Float32Array]",ga="[object Float64Array]",pa="[object Int8Array]",xa="[object Int16Array]",fa="[object Int32Array]",ma="[object Uint8Array]",va="[object Uint8ClampedArray]",ba="[object Uint16Array]",wa="[object Uint32Array]",C={};C[Ps]=C[Io]=C[ca]=C[ua]=C[ta]=C[ea]=C[ya]=C[ga]=C[pa]=C[xa]=C[fa]=C[oa]=C[aa]=C[Fs]=C[ia]=C[na]=C[la]=C[ha]=C[ma]=C[va]=C[ba]=C[wa]=!0;C[sa]=C[Ns]=C[da]=!1;function Yt(i,t,s,e,a,o){var r,n=t&Qo,l=t&Oo,c=t&jo;if(s&&(r=a?s(i,e,a,o):s(i)),r!==void 0)return r;if(!_t(i))return i;var d=he(i);if(d){if(r=po(i),!n)return $r(i,r)}else{var h=de(i),g=h==Ns||h==ra;if(tr(i))return io(i,n);if(h==Fs||h==Ps||g&&!a){if(r=l||g?{}:Wo(i),!n)return l?co(i,oo(r,i)):no(i,ro(r,i))}else{if(!C[h])return a?i:{};r=Vo(i,h,n)}}o||(o=new er);var p=o.get(i);if(p)return p;o.set(i,r),Zo(i)?i.forEach(function(f){r.add(Yt(f,t,s,f,i,o))}):Yo(i)&&i.forEach(function(f,v){r.set(v,Yt(f,t,s,v,i,o))});var x=c?l?uo:sr:l?pe:is,y=d?void 0:x(i);return Yr(y||i,function(f,v){y&&(v=f,f=i[v]),ge(r,v,Yt(f,t,s,v,i,o))}),r}var Ba=1,Pa=4;function Xe(i){return Yt(i,Ba|Pa)}function Na(i,t){return i!=null&&t in Object(i)}function Fa(i,t,s){t=ce(t,i);for(var e=-1,a=t.length,o=!1;++e<a;){var r=ds(t[e]);if(!(o=i!=null&&s(i,r)))break;i=i[r]}return o||++e!=a?o:(a=i==null?0:i.length,!!a&&rr(a)&&cs(r,a)&&(he(i)||os(i)))}function Ma(i,t){return i!=null&&Fa(i,t,Na)}function Ta(i,t,s,e){if(!_t(i))return i;t=ce(t,i);for(var a=-1,o=t.length,r=o-1,n=i;n!=null&&++a<o;){var l=ds(t[a]),c=s;if(l==="__proto__"||l==="constructor"||l==="prototype")return i;if(a!=r){var d=n[l];c=e?e(d,l,n):void 0,c===void 0&&(c=_t(d)?d:cs(t[a+1])?[]:{})}ge(n,l,c),n=n[l]}return i}function Sa(i,t,s){for(var e=-1,a=t.length,o={};++e<a;){var r=t[e],n=or(i,r);s(n,r)&&Ta(o,ce(r,i),n)}return o}function Ca(i,t){return Sa(i,t,function(s,e){return Ma(i,e)})}var Ra=eo(function(i,t){return i==null?{}:Ca(i,t)});const Ye=Ra,_a=["class","style"],La=/^on[A-Z]/,Ea=(i={})=>{const{excludeListeners:t=!1,excludeKeys:s}=i,e=M(()=>((s==null?void 0:s.value)||[]).concat(_a)),a=Et();return a?M(()=>{var o;return ar(Object.entries((o=a.proxy)==null?void 0:o.$attrs).filter(([r])=>!e.value.includes(r)&&!(t&&La.test(r))))}):M(()=>({}))};function $a(i){const t=L();function s(){if(i.value==null)return;const{selectionStart:a,selectionEnd:o,value:r}=i.value;if(a==null||o==null)return;const n=r.slice(0,Math.max(0,a)),l=r.slice(Math.max(0,o));t.value={selectionStart:a,selectionEnd:o,value:r,beforeTxt:n,afterTxt:l}}function e(){if(i.value==null||t.value==null)return;const{value:a}=i.value,{beforeTxt:o,afterTxt:r,selectionStart:n}=t.value;if(o==null||r==null||n==null)return;let l=a.length;if(a.endsWith(r))l=a.length-r.length;else if(a.startsWith(o))l=o.length;else{const c=o[n-1],d=a.indexOf(c,n-1);d!==-1&&(l=d+1)}i.value.setSelectionRange(l,l)}return[s,e]}let Y;const Aa=`
  height:0 !important;
  visibility:hidden !important;
  ${ir()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Da=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function za(i){const t=window.getComputedStyle(i),s=t.getPropertyValue("box-sizing"),e=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),a=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:Da.map(r=>`${r}:${t.getPropertyValue(r)}`).join(";"),paddingSize:e,borderSize:a,boxSizing:s}}function Ge(i,t=1,s){var e;Y||(Y=document.createElement("textarea"),document.body.appendChild(Y));const{paddingSize:a,borderSize:o,boxSizing:r,contextStyle:n}=za(i);Y.setAttribute("style",`${n};${Aa}`),Y.value=i.value||i.placeholder||"";let l=Y.scrollHeight;const c={};r==="border-box"?l=l+o:r==="content-box"&&(l=l-a),Y.value="";const d=Y.scrollHeight-a;if(_e(t)){let h=d*t;r==="border-box"&&(h=h+a+o),l=Math.max(h,l),c.minHeight=`${h}px`}if(_e(s)){let h=d*s;r==="border-box"&&(h=h+a+o),l=Math.min(h,l)}return c.height=`${l}px`,(e=Y.parentNode)==null||e.removeChild(Y),Y=void 0,c}const Ka=jt({id:{type:String,default:void 0},size:us,disabled:Boolean,modelValue:{type:xt([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:xt([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Le},prefixIcon:{type:Le},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:xt([Object,Array,String]),default:()=>nr({})}}),Ha={[vt]:i=>pt(i),input:i=>pt(i),change:i=>pt(i),focus:i=>i instanceof FocusEvent,blur:i=>i instanceof FocusEvent,clear:()=>!0,mouseleave:i=>i instanceof MouseEvent,mouseenter:i=>i instanceof MouseEvent,keydown:i=>i instanceof Event,compositionstart:i=>i instanceof CompositionEvent,compositionupdate:i=>i instanceof CompositionEvent,compositionend:i=>i instanceof CompositionEvent},Va=["role"],Wa=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],Ua=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],qa=q({name:"ElInput",inheritAttrs:!1}),Xa=q({...qa,props:Ka,emits:Ha,setup(i,{expose:t,emit:s}){const e=i,a=Ds(),o=zs(),r=M(()=>{const m={};return e.containerRole==="combobox"&&(m["aria-haspopup"]=a["aria-haspopup"],m["aria-owns"]=a["aria-owns"],m["aria-expanded"]=a["aria-expanded"]),m}),n=M(()=>[e.type==="textarea"?f.b():y.b(),y.m(p.value),y.is("disabled",x.value),y.is("exceed",O.value),{[y.b("group")]:o.prepend||o.append,[y.bm("group","append")]:o.append,[y.bm("group","prepend")]:o.prepend,[y.m("prefix")]:o.prefix||e.prefixIcon,[y.m("suffix")]:o.suffix||e.suffixIcon||e.clearable||e.showPassword,[y.bm("suffix","password-clear")]:yt.value&&Nt.value},a.class]),l=M(()=>[y.e("wrapper"),y.is("focus",F.value)]),c=Ea({excludeKeys:M(()=>Object.keys(r.value))}),{form:d,formItem:h}=ys(),{inputId:g}=gs(e,{formItemContext:h}),p=ps(),x=xs(),y=ot("input"),f=ot("textarea"),v=Ct(),w=Ct(),F=L(!1),et=L(!1),Q=L(!1),ct=L(!1),$t=L(),ut=Ct(e.inputStyle),at=M(()=>v.value||w.value),wt=M(()=>{var m;return(m=d==null?void 0:d.statusIcon)!=null?m:!1}),G=M(()=>(h==null?void 0:h.validateState)||""),At=M(()=>G.value&&lr[G.value]),Dt=M(()=>ct.value?hr:dr),Bt=M(()=>[a.style,e.inputStyle]),Pt=M(()=>[e.inputStyle,ut.value,{resize:e.resize}]),X=M(()=>Xt(e.modelValue)?"":String(e.modelValue)),yt=M(()=>e.clearable&&!x.value&&!e.readonly&&!!X.value&&(F.value||et.value)),Nt=M(()=>e.showPassword&&!x.value&&!e.readonly&&!!X.value&&(!!X.value||F.value)),P=M(()=>e.showWordLimit&&!!c.value.maxlength&&(e.type==="text"||e.type==="textarea")&&!x.value&&!e.readonly&&!e.showPassword),K=M(()=>X.value.length),O=M(()=>!!P.value&&K.value>Number(c.value.maxlength)),zt=M(()=>!!o.suffix||!!e.suffixIcon||yt.value||e.showPassword||P.value||!!G.value&&wt.value),[Kt,Cs]=$a(v);cr(w,m=>{if(Rs(),!P.value||e.resize!=="both")return;const S=m[0],{width:J}=S.contentRect;$t.value={right:`calc(100% - ${J+15+6}px)`}});const Ft=()=>{const{type:m,autosize:S}=e;if(!(!fs||m!=="textarea"||!w.value))if(S){const J=Me(S)?S.minRows:void 0,Vt=Me(S)?S.maxRows:void 0,Fe=Ge(w.value,J,Vt);ut.value={overflowY:"hidden",...Fe},k(()=>{w.value.offsetHeight,ut.value=Fe})}else ut.value={minHeight:Ge(w.value).minHeight}},Rs=(m=>{let S=!1;return()=>{var J;if(S||!e.autosize)return;((J=w.value)==null?void 0:J.offsetParent)===null||(m(),S=!0)}})(Ft),Mt=()=>{const m=at.value;!m||m.value===X.value||(m.value=X.value)},te=async m=>{Kt();let{value:S}=m.target;if(e.formatter&&(S=e.parser?e.parser(S):S,S=e.formatter(S)),!Q.value){if(S===X.value){Mt();return}s(vt,S),s("input",S),await k(),Mt(),Cs()}},fe=m=>{s("change",m.target.value)},me=m=>{s("compositionstart",m),Q.value=!0},ve=m=>{var S;s("compositionupdate",m);const J=(S=m.target)==null?void 0:S.value,Vt=J[J.length-1]||"";Q.value=!yr(Vt)},be=m=>{s("compositionend",m),Q.value&&(Q.value=!1,te(m))},_s=()=>{ct.value=!ct.value,Ht()},Ht=async()=>{var m;await k(),(m=at.value)==null||m.focus()},Ls=()=>{var m;return(m=at.value)==null?void 0:m.blur()},we=m=>{F.value=!0,s("focus",m)},Be=m=>{var S;F.value=!1,s("blur",m),e.validateEvent&&((S=h==null?void 0:h.validate)==null||S.call(h,"blur").catch(J=>Zt()))},Es=m=>{et.value=!1,s("mouseleave",m)},$s=m=>{et.value=!0,s("mouseenter",m)},Pe=m=>{s("keydown",m)},As=()=>{var m;(m=at.value)==null||m.select()},Ne=()=>{s(vt,""),s("change",""),s("clear"),s("input","")};return W(()=>e.modelValue,()=>{var m;k(()=>Ft()),e.validateEvent&&((m=h==null?void 0:h.validate)==null||m.call(h,"change").catch(S=>Zt()))}),W(X,()=>Mt()),W(()=>e.type,async()=>{await k(),Mt(),Ft()}),bt(()=>{!e.formatter&&e.parser,Mt(),k(Ft)}),t({input:v,textarea:w,ref:at,textareaStyle:Pt,autosize:Ks(e,"autosize"),focus:Ht,blur:Ls,select:As,clear:Ne,resizeTextarea:Ft}),(m,S)=>le((b(),T("div",ee(u(r),{class:u(n),style:u(Bt),role:m.containerRole,onMouseenter:$s,onMouseleave:Es}),[E(" input "),m.type!=="textarea"?(b(),T(qt,{key:0},[E(" prepend slot "),m.$slots.prepend?(b(),T("div",{key:0,class:B(u(y).be("group","prepend"))},[St(m.$slots,"prepend")],2)):E("v-if",!0),N("div",{class:B(u(l))},[E(" prefix slot "),m.$slots.prefix||m.prefixIcon?(b(),T("span",{key:0,class:B(u(y).e("prefix"))},[N("span",{class:B(u(y).e("prefix-inner")),onClick:Ht},[St(m.$slots,"prefix"),m.prefixIcon?(b(),z(u(nt),{key:0,class:B(u(y).e("icon"))},{default:$(()=>[(b(),z(Wt(m.prefixIcon)))]),_:1},8,["class"])):E("v-if",!0)],2)],2)):E("v-if",!0),N("input",ee({id:u(g),ref_key:"input",ref:v,class:u(y).e("inner")},u(c),{type:m.showPassword?ct.value?"text":"password":m.type,disabled:u(x),formatter:m.formatter,parser:m.parser,readonly:m.readonly,autocomplete:m.autocomplete,tabindex:m.tabindex,"aria-label":m.label,placeholder:m.placeholder,style:m.inputStyle,form:e.form,onCompositionstart:me,onCompositionupdate:ve,onCompositionend:be,onInput:te,onFocus:we,onBlur:Be,onChange:fe,onKeydown:Pe}),null,16,Wa),E(" suffix slot "),u(zt)?(b(),T("span",{key:1,class:B(u(y).e("suffix"))},[N("span",{class:B(u(y).e("suffix-inner")),onClick:Ht},[!u(yt)||!u(Nt)||!u(P)?(b(),T(qt,{key:0},[St(m.$slots,"suffix"),m.suffixIcon?(b(),z(u(nt),{key:0,class:B(u(y).e("icon"))},{default:$(()=>[(b(),z(Wt(m.suffixIcon)))]),_:1},8,["class"])):E("v-if",!0)],64)):E("v-if",!0),u(yt)?(b(),z(u(nt),{key:1,class:B([u(y).e("icon"),u(y).e("clear")]),onMousedown:Hs(u(Vs),["prevent"]),onClick:Ne},{default:$(()=>[_(u(ur))]),_:1},8,["class","onMousedown"])):E("v-if",!0),u(Nt)?(b(),z(u(nt),{key:2,class:B([u(y).e("icon"),u(y).e("password")]),onClick:_s},{default:$(()=>[(b(),z(Wt(u(Dt))))]),_:1},8,["class"])):E("v-if",!0),u(P)?(b(),T("span",{key:3,class:B(u(y).e("count"))},[N("span",{class:B(u(y).e("count-inner"))},gt(u(K))+" / "+gt(u(c).maxlength),3)],2)):E("v-if",!0),u(G)&&u(At)&&u(wt)?(b(),z(u(nt),{key:4,class:B([u(y).e("icon"),u(y).e("validateIcon"),u(y).is("loading",u(G)==="validating")])},{default:$(()=>[(b(),z(Wt(u(At))))]),_:1},8,["class"])):E("v-if",!0)],2)],2)):E("v-if",!0)],2),E(" append slot "),m.$slots.append?(b(),T("div",{key:1,class:B(u(y).be("group","append"))},[St(m.$slots,"append")],2)):E("v-if",!0)],64)):(b(),T(qt,{key:1},[E(" textarea "),N("textarea",ee({id:u(g),ref_key:"textarea",ref:w,class:u(f).e("inner")},u(c),{tabindex:m.tabindex,disabled:u(x),readonly:m.readonly,autocomplete:m.autocomplete,style:u(Pt),"aria-label":m.label,placeholder:m.placeholder,form:e.form,onCompositionstart:me,onCompositionupdate:ve,onCompositionend:be,onInput:te,onFocus:we,onBlur:Be,onChange:fe,onKeydown:Pe}),null,16,Ua),u(P)?(b(),T("span",{key:0,style:tt($t.value),class:B(u(y).e("count"))},gt(u(K))+" / "+gt(u(c).maxlength),7)):E("v-if",!0)],64))],16,Va)),[[es,m.type!=="hidden"]])}});var Ya=ht(Xa,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const Ga=ue(Ya),Ja=jt({color:{type:xt(Object),required:!0},vertical:{type:Boolean,default:!1}});let oe=!1;function Lt(i,t){if(!fs)return;const s=function(o){var r;(r=t.drag)==null||r.call(t,o)},e=function(o){var r;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",e),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",e),document.onselectstart=null,document.ondragstart=null,oe=!1,(r=t.end)==null||r.call(t,o)},a=function(o){var r;oe||(o.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",e),document.addEventListener("touchmove",s),document.addEventListener("touchend",e),oe=!0,(r=t.start)==null||r.call(t,o))};i.addEventListener("mousedown",a),i.addEventListener("touchstart",a)}const ka=i=>{const t=Et(),s=Ct(),e=Ct();function a(r){r.target!==s.value&&o(r)}function o(r){if(!e.value||!s.value)return;const l=t.vnode.el.getBoundingClientRect(),{clientX:c,clientY:d}=ye(r);if(i.vertical){let h=d-l.top;h=Math.max(s.value.offsetHeight/2,h),h=Math.min(h,l.height-s.value.offsetHeight/2),i.color.set("alpha",Math.round((h-s.value.offsetHeight/2)/(l.height-s.value.offsetHeight)*100))}else{let h=c-l.left;h=Math.max(s.value.offsetWidth/2,h),h=Math.min(h,l.width-s.value.offsetWidth/2),i.color.set("alpha",Math.round((h-s.value.offsetWidth/2)/(l.width-s.value.offsetWidth)*100))}}return{thumb:s,bar:e,handleDrag:o,handleClick:a}},Za=(i,{bar:t,thumb:s,handleDrag:e})=>{const a=Et(),o=ot("color-alpha-slider"),r=L(0),n=L(0),l=L();function c(){if(!s.value||i.vertical)return 0;const w=a.vnode.el,F=i.color.get("alpha");return w?Math.round(F*(w.offsetWidth-s.value.offsetWidth/2)/100):0}function d(){if(!s.value)return 0;const w=a.vnode.el;if(!i.vertical)return 0;const F=i.color.get("alpha");return w?Math.round(F*(w.offsetHeight-s.value.offsetHeight/2)/100):0}function h(){if(i.color&&i.color.value){const{r:w,g:F,b:et}=i.color.toRgb();return`linear-gradient(to right, rgba(${w}, ${F}, ${et}, 0) 0%, rgba(${w}, ${F}, ${et}, 1) 100%)`}return""}function g(){r.value=c(),n.value=d(),l.value=h()}bt(()=>{if(!t.value||!s.value)return;const w={drag:F=>{e(F)},end:F=>{e(F)}};Lt(t.value,w),Lt(s.value,w),g()}),W(()=>i.color.get("alpha"),()=>g()),W(()=>i.color.value,()=>g());const p=M(()=>[o.b(),o.is("vertical",i.vertical)]),x=M(()=>o.e("bar")),y=M(()=>o.e("thumb")),f=M(()=>({background:l.value})),v=M(()=>({left:Ee(r.value),top:Ee(n.value)}));return{rootKls:p,barKls:x,barStyle:f,thumbKls:y,thumbStyle:v,update:g}},Qa="ElColorAlphaSlider",Oa=q({name:Qa}),ja=q({...Oa,props:Ja,setup(i,{expose:t}){const s=i,{bar:e,thumb:a,handleDrag:o,handleClick:r}=ka(s),{rootKls:n,barKls:l,barStyle:c,thumbKls:d,thumbStyle:h,update:g}=Za(s,{bar:e,thumb:a,handleDrag:o});return t({update:g,bar:e,thumb:a}),(p,x)=>(b(),T("div",{class:B(u(n))},[N("div",{ref_key:"bar",ref:e,class:B(u(l)),style:tt(u(c)),onClick:x[0]||(x[0]=(...y)=>u(r)&&u(r)(...y))},null,6),N("div",{ref_key:"thumb",ref:a,class:B(u(d)),style:tt(u(h))},null,6)],2))}});var Ia=ht(ja,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const ti=q({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(i){const t=ot("color-hue-slider"),s=Et(),e=L(),a=L(),o=L(0),r=L(0),n=M(()=>i.color.get("hue"));W(()=>n.value,()=>{g()});function l(p){p.target!==e.value&&c(p)}function c(p){if(!a.value||!e.value)return;const y=s.vnode.el.getBoundingClientRect(),{clientX:f,clientY:v}=ye(p);let w;if(i.vertical){let F=v-y.top;F=Math.min(F,y.height-e.value.offsetHeight/2),F=Math.max(e.value.offsetHeight/2,F),w=Math.round((F-e.value.offsetHeight/2)/(y.height-e.value.offsetHeight)*360)}else{let F=f-y.left;F=Math.min(F,y.width-e.value.offsetWidth/2),F=Math.max(e.value.offsetWidth/2,F),w=Math.round((F-e.value.offsetWidth/2)/(y.width-e.value.offsetWidth)*360)}i.color.set("hue",w)}function d(){if(!e.value)return 0;const p=s.vnode.el;if(i.vertical)return 0;const x=i.color.get("hue");return p?Math.round(x*(p.offsetWidth-e.value.offsetWidth/2)/360):0}function h(){if(!e.value)return 0;const p=s.vnode.el;if(!i.vertical)return 0;const x=i.color.get("hue");return p?Math.round(x*(p.offsetHeight-e.value.offsetHeight/2)/360):0}function g(){o.value=d(),r.value=h()}return bt(()=>{if(!a.value||!e.value)return;const p={drag:x=>{c(x)},end:x=>{c(x)}};Lt(a.value,p),Lt(e.value,p),g()}),{bar:a,thumb:e,thumbLeft:o,thumbTop:r,hueValue:n,handleClick:l,update:g,ns:t}}});function ei(i,t,s,e,a,o){return b(),T("div",{class:B([i.ns.b(),i.ns.is("vertical",i.vertical)])},[N("div",{ref:"bar",class:B(i.ns.e("bar")),onClick:t[0]||(t[0]=(...r)=>i.handleClick&&i.handleClick(...r))},null,2),N("div",{ref:"thumb",class:B(i.ns.e("thumb")),style:tt({left:i.thumbLeft+"px",top:i.thumbTop+"px"})},null,6)],2)}var si=ht(ti,[["render",ei],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const ri=jt({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:us,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:xt(Array)},validateEvent:{type:Boolean,default:!0}}),oi={[vt]:i=>pt(i)||Xt(i),[gr]:i=>pt(i)||Xt(i),activeChange:i=>pt(i)||Xt(i)},Ms=Symbol("colorPickerContextKey"),Je=function(i,t,s){return[i,t*s/((i=(2-t)*s)<1?i:2-i)||0,i/2]},ai=function(i){return typeof i=="string"&&i.includes(".")&&Number.parseFloat(i)===1},ii=function(i){return typeof i=="string"&&i.includes("%")},mt=function(i,t){ai(i)&&(i="100%");const s=ii(i);return i=Math.min(t,Math.max(0,Number.parseFloat(`${i}`))),s&&(i=Number.parseInt(`${i*t}`,10)/100),Math.abs(i-t)<1e-6?1:i%t/Number.parseFloat(t)},ke={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Gt=i=>{i=Math.min(Math.round(i),255);const t=Math.floor(i/16),s=i%16;return`${ke[t]||t}${ke[s]||s}`},Ze=function({r:i,g:t,b:s}){return Number.isNaN(+i)||Number.isNaN(+t)||Number.isNaN(+s)?"":`#${Gt(i)}${Gt(t)}${Gt(s)}`},ae={A:10,B:11,C:12,D:13,E:14,F:15},it=function(i){return i.length===2?(ae[i[0].toUpperCase()]||+i[0])*16+(ae[i[1].toUpperCase()]||+i[1]):ae[i[1].toUpperCase()]||+i[1]},ni=function(i,t,s){t=t/100,s=s/100;let e=t;const a=Math.max(s,.01);s*=2,t*=s<=1?s:2-s,e*=a<=1?a:2-a;const o=(s+t)/2,r=s===0?2*e/(a+e):2*t/(s+t);return{h:i,s:r*100,v:o*100}},Qe=(i,t,s)=>{i=mt(i,255),t=mt(t,255),s=mt(s,255);const e=Math.max(i,t,s),a=Math.min(i,t,s);let o;const r=e,n=e-a,l=e===0?0:n/e;if(e===a)o=0;else{switch(e){case i:{o=(t-s)/n+(t<s?6:0);break}case t:{o=(s-i)/n+2;break}case s:{o=(i-t)/n+4;break}}o/=6}return{h:o*360,s:l*100,v:r*100}},Tt=function(i,t,s){i=mt(i,360)*6,t=mt(t,100),s=mt(s,100);const e=Math.floor(i),a=i-e,o=s*(1-t),r=s*(1-a*t),n=s*(1-(1-a)*t),l=e%6,c=[s,r,o,o,n,s][l],d=[n,s,s,r,o,o][l],h=[o,o,n,s,s,r][l];return{r:Math.round(c*255),g:Math.round(d*255),b:Math.round(h*255)}};class Rt{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const s in t)Te(t,s)&&(this[s]=t[s]);t.value?this.fromString(t.value):this.doOnChange()}set(t,s){if(arguments.length===1&&typeof t=="object"){for(const e in t)Te(t,e)&&this.set(e,t[e]);return}this[`_${t}`]=s,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Tt(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const s=(e,a,o)=>{this._hue=Math.max(0,Math.min(360,e)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,o)),this.doOnChange()};if(t.includes("hsl")){const e=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,o)=>o>2?Number.parseFloat(a):Number.parseInt(a,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:a,s:o,v:r}=ni(e[0],e[1],e[2]);s(a,o,r)}}else if(t.includes("hsv")){const e=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,o)=>o>2?Number.parseFloat(a):Number.parseInt(a,10));e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3&&s(e[0],e[1],e[2])}else if(t.includes("rgb")){const e=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,o)=>o>2?Number.parseFloat(a):Number.parseInt(a,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:a,s:o,v:r}=Qe(e[0],e[1],e[2]);s(a,o,r)}}else if(t.includes("#")){const e=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(e))return;let a,o,r;e.length===3?(a=it(e[0]+e[0]),o=it(e[1]+e[1]),r=it(e[2]+e[2])):(e.length===6||e.length===8)&&(a=it(e.slice(0,2)),o=it(e.slice(2,4)),r=it(e.slice(4,6))),e.length===8?this._alpha=it(e.slice(6))/255*100:(e.length===3||e.length===6)&&(this._alpha=100);const{h:n,s:l,v:c}=Qe(a,o,r);s(n,l,c)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:s,_value:e,_alpha:a,format:o}=this;if(this.enableAlpha)switch(o){case"hsl":{const r=Je(t,s/100,e/100);this.value=`hsla(${t}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(s)}%, ${Math.round(e)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${Ze(Tt(t,s,e))}${Gt(a*255/100)}`;break}default:{const{r,g:n,b:l}=Tt(t,s,e);this.value=`rgba(${r}, ${n}, ${l}, ${this.get("alpha")/100})`}}else switch(o){case"hsl":{const r=Je(t,s/100,e/100);this.value=`hsl(${t}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(s)}%, ${Math.round(e)}%)`;break}case"rgb":{const{r,g:n,b:l}=Tt(t,s,e);this.value=`rgb(${r}, ${n}, ${l})`;break}default:this.value=Ze(Tt(t,s,e))}}}const li=q({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(i){const t=ot("color-predefine"),{currentColor:s}=Ws(Ms),e=L(o(i.colors,i.color));W(()=>s.value,r=>{const n=new Rt;n.fromString(r),e.value.forEach(l=>{l.selected=n.compare(l)})}),Us(()=>{e.value=o(i.colors,i.color)});function a(r){i.color.fromString(i.colors[r])}function o(r,n){return r.map(l=>{const c=new Rt;return c.enableAlpha=!0,c.format="rgba",c.fromString(l),c.selected=c.value===n.value,c})}return{rgbaColors:e,handleSelect:a,ns:t}}}),hi=["onClick"];function di(i,t,s,e,a,o){return b(),T("div",{class:B(i.ns.b())},[N("div",{class:B(i.ns.e("colors"))},[(b(!0),T(qt,null,qs(i.rgbaColors,(r,n)=>(b(),T("div",{key:i.colors[n],class:B([i.ns.e("color-selector"),i.ns.is("alpha",r._alpha<100),{selected:r.selected}]),onClick:l=>i.handleSelect(n)},[N("div",{style:tt({backgroundColor:r.value})},null,4)],10,hi))),128))],2)],2)}var ci=ht(li,[["render",di],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const ui=q({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(i){const t=ot("color-svpanel"),s=Et(),e=L(0),a=L(0),o=L("hsl(0, 100%, 50%)"),r=M(()=>{const c=i.color.get("hue"),d=i.color.get("value");return{hue:c,value:d}});function n(){const c=i.color.get("saturation"),d=i.color.get("value"),h=s.vnode.el,{clientWidth:g,clientHeight:p}=h;a.value=c*g/100,e.value=(100-d)*p/100,o.value=`hsl(${i.color.get("hue")}, 100%, 50%)`}function l(c){const h=s.vnode.el.getBoundingClientRect(),{clientX:g,clientY:p}=ye(c);let x=g-h.left,y=p-h.top;x=Math.max(0,x),x=Math.min(x,h.width),y=Math.max(0,y),y=Math.min(y,h.height),a.value=x,e.value=y,i.color.set({saturation:x/h.width*100,value:100-y/h.height*100})}return W(()=>r.value,()=>{n()}),bt(()=>{Lt(s.vnode.el,{drag:c=>{l(c)},end:c=>{l(c)}}),n()}),{cursorTop:e,cursorLeft:a,background:o,colorValue:r,handleDrag:l,update:n,ns:t}}}),yi=N("div",null,null,-1),gi=[yi];function pi(i,t,s,e,a,o){return b(),T("div",{class:B(i.ns.b()),style:tt({backgroundColor:i.background})},[N("div",{class:B(i.ns.e("white"))},null,2),N("div",{class:B(i.ns.e("black"))},null,2),N("div",{class:B(i.ns.e("cursor")),style:tt({top:i.cursorTop+"px",left:i.cursorLeft+"px"})},gi,6)],6)}var xi=ht(ui,[["render",pi],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const fi=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],mi=q({name:"ElColorPicker"}),vi=q({...mi,props:ri,emits:oi,setup(i,{expose:t,emit:s}){const e=i,{t:a}=pr(),o=ot("color"),{formItem:r}=ys(),n=ps(),l=xs(),{inputId:c,isLabeledByFormItem:d}=gs(e,{formItemContext:r}),h=L(),g=L(),p=L(),x=L();let y=!0;const f=ss(new Rt({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue})),v=L(!1),w=L(!1),F=L(""),et=M(()=>!e.modelValue&&!w.value?"transparent":at(f,e.showAlpha)),Q=M(()=>!e.modelValue&&!w.value?"":f.value),ct=M(()=>d.value?void 0:e.label||a("el.colorpicker.defaultLabel")),$t=M(()=>d.value?r==null?void 0:r.labelId:void 0),ut=M(()=>[o.b("picker"),o.is("disabled",l.value),o.bm("picker",n.value)]);function at(P,K){if(!(P instanceof Rt))throw new TypeError("color should be instance of _color Class");const{r:O,g:zt,b:Kt}=P.toRgb();return K?`rgba(${O}, ${zt}, ${Kt}, ${P.get("alpha")/100})`:`rgb(${O}, ${zt}, ${Kt})`}function wt(P){v.value=P}const G=xr(wt,100);function At(){l.value||wt(!0)}function Dt(){G(!1),Bt()}function Bt(){k(()=>{e.modelValue?f.fromString(e.modelValue):(f.value="",k(()=>{w.value=!1}))})}function Pt(){l.value||G(!v.value)}function X(){f.fromString(F.value)}function yt(){const P=f.value;s(vt,P),s("change",P),e.validateEvent&&(r==null||r.validate("change").catch(K=>Zt())),G(!1),k(()=>{const K=new Rt({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue});f.compare(K)||Bt()})}function Nt(){G(!1),s(vt,null),s("change",null),e.modelValue!==null&&e.validateEvent&&(r==null||r.validate("change").catch(P=>Zt())),Bt()}return bt(()=>{e.modelValue&&(F.value=Q.value)}),W(()=>e.modelValue,P=>{P?P&&P!==f.value&&(y=!1,f.fromString(P)):w.value=!1}),W(()=>Q.value,P=>{F.value=P,y&&s("activeChange",P),y=!0}),W(()=>f.value,()=>{!e.modelValue&&!w.value&&(w.value=!0)}),W(()=>v.value,()=>{k(()=>{var P,K,O;(P=h.value)==null||P.update(),(K=g.value)==null||K.update(),(O=p.value)==null||O.update()})}),Xs(Ms,{currentColor:Q}),t({color:f,show:At,hide:Dt}),(P,K)=>(b(),z(u(br),{ref_key:"popper",ref:x,visible:v.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[u(o).be("picker","panel"),u(o).b("dropdown"),P.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${u(o).namespace.value}-zoom-in-top`,persistent:""},{content:$(()=>[le((b(),T("div",null,[N("div",{class:B(u(o).be("dropdown","main-wrapper"))},[_(si,{ref_key:"hue",ref:h,class:"hue-slider",color:u(f),vertical:""},null,8,["color"]),_(xi,{ref:"svPanel",color:u(f)},null,8,["color"])],2),P.showAlpha?(b(),z(Ia,{key:0,ref_key:"alpha",ref:p,color:u(f)},null,8,["color"])):E("v-if",!0),P.predefine?(b(),z(ci,{key:1,ref:"predefine",color:u(f),colors:P.predefine},null,8,["color","colors"])):E("v-if",!0),N("div",{class:B(u(o).be("dropdown","btns"))},[N("span",{class:B(u(o).be("dropdown","value"))},[_(u(Ga),{modelValue:F.value,"onUpdate:modelValue":K[0]||(K[0]=O=>F.value=O),"validate-event":!1,size:"small",onKeyup:Se(X,["enter"]),onBlur:X},null,8,["modelValue","onKeyup"])],2),_(u(H),{class:B(u(o).be("dropdown","link-btn")),text:"",size:"small",onClick:Nt},{default:$(()=>[Ce(gt(u(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),_(u(H),{plain:"",size:"small",class:B(u(o).be("dropdown","btn")),onClick:yt},{default:$(()=>[Ce(gt(u(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[u(fr),Dt]])]),default:$(()=>[N("div",{id:u(c),class:B(u(ut)),role:"button","aria-label":u(ct),"aria-labelledby":u($t),"aria-description":u(a)("el.colorpicker.description",{color:P.modelValue||""}),tabindex:P.tabindex,onKeydown:Se(Pt,["enter"])},[u(l)?(b(),T("div",{key:0,class:B(u(o).be("picker","mask"))},null,2)):E("v-if",!0),N("div",{class:B(u(o).be("picker","trigger")),onClick:Pt},[N("span",{class:B([u(o).be("picker","color"),u(o).is("alpha",P.showAlpha)])},[N("span",{class:B(u(o).be("picker","color-inner")),style:tt({backgroundColor:u(et)})},[le(_(u(nt),{class:B([u(o).be("picker","icon"),u(o).is("icon-arrow-down")])},{default:$(()=>[_(u(mr))]),_:1},8,["class"]),[[es,P.modelValue||w.value]]),!P.modelValue&&!w.value?(b(),z(u(nt),{key:0,class:B([u(o).be("picker","empty"),u(o).is("icon-close")])},{default:$(()=>[_(u(vr))]),_:1},8,["class"])):E("v-if",!0)],6)],2)],2)],42,fi)]),_:1},8,["visible","popper-class","transition"]))}});var bi=ht(vi,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const ie=ue(bi),wi=jt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:xt(String),default:"solid"}}),Bi=q({name:"ElDivider"}),Pi=q({...Bi,props:wi,setup(i){const t=i,s=ot("divider"),e=M(()=>s.cssVar({"border-style":t.borderStyle}));return(a,o)=>(b(),T("div",{class:B([u(s).b(),u(s).m(a.direction)]),style:tt(u(e)),role:"separator"},[a.$slots.default&&a.direction!=="vertical"?(b(),T("div",{key:0,class:B([u(s).e("text"),u(s).is(a.contentPosition)])},[St(a.$slots,"default")],2)):E("v-if",!0)],6))}});var Ni=ht(Pi,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const ne=ue(Ni);class Fi extends dt{constructor(t,s){super(),this.x=0,this.y=0,this.w=20,this.h=14,this.fillStyle="#eeb174",this.strokeStyle="#333",this.ctx=t,this.analysisOptions(s)}analysisOptions(t){t.x&&(this.x=t.x),t.y&&(this.y=t.y),t.w&&(this.w=t.w),t.h&&(this.h=t.h),t.fillStyle&&(this.fillStyle=t.fillStyle),t.strokeStyle&&(this.strokeStyle=t.strokeStyle),t.tiggerFunc&&(this.tiggerFunc=t.tiggerFunc)}draw(){const{ctx:t,x:s,y:e,w:a,h:o,fillStyle:r,strokeStyle:n}=this;t.save(),t.fillStyle=r,t.strokeStyle=n,t.lineWidth=3,t.beginPath(),t.arc(s+a/2,e-3,a/3,0,Math.PI,!0),t.stroke(),t.drawRoundedRect(s,e,a,o,2,2,2,2,!0,!0,!1,!1),t.restore()}containsPoint(t,s=!1){var g;const{x:e,y:a,w:o,h:r}=this,{x:n,y:l}=t,c=this.getImageLines({tl:{x:e,y:a},tr:{x:e+o,y:a},bl:{x:e,y:a+r},br:{x:e+o,y:a+r}}),h=!!(this.findCrossPoints(n,l,c)%2);return h&&s&&((g=this.tiggerFunc)==null||g.call(this)),h}}const Mi=function(i){return i.length===4&&(i=i.slice(0,2)+i.slice(1,2)+i.slice(2,3)+i.slice(2,3)+i.slice(3,4)+i.slice(3,4)),"rgb("+parseInt("0x"+i.slice(1,3))+","+parseInt("0x"+i.slice(3,5))+","+parseInt("0x"+i.slice(5,7))+")"},Ti=function(i){const s=(i.includes("rgb")?i:Mi(i)).replace(/rgb\(|rgba\(|\)/g,"").split(",");return .213*s[0]+.715*s[1]+.072*s[2]>255/2},Si="L";function rt(){return((1+Math.random())*65536|0).toString(16).substring(1)}function Ci(){return`${Si}${rt()}${rt()}-${rt()}-${rt()}-${rt()}-${rt()}${rt()}${rt()}`}class Z extends dt{constructor(t,s){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=12,this.padding=10,this.attrHeight=14,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.bgColor="#FFFFFF",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s,y:e,width:a,height:o,id:r,enName:n,cnName:l,type:c,attributes:d,bgC:h,bdC:g,quotePrimaryKey:p,physicalTables:x,manualChange:y}=t;U(s)&&(this.x=s),U(e)&&(this.y=e),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),U(a)&&(this.width=a),U(o)&&(this.height=o),c&&(this.type=c),d&&(this.attributes=d,this.attributesPartition()),h&&(this.bgColor=h),g&&(this.borderColor=g),ft(p)&&(this.quotePrimaryKey=p),ft(x)&&(this.physicalTables=x),ft(y)&&(this.manualChange=y)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t){var y;const{x:s,y:e}=t,{x:a,y:o,width:r,height:n,attrHeight:l}=this,c=this.getImageLines({tl:{x:a,y:o},tr:{x:a+r,y:o},bl:{x:a,y:o+n},br:{x:a+r,y:o+n}});if(!!!(this.findCrossPoints(s,e,c)%2))return!1;const g=e-o-this.padding-(this.attributesPrimary.length?0:l),p=Math.floor(g/l),x=(y=[...this.attributesPrimary,{},...this.attributesPrimaryNon][p])==null?void 0:y.id;return this.activeAttribute=x,x??!0}draw(t){this.updateOptions(t),this.drawContainer(),this.drawTitle(),this.drawbody()}drawContainer(){const{ctx:t,x:s,y:e,width:a,height:o,type:r,bgColor:n,borderColor:l,quotePrimaryKey:c,physicalTables:d}=this;if(t.save(),t.strokeStyle=l,t.fillStyle=n,["exclusive","inclusive"].includes(r))t.beginPath(),t.arc(s+a/2,e+a/2,a/2,0,Math.PI,!0),t.closePath(),t.fill(),t.stroke(),r==="exclusive"&&(t.moveTo(s+12,e+6),t.lineTo(s+a-12,e+o-3),t.moveTo(s+a-12,e+6),t.lineTo(s+12,e+o-3),t.stroke());else{const h=c?4:0;t.drawRoundedRect(s,e,a,o,h,h,h,h,!0,!0,d,!0)}t.restore()}drawDataType(t,s,e){const a=t==null?void 0:t.toLocaleUpperCase();let o;a in wr?o=se.get("date"):a in Br?o=se.get("number"):a in Pr&&(o=se.get("string"));const{ctx:r}=this;if(!o)return r.save(),r.fillStyle="#808080",r.fillText("?",s,e,this.fontSize),r.restore(),!1;r.drawImage(o,s,e,this.fontSize,this.fontSize)}drawTitle(){const{ctx:t,textColor:s,enName:e,width:a,x:o,y:r,titleHeight:n,fontSize:l}=this;t.save(),t.font=`${l}px`,t.fillStyle=s,t.textAlign="left",t.textBaseline="top",t.fillText(t.fittingString(e,a-14),o,r-n),t.restore()}drawbody(){const{ctx:t,x:s,y:e,bgColor:a,fontSize:o,padding:r,attrHeight:n,attributesPrimary:l,attributesPrimaryNon:c}=this;t.save(),t.font=`${o}px Arial`,t.fillStyle=Ti(a)?"#000":"#fff",t.textAlign="left",t.textBaseline="top";const d=r+s;let h=e+r-n;for(let g=0;g<l.length;g++){const p=l[g];h=this.drawAttrRow(p,d,h)}h=this.drawSplitLine(h);for(let g=0;g<c.length;g++){const p=c[g];h=this.drawAttrRow(p,d,h)}t.restore()}drawAttrRow(t,s,e){var y;const{ctx:a,attrHeight:o,padding:r,fontSize:n,x:l,y:c,width:d,height:h}=this;if(e+=o,e+16>h+c)return;this.activeAttribute===t.id&&(a.save(),a.fillStyle="#ADD8E6",a.fillRect(s+n,e-1,d-(s-l)-r-n,o),a.restore()),this.drawDataType(t.type,s,e);const g=t.foreignKey?"(FK)":"",p=a.fittingString(t.attrName+g,d-(s-l)-r-n);a.fillText(p,s+n,e);const x=s+a.measureText(p).width+n;if(this.drawIcons(t.icons,x,e),(y=t.children)!=null&&y.length){const f=this.expandAttrs.includes(t);this.drawTreeExpandArrow.call(this,{x:s,y:e,size:n,expand:f}),f&&t.children.forEach(v=>{e=this.drawAttrRow(v,s+10,e)})}return e}drawIcons(t=[],s,e){const{fontSize:a,x:o,width:r,padding:n}=this;for(let l=0;l<t.length;l++){const c=t[l],d=s+a*.7+l*(a*1.2);if(d+a/2*3>o+r+n)return;this.drawIcon(c,d,e)}}drawIcon(t,s,e){const{ctx:a,attrHeight:o,fontSize:r}=this;a.save(),a.beginPath(),a.strokeStyle=t.bdC||"#0C64EB",a.fillStyle=t.bgC||"#ECF5FF",a.arc(s,e+Math.floor(o/2)-1,r/2,0,2*Math.PI),a.fill(),a.stroke(),a.fillStyle=t.color||"#0C64EB",a.font=`${Math.ceil(r/1.2)}px Arial`,a.textAlign="center",a.fillText(t.text,s,e+(o-r)/2+1),a.restore()}drawSplitLine(t){const{ctx:s,attributesPrimary:e,attrHeight:a,x:o,y:r,width:n,height:l}=this;return t+=(e.length?1:2)*a,s.save(),t<l+r&&(s.beginPath(),s.strokeStyle="#000",s.moveTo(o+.5,t+a/3+.5),s.lineTo(o+n+.5,t+a/3+.5),s.stroke()),s.restore(),t}drawTreeExpandArrow({x:t,y:s,size:e,expand:a}){const{ctx:o}=this;o.save(),o.beginPath(),o.translate(t-4,s+e/2),a&&o.rotate(90*Math.PI/180),o.moveTo(-2,-4),o.lineTo(-2,4),o.lineTo(2,0),o.fill(),o.restore()}drawFocusAttr({attrItem:t,finalText:s,curX:e,curY:a,fullWidth:o,nodePadding:r}){var h,g;const{ctx:n,attrFocusStyle:l}=this,c=(h=t==null?void 0:t.children)!=null&&h.length?e:e-r/2,d=(g=t==null?void 0:t.children)!=null&&g.length?o-r/2:o;n.save(),n.fillStyle=l.backgroundColor,n.fillRect(c,a-1,d,16),n.fillStyle=l.color,n.fillText(s,e,a),n.restore()}attributesPartition(){this.attributesPrimary=[],this.attributesPrimaryNon=[];const{attributes:t,attributesPrimary:s,attributesPrimaryNon:e}=this;for(let a=0;a<t.length;a++){const o=t[a];o.primaryKey?s.push(o):e.push(o),o.id||(o.id=Ci())}}calcBoundingBox(){const{x:t,y:s,width:e,height:a}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+a],[t+e,s+a]]}}class lt extends dt{constructor(t,s){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=16,this.padding=10,this.attrHeight=16,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=t,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(t){if(!t)return;const{x:s,y:e,width:a,height:o,id:r,enName:n,cnName:l,type:c,bgC:d,bdC:h,quotePrimaryKey:g,physicalTables:p,manualChange:x}=t;U(s)&&(this.x=s),U(e)&&(this.y=e),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),U(a)&&(this.width=a),U(o)&&(this.height=o),c&&(this.type=c),d&&(this.bgColor=d),h&&(this.borderColor=h),ft(g)&&(this.quotePrimaryKey=g),ft(p)&&(this.physicalTables=p),ft(x)&&(this.manualChange=x)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t){const{x:s,y:e}=t,{x:a,y:o,width:r,height:n}=this,l=this.getImageLines({tl:{x:a,y:o},tr:{x:a+r,y:o},bl:{x:a,y:o+n},br:{x:a+r,y:o+n}});return!!(this.findCrossPoints(s,e,l)%2)}draw(t){this.analysisOptions(t),this.drawRect()}drawRect(){const{ctx:t,x:s,y:e,width:a,height:o,bgColor:r,borderColor:n}=this;t.save(),t.lineWidth=2.5,t.strokeStyle=n||"#000000",t.fillStyle=r||"#ffffff",t.drawRoundedRect(s,e,a,o,0,0,0,0,!!r,!0,!1,!1),t.restore()}calcBoundingBox(){const{x:t,y:s,width:e,height:a}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+a],[t+e,s+a]]}}const Oe=(i,t,s=0)=>{const{x:e,y:a}=i,o=s||0,r=s||0;for(let n=0;n<t.length-1;n++){const l=t[n],c=t[n+1],d=l.y-c.y,h=c.x-l.x,g=l.x*c.y-c.x*l.y;if(Math.abs(d*e+h*a+g)/Math.sqrt(d*d+h*h)<=o&&e>=Math.min(l.x,c.x)-o&&e<=Math.max(l.x,c.x)+o&&a>=Math.min(l.y,c.y)-r&&a<=Math.max(l.y,c.y)+r)return n}return!1};class I extends dt{constructor(t,s){super(),this.pos=[],this.lineWidth=1,this.strokeStyle="#000000",this.ctx=t,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(t){if(!t)return;const{pos:s,type:e,from:a,to:o,id:r,lineWidth:n,numLineTypes:l,strokeStyle:c}=t;r&&(this.id=r),a&&(this.from=a),o&&(this.to=o),s&&(this.pos=s),e&&(this.type=e),l&&(this.numLineTypes=l),n&&(this.lineWidth=n),c&&(this.strokeStyle=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}draw(t){this.analysisOptions(t),this.drawLine(),this.drawEnds(),this.drawNote()}containsPoint(t){const{pos:s}=this;return U(Oe(t,s,5))}getIndexInPos(t){return Oe(t,this.pos,5)}drawLine(){const{ctx:t,strokeStyle:s,lineWidth:e,type:a,pos:o}=this;t.save(),t.strokeStyle=s,t.lineWidth=e,a==="foreignKey"&&t.setLineDash([8,5]),o.forEach((r,n)=>{n===0?(t.beginPath(),t.moveTo(r.x,r.y)):t.lineTo(r.x,r.y)}),t.stroke(),t.restore()}drawEnds(){const{ctx:t,pos:s,strokeStyle:e,lineWidth:a,numLineTypes:o}=this,r=15,n=s.length||0;if(!(n<2)){if(t.save(),t.beginPath(),t.setLineDash([0,0]),t.strokeStyle=e,t.lineWidth=a,s[0].x===s[1].x){const l=s[1].y-s[0].y,c=Math.abs(l)<10?l<0?s[0].y-1:s[0].y+1:l<0?s[0].y-10:s[0].y+10;t.moveTo(s[0].x-r/2,c),t.lineTo(s[0].x+r/2,c)}else{const l=s[1].x-s[0].x,c=Math.abs(l)<10?l<0?s[0].x-1:s[0].x+1:l<0?s[0].x-10:s[0].x+10;t.moveTo(c,s[0].y-r/2),t.lineTo(c,s[0].y+r/2)}if(s[n-2].x===s[n-1].x){const l=s[n-1].y-s[n-2].y,c=Math.abs(l)<10?l<0?s[n-1].y+1:s[n-1].y-1:l<0?s[n-1].y+10:s[n-1].y-10;if(t.moveTo(s[n-1].x-r/2,c),t.lineTo(s[n-1].x+r/2,c),t.stroke(),[1,2].includes(o)&&(t.moveTo(s[n-1].x-r/2,s[n-1].y),t.lineTo(s[n-1].x,c),t.lineTo(s[n-1].x+r/2,s[n-1].y),t.stroke()),[1,4].includes(o)){t.beginPath();const d=s[n-1].x,h=l<0?c+r/2:c-r/2;t.arc(d,h,(r-2)/2,0,360,!1),t.fillStyle="#fff",t.fill(),t.stroke()}}else{const l=s[n-1].x-s[n-2].x,c=Math.abs(l)<10?l<0?s[n-1].x+1:s[n-1].x-1:l<0?s[n-1].x+10:s[n-1].x-10;if(t.moveTo(c,s[n-1].y-r/2),t.lineTo(c,s[n-1].y+r/2),t.stroke(),[1,2].includes(o)&&(t.moveTo(s[n-1].x,s[n-1].y-r/2),t.lineTo(c,s[n-1].y),t.lineTo(s[n-1].x,s[n-1].y+r/2),t.stroke()),[1,4].includes(o)){t.beginPath();const d=l<0?c+r/2:c-r/2,h=s[n-1].y;t.arc(d,h,(r-2)/2,0,360,!1),t.fillStyle="#fff",t.fill(),t.stroke()}}t.restore()}}drawNote(){const{ctx:t,pos:s,remark:e}=this;if(!e)return;const a=Math.floor(s.length/2)-1;let o,r,n;s[a].y===s[a+1].y?(n=!1,o=Math.abs(s[a+1].x-s[a].x)/2+Math.min(s[a+1].x,s[a].x),r=s[a].y-10):(n=!0,o=s[a].x+10,r=Math.abs(s[a+1].y-s[a].y)/2+Math.min(s[a+1].y,s[a].y)-t.measureText(e).width/2),t.textAlign="center",n?t.fillRowText(e,o,r,16,16):t.fillText(e,o,r)}calcBoundingBox(){const{pos:t}=this,s=[],e=[];for(let a=0;a<t.length;a++){const o=t[a];s.push(o.x),e.push(o.y)}this.boundingBox=[[Math.min(...s),Math.min(...e)],[Math.max(...s),Math.max(...e)]]}}const Ri=(i,t=-1/0,s=1/0)=>Math.max(Math.min(i,s),t);class _i{constructor(t){this.originData={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},this.originDataMap=new Map,this.update(t),this.mountAutoUpdate()}update(t){this.analysisOptions(t)}analysisOptions(t){const{data:s={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},context:e}=t;e&&(this.context=e),this.originData=s,this.initMap()}initMap(){const{originData:{nodeDataArray:t=[],linkDataArray:s=[],markDataArray:e=[],noteDataArray:a=[]},originDataMap:o}=this;o.clear();for(let r=0;r<t.length;r++){const n=t[r];o.set(n.key,n)}for(let r=0;r<s.length;r++){const n=s[r];o.set(n.key,n)}for(let r=0;r<e.length;r++){const n=e[r];o.set(n.key,n)}for(let r=0;r<a.length;r++){const n=a[r];o.set(n.key,n)}}mountAutoUpdate(){const{originDataMap:t,context:s}=this;s.on("node:move",e=>{const a=t.get(e.id);a.x=e.x,a.y=e.y,a.width=e.width,a.height=e.height}),s.on("node:resize",e=>{const a=t.get(e.id);a.x=e.x,a.y=e.y,a.width=e.width,a.height=e.height}),s.on("line:move",e=>{const a=t.get(e.id);a.pos=e.pos}),s.on("note:move",e=>{const a=t.get(e.id);a.x=e.x,a.y=e.y}),s.on("mark:move",e=>{const a=t.get(e.id);a.x=e.x,a.y=e.y,a.width=e.width,a.height=e.height}),s.on("mark:resize",e=>{const a=t.get(e.id);a.x=e.x,a.y=e.y,a.width=e.width,a.height=e.height})}unmountAutoUpdate(){const{context:t}=this;t.off()}freeVariable(){this.originData=null,this.originDataMap=null}destroy(){this.unmountAutoUpdate(),this.freeVariable()}}class Ot extends dt{constructor(t,s){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.borderColor="#0C64EB",this.textColor="#0C64EB",this.bgColor="#D0E2FF",this.borderWidth=1,this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,id:a,borderColor:o,textColor:r,bgColor:n,borderWidth:l,content:c}=t;U(s)&&(this.x=s),U(e)&&(this.y=e),a&&(this.id=a),o&&(this.borderColor=o),r&&(this.textColor=r),n&&(this.bgColor=n),U(l)&&(this.borderWidth=l),c&&(this.content=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(t){const{x:s,y:e}=t,{x:a,y:o,width:r,height:n}=this;return s>=a&&s<=a+r&&e>=o&&e<=o+n}draw(t){this.updateOptions(t);const{ctx:s,content:e,x:a,y:o,textColor:r}=this;s.save(),s.textBaseline="top",s.fillStyle=r,s.fillText(e,a,o),s.restore()}calcBoundingBox(){const{x:t,y:s,ctx:e,content:a}=this,o=e.measureText(a),r=this.width=o.width,n=this.height=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent;this.boundingBox=[[t,s],[t+r,s],[t,s+n],[t+r,s+n]]}}class Li extends dt{constructor(t,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=1,this.borderColor="blue",this.targetWidth=6,this.targetBgColor="#FFFFFF",this.targetBdColor="#B4B4B4",this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,width:a,height:o,targetBgColor:r,targetBdColor:n,bdC:l,lineWidth:c}=t;s&&(this.x=s),e&&(this.y=e),a&&(this.width=a),o&&(this.height=o),r&&(this.targetBgColor=r),n&&(this.targetBdColor=n),l&&(this.borderColor=l),c&&(this.lineWidth=c)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(){return!1}draw(t){this.updateOptions(t),this.drawBorder(),this.drawTargets()}drawBorder(){const{ctx:t,borderColor:s,lineWidth:e,x:a,y:o,width:r,height:n}=this;t.save(),t.lineWidth=e,t.strokeStyle=s,t.strokeRect(a,o,r,n),t.restore()}drawTargets(){const{ctx:t,targetBdColor:s,targetBgColor:e,targetWidth:a,x:o,y:r,width:n,height:l}=this,c=a/2,d=o-c,h=r-c;t.save(),t.strokeStyle=s,t.fillStyle=e,t.fillRect(d,h,a,a),t.fillRect(d,h+l/2,a,a),t.fillRect(d,h+l,a,a),t.fillRect(d+n/2,h,a,a),t.fillRect(d+n/2,h+l,a,a),t.fillRect(d+n,h,a,a),t.fillRect(d+n,h+l/2,a,a),t.fillRect(d+n,h+l,a,a),t.strokeRect(d,h,a,a),t.strokeRect(d,h+l/2,a,a),t.strokeRect(d,h+l,a,a),t.strokeRect(d+n/2,h,a,a),t.strokeRect(d+n/2,h+l,a,a),t.strokeRect(d+n,h,a,a),t.strokeRect(d+n,h+l/2,a,a),t.strokeRect(d+n,h+l,a,a),t.restore()}calcBoundingBox(){const{x:t,y:s,width:e,height:a}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+a],[t+e,s+a]]}}class Ei extends dt{constructor(t,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=2,this.borderColor="blue",this.ctx=t,this.updateOptions(s)}analysisOptions(t){if(!t)return;const{x:s=0,y:e=0,width:a,height:o,bdC:r,lineWidth:n}=t;s&&(this.x=s),e&&(this.y=e),a&&(this.width=a),o&&(this.height=o),r&&(this.borderColor=r),r&&(this.lineWidth=n)}updateOptions(t){this.analysisOptions(t),this.calcBoundingBox()}containsPoint(){return!1}draw(t){this.updateOptions(t),this.drawBorder()}drawBorder(){const{ctx:t,borderColor:s,lineWidth:e,x:a,y:o,width:r,height:n}=this;t.save(),t.lineWidth=e,t.strokeStyle=s,t.strokeRect(a,o,r,n),t.restore()}calcBoundingBox(){const{x:t,y:s,width:e,height:a}=this;this.boundingBox=[[t,s],[t+e,s],[t,s+a],[t+e,s+a]]}}var D=(i=>(i.None="",i.addNode="addNode",i.primaryKey="primaryKey",i.foreignKey="foreignKey",i.branchLine="branchLine",i.addMark="addMark",i.addNote="addNote",i.copy="copy",i))(D||{}),A=(i=>(i.NONE="",i.LT="LT",i.TM="TM",i.RT="RT",i.LM="LM",i.RM="RM",i.LB="LB",i.BM="BM",i.RB="RB",i))(A||{}),R=(i=>(i.default="default",i.none="none",i.wait="wait",i.progress="progress",i.crosshair="crosshair",i.cell="cell",i.text="text",i.move="move",i.colResize="col-resize",i.rowResize="row-resize",i.ewResize="ew-resize",i.nsResize="ns-resize",i.neswResize="nesw-resize",i.nwseResize="nwse-resize",i.copy="copy",i.help="help",i.grab="grab",i.grabbing="grabbing",i.pointer="pointer",i.notAllowed="not-allowed",i.zoomIn="zoom-in",i.zoomOut="zoom-out",i.contextMenu="context-menu",i))(R||{});const Ts=(i,t)=>{if(!(i instanceof Z||i instanceof lt))return!1;const{x:e,y:a,width:o,height:r}=i,n=e+o/2,l=a+r/2,c=e+o,d=a+r,h=5;let g=A.NONE;return Math.abs(e-t.x)<=h&&Math.abs(a-t.y)<=h?g=A.LT:Math.abs(n-t.x)<=h&&Math.abs(a-t.y)<=h?g=A.TM:Math.abs(c-t.x)<=h&&Math.abs(a-t.y)<=h?g=A.RT:Math.abs(e-t.x)<=h&&Math.abs(l-t.y)<=h?g=A.LM:Math.abs(c-t.x)<=h&&Math.abs(l-t.y)<=h?g=A.RM:Math.abs(e-t.x)<=h&&Math.abs(d-t.y)<=h?g=A.LB:Math.abs(n-t.x)<=h&&Math.abs(d-t.y)<=h?g=A.BM:Math.abs(c-t.x)<=h&&Math.abs(d-t.y)<=h&&(g=A.RB),g},$i=function(i,t){const s=()=>{const{eventObj:d}=this,h={x:t.x-d.targetOffsetX-d.target.x,y:t.y-d.targetOffsetY-d.target.y},g={x:d.target.x+h.x,y:d.target.y+h.y};this.markMap.get(d.target.id).updateOptions(g),this.emit("mark:move",this.markMap.get(d.target.id)),this.update()},e=()=>{const{eventObj:d}=this,h={x:t.x-d.targetOffsetX-d.target.x,y:t.y-d.targetOffsetY-d.target.y},g={x:d.target.x+h.x,y:d.target.y+h.y};this.noteMap.get(d.target.id).updateOptions(g),this.emit("note:move",d.target),this.update()},a=()=>{const{eventObj:d}=this,{x:h,y:g}=t;d.target.type==="mark"?this.resizeNode(h,g,d,null):this.resizeNode(h,g,d),this.update()},o=()=>{const{focusTarget:d,eventObj:h,nodeRelatedLineMap:g}=this,p={x:t.x-h.targetOffsetX-h.target.x,y:t.y-h.targetOffsetY-h.target.y};d.forEach(x=>{if(!(x instanceof Z))return;const y={x:x.x+p.x,y:x.y+p.y};g.has(x.id)&&[...g.get(x.id).from,...g.get(x.id).to].forEach(v=>{v.from===v.to?this.moveLineForSameNode(v,{target:x}):this.moveLineForNode(v,{target:x},y)}),this.nodeMap.get(x.id).updateOptions(y),this.emit("node:move",x)}),this.update()},r=()=>{const{eventObj:d}=this,h=d.target.getIndexInPos(d.lastEvLoc);d.targetLineStartPointIdx=h,d.lastEvLoc=t,h!==!1&&(this.moveLineForLine(d,t),this.update())};return{changeMouseCursor:()=>{const{editType:d,renderElements:h}=this,p={[D.addNode]:R.cell,[D.primaryKey]:R.crosshair,[D.foreignKey]:R.crosshair,[D.branchLine]:R.crosshair,[D.addMark]:R.cell,[D.addNote]:R.text,[D.copy]:R.copy}[d];if(p)return this.canvas.eventEl.style.cursor=p||R.default;let x=null,y=R.grab;for(let f=h.length-1;f>=0;f--){const v=h[f],w=v.containsPoint(t)||Ts(v,t);if(w){x=v,y=w===A.LT?R.nwseResize:w===A.TM?R.nsResize:w===A.RT?R.neswResize:w===A.LM||w===A.RM?R.ewResize:w===A.LB?R.neswResize:w===A.BM?R.nsResize:w===A.RB?R.nwseResize:R.move;break}}this.hoverTarget=x,this.canvas.eventEl.style.cursor=y,this.updateEventCanvas()},moveCanvas:()=>{this.canvas.setTranslate(i),this.canvas.clearEventCanvas();const d=this.canvas.getTranslate();this.emit("graph:move",d),this.update()},moveElement:()=>{const{eventObj:d}=this,h=!!d.targetDirection,g=d.target instanceof Z,p=d.target instanceof I,x=d.target instanceof lt,y=d.target instanceof Ot;if(h)return a();if(g)return o();if(p)return r();if(x)return s();if(y)return e()}}},Ai=function(i,t){const{x:s,y:e}=t;return{execTask:()=>{var c,d,h,g,p;const{editType:r,defaultWidth:n,defaultHeight:l}=this;switch(r){case D.copy:{const x={x:s-((d=(c=this.copyTarget)==null?void 0:c[0])==null?void 0:d.x),y:e-((g=(h=this.copyTarget)==null?void 0:h[0])==null?void 0:g.y)},y=this.copyTarget.filter(f=>!!f.attributes).map(f=>(f.x=f.x+x.x,f.y=f.y+x.y,f));(p=this.externalFn)==null||p.handlePaste(y),this.editType=D.None,this.canvas.eventEl.style.cursor=R.default,this.update();break}case D.addNode:{const x={x:s-n/2,y:e-l/2,width:n,height:l};this.externalFn.addNode(x),this.editType=D.None,this.canvas.eventEl.style.cursor=R.default,this.update();break}case D.addMark:{const x={key:this.createKey(),x:s,y:e,width:n,height:l,type:"mark"};this.externalFn.addMark(x),this.editType=D.None,this.canvas.eventEl.style.cursor=R.default,this.update();break}case D.addNote:{const x={key:this.createKey(),x:s,y:e,text:"",type:"note"};this.externalFn.addNote(x),this.editType=D.None,this.canvas.eventEl.style.cursor=R.default;break}}},setEventTarget:r=>{const{metaKey:n,ctrlKey:l}=r,{hoverTarget:c,focusTarget:d,eventObj:h}=this;if(!l&&!n&&d.clear(),this.canvas.eventEl.style.cursor=R.grabbing,!c)return;const g=Ts(c,t);h.target=c,c instanceof I?(d.clear(),h.lastEvLoc=t):(c instanceof Z||c instanceof Ot||c instanceof lt)&&(h.targetOffsetX=t.x-c.x,h.targetOffsetY=t.y-c.y,h.targetDirection=g||null),d.add(c),this.update()}}},Di=function(){return{resetMouseState:()=>{this.canvas.eventEl.style.cursor=R.default,this.eventObj={target:null,targetDirection:A.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}}}}};class zi extends Nr{constructor(t){super(),this.eventObj={target:null,targetDirection:A.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}},this.rightMenuConfig=[],this.chooseTargets=[],this.imgList={},this.editable=re.Edit,this.defaultWidth=100,this.defaultHeight=50,this.focusTarget=new Set,this.expandAttrs=[],this.analysisOptions(t),this.mountDataHandler(t),this.mountCanvas(),this.mountCanvasEvents(),this.mountPlugins(),Fr().then(()=>this.update())}analysisOptions(t){const{el:s,externalFn:e,editable:a,fontFamily:o,rightMenu:r,useRightMenu:n=!1,useAttrFocus:l=!1,useThumbnail:c=!1,useHistory:d=!0}=t;this.el=s,this.editable=a||re.Edit,this.fontFamily=o,this.rightMenuConfig=r,this.useRightMenu=n,this.useAttrFocus=l,this.useThumbnail=c,this.useHistory=d,this.externalFn=e}mountDataHandler(t){this.dataHandler=new _i({context:this,data:t.data})}destroy(){this.unmountPlugins(),this.unmountCanvasEvents(),this.canvas.destroy(),this.dataHandler.destroy()}mountCanvas(){this.canvas=new Mr({mountEl:this.el,backgroundType:Tr.Checker}),this.cacheCtx=this.canvas.cacheCtx}mountPlugins(){this.plugins=new Sr,this.useHistory&&this.plugins.use(st.History),this.useThumbnail&&this.plugins.use(st.Thumbnail,{mountEl:this.canvas.boxEl,mainCanvas:this.canvas}),this.useRightMenu&&this.plugins.use(st.RightMenu,this.el,this.rightMenuConfig)}unmountPlugins(){this.plugins.destroy()}mountCanvasEvents(){this._bindEventMousedown=this.onMouseDown.bind(this),this._bindEventMousemove=this.onMouseMove.bind(this),this._bindEventMouseup=this.onMouseUp.bind(this),this._bindEventResize=this.onResize.bind(this),this._bindEventWheel=this.onWheel.bind(this),this._bindEventContextmenu=this.onContextmenu.bind(this),this._bindEventUndo=this.onUndo.bind(this),this._bindEventRedo=this.onRedo.bind(this),this.canvas.on("canvas:resize",this._bindEventResize),this.canvas.on("canvas:wheel",this._bindEventWheel),this.canvas.on("canvas:mouseup",this._bindEventMouseup),this.canvas.on("canvas:mousedown",this._bindEventMousedown),this.canvas.on("canvas:mousemove",this._bindEventMousemove),this.canvas.on("canvas:contextmenu",this._bindEventContextmenu),this.canvas.on("canvas:undo",this._bindEventUndo),this.canvas.on("canvas:redo",this._bindEventRedo)}unmountCanvasEvents(){this.canvas.off("canvas:resize",this._bindEventResize),this.canvas.off("canvas:wheel",this._bindEventWheel),this.canvas.off("canvas:mouseup",this._bindEventMouseup),this.canvas.off("canvas:mousedown",this._bindEventMousedown),this.canvas.off("canvas:mousemove",this._bindEventMousemove),this.canvas.off("canvas:contextmenu",this._bindEventContextmenu),this.canvas.off("canvas:undo",this._bindEventUndo),this.canvas.off("canvas:redo",this._bindEventRedo)}onUndo(){const t=this.plugins.get(st.History).undo();t==null||t.reverse(),t||console.warn("撤无可撤")}onRedo(){const t=this.plugins.get(st.History).redo();t==null||t.reverse(),t||console.warn("恢无可恢")}onMouseUp(t,s){const{resetMouseState:e}=Di.call(this,t,s);e()}onMouseDown(t,s){const{editType:e}=this,{execTask:a,setEventTarget:o}=Ai.call(this,t,s);if(e)return a();o(t)}onMouseMove(t,s){const{canvas:e,eventObj:a}=this,{changeMouseCursor:o,moveCanvas:r,moveElement:n}=$i.call(this,t,s),l=!e.isMouseDown,c=e.isMouseDown&&!a.target,d=e.isMouseDown&&a.target;if(l)return o();if(c)return r();if(d){const h=[...this.focusTarget];for(let g=0;g<h.length;g++){const p=h[g],x={target:p,originValue:{}};if(p instanceof Z){const y=Ye(p,"x","y","width","height");x.originValue=Xe(y);const f=this.nodeRelatedLineMap.get(p.id);h.push(...f.from,...f.to)}if(p instanceof I){const y=Ye(p,"pos");x.originValue=Xe(y)}h[g]=x}return this.plugins.get(st.History).push(()=>{for(let g=0;g<h.length;g++){const{target:p,originValue:x}=h[g];p.updateOptions(x),p instanceof Z&&this.emit("node:resize",p),p instanceof I&&this.emit("line:move",p)}this.update()}),n()}}onContextmenu(t){if(!this.useRightMenu)return;const{clientX:s,clientY:e,view:{innerWidth:a,innerHeight:o}}=t;this.plugins.get(st.RightMenu).show({top:e,left:s,innerWidth:a,innerHeight:o}),this.emit("graph:contextmenu",t)}onWheel(t){const{deltaY:s,deltaX:e,ctrlKey:a}=t;if(Math.abs(s)>2||Math.abs(e)>2)if(a){const r=this.canvas.zoomRate,n=Math.floor(Ri(r*100+s,10,200));this.zoom(n)}else{const r=this.canvas.getTranslate();this.canvas.setTranslate({x:r.x-e,y:r.y-s}),this.update()}}onResize(){this.update()}initNodes(){const{dataHandler:{originData:{nodeDataArray:t}},nodeRelatedLineMap:s}=this;if(t!=null&&t.length)for(let e=0;e<t.length;e++){const a=t[e];let o=this.nodeMap.get(a.key);o||(o=new Z(this.canvas.cacheCtx,{id:a.key,enName:a.tableName,cnName:a.cnName,type:a.type,x:a.x,y:a.y,width:a.width,height:a.height,attributes:a.attributes,bdC:a.bdC,bgC:a.bgC,quotePrimaryKey:a.quotePrimaryKey,physicalTables:a.physicalTables}),this.nodeMap.set(a.key,o),s.has(a.key)||s.set(a.key,{from:new Set,to:new Set}))}}renderNodes(){const{nodeMap:t,dataHandler:{originData:s},renderElements:e}=this,a=s.nodeDataArray;for(let o=0;o<a.length;o++){const r=a[o],n=t.get(r.key);n.updateOptions(r),this.canvas.isVisible(n.boundingBox)&&(e.push(n),n.draw())}}renderLines(){const{lineMap:t,dataHandler:{originData:s},renderElements:e,nodeRelatedLineMap:a}=this,o=s.linkDataArray;for(let r=0;r<o.length;r++){const n=o[r];let l=t.get(n.key);l?l.updateOptions(n):(l=new I(this.canvas.cacheCtx,{pos:n.pos,type:n.type,from:n.from,to:n.to,id:n.key,numLineTypes:n.numLineTypes}),this.lineMap.set(n.key,l)),a.has(l.from)||a.set(l.from,{from:new Set,to:new Set}),a.has(l.to)||a.set(l.to,{from:new Set,to:new Set}),a.get(l.from).from.add(l),a.get(l.to).to.add(l),this.canvas.isVisible(l.boundingBox)&&(e.push(l),l.draw())}}renderNote(){const{dataHandler:{originData:{noteDataArray:t}},noteMap:s,renderElements:e}=this;for(let a=0;a<t.length;a++){const o=t[a];let r=s.get(o.key);r?r.updateOptions(o):(r=new Ot(this.canvas.cacheCtx,{id:o.key,content:o.text,textColor:o.color,x:o.x,y:o.y}),this.noteMap.set(o.key,r)),this.canvas.isVisible(r.boundingBox)&&(e.push(r),r.draw())}}update(t){this.renderElements=[],t&&(this.dataHandler.update({data:t}),this.lineMap=new Map,this.markMap=new Map,this.noteMap=new Map,this.nodeMap=new Map,this.nodeRelatedLineMap=new Map,this.focusTarget.clear(),this.initNodes()),this.canvas.clearCacheCanvas();const s=this.cacheCtx;s.font="15px "+this.fontFamily,s.save(),this.renderMarks(),this.renderLines(),this.renderNodes(),this.renderNote(),s.restore(),this.canvas.update(),this.updateEventCanvas(),this.updateThumbnail()}async updateThumbnail(){const{dataHandler:{originData:{nodeDataArray:t}}}=this,s=this.plugins.get(st.Thumbnail);if(!s)return!1;await Cr();const{width:e,height:a}=this.canvas.getRenderSize();let o=0,r=0,n=e,l=a;for(let c=0;c<t.length;c++){const d=t[c],{x:h,y:g,width:p,height:x}=d;h<o&&(o=h),g<r&&(r=g),h+p>n&&(n=h+p),g+x>l&&(l=g+x)}s.draw(o,r,n,l,c=>{for(let d=0;d<t.length;d++){const h=t[d],{x:g,y:p,width:x,height:y,bgC:f,bdC:v}=h;c.save(),c.fillStyle=f||"#fff",c.fillRect(g,p,x,y),c.strokeStyle=v||"#000",c.strokeRect(g,p,x,y),c.restore()}})}updateEventCanvas(){this.canvas.clearEventCanvas(),this.drawFocusElement(),this.drawHoverElement(),this.drawLockIcon()}drawFocusElement(){const{canvas:t,focusTarget:s}=this;s.forEach(e=>{e instanceof Z?new Li(t.eventCtx,{x:e.x,y:e.y,width:e.width,height:e.height}).draw():e instanceof I?new I(t.eventCtx,{...e,lineWidth:3,strokeStyle:"blue"}).draw():e instanceof lt&&new lt(t.eventCtx,{...e}).draw()})}drawHoverElement(){const{canvas:t,hoverTarget:s,focusTarget:e}=this,a=e.has(s);!s||a||(s instanceof Z?new Ei(t.eventCtx,{x:s.x,y:s.y,width:s.width,height:s.height}).draw():s instanceof I&&new I(t.eventCtx,{...s,lineWidth:2,strokeStyle:"blue"}).draw())}copy(){if(!this.focusTarget.size)return;const t=JSON.parse(JSON.stringify([...this.focusTarget])),{handleCopy:s}=this.externalFn;if(!((s==null?void 0:s(t,this.copyTarget))!==!1))return!1;this.copyTarget=t,this.editType=D.copy,this.el.style.cursor=R.copy}setEditable(t){this.editable=t,this.update()}drawLockIcon(){if(this.editable===re.Edit)return;const t=this.canvas.getTranslate();new Fi(this.canvas.eventCtx,{x:-t.x+this.canvas.width-40,y:-t.y+25}).draw()}_checkLinePos(t){var n,l;if(((n=t.pos)==null?void 0:n.length)<2||((l=t.pos)==null?void 0:l.length)>4)return this.mergeLines([t]);const e=this.nodeMap.get(t.from),a=this.nodeMap.get(t.to),o=this.getPointBelongBord(e,t.pos[0]),r=this.getPointBelongBord(a,t.pos[t.pos.length-1]);if(o&&r)return!0;this.mergeLines([t])}_drawFocus(t,s,e,a){const o=this.cacheCtx;o.save(),o.fillStyle="#fff",o.strokeStyle="#B4B4B4",o.shadowColor="#DADADA",o.shadowBlur=5,o.fillRect(t-3,s-3,6,6),o.fillRect(t+e/2-3,s-3,6,6),o.fillRect(t+e-3,s-3,6,6),o.fillRect(t-3,s+a/2-3,6,6),o.fillRect(t+e-3,s+a/2-3,6,6),o.fillRect(t-3,s+a-3,6,6),o.fillRect(t+e/2-3,s+a-3,6,6),o.fillRect(t+e-3,s+a-3,6,6),o.strokeRect(t-3,s-3,6,6),o.strokeRect(t+e/2-3,s-3,6,6),o.strokeRect(t+e-3,s-3,6,6),o.strokeRect(t-3,s+a/2-3,6,6),o.strokeRect(t+e-3,s+a/2-3,6,6),o.strokeRect(t-3,s+a-3,6,6),o.strokeRect(t+e/2-3,s+a-3,6,6),o.strokeRect(t+e-3,s+a-3,6,6),o.restore()}_drawTitle(t,s,e,a){const o=this.cacheCtx;o.save(),o.font="15px "+this.fontFamily,o.fillStyle="#000",o.textAlign="left",o.textBaseline="top",o.fillText(o.fittingString(t,s-14),e,a-24),o.restore()}_loadImg(t){const s=this,e=new Image;e.src=t.checkoutInfo.imgUrl,e.onload=function(){s.imgList[t.key]=e,s.update()}}_drawIcon(t,s,e,a,o){const r=this.cacheCtx;r.save(),r.beginPath(),r.strokeStyle=o,r.lineWidth=3,r.arc(e+s-6,a-18,9,0,2*Math.PI),r.clip(),r.drawImage(t,e+s-15,a-27,18,18),r.stroke(),r.restore()}renderMarks(){var e;const t=this,s=this.dataHandler.originData;(e=s==null?void 0:s.markDataArray)==null||e.forEach(a=>{const o=a.width,r=a.height,n=Number(a.x),l=Number(a.y),c=a;let d=this.markMap.get(c.key);d?d.updateOptions(c):(d=new lt(this.canvas.cacheCtx,{id:c.key,x:n,y:l,width:o,height:r}),this.markMap.set(c.key,d)),this.canvas.isVisible(d.boundingBox)&&(this.renderElements.push(d),d.draw()),t.focusTarget.has(d)&&t._drawFocus(n,l,o,r)})}zoom(t){const s=t/100;this.canvas.zoom(s),this.update(),this.emit("graph:zoom",this.canvas.zoomRate)}getPointBelongBord(t,s){if(s.x===t.x)return"L";if(s.x===t.x+t.width)return"R";if(s.y===t.y)return"T";if(s.y===t.y+t.height)return"B";console.error("getPointBelongBord未找到匹配边，detail:",t,JSON.parse(JSON.stringify(t)),JSON.parse(JSON.stringify(s)))}resizeNode(t,s,e,a=50){if(["exclusive","inclusive"].includes(e.target.type))return;const o=this,r={x:e.target.x,y:e.target.y,width:e.target.width,height:e.target.height};if(e.targetDirection==="LT"){const l=e.target.width+e.target.x-t,c=e.target.height+e.target.y-s;e.target.updateOptions({x:l<a?e.target.x:t,y:c<a?e.target.y:s,width:l<a?e.target.width:l,height:c<a?e.target.height:c}),n()}else if(e.targetDirection==="TM"){const l=e.target.height+e.target.y-s;e.target.updateOptions({y:l<a?e.target.y:s,height:l<a?e.target.height:l}),n()}else if(e.targetDirection==="RT"){const l=t-e.target.x,c=e.target.height+e.target.y-s;e.target.updateOptions({y:c<a?e.target.y:s,width:l<a?e.target.width:l,height:c<a?e.target.height:c}),n()}else if(e.targetDirection==="LM"){const l=e.target.width+e.target.x-t;e.target.updateOptions({x:l<a?e.target.x:t,width:l<a?e.target.width:l}),n()}else if(e.targetDirection==="RM"){const l=t-e.target.x;e.target.updateOptions({width:l<a?e.target.width:l}),n()}else if(e.targetDirection==="LB"){const l=e.target.width+e.target.x-t,c=s-e.target.y;e.target.updateOptions({x:l<a?e.target.x:t,width:l<a?e.target.width:l,height:c<a?e.target.height:c}),n()}else if(e.targetDirection==="BM"){const l=s-e.target.y;e.target.updateOptions({height:l<a?e.target.height:l}),n()}else if(e.targetDirection==="RB"){const l=t-e.target.x,c=s-e.target.y;e.target.updateOptions({width:l<a?e.target.width:l,height:c<a?e.target.height:c}),n()}e.target.type==="mark"?this.emit("mark:resize",e.target):this.emit("node:resize",e.target);function n(){if(!a)return;o.nodeMap.get(e.target.id).updateOptions(e.target);const l=o.nodeRelatedLineMap.get(e.target.id);[...l.from,...l.to].forEach(d=>{const h=d.from!==d.to,g=l.from.has(d)?0:d.pos.length-1;h&&c(d,g),h?o.moveLineForNode(d,e,e.target):o.moveLineForSameNode(d,e)});function c(d,h){d.pos[h].x===r.x?(d.pos[h].x=e.target.x,d.pos[h].y=d.pos[h].y<e.target.y?e.target.y+1:d.pos[h].y>e.target.y+e.target.height?e.target.y+e.target.height-1:d.pos[h].y):d.pos[h].x===r.x+r.width?(d.pos[h].x=e.target.x+e.target.width,d.pos[h].y=d.pos[h].y<e.target.y?e.target.y+1:d.pos[h].y>e.target.y+e.target.height?e.target.y+e.target.height-1:d.pos[h].y):d.pos[h].y===r.y?(d.pos[h].x=d.pos[h].x<=e.target.x?e.target.x+1:d.pos[h].x>=e.target.x+e.target.width?e.target.x+e.target.width-1:d.pos[h].x,d.pos[h].y=e.target.y):d.pos[h].y===r.y+r.height&&(d.pos[h].x=d.pos[h].x<=e.target.x?e.target.x+1:d.pos[h].x>=e.target.x+e.target.width?e.target.x+e.target.width-1:d.pos[h].x,d.pos[h].y=e.target.y+e.target.height)}}}getNodePosFromBoreder(t,s){let e={start:{x:null,y:null},end:{x:null,y:null}};switch(s){case"T":e={start:{x:t.x,y:t.y},end:{x:t.x+t.width,y:t.y}};break;case"B":e={start:{x:t.x,y:t.y+t.height},end:{x:t.x+t.width,y:t.y+t.height}};break;case"L":e={start:{x:t.x,y:t.y},end:{x:t.x,y:t.y+t.height}};break;case"R":e={start:{x:t.x+t.width,y:t.y},end:{x:t.x+t.width,y:t.y+t.height}};break}return e}moveLineForNode(t,s,e){const a=t.pos.length-1,o={x:e.x-s.target.x,y:e.y-s.target.y},r=this.nodeMap.get(t.from),n=this.nodeMap.get(t.to),l=this.getPointBelongBord(r,t.pos[0]),c=this.getPointBelongBord(n,t.pos[a]);(!l||!c)&&this.mergeLines([t]);const d=s.target.id===r.id;if(d?(t.pos[0].x=e.x+(t.pos[0].x-s.target.x),t.pos[0].y=e.y+(t.pos[0].y-s.target.y)):(t.pos[a].x=e.x+(t.pos[a].x-s.target.x),t.pos[a].y=e.y+(t.pos[a].y-s.target.y)),a===1)t.pos.splice(1,0,{x:t.pos[0].x,y:t.pos[0].y},{x:t.pos[0].x,y:t.pos[0].y});else if(a===2)if(l==="R"&&c==="B"){if(this.getNodePosFromBoreder(n,"B").start.y<t.pos[0].y)t.pos[1]={x:t.pos[2].x,y:t.pos[0].y};else{const h=this.getNodePosFromBoreder(r,"R").start.x<this.getNodePosFromBoreder(n,"L").start.x?this.getNodePosFromBoreder(n,"L").start.x:this.getNodePosFromBoreder(n,"R").start.x;t.pos[1]={x:h+(d?0:o.x),y:t.pos[0].y+o.y},t.pos.splice(2)}t.pos[2]&&t.pos[2].x<=t.pos[0].x&&(t.pos[0]={x:t.pos[0].x-1,y:r.y+(d?o.y:0)},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2))}else l==="B"&&c==="R"?(r.y+r.height<t.pos[1].y?t.pos[1]={x:t.pos[0].x,y:t.pos[2].y}:["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},t.pos[2]={x:n.x+Math.floor(n.width/2)+(d?0:o.x),y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(d?0:o.y)}):(t.pos[0]={x:r.x+(s.target.id===r.id?o.x:0),y:t.pos[1].y},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2)),t.pos[1].x<n.x+n.width&&(t.pos[1].y=n.y+(s.target.id===n.id?o.y:0),t.pos.splice(2))):l==="L"&&c==="B"?(this.getNodePosFromBoreder(n,"B").start.y<t.pos[0].y?t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}:(t.pos[1]={x:n.x+n.width+(s.target.id===n.id?o.x:0),y:t.pos[0].y},t.pos.splice(2)),t.pos[1].x>=s.target.x&&this.getNodePosFromBoreder(n,"B").start.y<this.getNodePosFromBoreder(r,"T").start.y&&(t.pos[0]={x:t.pos[0].x+(d?o.x:0)-1,y:r.y+(d?o.y:0)},t.pos[1]={x:t.pos[2].x,y:t.pos[2].y},t.pos.splice(2))):l==="B"&&c==="L"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x>n.x&&(t.pos[1].y=n.y+(s.target.id===n.id?o.y:0),t.pos.splice(2)),t.pos[1].y<t.pos[0].y&&(["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},t.pos[2]={x:n.x+Math.floor(n.width/2)+(d?0:o.x),y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(d?0:o.y)}):(t.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(s.target.id===r.id?o.x:0),t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?o.y:0),t.pos.splice(0,1)))):l==="R"&&c==="T"?(t.pos[1].x=t.pos[2].x,t.pos[1].y=t.pos[0].y,t.pos[1].x<t.pos[0].x&&(t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?o.y:0),t.pos.splice(0,1)),t.pos[2]&&t.pos[1].y>t.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(d?o.y:0)},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[2].x,y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:n.y+(d?0:o.y)}):(t.pos[1].x=n.x+(d?0:o.x),t.pos[1].y=n.y+(d?0:o.y),t.pos.splice(2)))):l==="T"&&c==="R"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x<t.pos[2].x&&(t.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(s.target.id===n.id?o.y:0),t.pos.splice(2)),t.pos[0].y<t.pos[1].y&&(t.pos[1].x=r.x+(s.target.id===r.id?o.x:0),t.pos[1].y=r.y+(s.target.id===r.id?o.y:0),t.pos.splice(0,1))):l==="T"&&c==="L"?(t.pos[1].x=t.pos[0].x,t.pos[1].y=t.pos[2].y,t.pos[1].x>t.pos[2].x&&(t.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(s.target.id===n.id?o.y:0),t.pos.splice(2)),t.pos[1].y>t.pos[0].y&&(t.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(s.target.id===r.id?o.x:0),t.pos.splice(0,1))):l==="L"&&c==="T"&&(t.pos[1].x=t.pos[2].x,t.pos[1].y=t.pos[0].y,t.pos[1].y>t.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(d?o.y:0)},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[2].x,y:t.pos[1].y},t.pos[3]={x:t.pos[2].x,y:n.y+(d?0:o.y)}):(t.pos[1].x=this.getNodePosFromBoreder(n,"R").start.x+(s.target.id===n.id?o.x:0),t.pos.splice(2))),t.pos[1].x>t.pos[0].x&&(t.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(s.target.id===r.id?o.y:0),t.pos.splice(0,1)));else if(a===3){const h=Math.floor(Math.abs(t.pos[0].x-t.pos[a].x)/2),g=Math.floor(Math.abs(t.pos[0].y-t.pos[a].y)/2);if(l==="B"&&c==="B")if(this.getNodePosFromBoreder(r,"T").start.y<this.getNodePosFromBoreder(n,"B").start.y)if(this.getNodePosFromBoreder(r,"B").start.y<t.pos[1].y){const p=t.pos[2].y-n.y-n.height+t.pos[3].y;t.pos[1]={x:t.pos[0].x,y:p},t.pos[2]={x:t.pos[3].x,y:p}}else{const p=r.x+r.width>t.pos[3].x?r.x:r.x+r.width,x=t.pos[2].y-n.y-n.height+t.pos[3].y;t.pos[0]={x:p+(s.target.id===r.id?o.x:0),y:x},t.pos[1]={x:t.pos[3].x,y:x},t.pos[2]={x:t.pos[3].x,y:t.pos[3].y},t.pos.splice(3)}else["exclusive","inclusive"].includes(r.type)?(t.pos[1]={x:t.pos[0].x,y:r.y+r.height+20},t.pos[2]={x:t.pos[3].x,y:t.pos[1].y}):(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y-r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+Math.floor((r.y-n.y-n.height)/2)},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+Math.floor((r.y-n.y-n.height)/2)});else if(l==="B"&&c==="T")r.y+r.height<n.y?(t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+g},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+g}):r.y+r.height>=n.y&&(["exclusive","inclusive"].includes(n.type)?(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y-r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-20},t.pos[2]={x:t.pos[3].x,y:t.pos[1].y}):(t.pos[1]={x:t.pos[0].x,y:n.y+n.height+20},t.pos[2]={x:t.pos[3].x,y:n.y+n.height+20},t.pos[3]={x:t.pos[3].x,y:t.pos[3].y+n.height}));else if(l==="T"&&c==="T")if(["exclusive","inclusive"].includes(r.type)||["exclusive","inclusive"].includes(n.type)){const p=t.pos[1].y+o.y>Math.min(r.y,n.y)-20?Math.min(r.y,n.y)-20:t.pos[1].y+o.y;t.pos[1]={x:t.pos[0].x,y:p},t.pos[2]={x:t.pos[3].x,y:p}}else t.pos[1].y<s.target.y?(t.pos[1]={x:t.pos[0].x,y:t.pos[1].y},t.pos[2]={x:t.pos[3].x,y:t.pos[2].y}):(t.pos[0]={x:t.pos[0].x,y:t.pos[0].y+r.height},t.pos[1]={x:t.pos[0].x,y:Math.max(r.y+r.height,n.y+n.height)+20},t.pos[2]={x:t.pos[3].x,y:Math.max(r.y+r.height,n.y+n.height)+20},t.pos[3]={x:t.pos[3].x,y:t.pos[3].y+n.height});else l==="T"&&c==="B"?r.y>n.y+n.height?(t.pos[1]={x:t.pos[0].x,y:t.pos[0].y-g},t.pos[2]={x:t.pos[3].x,y:t.pos[3].y+g}):r.y<=n.y+n.height&&(console.log("B->B"),t.pos[0]={x:t.pos[0].x,y:t.pos[0].y+r.height},t.pos[1]={x:t.pos[0].x,y:t.pos[0].y+20},t.pos[2]={x:t.pos[3].x,y:t.pos[0].y+20}):l==="L"&&c==="L"?(s.target.id===n.id?(t.pos[2]={x:e.x-(n.x-t.pos[2].x),y:t.pos[3].y},t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}):t.pos[1]={x:t.pos[2].x,y:t.pos[0].y},t.pos[1].x>r.x&&t.pos[1].x<r.x+r.width&&(t.pos.splice(0,1),++t.pos[0].x,t.pos[0].y=(t.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(s.target.id===r.id?o.y:0))):l==="L"&&c==="R"?r.x>n.x+n.width?(t.pos[1]={x:t.pos[0].x-h,y:t.pos[0].y},t.pos[2]={x:t.pos[1].x,y:t.pos[3].y}):(t.pos[0]={x:t.pos[0].x+r.width,y:t.pos[0].y},t.pos[1]={x:t.pos[0].x+20,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+20,y:t.pos[3].y}):l==="R"&&c==="L"?r.x+r.width<n.x?(t.pos[1]={x:t.pos[0].x+h,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+h,y:t.pos[3].y}):(t.pos[1]={x:t.pos[0].x+n.width+20,y:t.pos[0].y},t.pos[2]={x:t.pos[0].x+n.width+20,y:t.pos[3].y},t.pos[3]={x:t.pos[3].x+n.width,y:t.pos[3].y}):l==="R"&&c==="R"&&(s.target.id===n.id?(t.pos[2]={x:e.x-(n.x-t.pos[2].x),y:t.pos[3].y},t.pos[1]={x:t.pos[2].x,y:t.pos[0].y}):t.pos[1]={x:t.pos[2].x,y:t.pos[0].y},t.pos[1].x>r.x&&t.pos[1].x<r.x+r.width&&(t.pos.splice(0,1),--t.pos[0].x,t.pos[0].y=(t.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(s.target.id===r.id?o.y:0)))}this.emit("line:move",t)}moveLineForSameNode(t,s){const o=t.pos[1].x-t.pos[0].x,r=t.pos[2].y-t.pos[1].y;t.pos[0]={x:s.target.x+s.target.width,y:s.target.y+s.target.height-20},t.pos[4]={x:s.target.x+s.target.width-20,y:s.target.y+s.target.height},t.pos[1]={x:t.pos[0].x+o,y:t.pos[0].y},t.pos[2]={x:t.pos[1].x,y:t.pos[1].y+r},t.pos[3]={x:t.pos[4].x,y:t.pos[2].y},this.emit("line:move",t)}moveLineForLine(t,s){var d;const e=t.target.pos,a=e.length-1;let o,r,n=0;if((d=this.dataHandler.originData.nodeDataArray)==null||d.forEach(h=>{h.key===t.target.from&&(o=h,n++),h.key===t.target.to&&(r=h,n++)}),["exclusive","inclusive"].includes(o.type)){if(t.targetLineStartPointIdx===0&&e[t.targetLineStartPointIdx].x===e[t.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(o,"L").start.x>=s.x||this.getNodePosFromBoreder(o,"R").start.x<=s.x)||t.targetLineStartPointIdx===1&&e[t.targetLineStartPointIdx].y===e[t.targetLineStartPointIdx+1].y&&this.getNodePosFromBoreder(o,"B").start.y>=s.y||t.targetLineStartPointIdx===2&&e[t.targetLineStartPointIdx].x===e[t.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(r,"L").start.x>=s.x||this.getNodePosFromBoreder(r,"R").start.x<=s.x))return}else if(["exclusive","inclusive"].includes(r.type)&&(a===1||a===2&&t.targetLineStartPointIdx===1||a===2&&t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"T").start.y<s.y||a===3&&t.targetLineStartPointIdx===2||a===3&&t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(r,"T").start.y<s.y||a===3&&t.targetLineStartPointIdx===0&&(this.getNodePosFromBoreder(o,"L").start.x>=s.x||this.getNodePosFromBoreder(o,"R").start.x<=s.x)))return;a===1?e[0].y===e[1].y?(e[0].y=s.y,e[1].y=s.y,(this.getNodePosFromBoreder(o,"T").start.y>s.y||this.getNodePosFromBoreder(o,"B").start.y<s.y)&&(e[0].x=o.x+o.width/2,e.unshift({x:o.x+o.width/2,y:this.getNodePosFromBoreder(o,"T").start.y>s.y?o.y:o.y+o.height})),(this.getNodePosFromBoreder(r,"T").start.y>s.y||this.getNodePosFromBoreder(r,"B").start.y<s.y)&&(e[e.length-1].x=r.x+r.width/2,e.push({x:r.x+r.width/2,y:this.getNodePosFromBoreder(r,"T").start.y>s.y?r.y:r.y+r.height}))):(e[0].x=s.x,e[1].x=s.x,(this.getNodePosFromBoreder(o,"L").start.x>s.x||this.getNodePosFromBoreder(o,"R").start.x<s.x)&&(e[0].y=o.y+o.height/2,e.unshift({x:this.getNodePosFromBoreder(o,"R").start.x<s.x?o.x+o.width:o.x,y:o.y+o.height/2})),(this.getNodePosFromBoreder(r,"L").start.x>s.x||this.getNodePosFromBoreder(r,"R").start.x<s.x)&&(e[e.length-1].y=r.y+r.height/2,e.push({x:this.getNodePosFromBoreder(r,"R").start.x<s.x?r.x+r.width:r.x,y:r.y+r.height/2}))):a===2?e[t.targetLineStartPointIdx].y===e[t.targetLineStartPointIdx+1].y?(e[t.targetLineStartPointIdx].y=s.y,e[t.targetLineStartPointIdx+1].y=s.y,(this.getNodePosFromBoreder(o,"B").start.y<s.y||this.getNodePosFromBoreder(o,"T").start.y>s.y)&&t.targetLineStartPointIdx===0&&(e[t.targetLineStartPointIdx].x=o.x+o.width/2,e.unshift({x:o.x+o.width/2,y:this.getNodePosFromBoreder(o,"T").start.y>s.y?o.y:o.y+o.height})),(this.getNodePosFromBoreder(r,"B").start.y<s.y||this.getNodePosFromBoreder(r,"T").start.y>s.y)&&t.targetLineStartPointIdx===1&&(e[t.targetLineStartPointIdx+1].x=r.x+r.width/2,e.push({x:r.x+r.width/2,y:this.getNodePosFromBoreder(r,"T").start.y>s.y?r.y:r.y+r.height})),t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(o,"B").start.y>s.y&&this.getNodePosFromBoreder(o,"T").start.y<s.y&&(e.splice(0,1),e[0].x=r.x>o.x?o.x+o.width:o.x),t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"B").start.y>s.y&&this.getNodePosFromBoreder(r,"T").start.y<s.y&&(e.splice(e.length-1,1),e[e.length-1].x=o.x>r.x?r.x+r.width:r.x)):(e[t.targetLineStartPointIdx].x=s.x,e[t.targetLineStartPointIdx+1].x=s.x,(this.getNodePosFromBoreder(o,"L").start.x>s.x||this.getNodePosFromBoreder(o,"R").start.x<s.x)&&t.targetLineStartPointIdx===0&&(e[t.targetLineStartPointIdx].y=o.y+o.height/2,e.unshift({x:this.getNodePosFromBoreder(o,"L").start.x>s.x?o.x:o.x+o.width,y:o.y+o.height/2})),(this.getNodePosFromBoreder(r,"L").start.x>s.x||this.getNodePosFromBoreder(r,"R").start.x<s.x)&&t.targetLineStartPointIdx===1&&(e[t.targetLineStartPointIdx+1].y=r.y+r.height/2,e.push({x:this.getNodePosFromBoreder(r,"L").start.x>s.x?r.x:r.x+r.width,y:r.y+r.height/2})),t.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(o,"L").start.x<s.x&&this.getNodePosFromBoreder(o,"R").start.x>s.x&&(e.splice(0,1),e[0].y=r.y>o.y?o.y+o.height:o.y),t.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"L").start.x<s.x&&this.getNodePosFromBoreder(r,"R").start.x>s.x&&(e.splice(e.length-1,1),e[e.length-1].y=o.y>r.y?r.y+r.height:r.y)):a===3&&(e[t.targetLineStartPointIdx].y===e[t.targetLineStartPointIdx+1].y?(e[t.targetLineStartPointIdx].y=s.y,e[t.targetLineStartPointIdx+1].y=s.y,t.targetLineStartPointIdx===0?l(e)?e[0].y<this.getNodePosFromBoreder(o,"T").start.y?(e[0]={x:this.getNodePosFromBoreder(o,"T").start.x+o.width/2,y:o.y},e[1]={x:e[0].x,y:s.y},s.y<this.getNodePosFromBoreder(r,"T").start.y||s.y>this.getNodePosFromBoreder(r,"B").start.y?(e[2]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:s.y},e[3]={x:e[2].x,y:s.y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y}):(e[2]={x:e[1].x<this.getNodePosFromBoreder(r,"R").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:s.y},e.splice(3))):e[0].y>this.getNodePosFromBoreder(o,"B").start.y&&(e[0]={x:this.getNodePosFromBoreder(o,"T").start.x+o.width/2,y:this.getNodePosFromBoreder(o,"B").start.y},e[1]={x:e[0].x,y:s.y},s.y<this.getNodePosFromBoreder(r,"T").start.y||s.y>this.getNodePosFromBoreder(r,"B").start.y?(e[2]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:s.y},e[3]={x:e[2].x,y:s.y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y}):(e[2]={x:e[1].x<this.getNodePosFromBoreder(r,"R").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:s.y},e.splice(3))):s.y<this.getNodePosFromBoreder(o,"T").start.y?(e[0].y=this.getNodePosFromBoreder(o,"T").start.y,e[1].y=this.getNodePosFromBoreder(o,"T").start.y):s.y>this.getNodePosFromBoreder(o,"B").start.y&&(e[0].y=this.getNodePosFromBoreder(o,"B").start.y,e[1].y=this.getNodePosFromBoreder(o,"B").start.y):t.targetLineStartPointIdx===e.length-2?l(e)?e[3].y<this.getNodePosFromBoreder(r,"T").start.y?(e[3]={x:this.getNodePosFromBoreder(r,"T").start.x+r.width/2,y:r.y},e[2]={x:e[3].x,y:s.y},s.y<this.getNodePosFromBoreder(o,"T").start.y||s.y>this.getNodePosFromBoreder(o,"B").start.y?(e[1]={x:this.getNodePosFromBoreder(o,"L").start.x+o.width/2,y:s.y},e[0]={x:e[1].x,y:s.y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y}):(e[1]={x:e[2].x>this.getNodePosFromBoreder(o,"R").start.x?this.getNodePosFromBoreder(o,"R").start.x:this.getNodePosFromBoreder(o,"L").start.x,y:s.y},e.splice(0,1))):e[3].y>this.getNodePosFromBoreder(r,"B").start.y&&(e[3]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:this.getNodePosFromBoreder(r,"B").start.y},e[2]={x:e[3].x,y:s.y},s.y<this.getNodePosFromBoreder(o,"T").start.y||s.y>this.getNodePosFromBoreder(o,"B").start.y?(e[1]={x:this.getNodePosFromBoreder(o,"L").start.x+o.width/2,y:s.y},e[0]={x:e[1].x,y:s.y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y}):(e[1]={x:e[2].x>this.getNodePosFromBoreder(o,"R").start.x?this.getNodePosFromBoreder(o,"R").start.x:this.getNodePosFromBoreder(o,"L").start.x,y:s.y},e.splice(0,1))):s.y<this.getNodePosFromBoreder(r,"T").start.y?(e[2].y=this.getNodePosFromBoreder(r,"T").start.y,e[3].y=this.getNodePosFromBoreder(r,"T").start.y):s.y>this.getNodePosFromBoreder(r,"B").start.y&&(e[2].y=this.getNodePosFromBoreder(r,"B").start.y,e[3].y=this.getNodePosFromBoreder(r,"B").start.y):(s.y>this.getNodePosFromBoreder(o,"T").start.y&&s.y<this.getNodePosFromBoreder(o,"B").start.y&&(e.splice(0,1),e[0].x=e[1].x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x),s.y>this.getNodePosFromBoreder(r,"T").start.y&&s.y<this.getNodePosFromBoreder(r,"B").start.y&&(e[e.length-2].x=e[e.length-3].x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,e.splice(e.length-1)))):(e[t.targetLineStartPointIdx].x=s.x,e[t.targetLineStartPointIdx+1].x=s.x,t.targetLineStartPointIdx===0?c(e)?e[0].x<this.getNodePosFromBoreder(o,"L").start.x?(e[0]={x:this.getNodePosFromBoreder(o,"L").start.x,y:this.getNodePosFromBoreder(o,"L").start.y+o.height/2},e[1]={x:s.x,y:e[0].y},s.x<this.getNodePosFromBoreder(r,"L").start.x||s.x>this.getNodePosFromBoreder(r,"R").start.x?(e[2]={x:s.x,y:this.getNodePosFromBoreder(r,"T").start.y+r.height/2},e[3]={x:s.x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:e[2].y}):(e[2]={x:s.x,y:e[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y},e.splice(3))):e[0].x>this.getNodePosFromBoreder(o,"R").start.x&&(e[0]={x:this.getNodePosFromBoreder(o,"R").start.x,y:this.getNodePosFromBoreder(o,"R").start.y+o.height/2},e[1]={x:s.x,y:e[0].y},s.x<this.getNodePosFromBoreder(r,"L").start.x||s.x>this.getNodePosFromBoreder(r,"R").start.x?(e[2]={x:s.x,y:this.getNodePosFromBoreder(r,"T").start.y+r.height/2},e[3]={x:s.x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:e[2].y}):(e[2]={x:s.x,y:e[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y},e.splice(3))):s.x<this.getNodePosFromBoreder(o,"L").start.x?(e[0].x=this.getNodePosFromBoreder(o,"L").start.x+1,e[1].x=this.getNodePosFromBoreder(o,"L").start.x+1):s.x>this.getNodePosFromBoreder(o,"R").start.x&&(e[0].x=this.getNodePosFromBoreder(o,"R").start.x-1,e[1].x=this.getNodePosFromBoreder(o,"R").start.x-1):t.targetLineStartPointIdx===e.length-2?c(e)?e[3].x<this.getNodePosFromBoreder(r,"L").start.x?(e[3]={x:this.getNodePosFromBoreder(r,"L").start.x,y:this.getNodePosFromBoreder(r,"L").start.y+r.height/2},e[2]={x:s.x,y:e[3].y},s.x<this.getNodePosFromBoreder(o,"L").start.x||s.x>this.getNodePosFromBoreder(o,"R").start.x?(e[1]={x:s.x,y:this.getNodePosFromBoreder(o,"T").start.y+o.height/2},e[0]={x:s.x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:e[1].y}):(e[1]={x:s.x,y:e[2].y>this.getNodePosFromBoreder(o,"B").start.y?this.getNodePosFromBoreder(o,"B").start.y:this.getNodePosFromBoreder(o,"T").start.y},e.splice(0,1))):e[3].x>this.getNodePosFromBoreder(r,"R").start.x&&(e[3]={x:this.getNodePosFromBoreder(r,"R").start.x,y:this.getNodePosFromBoreder(r,"R").start.y+r.height/2},e[2]={x:s.x,y:e[3].y},s.x<this.getNodePosFromBoreder(o,"L").start.x||s.x>this.getNodePosFromBoreder(o,"R").start.x?(e[1]={x:s.x,y:this.getNodePosFromBoreder(o,"T").start.y+o.height/2},e[0]={x:s.x<this.getNodePosFromBoreder(o,"L").start.x?this.getNodePosFromBoreder(o,"L").start.x:this.getNodePosFromBoreder(o,"R").start.x,y:e[1].y}):(e[1]={x:s.x,y:e[2].y>this.getNodePosFromBoreder(o,"B").start.y?this.getNodePosFromBoreder(o,"B").start.y:this.getNodePosFromBoreder(o,"T").start.y},e.splice(0,1))):s.x<this.getNodePosFromBoreder(r,"L").start.x?(e[2].x=this.getNodePosFromBoreder(r,"L").start.x+1,e[3].x=this.getNodePosFromBoreder(r,"L").start.x+1):s.x>this.getNodePosFromBoreder(r,"R").start.x&&(e[2].x=this.getNodePosFromBoreder(r,"R").start.x-1,e[3].x=this.getNodePosFromBoreder(r,"R").start.x-1):(s.x>this.getNodePosFromBoreder(o,"L").start.x&&s.x<this.getNodePosFromBoreder(o,"R").start.x&&(e.splice(0,1),e[0].y=e[1].y<this.getNodePosFromBoreder(o,"T").start.y?this.getNodePosFromBoreder(o,"T").start.y:this.getNodePosFromBoreder(o,"B").start.y),s.x>this.getNodePosFromBoreder(r,"L").start.x&&s.x<this.getNodePosFromBoreder(r,"R").start.x&&(e[e.length-2].y=e[e.length-3].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y,e.splice(e.length-1)))),e.length===4&&e[1].x===e[2].x&&e[1].y===e[2].y&&e.splice(1,2));function l(h){let g=0;for(let p=0,x=h.length-1;p<x;p++)g+=Math.abs(h[p].x-h[p+1].x);return g===Math.abs(h[0].x-h[h.length-1].x)}function c(h){let g=0;for(let p=0,x=h.length-1;p<x;p++)g+=Math.abs(h[p].y-h[p+1].y);return g===Math.abs(h[0].y-h[h.length-1].y)}this.emit("line:move",t.target)}addNode(){this.editType=D.addNote}packNodeInfo(t,s){const{x:e,y:a}=this.transLoc(s);return Object.assign(t,{x:e,y:a+24,width:50,height:50})}getOverlapNode(){const t=this.dataHandler.originData;for(let s=0,e=t.nodeDataArray.length;s<e;s++){const a=Number(t.nodeDataArray[s].width)||100,o=Number(t.nodeDataArray[s].height)||50,r=Number(t.nodeDataArray[s].x),n=Number(t.nodeDataArray[s].y);if(r>r&&r<a+r&&n>n&&n<o+n)return t.nodeDataArray[s]}}transLoc(t){const s=this.canvas.getTranslate(),e=this.canvas.zoomRate,a=Math.floor((t.x+s.x)/e),o=Math.floor((t.y+s.y)/e);return{x:a,y:o}}addLine(t){this.editType=t}addMark(){this.editType=D.addMark}addNote(){this.editType=D.addNote}addRemark(t=""){var s;(s=this.focusTarget)==null||s.forEach(e=>{e.remark=t}),this.update()}changeColor(t,s){var e;(e=this.focusTarget)==null||e.forEach(a=>{a instanceof Z?s!=="color"?a[s]=t:console.log("修改的是属性文字颜色, 逻辑待完善."):a instanceof lt?a[s]=t:a instanceof Ot&&(a.textColor=t)}),this.update()}createLineInfo(t,s){const e=this.chooseTargets,a=this.getNodePosFromBoreder(e[0],"L"),o=this.getNodePosFromBoreder(e[1],"L"),r=[];if(e[0].key===e[1].key)r[0]={x:e[0].x+e[0].width,y:e[0].y+e[0].height-20},r[1]={x:e[0].x+e[0].width+20,y:e[0].y+e[0].height-20},r[2]={x:e[0].x+e[0].width+20,y:e[0].y+e[0].height+20},r[3]={x:e[0].x+e[0].width-20,y:e[0].y+e[0].height+20},r[4]={x:e[0].x+e[0].width-20,y:e[0].y+e[0].height};else if(["exclusive","inclusive"].includes(e[0].type))a.end.y<o.start.y?(r[0]={x:a.end.x+Math.floor(e[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((o.start.y-a.end.y)/2)},r[2]={x:o.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:o.start.y}):(r[0]={x:a.end.x+Math.floor(e[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:Math.max(a.end.y,o.start.y)+20},r[2]={x:o.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:o.end.y});else if(["exclusive","inclusive"].includes(e[1].type))a.end.y<o.start.y?(r[0]={x:a.end.x+Math.floor(e[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((o.start.y-a.end.y)/2)},r[2]={x:o.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:o.start.y}):(r[0]={x:a.end.x+Math.floor(e[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:Math.min(a.end.y,o.start.y)-20},r[2]={x:o.start.x+Math.floor(e[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:o.start.y});else if(this.getNodePosFromBoreder(e[0],"R").start.x<this.getNodePosFromBoreder(e[1],"L").start.x)if((o.start.y-a.end.y)*(o.end.y-a.start.y)<0){const n=Math.max(a.start.y,o.start.y)+Math.abs(Math.floor((Math.min(a.end.y,o.end.y)-Math.max(a.start.y,o.start.y))/2));r[0]={x:this.getNodePosFromBoreder(e[0],"R").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x,y:n}}else a.start.y>o.end.y?(r[0]={x:a.start.x+Math.floor(e[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:o.start.y+Math.floor(e[1].height/2)},r[2]={x:o.start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(e[0],"R").start.x,y:a.start.y+Math.floor(e[0].height/2)},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x+Math.floor(e[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(e[1],"L").start.y});else if(this.getNodePosFromBoreder(e[0],"L").start.x>this.getNodePosFromBoreder(e[1],"R").start.x)if((o.start.y-a.end.y)*(o.end.y-a.start.y)<0){const n=Math.max(a.start.y,o.start.y)+Math.abs(Math.floor((Math.min(a.end.y,o.end.y)-Math.max(a.start.y,o.start.y))/2));r[0]={x:this.getNodePosFromBoreder(e[0],"L").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(e[1],"R").start.x,y:n}}else a.start.y>o.end.y?(r[0]={x:a.start.x+Math.floor(e[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:o.start.y+Math.floor(e[1].height/2)},r[2]={x:this.getNodePosFromBoreder(e[1],"R").start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(e[0],"L").start.x,y:a.start.y+Math.floor(e[0].height/2)},r[1]={x:this.getNodePosFromBoreder(e[1],"L").start.x+Math.floor(e[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(e[1],"L").start.y});else if(a.start.y>o.end.y){const n=Math.max(a.start.x,o.start.x),l=Math.min(this.getNodePosFromBoreder(e[0],"R").start.x,this.getNodePosFromBoreder(e[1],"R").start.x),c=n+Math.floor((l-n)/2);r[0]={x:c,y:a.start.y},r[1]={x:c,y:o.end.y}}else{const n=Math.max(a.start.x,o.start.x),l=Math.min(this.getNodePosFromBoreder(e[0],"R").start.x,this.getNodePosFromBoreder(e[1],"R").start.x),c=n+Math.floor((l-n)/2);r[0]={x:c,y:a.end.y},r[1]={x:c,y:o.start.y}}if(r.length){const n={};return s?(s.pos=r,Object.assign(n,s)):Object.assign(n,{key:this.createKey(),from:e[0].key,to:e[1].key,pos:r,type:t}),n}else console.error("createLine方法错误：未生成对应关键点坐标")}createLine(t,s){const e=this.createLineInfo(t,s);["primaryKey","foreignKey"].includes(t)&&this.externalFn.addLine(e)}mergeLine(t,s){const e=this.createLineInfo(t,s);return Object.assign(s,e)}createBranchLine(){const t=[].concat(this.chooseTargets),s=this.getNodePosFromBoreder(t[0],"L"),e=this.getNodePosFromBoreder(t[1],"L");if(["inclusive","exclusive"].includes(t[1].type))this.$message({message:"未将对象引用设置到对象的实例。",type:"error",showClose:!0});else if(["inclusive","exclusive"].includes(t[0].type)){const a=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({fromFilter:a})}else{const a=s.end.y+50<e.start.y?{x:s.start.x+Math.floor(t[0].width/2)-20,y:s.end.y+Math.floor((e.start.y-s.end.y)/2)-10}:{x:e.start.x+Math.floor(t[1].width/2)-20,y:Math.min(s.start.y,e.start.y)-50},o={key:this.createKey(),x:a.x,y:a.y,width:40,height:20,type:"exclusive",fromKey:t[0].key};this.chooseTargets=[t[0],o];const r=this.createLine("toFilter");this.chooseTargets=[o,t[1]];const n=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({filter:o,toFilter:r,fromFilter:n}),this.chooseTargets=[]}}getNodeWithKey(t){for(const s of this.dataHandler.originData.nodeDataArray)if(s.key===t)return s}createLines(t){for(const s of t){const e=this.getNodeWithKey(s.from),a=this.getNodeWithKey(s.to);e&&a&&(this.chooseTargets=[e,a],this.createLine(s.type,s))}this.chooseTargets=[],this.update()}mergeLines(t){const s=[];for(const e of t){const a=this.getNodeWithKey(e.from),o=this.getNodeWithKey(e.to);a&&o&&(this.chooseTargets=[a,o],s.push(this.mergeLine(e.type,e)))}return this.chooseTargets=[],s}createKey(){return+new Date+""+Math.floor(Math.random()*1e5)}$message(t){this.externalFn.$message&&this.externalFn.$message(t)}}const j={nodeDataArray:[{key:"q000",x:100,y:100,width:100,height:100,bgC:"#FF8080",bdC:"red",tableName:"Entity1",physicalTables:!0,quotePrimaryKey:!0,attributes:[{attrName:"attr1",id:"1",primaryKey:!0,foreignKey:!0,type:"INT",icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"L",bdC:"green"}]},{attrName:"attr2",id:"2",type:"DATE",primaryKey:!0},{attrName:"属性名3",id:"3",primaryKey:!0,type:"char",children:[{attrName:"属性名3-1",id:"3-1",primaryKey:!0,foreignKey:!0,children:[{attrName:"属性名3-1-1",primaryKey:!0,foreignKey:!0,children:[{attrName:"属性名3-1-1-1",primaryKey:!0,foreignKey:!0}],icons:[{text:"A",bdC:"green"}]}]},{attrName:"属性名3-2",primaryKey:!0,foreignKey:!0},{attrName:"属性名3-3",primaryKey:!0,foreignKey:!0}]},{attrName:"attr4",primaryKey:!1,foreignKey:!0,icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"标"}]},{attrName:"attr5",primaryKey:!1},{attrName:"attr6",primaryKey:!1,icons:[{text:"A",bdC:"green"}]}],checkoutInfo:{operator:1,imgUrl:"http://himg.bdimg.com/sys/portrait/item/2610e8b5b0e5a4b1e69ca8e69893fc0b.jpg"}},{key:"q111",x:400,y:100,width:50,height:100,bgC:"#8080FF",tableName:"表2",quotePrimaryKey:!0,attributes:[{attrName:"属性名1",primaryKey:!0,foreignKey:!1},{attrName:"属性名2",primaryKey:!0},{attrName:"属性名3",primaryKey:!0}],checkoutInfo:{operator:2,imgUrl:"http://himg.bdimg.com/sys/portrait/item/2610e8b5b0e5a4b1e69ca8e69893fc0b.jpg"}},{key:"q222",x:100,y:400,width:50,height:100,bgC:"#FFFF80",tableName:"Entity3",attributes:[{attrName:"属性名1",primaryKey:!1,foreignKey:!1},{attrName:"属性名2",primaryKey:!1}],checkoutInfo:{operator:2,imgUrl:"http://himg.bdimg.com/sys/portrait/item/2610e8b5b0e5a4b1e69ca8e69893fc0b.jpg"}},{key:"q444",x:100,y:250,width:40,height:20,type:"inclusive"},{key:"q555",x:705,y:92,width:260,height:100,tableName:"Entity inside",type:"inside"},{key:"q666",x:600,y:280,width:260,height:100,tableName:"Entity discribe",type:"explain",attributes:[{label:"说明",content:"表示与银行有利害关系，以及银行希望保留其信息"},{label:"示例",content:"个人 组织 客户"},{label:"所属部门",content:"数据研究院"},{label:"负责人",content:"杨中旭"}]},{key:"test",x:2999,y:2999,width:260,height:100,tableName:"Entity away",type:"inside"},{key:"test",x:-2999,y:-2999,width:260,height:100,tableName:"Entity away",type:"inside"}],linkDataArray:[{key:1,from:"q000",to:"q111",pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1,remark:"主键"},{key:3,from:"q111",to:"q222",pos:[{x:400,y:150},{x:300,y:150},{x:300,y:450},{x:150,y:450}],type:"foreignKey",numLineTypes:1},{key:4,from:"q000",to:"q444",pos:[{x:120,y:200},{x:120,y:250}],type:"toFilter",numLineTypes:2},{key:5,from:"q444",to:"q222",pos:[{x:120,y:270},{x:120,y:400}],type:"fromFilter",numLineTypes:4},{key:6,from:"q555",to:"q666",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"}],markDataArray:[],noteDataArray:[{key:"157837643603536658",x:525,y:408,text:"啦啦啦啦啦111",type:"note",color:"#0000ff"}]},Ki=[[{icon:"",value:"copy",label:"复制"},{icon:"",value:"extend-copy",label:"继承复制"},{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"parent",label:"显示父级关联",children:[{icon:"",value:"level-2",label:"显示2级"},{icon:"",value:"level-all",label:"显示全部"},{icon:"",value:"level-1",label:"显示1级"}]}],[{icon:"",value:"auto-size",label:"自适应大小"},{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}],{icon:"",value:"delete",label:"删除"}],V=""+new URL("symbol-defs-a40770d4.svg",import.meta.url).href,Hi={class:"erg"},Vi={class:"toobar"},Wi=["xlink:href"],Ui=["xlink:href"],qi=["xlink:href"],Xi=["xlink:href"],Yi=["xlink:href"],Gi=["xlink:href"],Ji=["xlink:href"],ki=["xlink:href"],Zi=["xlink:href"],Qi=["xlink:href"],Oi=["xlink:href"],ji=["xlink:href"],Ii=N("div",{id:"canvas",class:"canvas"},null,-1),Ss=q({__name:"Erg",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(i){const t=i;let s;const e=ss({scale:100,bgC:"",bdC:"",color:"",lock:"edit"}),a=()=>{s=new zi({el:document.getElementById("canvas"),fontFamily:"-apple-system, Noto Sans, Helvetica Neue, Helvetica, Nimbus Sans L, Arial, Liberation Sans, PingFang SC, Hiragino Sans GB, Noto Sans CJK SC, Source Han Sans SC, Source Han Sans CN, Microsoft YaHei, Wenquanyi Micro Hei, WenQuanYi Zen Hei, ST Heiti, SimHei, WenQuanYi Zen Hei Sharp, sans-serif",editable:e.lock,externalFn:{addNode:function(y){const f=prompt("请输入表名：");f&&(y.tableName=f,j.nodeDataArray.push(y))},delNode:function(y){console.log(y)},addLine:function(y){console.log("添加线了"),y.numLineTypes=2,j.linkDataArray.push(y)},delLine:function(y){console.log(y)},addFilter:function(y){y.filter&&j.nodeDataArray.push(y.filter),y.toFilter&&j.linkDataArray.push(y.toFilter),j.linkDataArray.push(y.fromFilter)},delFilter:function(y){console.log(y)},addMark:function(y){j.markDataArray.push(y),markMap.set(y.key,y)},delMark:function(y){console.log(y)},addNote:function(y){const f=prompt("请输入备注内容：");f&&(y.text=f,j.noteDataArray.push(y))},delNote:function(y){console.log(y)},$message:function(y){console.log(y.message)},handleCopy(y,f){return console.log(y,f),!0},handlePaste(y){j.nodeDataArray.push(...y)},handleContextMenu(y,f){switch(console.log("菜单点击触发：",y,f),f){case"remark":const v=prompt("请输入备注内容：");if(!v)return;s.addRemark(v);break}}},useThumbnail:t.useThumbnail,useAttrFocus:t.useAttrFocus,useRightMenu:t.useRightMenu,rightMenu:Ki}),s.update(j)},o=()=>{s.destroy()},r=y=>{e.scale>20&&(e.scale+=y),s.zoom(e.scale)},n=()=>{s.addNode({key:s.createKey(),attributes:[]})},l=y=>{s.addLine(y)},c=()=>{s.addMark()},d=()=>{s.addNote()},h=(y,f)=>{s.changeColor(y,f)},g=()=>{e.lock=e.lock===1?2:1,s.setEditable(e.lock)},p=()=>{s.copy()},x=()=>{const y=[{from:0,to:1,pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1}];s.createLines(y)};return bt(()=>{a()}),Ys(o),(y,f)=>(b(),T("div",Hi,[N("div",Vi,[_(u(H),{size:"small",circle:"",title:"新增实体",onClick:n},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-add`},null,8,Wi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"复制",onClick:p},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#copy`},null,8,Ui)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"新增主键",onClick:f[0]||(f[0]=v=>l("primaryKey"))},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-primary`},null,8,qi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"新增非主键",onClick:f[1]||(f[1]=v=>l("foreignKey"))},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-foreign`},null,8,Xi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"新增过滤器",onClick:f[2]||(f[2]=v=>l("branchLine"))},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-subtype`},null,8,Yi)]))]),_:1}),_(u(ne),{direction:"vertical"}),_(u(H),{size:"small",circle:"",title:"新增框",onClick:c},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-square`},null,8,Gi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"新增备注",onClick:d},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#icon-tool-text`},null,8,Ji)]))]),_:1}),_(u(ne),{direction:"vertical"}),e.lock===1?(b(),z(u(H),{key:0,size:"small",circle:"",title:"只读",onClick:g},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#lock`},null,8,ki)]))]),_:1})):(b(),z(u(H),{key:1,size:"small",circle:"",title:"编辑",onClick:g},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#unlock`},null,8,Zi)]))]),_:1})),_(u(H),{size:"small",circle:"",title:"批量创建连线",onClick:x},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#copy`},null,8,Qi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"放大",onClick:f[3]||(f[3]=v=>r(20))},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#plus-circle`},null,8,Oi)]))]),_:1}),_(u(H),{size:"small",circle:"",title:"缩小",onClick:f[4]||(f[4]=v=>r(-20))},{icon:$(()=>[(b(),T("svg",null,[N("use",{"xlink:href":`${u(V)}#minus-circle`},null,8,ji)]))]),_:1}),_(u(ne),{direction:"vertical"}),_(u(ie),{modelValue:e.bgc,"onUpdate:modelValue":f[5]||(f[5]=v=>e.bgc=v),size:"small",onChange:f[6]||(f[6]=v=>h(v,"bgC"))},null,8,["modelValue"]),_(u(ie),{modelValue:e.bdC,"onUpdate:modelValue":f[7]||(f[7]=v=>e.bdC=v),size:"small",onChange:f[8]||(f[8]=v=>h(v,"bdC"))},null,8,["modelValue"]),_(u(ie),{modelValue:e.color,"onUpdate:modelValue":f[9]||(f[9]=v=>e.color=v),size:"small",onChange:f[10]||(f[10]=v=>h(v,"color"))},null,8,["modelValue"])]),Ii]))}});Ss.__docgenInfo={exportName:"default",displayName:"Erg",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/Erg.vue"]};const rn={title:"Example/Erg",component:Ss,argTypes:{editable:{control:"select",options:[1,2,3]}},args:{useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:!0}},Ut={};var je,Ie,ts;Ut.parameters={...Ut.parameters,docs:{...(je=Ut.parameters)==null?void 0:je.docs,source:{originalSource:"{}",...(ts=(Ie=Ut.parameters)==null?void 0:Ie.docs)==null?void 0:ts.source}}};const on=["Primary"];export{Ut as Primary,on as __namedExportsOrder,rn as default};
//# sourceMappingURL=Erg.stories-26362852.js.map
