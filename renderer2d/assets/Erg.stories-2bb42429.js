import{i as Ie,a as T,g as Ue,o as ge,w as _o,b as Gt,d as Ko,e as Er,f as X,j as Lr,N as rs,k as M,l as st,m as U,u as Rr,n as Vo,s as pt,p as Y,t as Rs,q as De,v as mt,x as w,y as E,z as _,F as Ae,A as P,B as h,C as ee,D as N,E as K,G as $,H as je,I as is,J as A,K as We,L as ye,M as re,O as kt,P as rt,T as cs,Q as Qt,r as vt,R as $r,S as js,U as Kt,V as Be,W as eo,h as Ar,X as Wo,Y as Dr,Z as hs,_ as Hs,$ as zt,a0 as Ps,a1 as Ze,a2 as zr,a3 as Hr}from"./vue.esm-bundler-98d418b2.js";import{i as qt,g as Or,e as _r,a as ko,b as Kr,c as Vr,S as ps,d as Os,f as qo,h as Uo,o as Wr,k as Yo,r as kr,j as Xo,s as qr,l as Ur,U as to,m as _s,n as Ks,p as fs,q as Go,t as Yr,u as Xr,v as Gr,w as Vs,x as Qo,y as Qr,z as Zo,A as Zr,B as Jr,C as it,D as Ir,E as jr,F as yt,G as Jo,H as ae,I as so,J as ei,K as ti,L as si,M as et,N as oi,O as Oe,P as Io,Q as ze,R as Ut,T as ri,V as ue,W as Ws,X as jo,Y as ks,Z as er,_ as ii,$ as ai,a0 as ni,a1 as as,a2 as gs,a3 as Yt,a4 as ke,a5 as tr,a6 as ce,a7 as sr,a8 as Ft,a9 as li,aa as di,ab as $s,ac as Tt,ad as qs,ae as Zt,af as As,ag as fe,ah as or,ai as rr,aj as ui,ak as ir,al as ci,am as hi,an as pi,ao as fi,ap as oo,aq as yi,ar as gi,as as ro,at as Ds,au as mi,av as Ee,aw as vi,ax as io,ay as ao,az as xi,aA as bi,aB as wi,aC as Bi,aD as Si,aE as Ci,aF as ar,aG as xt,aH as Te,aI as Pt,aJ as Ti,aK as Ms,aL as Pi,aM as Mi,aN as ns,aO as ft,aP as tt,aQ as Mt,aR as Vt,aS as He,aT as Ni,aU as Fi,aV as Ns,aW as Ei,aX as Li,aY as Ri,aZ as Ne,a_ as jt,a$ as $i}from"./tween.esm-78b512d0.js";const Us=s=>{let e,o;return s.type==="touchend"?(o=s.changedTouches[0].clientY,e=s.changedTouches[0].clientX):s.type.startsWith("touch")?(o=s.touches[0].clientY,e=s.touches[0].clientX):(o=s.clientY,e=s.clientX),{clientX:e,clientY:o}};function Ai(s){return s}var no=Object.create,Di=function(){function s(){}return function(e){if(!qt(e))return{};if(no)return no(e);s.prototype=e;var o=new s;return s.prototype=void 0,o}}();const zi=Di;function Hi(s,e,o){switch(o.length){case 0:return s.call(e);case 1:return s.call(e,o[0]);case 2:return s.call(e,o[0],o[1]);case 3:return s.call(e,o[0],o[1],o[2])}return s.apply(e,o)}function Oi(s,e){var o=-1,t=s.length;for(e||(e=Array(t));++o<t;)e[o]=s[o];return e}var _i=800,Ki=16,Vi=Date.now;function Wi(s){var e=0,o=0;return function(){var t=Vi(),a=Ki-(t-o);if(o=t,a>0){if(++e>=_i)return arguments[0]}else e=0;return s.apply(void 0,arguments)}}function ki(s){return function(){return s}}var qi=function(){try{var s=Or(Object,"defineProperty");return s({},"",{}),s}catch{}}();const ys=qi;var Ui=ys?function(s,e){return ys(s,"toString",{configurable:!0,enumerable:!1,value:ki(e),writable:!0})}:Ai;const Yi=Ui;var Xi=Wi(Yi);const Gi=Xi;function Qi(s,e){for(var o=-1,t=s==null?0:s.length;++o<t&&e(s[o],o,s)!==!1;);return s}function nr(s,e,o){e=="__proto__"&&ys?ys(s,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):s[e]=o}var Zi=Object.prototype,Ji=Zi.hasOwnProperty;function Ys(s,e,o){var t=s[e];(!(Ji.call(s,e)&&_r(t,o))||o===void 0&&!(e in s))&&nr(s,e,o)}function ms(s,e,o,t){var a=!o;o||(o={});for(var i=-1,r=e.length;++i<r;){var n=e[i],l=t?t(o[n],s[n],n,o,s):void 0;l===void 0&&(l=s[n]),a?nr(o,n,l):Ys(o,n,l)}return o}var lo=Math.max;function Ii(s,e,o){return e=lo(e===void 0?s.length-1:e,0),function(){for(var t=arguments,a=-1,i=lo(t.length-e,0),r=Array(i);++a<i;)r[a]=t[e+a];a=-1;for(var n=Array(e+1);++a<e;)n[a]=t[a];return n[e]=o(r),Hi(s,this,n)}}function ji(s){var e=[];if(s!=null)for(var o in Object(s))e.push(o);return e}var ea=Object.prototype,ta=ea.hasOwnProperty;function sa(s){if(!qt(s))return ji(s);var e=ko(s),o=[];for(var t in s)t=="constructor"&&(e||!ta.call(s,t))||o.push(t);return o}function Xs(s){return Kr(s)?Vr(s,!0):sa(s)}var uo=ps?ps.isConcatSpreadable:void 0;function oa(s){return Os(s)||qo(s)||!!(uo&&s&&s[uo])}function lr(s,e,o,t,a){var i=-1,r=s.length;for(o||(o=oa),a||(a=[]);++i<r;){var n=s[i];e>0&&o(n)?e>1?lr(n,e-1,o,t,a):Uo(a,n):t||(a[a.length]=n)}return a}function ra(s){var e=s==null?0:s.length;return e?lr(s,1):[]}function ia(s){return Gi(Ii(s,void 0,ra),s+"")}var aa=Wr(Object.getPrototypeOf,Object);const dr=aa;function na(s,e){return s&&ms(e,Yo(e),s)}function la(s,e){return s&&ms(e,Xs(e),s)}var ur=typeof exports=="object"&&exports&&!exports.nodeType&&exports,co=ur&&typeof module=="object"&&module&&!module.nodeType&&module,da=co&&co.exports===ur,ho=da?kr.Buffer:void 0,po=ho?ho.allocUnsafe:void 0;function ua(s,e){if(e)return s.slice();var o=s.length,t=po?po(o):new s.constructor(o);return s.copy(t),t}function ca(s,e){return ms(s,Xo(s),e)}var ha=Object.getOwnPropertySymbols,pa=ha?function(s){for(var e=[];s;)Uo(e,Xo(s)),s=dr(s);return e}:qr;const cr=pa;function fa(s,e){return ms(s,cr(s),e)}function ya(s){return Ur(s,Xs,cr)}var ga=Object.prototype,ma=ga.hasOwnProperty;function va(s){var e=s.length,o=new s.constructor(e);return e&&typeof s[0]=="string"&&ma.call(s,"index")&&(o.index=s.index,o.input=s.input),o}function Gs(s){var e=new s.constructor(s.byteLength);return new to(e).set(new to(s)),e}function xa(s,e){var o=e?Gs(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.byteLength)}var ba=/\w*$/;function wa(s){var e=new s.constructor(s.source,ba.exec(s));return e.lastIndex=s.lastIndex,e}var fo=ps?ps.prototype:void 0,yo=fo?fo.valueOf:void 0;function Ba(s){return yo?Object(yo.call(s)):{}}function Sa(s,e){var o=e?Gs(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.length)}var Ca="[object Boolean]",Ta="[object Date]",Pa="[object Map]",Ma="[object Number]",Na="[object RegExp]",Fa="[object Set]",Ea="[object String]",La="[object Symbol]",Ra="[object ArrayBuffer]",$a="[object DataView]",Aa="[object Float32Array]",Da="[object Float64Array]",za="[object Int8Array]",Ha="[object Int16Array]",Oa="[object Int32Array]",_a="[object Uint8Array]",Ka="[object Uint8ClampedArray]",Va="[object Uint16Array]",Wa="[object Uint32Array]";function ka(s,e,o){var t=s.constructor;switch(e){case Ra:return Gs(s);case Ca:case Ta:return new t(+s);case $a:return xa(s,o);case Aa:case Da:case za:case Ha:case Oa:case _a:case Ka:case Va:case Wa:return Sa(s,o);case Pa:return new t;case Ma:case Ea:return new t(s);case Na:return wa(s);case Fa:return new t;case La:return Ba(s)}}function qa(s){return typeof s.constructor=="function"&&!ko(s)?zi(dr(s)):{}}var Ua="[object Map]";function Ya(s){return _s(s)&&Ks(s)==Ua}var go=fs&&fs.isMap,Xa=go?Go(go):Ya;const Ga=Xa;var Qa="[object Set]";function Za(s){return _s(s)&&Ks(s)==Qa}var mo=fs&&fs.isSet,Ja=mo?Go(mo):Za;const Ia=Ja;var ja=1,en=2,tn=4,hr="[object Arguments]",sn="[object Array]",on="[object Boolean]",rn="[object Date]",an="[object Error]",pr="[object Function]",nn="[object GeneratorFunction]",ln="[object Map]",dn="[object Number]",fr="[object Object]",un="[object RegExp]",cn="[object Set]",hn="[object String]",pn="[object Symbol]",fn="[object WeakMap]",yn="[object ArrayBuffer]",gn="[object DataView]",mn="[object Float32Array]",vn="[object Float64Array]",xn="[object Int8Array]",bn="[object Int16Array]",wn="[object Int32Array]",Bn="[object Uint8Array]",Sn="[object Uint8ClampedArray]",Cn="[object Uint16Array]",Tn="[object Uint32Array]",Q={};Q[hr]=Q[sn]=Q[yn]=Q[gn]=Q[on]=Q[rn]=Q[mn]=Q[vn]=Q[xn]=Q[bn]=Q[wn]=Q[ln]=Q[dn]=Q[fr]=Q[un]=Q[cn]=Q[hn]=Q[pn]=Q[Bn]=Q[Sn]=Q[Cn]=Q[Tn]=!0;Q[an]=Q[pr]=Q[fn]=!1;function ls(s,e,o,t,a,i){var r,n=e&ja,l=e&en,u=e&tn;if(o&&(r=a?o(s,t,a,i):o(s)),r!==void 0)return r;if(!qt(s))return s;var c=Os(s);if(c){if(r=va(s),!n)return Oi(s,r)}else{var d=Ks(s),f=d==pr||d==nn;if(Yr(s))return ua(s,n);if(d==fr||d==hr||f&&!a){if(r=l||f?{}:qa(s),!n)return l?fa(s,la(r,s)):ca(s,na(r,s))}else{if(!Q[d])return a?s:{};r=ka(s,d,n)}}i||(i=new Xr);var y=i.get(s);if(y)return y;i.set(s,r),Ia(s)?s.forEach(function(x){r.add(ls(x,e,o,x,s,i))}):Ga(s)&&s.forEach(function(x,C){r.set(C,ls(x,e,o,C,s,i))});var v=u?l?ya:Gr:l?Xs:Yo,p=c?void 0:v(s);return Qi(p||s,function(x,C){p&&(C=x,x=s[C]),Ys(r,C,ls(x,e,o,C,s,i))}),r}var Pn=1,Mn=4;function vo(s){return ls(s,Pn|Mn)}function Nn(s,e){return s!=null&&e in Object(s)}function Fn(s,e,o){e=Vs(e,s);for(var t=-1,a=e.length,i=!1;++t<a;){var r=Qo(e[t]);if(!(i=s!=null&&o(s,r)))break;s=s[r]}return i||++t!=a?i:(a=s==null?0:s.length,!!a&&Qr(a)&&Zo(r,a)&&(Os(s)||qo(s)))}function En(s,e){return s!=null&&Fn(s,e,Nn)}var Ln="[object Boolean]";function _t(s){return s===!0||s===!1||_s(s)&&Zr(s)==Ln}function Rn(s,e,o,t){if(!qt(s))return s;e=Vs(e,s);for(var a=-1,i=e.length,r=i-1,n=s;n!=null&&++a<i;){var l=Qo(e[a]),u=o;if(l==="__proto__"||l==="constructor"||l==="prototype")return s;if(a!=r){var c=n[l];u=t?t(c,l,n):void 0,u===void 0&&(u=qt(c)?c:Zo(e[a+1])?[]:{})}Ys(n,l,u),n=n[l]}return s}function $n(s,e,o){for(var t=-1,a=e.length,i={};++t<a;){var r=e[t],n=Jr(s,r);o(n,r)&&Rn(i,Vs(r,s),n)}return i}function An(s,e){return $n(s,e,function(o,t){return En(s,t)})}var Dn=ia(function(s,e){return s==null?{}:An(s,e)});const xo=Dn;let es;const zn=s=>{var e;if(!it)return 0;if(es!==void 0)return es;const o=document.createElement("div");o.className=`${s}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const t=o.offsetWidth;o.style.overflow="scroll";const a=document.createElement("div");a.style.width="100%",o.appendChild(a);const i=a.offsetWidth;return(e=o.parentNode)==null||e.removeChild(o),es=t-i,es};function Hn(s,e){if(!it)return;if(!e){s.scrollTop=0;return}const o=[];let t=e.offsetParent;for(;t!==null&&s!==t&&s.contains(t);)o.push(t),t=t.offsetParent;const a=e.offsetTop+o.reduce((l,u)=>l+u.offsetTop,0),i=a+e.offsetHeight,r=s.scrollTop,n=r+s.clientHeight;a<r?s.scrollTop=a:i>n&&(s.scrollTop=i-s.clientHeight)}const On=(...s)=>e=>{s.forEach(o=>{Ie(o)?o(e):o.value=e})},_n=s=>Ir[s||"default"];var ds=(s=>(s[s.TEXT=1]="TEXT",s[s.CLASS=2]="CLASS",s[s.STYLE=4]="STYLE",s[s.PROPS=8]="PROPS",s[s.FULL_PROPS=16]="FULL_PROPS",s[s.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",s[s.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",s[s.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",s[s.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",s[s.NEED_PATCH=512]="NEED_PATCH",s[s.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",s[s.HOISTED=-1]="HOISTED",s[s.BAIL=-2]="BAIL",s))(ds||{});const Kn=["class","style"],Vn=/^on[A-Z]/,Wn=(s={})=>{const{excludeListeners:e=!1,excludeKeys:o}=s,t=T(()=>((o==null?void 0:o.value)||[]).concat(Kn)),a=Ue();return a?T(()=>{var i;return jr(Object.entries((i=a.proxy)==null?void 0:i.$attrs).filter(([r])=>!t.value.includes(r)&&!(e&&Vn.test(r))))}):T(()=>({}))},kn=(s,e,o)=>{let t={offsetX:0,offsetY:0};const a=n=>{const l=n.clientX,u=n.clientY,{offsetX:c,offsetY:d}=t,f=s.value.getBoundingClientRect(),y=f.left,v=f.top,p=f.width,x=f.height,C=document.documentElement.clientWidth,m=document.documentElement.clientHeight,B=-y+c,k=-v+d,G=C-y-p+c,D=m-v-x+d,F=q=>{const R=Math.min(Math.max(c+q.clientX-l,B),G),V=Math.min(Math.max(d+q.clientY-u,k),D);t={offsetX:R,offsetY:V},s.value.style.transform=`translate(${yt(R)}, ${yt(V)})`},H=()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",F),document.addEventListener("mouseup",H)},i=()=>{e.value&&s.value&&e.value.addEventListener("mousedown",a)},r=()=>{e.value&&s.value&&e.value.removeEventListener("mousedown",a)};ge(()=>{_o(()=>{o.value?i():r()})}),Gt(()=>{r()})},qn=s=>({focus:()=>{var e,o;(o=(e=s.value)==null?void 0:e.focus)==null||o.call(e)}}),Un=(s,e={})=>{Ko(s)||Jo("[useLockscreen]","You need to pass a ref param to this function");const o=e.ns||ae("popup"),t=Er(()=>o.bm("parent","hidden"));if(!it||so(document.body,t.value))return;let a=0,i=!1,r="0";const n=()=>{setTimeout(()=>{si(document==null?void 0:document.body,t.value),i&&document&&(document.body.style.width=r)},200)};X(s,l=>{if(!l){n();return}i=!so(document.body,t.value),i&&(r=document.body.style.width),a=zn(o.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=ei(document.body,"overflowY");a>0&&(u||c==="scroll")&&i&&(document.body.style.width=`calc(100% - ${a}px)`),ti(document.body,t.value)}),Lr(()=>n())},yr=s=>{if(!s)return{onClick:rs,onMousedown:rs,onMouseup:rs};let e=!1,o=!1;return{onClick:r=>{e&&o&&s(r),e=o=!1},onMousedown:r=>{e=r.target===r.currentTarget},onMouseup:r=>{o=r.target===r.currentTarget}}};function Yn(s){const e=M();function o(){if(s.value==null)return;const{selectionStart:a,selectionEnd:i,value:r}=s.value;if(a==null||i==null)return;const n=r.slice(0,Math.max(0,a)),l=r.slice(Math.max(0,i));e.value={selectionStart:a,selectionEnd:i,value:r,beforeTxt:n,afterTxt:l}}function t(){if(s.value==null||e.value==null)return;const{value:a}=s.value,{beforeTxt:i,afterTxt:r,selectionStart:n}=e.value;if(i==null||r==null||n==null)return;let l=a.length;if(a.endsWith(r))l=a.length-r.length;else if(a.startsWith(i))l=i.length;else{const u=i[n-1],c=a.indexOf(u,n-1);c!==-1&&(l=c+1)}s.value.setSelectionRange(l,l)}return[o,t]}let Fe;const Xn=`
  height:0 !important;
  visibility:hidden !important;
  ${oi()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Gn=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Qn(s){const e=window.getComputedStyle(s),o=e.getPropertyValue("box-sizing"),t=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),a=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:Gn.map(r=>`${r}:${e.getPropertyValue(r)}`).join(";"),paddingSize:t,borderSize:a,boxSizing:o}}function bo(s,e=1,o){var t;Fe||(Fe=document.createElement("textarea"),document.body.appendChild(Fe));const{paddingSize:a,borderSize:i,boxSizing:r,contextStyle:n}=Qn(s);Fe.setAttribute("style",`${n};${Xn}`),Fe.value=s.value||s.placeholder||"";let l=Fe.scrollHeight;const u={};r==="border-box"?l=l+i:r==="content-box"&&(l=l-a),Fe.value="";const c=Fe.scrollHeight-a;if(et(e)){let d=c*e;r==="border-box"&&(d=d+a+i),l=Math.max(d,l),u.minHeight=`${d}px`}if(et(o)){let d=c*o;r==="border-box"&&(d=d+a+i),l=Math.min(d,l)}return u.height=`${l}px`,(t=Fe.parentNode)==null||t.removeChild(Fe),Fe=void 0,u}const Zn=Oe({id:{type:String,default:void 0},size:Io,disabled:Boolean,modelValue:{type:ze([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:ze([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Ut},prefixIcon:{type:Ut},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:ze([Object,Array,String]),default:()=>ri({})}}),Jn={[ue]:s=>st(s),input:s=>st(s),change:s=>st(s),focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,clear:()=>!0,mouseleave:s=>s instanceof MouseEvent,mouseenter:s=>s instanceof MouseEvent,keydown:s=>s instanceof Event,compositionstart:s=>s instanceof CompositionEvent,compositionupdate:s=>s instanceof CompositionEvent,compositionend:s=>s instanceof CompositionEvent},In=["role"],jn=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],el=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],tl=U({name:"ElInput",inheritAttrs:!1}),sl=U({...tl,props:Zn,emits:Jn,setup(s,{expose:e,emit:o}){const t=s,a=Rr(),i=Vo(),r=T(()=>{const S={};return t.containerRole==="combobox"&&(S["aria-haspopup"]=a["aria-haspopup"],S["aria-owns"]=a["aria-owns"],S["aria-expanded"]=a["aria-expanded"]),S}),n=T(()=>[t.type==="textarea"?x.b():p.b(),p.m(y.value),p.is("disabled",v.value),p.is("exceed",ve.value),{[p.b("group")]:i.prepend||i.append,[p.bm("group","append")]:i.append,[p.bm("group","prepend")]:i.prepend,[p.m("prefix")]:i.prefix||t.prefixIcon,[p.m("suffix")]:i.suffix||t.suffixIcon||t.clearable||t.showPassword,[p.bm("suffix","password-clear")]:he.value&&Le.value},a.class]),l=T(()=>[p.e("wrapper"),p.is("focus",B.value)]),u=Wn({excludeKeys:T(()=>Object.keys(r.value))}),{form:c,formItem:d}=Ws(),{inputId:f}=jo(t,{formItemContext:d}),y=ks(),v=er(),p=ae("input"),x=ae("textarea"),C=pt(),m=pt(),B=M(!1),k=M(!1),G=M(!1),D=M(!1),F=M(),H=pt(t.inputStyle),q=T(()=>C.value||m.value),R=T(()=>{var S;return(S=c==null?void 0:c.statusIcon)!=null?S:!1}),V=T(()=>(d==null?void 0:d.validateState)||""),j=T(()=>V.value&&ii[V.value]),me=T(()=>D.value?ai:ni),J=T(()=>[a.style,t.inputStyle]),ne=T(()=>[t.inputStyle,H.value,{resize:t.resize}]),I=T(()=>as(t.modelValue)?"":String(t.modelValue)),he=T(()=>t.clearable&&!v.value&&!t.readonly&&!!I.value&&(B.value||k.value)),Le=T(()=>t.showPassword&&!v.value&&!t.readonly&&!!I.value&&(!!I.value||B.value)),z=T(()=>t.showWordLimit&&!!u.value.maxlength&&(t.type==="text"||t.type==="textarea")&&!v.value&&!t.readonly&&!t.showPassword),te=T(()=>I.value.length),ve=T(()=>!!z.value&&te.value>Number(u.value.maxlength)),Ye=T(()=>!!i.suffix||!!t.suffixIcon||he.value||t.showPassword||z.value||!!V.value&&R.value),[Xe,Et]=Yn(C);gs(m,S=>{if(Lt(),!z.value||t.resize!=="both")return;const W=S[0],{width:pe}=W.contentRect;F.value={right:`calc(100% - ${pe+15+6}px)`}});const _e=()=>{const{type:S,autosize:W}=t;if(!(!it||S!=="textarea"||!m.value))if(W){const pe=kt(W)?W.minRows:void 0,Qe=kt(W)?W.maxRows:void 0,ut=bo(m.value,pe,Qe);H.value={overflowY:"hidden",...ut},Y(()=>{m.value.offsetHeight,H.value=ut})}else H.value={minHeight:bo(m.value).minHeight}},Lt=(S=>{let W=!1;return()=>{var pe;if(W||!t.autosize)return;((pe=m.value)==null?void 0:pe.offsetParent)===null||(S(),W=!0)}})(_e),xe=()=>{const S=q.value;!S||S.value===I.value||(S.value=I.value)},Re=async S=>{Xe();let{value:W}=S.target;if(t.formatter&&(W=t.parser?t.parser(W):W,W=t.formatter(W)),!G.value){if(W===I.value){xe();return}o(ue,W),o("input",W),await Y(),xe(),Et()}},bt=S=>{o("change",S.target.value)},at=S=>{o("compositionstart",S),G.value=!0},Ge=S=>{var W;o("compositionupdate",S);const pe=(W=S.target)==null?void 0:W.value,Qe=pe[pe.length-1]||"";G.value=!sr(Qe)},nt=S=>{o("compositionend",S),G.value&&(G.value=!1,Re(S))},lt=()=>{D.value=!D.value,Pe()},Pe=async()=>{var S;await Y(),(S=q.value)==null||S.focus()},Rt=()=>{var S;return(S=q.value)==null?void 0:S.blur()},wt=S=>{B.value=!0,o("focus",S)},Bt=S=>{var W;B.value=!1,o("blur",S),t.validateEvent&&((W=d==null?void 0:d.validate)==null||W.call(d,"blur").catch(pe=>Yt()))},dt=S=>{k.value=!1,o("mouseleave",S)},$t=S=>{k.value=!0,o("mouseenter",S)},St=S=>{o("keydown",S)},At=()=>{var S;(S=q.value)==null||S.select()},Me=()=>{o(ue,""),o("change",""),o("clear"),o("input","")};return X(()=>t.modelValue,()=>{var S;Y(()=>_e()),t.validateEvent&&((S=d==null?void 0:d.validate)==null||S.call(d,"change").catch(W=>Yt()))}),X(I,()=>xe()),X(()=>t.type,async()=>{await Y(),xe(),_e()}),ge(()=>{!t.formatter&&t.parser,xe(),Y(_e)}),e({input:C,textarea:m,ref:q,textareaStyle:ne,autosize:Rs(t,"autosize"),focus:Pe,blur:Rt,select:At,clear:Me,resizeTextarea:_e}),(S,W)=>De((w(),E("div",is(h(r),{class:h(n),style:h(J),role:S.containerRole,onMouseenter:$t,onMouseleave:dt}),[_(" input "),S.type!=="textarea"?(w(),E(Ae,{key:0},[_(" prepend slot "),S.$slots.prepend?(w(),E("div",{key:0,class:P(h(p).be("group","prepend"))},[ee(S.$slots,"prepend")],2)):_("v-if",!0),N("div",{class:P(h(l))},[_(" prefix slot "),S.$slots.prefix||S.prefixIcon?(w(),E("span",{key:0,class:P(h(p).e("prefix"))},[N("span",{class:P(h(p).e("prefix-inner")),onClick:Pe},[ee(S.$slots,"prefix"),S.prefixIcon?(w(),K(h(ke),{key:0,class:P(h(p).e("icon"))},{default:$(()=>[(w(),K(je(S.prefixIcon)))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0),N("input",is({id:h(f),ref_key:"input",ref:C,class:h(p).e("inner")},h(u),{type:S.showPassword?D.value?"text":"password":S.type,disabled:h(v),formatter:S.formatter,parser:S.parser,readonly:S.readonly,autocomplete:S.autocomplete,tabindex:S.tabindex,"aria-label":S.label,placeholder:S.placeholder,style:S.inputStyle,form:t.form,onCompositionstart:at,onCompositionupdate:Ge,onCompositionend:nt,onInput:Re,onFocus:wt,onBlur:Bt,onChange:bt,onKeydown:St}),null,16,jn),_(" suffix slot "),h(Ye)?(w(),E("span",{key:1,class:P(h(p).e("suffix"))},[N("span",{class:P(h(p).e("suffix-inner")),onClick:Pe},[!h(he)||!h(Le)||!h(z)?(w(),E(Ae,{key:0},[ee(S.$slots,"suffix"),S.suffixIcon?(w(),K(h(ke),{key:0,class:P(h(p).e("icon"))},{default:$(()=>[(w(),K(je(S.suffixIcon)))]),_:1},8,["class"])):_("v-if",!0)],64)):_("v-if",!0),h(he)?(w(),K(h(ke),{key:1,class:P([h(p).e("icon"),h(p).e("clear")]),onMousedown:We(h(rs),["prevent"]),onClick:Me},{default:$(()=>[A(h(tr))]),_:1},8,["class","onMousedown"])):_("v-if",!0),h(Le)?(w(),K(h(ke),{key:2,class:P([h(p).e("icon"),h(p).e("password")]),onClick:lt},{default:$(()=>[(w(),K(je(h(me))))]),_:1},8,["class"])):_("v-if",!0),h(z)?(w(),E("span",{key:3,class:P(h(p).e("count"))},[N("span",{class:P(h(p).e("count-inner"))},ye(h(te))+" / "+ye(h(u).maxlength),3)],2)):_("v-if",!0),h(V)&&h(j)&&h(R)?(w(),K(h(ke),{key:4,class:P([h(p).e("icon"),h(p).e("validateIcon"),h(p).is("loading",h(V)==="validating")])},{default:$(()=>[(w(),K(je(h(j))))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0)],2),_(" append slot "),S.$slots.append?(w(),E("div",{key:1,class:P(h(p).be("group","append"))},[ee(S.$slots,"append")],2)):_("v-if",!0)],64)):(w(),E(Ae,{key:1},[_(" textarea "),N("textarea",is({id:h(f),ref_key:"textarea",ref:m,class:h(x).e("inner")},h(u),{tabindex:S.tabindex,disabled:h(v),readonly:S.readonly,autocomplete:S.autocomplete,style:h(ne),"aria-label":S.label,placeholder:S.placeholder,form:t.form,onCompositionstart:at,onCompositionupdate:Ge,onCompositionend:nt,onInput:Re,onFocus:wt,onBlur:Bt,onChange:bt,onKeydown:St}),null,16,el),h(z)?(w(),E("span",{key:0,style:re(F.value),class:P(h(p).e("count"))},ye(h(te))+" / "+ye(h(u).maxlength),7)):_("v-if",!0)],64))],16,In)),[[mt,S.type!=="hidden"]])}});var ol=ce(sl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const gr=Ft(ol),mr=Symbol("scrollbarContextKey"),rl=Oe({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),il="Thumb",al=U({__name:"thumb",props:rl,setup(s){const e=s,o=rt(mr),t=ae("scrollbar");o||Jo(il,"can not inject scrollbar context");const a=M(),i=M(),r=M({}),n=M(!1);let l=!1,u=!1,c=it?document.onselectstart:null;const d=T(()=>li[e.vertical?"vertical":"horizontal"]),f=T(()=>di({size:e.size,move:e.move,bar:d.value})),y=T(()=>a.value[d.value.offset]**2/o.wrapElement[d.value.scrollSize]/e.ratio/i.value[d.value.offset]),v=D=>{var F;if(D.stopPropagation(),D.ctrlKey||[1,2].includes(D.button))return;(F=window.getSelection())==null||F.removeAllRanges(),x(D);const H=D.currentTarget;H&&(r.value[d.value.axis]=H[d.value.offset]-(D[d.value.client]-H.getBoundingClientRect()[d.value.direction]))},p=D=>{if(!i.value||!a.value||!o.wrapElement)return;const F=Math.abs(D.target.getBoundingClientRect()[d.value.direction]-D[d.value.client]),H=i.value[d.value.offset]/2,q=(F-H)*100*y.value/a.value[d.value.offset];o.wrapElement[d.value.scroll]=q*o.wrapElement[d.value.scrollSize]/100},x=D=>{D.stopImmediatePropagation(),l=!0,document.addEventListener("mousemove",C),document.addEventListener("mouseup",m),c=document.onselectstart,document.onselectstart=()=>!1},C=D=>{if(!a.value||!i.value||l===!1)return;const F=r.value[d.value.axis];if(!F)return;const H=(a.value.getBoundingClientRect()[d.value.direction]-D[d.value.client])*-1,q=i.value[d.value.offset]-F,R=(H-q)*100*y.value/a.value[d.value.offset];o.wrapElement[d.value.scroll]=R*o.wrapElement[d.value.scrollSize]/100},m=()=>{l=!1,r.value[d.value.axis]=0,document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",m),G(),u&&(n.value=!1)},B=()=>{u=!1,n.value=!!e.size},k=()=>{u=!0,n.value=l};Gt(()=>{G(),document.removeEventListener("mouseup",m)});const G=()=>{document.onselectstart!==c&&(document.onselectstart=c)};return $s(Rs(o,"scrollbarElement"),"mousemove",B),$s(Rs(o,"scrollbarElement"),"mouseleave",k),(D,F)=>(w(),K(cs,{name:h(t).b("fade"),persisted:""},{default:$(()=>[De(N("div",{ref_key:"instance",ref:a,class:P([h(t).e("bar"),h(t).is(h(d).key)]),onMousedown:p},[N("div",{ref_key:"thumb",ref:i,class:P(h(t).e("thumb")),style:re(h(f)),onMousedown:v},null,38)],34),[[mt,D.always||n.value]])]),_:1},8,["name"]))}});var wo=ce(al,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const nl=Oe({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),ll=U({__name:"bar",props:nl,setup(s,{expose:e}){const o=s,t=M(0),a=M(0);return e({handleScroll:r=>{if(r){const n=r.offsetHeight-Tt,l=r.offsetWidth-Tt;a.value=r.scrollTop*100/n*o.ratioY,t.value=r.scrollLeft*100/l*o.ratioX}}}),(r,n)=>(w(),E(Ae,null,[A(wo,{move:t.value,ratio:r.ratioX,size:r.width,always:r.always},null,8,["move","ratio","size","always"]),A(wo,{move:a.value,ratio:r.ratioY,size:r.height,vertical:"",always:r.always},null,8,["move","ratio","size","always"])],64))}});var dl=ce(ll,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const ul=Oe({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:ze([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),cl={scroll:({scrollTop:s,scrollLeft:e})=>[s,e].every(et)},hl="ElScrollbar",pl=U({name:hl}),fl=U({...pl,props:ul,emits:cl,setup(s,{expose:e,emit:o}){const t=s,a=ae("scrollbar");let i,r;const n=M(),l=M(),u=M(),c=M("0"),d=M("0"),f=M(),y=M(1),v=M(1),p=T(()=>{const F={};return t.height&&(F.height=yt(t.height)),t.maxHeight&&(F.maxHeight=yt(t.maxHeight)),[t.wrapStyle,F]}),x=T(()=>[t.wrapClass,a.e("wrap"),{[a.em("wrap","hidden-default")]:!t.native}]),C=T(()=>[a.e("view"),t.viewClass]),m=()=>{var F;l.value&&((F=f.value)==null||F.handleScroll(l.value),o("scroll",{scrollTop:l.value.scrollTop,scrollLeft:l.value.scrollLeft}))};function B(F,H){kt(F)?l.value.scrollTo(F):et(F)&&et(H)&&l.value.scrollTo(F,H)}const k=F=>{et(F)&&(l.value.scrollTop=F)},G=F=>{et(F)&&(l.value.scrollLeft=F)},D=()=>{if(!l.value)return;const F=l.value.offsetHeight-Tt,H=l.value.offsetWidth-Tt,q=F**2/l.value.scrollHeight,R=H**2/l.value.scrollWidth,V=Math.max(q,t.minSize),j=Math.max(R,t.minSize);y.value=q/(F-q)/(V/(F-V)),v.value=R/(H-R)/(j/(H-j)),d.value=V+Tt<F?`${V}px`:"",c.value=j+Tt<H?`${j}px`:""};return X(()=>t.noresize,F=>{F?(i==null||i(),r==null||r()):({stop:i}=gs(u,D),r=$s("resize",D))},{immediate:!0}),X(()=>[t.maxHeight,t.height],()=>{t.native||Y(()=>{var F;D(),l.value&&((F=f.value)==null||F.handleScroll(l.value))})}),Qt(mr,vt({scrollbarElement:n,wrapElement:l})),ge(()=>{t.native||Y(()=>{D()})}),$r(()=>D()),e({wrapRef:l,update:D,scrollTo:B,setScrollTop:k,setScrollLeft:G,handleScroll:m}),(F,H)=>(w(),E("div",{ref_key:"scrollbarRef",ref:n,class:P(h(a).b())},[N("div",{ref_key:"wrapRef",ref:l,class:P(h(x)),style:re(h(p)),onScroll:m},[(w(),K(je(F.tag),{ref_key:"resizeRef",ref:u,class:P(h(C)),style:re(F.viewStyle)},{default:$(()=>[ee(F.$slots,"default")]),_:3},8,["class","style"]))],38),F.native?_("v-if",!0):(w(),K(dl,{key:0,ref_key:"barRef",ref:f,height:d.value,width:c.value,always:F.always,"ratio-x":v.value,"ratio-y":y.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var yl=ce(fl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const gl=Ft(yl),ml=Oe({color:{type:ze(Object),required:!0},vertical:{type:Boolean,default:!1}});let Fs=!1;function Xt(s,e){if(!it)return;const o=function(i){var r;(r=e.drag)==null||r.call(e,i)},t=function(i){var r;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",t),document.onselectstart=null,document.ondragstart=null,Fs=!1,(r=e.end)==null||r.call(e,i)},a=function(i){var r;Fs||(i.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",t),document.addEventListener("touchmove",o),document.addEventListener("touchend",t),Fs=!0,(r=e.start)==null||r.call(e,i))};s.addEventListener("mousedown",a),s.addEventListener("touchstart",a)}const vl=s=>{const e=Ue(),o=pt(),t=pt();function a(r){r.target!==o.value&&i(r)}function i(r){if(!t.value||!o.value)return;const l=e.vnode.el.getBoundingClientRect(),{clientX:u,clientY:c}=Us(r);if(s.vertical){let d=c-l.top;d=Math.max(o.value.offsetHeight/2,d),d=Math.min(d,l.height-o.value.offsetHeight/2),s.color.set("alpha",Math.round((d-o.value.offsetHeight/2)/(l.height-o.value.offsetHeight)*100))}else{let d=u-l.left;d=Math.max(o.value.offsetWidth/2,d),d=Math.min(d,l.width-o.value.offsetWidth/2),s.color.set("alpha",Math.round((d-o.value.offsetWidth/2)/(l.width-o.value.offsetWidth)*100))}}return{thumb:o,bar:t,handleDrag:i,handleClick:a}},xl=(s,{bar:e,thumb:o,handleDrag:t})=>{const a=Ue(),i=ae("color-alpha-slider"),r=M(0),n=M(0),l=M();function u(){if(!o.value||s.vertical)return 0;const m=a.vnode.el,B=s.color.get("alpha");return m?Math.round(B*(m.offsetWidth-o.value.offsetWidth/2)/100):0}function c(){if(!o.value)return 0;const m=a.vnode.el;if(!s.vertical)return 0;const B=s.color.get("alpha");return m?Math.round(B*(m.offsetHeight-o.value.offsetHeight/2)/100):0}function d(){if(s.color&&s.color.value){const{r:m,g:B,b:k}=s.color.toRgb();return`linear-gradient(to right, rgba(${m}, ${B}, ${k}, 0) 0%, rgba(${m}, ${B}, ${k}, 1) 100%)`}return""}function f(){r.value=u(),n.value=c(),l.value=d()}ge(()=>{if(!e.value||!o.value)return;const m={drag:B=>{t(B)},end:B=>{t(B)}};Xt(e.value,m),Xt(o.value,m),f()}),X(()=>s.color.get("alpha"),()=>f()),X(()=>s.color.value,()=>f());const y=T(()=>[i.b(),i.is("vertical",s.vertical)]),v=T(()=>i.e("bar")),p=T(()=>i.e("thumb")),x=T(()=>({background:l.value})),C=T(()=>({left:yt(r.value),top:yt(n.value)}));return{rootKls:y,barKls:v,barStyle:x,thumbKls:p,thumbStyle:C,update:f}},bl="ElColorAlphaSlider",wl=U({name:bl}),Bl=U({...wl,props:ml,setup(s,{expose:e}){const o=s,{bar:t,thumb:a,handleDrag:i,handleClick:r}=vl(o),{rootKls:n,barKls:l,barStyle:u,thumbKls:c,thumbStyle:d,update:f}=xl(o,{bar:t,thumb:a,handleDrag:i});return e({update:f,bar:t,thumb:a}),(y,v)=>(w(),E("div",{class:P(h(n))},[N("div",{ref_key:"bar",ref:t,class:P(h(l)),style:re(h(u)),onClick:v[0]||(v[0]=(...p)=>h(r)&&h(r)(...p))},null,6),N("div",{ref_key:"thumb",ref:a,class:P(h(c)),style:re(h(d))},null,6)],2))}});var Sl=ce(Bl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const Cl=U({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(s){const e=ae("color-hue-slider"),o=Ue(),t=M(),a=M(),i=M(0),r=M(0),n=T(()=>s.color.get("hue"));X(()=>n.value,()=>{f()});function l(y){y.target!==t.value&&u(y)}function u(y){if(!a.value||!t.value)return;const p=o.vnode.el.getBoundingClientRect(),{clientX:x,clientY:C}=Us(y);let m;if(s.vertical){let B=C-p.top;B=Math.min(B,p.height-t.value.offsetHeight/2),B=Math.max(t.value.offsetHeight/2,B),m=Math.round((B-t.value.offsetHeight/2)/(p.height-t.value.offsetHeight)*360)}else{let B=x-p.left;B=Math.min(B,p.width-t.value.offsetWidth/2),B=Math.max(t.value.offsetWidth/2,B),m=Math.round((B-t.value.offsetWidth/2)/(p.width-t.value.offsetWidth)*360)}s.color.set("hue",m)}function c(){if(!t.value)return 0;const y=o.vnode.el;if(s.vertical)return 0;const v=s.color.get("hue");return y?Math.round(v*(y.offsetWidth-t.value.offsetWidth/2)/360):0}function d(){if(!t.value)return 0;const y=o.vnode.el;if(!s.vertical)return 0;const v=s.color.get("hue");return y?Math.round(v*(y.offsetHeight-t.value.offsetHeight/2)/360):0}function f(){i.value=c(),r.value=d()}return ge(()=>{if(!a.value||!t.value)return;const y={drag:v=>{u(v)},end:v=>{u(v)}};Xt(a.value,y),Xt(t.value,y),f()}),{bar:a,thumb:t,thumbLeft:i,thumbTop:r,hueValue:n,handleClick:l,update:f,ns:e}}});function Tl(s,e,o,t,a,i){return w(),E("div",{class:P([s.ns.b(),s.ns.is("vertical",s.vertical)])},[N("div",{ref:"bar",class:P(s.ns.e("bar")),onClick:e[0]||(e[0]=(...r)=>s.handleClick&&s.handleClick(...r))},null,2),N("div",{ref:"thumb",class:P(s.ns.e("thumb")),style:re({left:s.thumbLeft+"px",top:s.thumbTop+"px"})},null,6)],2)}var Pl=ce(Cl,[["render",Tl],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const Ml=Oe({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Io,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:ze(Array)},validateEvent:{type:Boolean,default:!0}}),Nl={[ue]:s=>st(s)||as(s),[qs]:s=>st(s)||as(s),activeChange:s=>st(s)||as(s)},vr=Symbol("colorPickerContextKey"),Bo=function(s,e,o){return[s,e*o/((s=(2-e)*o)<1?s:2-s)||0,s/2]},Fl=function(s){return typeof s=="string"&&s.includes(".")&&Number.parseFloat(s)===1},El=function(s){return typeof s=="string"&&s.includes("%")},Nt=function(s,e){Fl(s)&&(s="100%");const o=El(s);return s=Math.min(e,Math.max(0,Number.parseFloat(`${s}`))),o&&(s=Number.parseInt(`${s*e}`,10)/100),Math.abs(s-e)<1e-6?1:s%e/Number.parseFloat(e)},So={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},us=s=>{s=Math.min(Math.round(s),255);const e=Math.floor(s/16),o=s%16;return`${So[e]||e}${So[o]||o}`},Co=function({r:s,g:e,b:o}){return Number.isNaN(+s)||Number.isNaN(+e)||Number.isNaN(+o)?"":`#${us(s)}${us(e)}${us(o)}`},Es={A:10,B:11,C:12,D:13,E:14,F:15},ht=function(s){return s.length===2?(Es[s[0].toUpperCase()]||+s[0])*16+(Es[s[1].toUpperCase()]||+s[1]):Es[s[1].toUpperCase()]||+s[1]},Ll=function(s,e,o){e=e/100,o=o/100;let t=e;const a=Math.max(o,.01);o*=2,e*=o<=1?o:2-o,t*=a<=1?a:2-a;const i=(o+e)/2,r=o===0?2*t/(a+t):2*e/(o+e);return{h:s,s:r*100,v:i*100}},To=(s,e,o)=>{s=Nt(s,255),e=Nt(e,255),o=Nt(o,255);const t=Math.max(s,e,o),a=Math.min(s,e,o);let i;const r=t,n=t-a,l=t===0?0:n/t;if(t===a)i=0;else{switch(t){case s:{i=(e-o)/n+(e<o?6:0);break}case e:{i=(o-s)/n+2;break}case o:{i=(s-e)/n+4;break}}i/=6}return{h:i*360,s:l*100,v:r*100}},Ht=function(s,e,o){s=Nt(s,360)*6,e=Nt(e,100),o=Nt(o,100);const t=Math.floor(s),a=s-t,i=o*(1-e),r=o*(1-a*e),n=o*(1-(1-a)*e),l=t%6,u=[o,r,i,i,n,o][l],c=[n,o,o,r,i,i][l],d=[i,i,n,o,o,r][l];return{r:Math.round(u*255),g:Math.round(c*255),b:Math.round(d*255)}};class Wt{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in e)js(e,o)&&(this[o]=e[o]);e.value?this.fromString(e.value):this.doOnChange()}set(e,o){if(arguments.length===1&&typeof e=="object"){for(const t in e)js(e,t)&&this.set(t,e[t]);return}this[`_${e}`]=o,this.doOnChange()}get(e){return e==="alpha"?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return Ht(this._hue,this._saturation,this._value)}fromString(e){if(!e){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(t,a,i)=>{this._hue=Math.max(0,Math.min(360,t)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,i)),this.doOnChange()};if(e.includes("hsl")){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:i,v:r}=Ll(t[0],t[1],t[2]);o(a,i,r)}}else if(e.includes("hsv")){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3&&o(t[0],t[1],t[2])}else if(e.includes("rgb")){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,i)=>i>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:i,v:r}=To(t[0],t[1],t[2]);o(a,i,r)}}else if(e.includes("#")){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return;let a,i,r;t.length===3?(a=ht(t[0]+t[0]),i=ht(t[1]+t[1]),r=ht(t[2]+t[2])):(t.length===6||t.length===8)&&(a=ht(t.slice(0,2)),i=ht(t.slice(2,4)),r=ht(t.slice(4,6))),t.length===8?this._alpha=ht(t.slice(6))/255*100:(t.length===3||t.length===6)&&(this._alpha=100);const{h:n,s:l,v:u}=To(a,i,r);o(n,l,u)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:o,_value:t,_alpha:a,format:i}=this;if(this.enableAlpha)switch(i){case"hsl":{const r=Bo(e,o/100,t/100);this.value=`hsla(${e}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${e}, ${Math.round(o)}%, ${Math.round(t)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${Co(Ht(e,o,t))}${us(a*255/100)}`;break}default:{const{r,g:n,b:l}=Ht(e,o,t);this.value=`rgba(${r}, ${n}, ${l}, ${this.get("alpha")/100})`}}else switch(i){case"hsl":{const r=Bo(e,o/100,t/100);this.value=`hsl(${e}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${e}, ${Math.round(o)}%, ${Math.round(t)}%)`;break}case"rgb":{const{r,g:n,b:l}=Ht(e,o,t);this.value=`rgb(${r}, ${n}, ${l})`;break}default:this.value=Co(Ht(e,o,t))}}}const Rl=U({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(s){const e=ae("color-predefine"),{currentColor:o}=rt(vr),t=M(i(s.colors,s.color));X(()=>o.value,r=>{const n=new Wt;n.fromString(r),t.value.forEach(l=>{l.selected=n.compare(l)})}),_o(()=>{t.value=i(s.colors,s.color)});function a(r){s.color.fromString(s.colors[r])}function i(r,n){return r.map(l=>{const u=new Wt;return u.enableAlpha=!0,u.format="rgba",u.fromString(l),u.selected=u.value===n.value,u})}return{rgbaColors:t,handleSelect:a,ns:e}}}),$l=["onClick"];function Al(s,e,o,t,a,i){return w(),E("div",{class:P(s.ns.b())},[N("div",{class:P(s.ns.e("colors"))},[(w(!0),E(Ae,null,Kt(s.rgbaColors,(r,n)=>(w(),E("div",{key:s.colors[n],class:P([s.ns.e("color-selector"),s.ns.is("alpha",r._alpha<100),{selected:r.selected}]),onClick:l=>s.handleSelect(n)},[N("div",{style:re({backgroundColor:r.value})},null,4)],10,$l))),128))],2)],2)}var Dl=ce(Rl,[["render",Al],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const zl=U({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(s){const e=ae("color-svpanel"),o=Ue(),t=M(0),a=M(0),i=M("hsl(0, 100%, 50%)"),r=T(()=>{const u=s.color.get("hue"),c=s.color.get("value");return{hue:u,value:c}});function n(){const u=s.color.get("saturation"),c=s.color.get("value"),d=o.vnode.el,{clientWidth:f,clientHeight:y}=d;a.value=u*f/100,t.value=(100-c)*y/100,i.value=`hsl(${s.color.get("hue")}, 100%, 50%)`}function l(u){const d=o.vnode.el.getBoundingClientRect(),{clientX:f,clientY:y}=Us(u);let v=f-d.left,p=y-d.top;v=Math.max(0,v),v=Math.min(v,d.width),p=Math.max(0,p),p=Math.min(p,d.height),a.value=v,t.value=p,s.color.set({saturation:v/d.width*100,value:100-p/d.height*100})}return X(()=>r.value,()=>{n()}),ge(()=>{Xt(o.vnode.el,{drag:u=>{l(u)},end:u=>{l(u)}}),n()}),{cursorTop:t,cursorLeft:a,background:i,colorValue:r,handleDrag:l,update:n,ns:e}}}),Hl=N("div",null,null,-1),Ol=[Hl];function _l(s,e,o,t,a,i){return w(),E("div",{class:P(s.ns.b()),style:re({backgroundColor:s.background})},[N("div",{class:P(s.ns.e("white"))},null,2),N("div",{class:P(s.ns.e("black"))},null,2),N("div",{class:P(s.ns.e("cursor")),style:re({top:s.cursorTop+"px",left:s.cursorLeft+"px"})},Ol,6)],6)}var Kl=ce(zl,[["render",_l],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const Vl=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],Wl=U({name:"ElColorPicker"}),kl=U({...Wl,props:Ml,emits:Nl,setup(s,{expose:e,emit:o}){const t=s,{t:a}=Zt(),i=ae("color"),{formItem:r}=Ws(),n=ks(),l=er(),{inputId:u,isLabeledByFormItem:c}=jo(t,{formItemContext:r}),d=M(),f=M(),y=M(),v=M();let p=!0;const x=vt(new Wt({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue})),C=M(!1),m=M(!1),B=M(""),k=T(()=>!t.modelValue&&!m.value?"transparent":q(x,t.showAlpha)),G=T(()=>!t.modelValue&&!m.value?"":x.value),D=T(()=>c.value?void 0:t.label||a("el.colorpicker.defaultLabel")),F=T(()=>c.value?r==null?void 0:r.labelId:void 0),H=T(()=>[i.b("picker"),i.is("disabled",l.value),i.bm("picker",n.value)]);function q(z,te){if(!(z instanceof Wt))throw new TypeError("color should be instance of _color Class");const{r:ve,g:Ye,b:Xe}=z.toRgb();return te?`rgba(${ve}, ${Ye}, ${Xe}, ${z.get("alpha")/100})`:`rgb(${ve}, ${Ye}, ${Xe})`}function R(z){C.value=z}const V=As(R,100);function j(){l.value||R(!0)}function me(){V(!1),J()}function J(){Y(()=>{t.modelValue?x.fromString(t.modelValue):(x.value="",Y(()=>{m.value=!1}))})}function ne(){l.value||V(!C.value)}function I(){x.fromString(B.value)}function he(){const z=x.value;o(ue,z),o("change",z),t.validateEvent&&(r==null||r.validate("change").catch(te=>Yt())),V(!1),Y(()=>{const te=new Wt({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue});x.compare(te)||J()})}function Le(){V(!1),o(ue,null),o("change",null),t.modelValue!==null&&t.validateEvent&&(r==null||r.validate("change").catch(z=>Yt())),J()}return ge(()=>{t.modelValue&&(B.value=G.value)}),X(()=>t.modelValue,z=>{z?z&&z!==x.value&&(p=!1,x.fromString(z)):m.value=!1}),X(()=>G.value,z=>{B.value=z,p&&o("activeChange",z),p=!0}),X(()=>x.value,()=>{!t.modelValue&&!m.value&&(m.value=!0)}),X(()=>C.value,()=>{Y(()=>{var z,te,ve;(z=d.value)==null||z.update(),(te=f.value)==null||te.update(),(ve=y.value)==null||ve.update()})}),Qt(vr,{currentColor:G}),e({color:x,show:j,hide:me}),(z,te)=>(w(),K(h(ir),{ref_key:"popper",ref:v,visible:C.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[h(i).be("picker","panel"),h(i).b("dropdown"),z.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${h(i).namespace.value}-zoom-in-top`,persistent:""},{content:$(()=>[De((w(),E("div",null,[N("div",{class:P(h(i).be("dropdown","main-wrapper"))},[A(Pl,{ref_key:"hue",ref:d,class:"hue-slider",color:h(x),vertical:""},null,8,["color"]),A(Kl,{ref:"svPanel",color:h(x)},null,8,["color"])],2),z.showAlpha?(w(),K(Sl,{key:0,ref_key:"alpha",ref:y,color:h(x)},null,8,["color"])):_("v-if",!0),z.predefine?(w(),K(Dl,{key:1,ref:"predefine",color:h(x),colors:z.predefine},null,8,["color","colors"])):_("v-if",!0),N("div",{class:P(h(i).be("dropdown","btns"))},[N("span",{class:P(h(i).be("dropdown","value"))},[A(h(gr),{modelValue:B.value,"onUpdate:modelValue":te[0]||(te[0]=ve=>B.value=ve),"validate-event":!1,size:"small",onKeyup:Be(I,["enter"]),onBlur:I},null,8,["modelValue","onKeyup"])],2),A(h(fe),{class:P(h(i).be("dropdown","link-btn")),text:"",size:"small",onClick:Le},{default:$(()=>[eo(ye(h(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),A(h(fe),{plain:"",size:"small",class:P(h(i).be("dropdown","btn")),onClick:he},{default:$(()=>[eo(ye(h(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[h(or),me]])]),default:$(()=>[N("div",{id:h(u),class:P(h(H)),role:"button","aria-label":h(D),"aria-labelledby":h(F),"aria-description":h(a)("el.colorpicker.description",{color:z.modelValue||""}),tabindex:z.tabindex,onKeydown:Be(ne,["enter"])},[h(l)?(w(),E("div",{key:0,class:P(h(i).be("picker","mask"))},null,2)):_("v-if",!0),N("div",{class:P(h(i).be("picker","trigger")),onClick:ne},[N("span",{class:P([h(i).be("picker","color"),h(i).is("alpha",z.showAlpha)])},[N("span",{class:P(h(i).be("picker","color-inner")),style:re({backgroundColor:h(k)})},[De(A(h(ke),{class:P([h(i).be("picker","icon"),h(i).is("icon-arrow-down")])},{default:$(()=>[A(h(rr))]),_:1},8,["class"]),[[mt,z.modelValue||m.value]]),!z.modelValue&&!m.value?(w(),K(h(ke),{key:0,class:P([h(i).be("picker","empty"),h(i).is("icon-close")])},{default:$(()=>[A(h(ui))]),_:1},8,["class"])):_("v-if",!0)],6)],2)],2)],42,Vl)]),_:1},8,["visible","popper-class","transition"]))}});var ql=ce(kl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const Ls=Ft(ql),Ul=Oe({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:ze([String,Array,Object])},zIndex:{type:ze([String,Number])}}),Yl={click:s=>s instanceof MouseEvent},Xl="overlay";var Gl=U({name:"ElOverlay",props:Ul,emits:Yl,setup(s,{slots:e,emit:o}){const t=ae(Xl),a=l=>{o("click",l)},{onClick:i,onMousedown:r,onMouseup:n}=yr(s.customMaskEvent?void 0:a);return()=>s.mask?A("div",{class:[t.b(),s.overlayClass],style:{zIndex:s.zIndex},onClick:i,onMousedown:r,onMouseup:n},[ee(e,"default")],ds.STYLE|ds.CLASS|ds.PROPS,["onClick","onMouseup","onMousedown"]):Ar("div",{class:s.overlayClass,style:{zIndex:s.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[ee(e,"default")])}});const Ql=Gl,xr=Symbol("dialogInjectionKey"),br=Oe({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:Ut},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),Zl={close:()=>!0},Jl=["aria-label"],Il=["id"],jl=U({name:"ElDialogContent"}),ed=U({...jl,props:br,emits:Zl,setup(s){const e=s,{t:o}=Zt(),{Close:t}=hi,{dialogRef:a,headerRef:i,bodyId:r,ns:n,style:l}=rt(xr),{focusTrapRef:u}=rt(ci),c=On(u,a),d=T(()=>e.draggable);return kn(a,i,d),(f,y)=>(w(),E("div",{ref:h(c),class:P([h(n).b(),h(n).is("fullscreen",f.fullscreen),h(n).is("draggable",h(d)),h(n).is("align-center",f.alignCenter),{[h(n).m("center")]:f.center},f.customClass]),style:re(h(l)),tabindex:"-1"},[N("header",{ref_key:"headerRef",ref:i,class:P(h(n).e("header"))},[ee(f.$slots,"header",{},()=>[N("span",{role:"heading",class:P(h(n).e("title"))},ye(f.title),3)]),f.showClose?(w(),E("button",{key:0,"aria-label":h(o)("el.dialog.close"),class:P(h(n).e("headerbtn")),type:"button",onClick:y[0]||(y[0]=v=>f.$emit("close"))},[A(h(ke),{class:P(h(n).e("close"))},{default:$(()=>[(w(),K(je(f.closeIcon||h(t))))]),_:1},8,["class"])],10,Jl)):_("v-if",!0)],2),N("div",{id:h(r),class:P(h(n).e("body"))},[ee(f.$slots,"default")],10,Il),f.$slots.footer?(w(),E("footer",{key:0,class:P(h(n).e("footer"))},[ee(f.$slots,"footer")],2)):_("v-if",!0)],6))}});var td=ce(ed,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const sd=Oe({...br,appendToBody:{type:Boolean,default:!1},beforeClose:{type:ze(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),od={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ue]:s=>pi(s),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},rd=(s,e)=>{const t=Ue().emit,{nextZIndex:a}=fi();let i="";const r=oo(),n=oo(),l=M(!1),u=M(!1),c=M(!1),d=M(s.zIndex||a());let f,y;const v=yi("namespace",gi),p=T(()=>{const J={},ne=`--${v.value}-dialog`;return s.fullscreen||(s.top&&(J[`${ne}-margin-top`]=s.top),s.width&&(J[`${ne}-width`]=yt(s.width))),J}),x=T(()=>s.alignCenter?{display:"flex"}:{});function C(){t("opened")}function m(){t("closed"),t(ue,!1),s.destroyOnClose&&(c.value=!1)}function B(){t("close")}function k(){y==null||y(),f==null||f(),s.openDelay&&s.openDelay>0?{stop:f}=ro(()=>H(),s.openDelay):H()}function G(){f==null||f(),y==null||y(),s.closeDelay&&s.closeDelay>0?{stop:y}=ro(()=>q(),s.closeDelay):q()}function D(){function J(ne){ne||(u.value=!0,l.value=!1)}s.beforeClose?s.beforeClose(J):G()}function F(){s.closeOnClickModal&&D()}function H(){it&&(l.value=!0)}function q(){l.value=!1}function R(){t("openAutoFocus")}function V(){t("closeAutoFocus")}function j(J){var ne;((ne=J.detail)==null?void 0:ne.focusReason)==="pointer"&&J.preventDefault()}s.lockScroll&&Un(l);function me(){s.closeOnPressEscape&&D()}return X(()=>s.modelValue,J=>{J?(u.value=!1,k(),c.value=!0,d.value=s.zIndex?d.value++:a(),Y(()=>{t("open"),e.value&&(e.value.scrollTop=0)})):l.value&&G()}),X(()=>s.fullscreen,J=>{e.value&&(J?(i=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=i)}),ge(()=>{s.modelValue&&(l.value=!0,c.value=!0,k())}),{afterEnter:C,afterLeave:m,beforeLeave:B,handleClose:D,onModalClick:F,close:G,doClose:q,onOpenAutoFocus:R,onCloseAutoFocus:V,onCloseRequested:me,onFocusoutPrevented:j,titleId:r,bodyId:n,closed:u,style:p,overlayDialogStyle:x,rendered:c,visible:l,zIndex:d}},id=["aria-label","aria-labelledby","aria-describedby"],ad=U({name:"ElDialog",inheritAttrs:!1}),nd=U({...ad,props:sd,emits:od,setup(s,{expose:e}){const o=s,t=Vo();Ds({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},T(()=>!!t.title)),Ds({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},T(()=>!!o.customClass));const a=ae("dialog"),i=M(),r=M(),n=M(),{visible:l,titleId:u,bodyId:c,style:d,overlayDialogStyle:f,rendered:y,zIndex:v,afterEnter:p,afterLeave:x,beforeLeave:C,handleClose:m,onModalClick:B,onOpenAutoFocus:k,onCloseAutoFocus:G,onCloseRequested:D,onFocusoutPrevented:F}=rd(o,i);Qt(xr,{dialogRef:i,headerRef:r,bodyId:c,ns:a,rendered:y,style:d});const H=yr(B),q=T(()=>o.draggable&&!o.fullscreen);return e({visible:l,dialogContentRef:n}),(R,V)=>(w(),K(Dr,{to:"body",disabled:!R.appendToBody},[A(cs,{name:"dialog-fade",onAfterEnter:h(p),onAfterLeave:h(x),onBeforeLeave:h(C),persisted:""},{default:$(()=>[De(A(h(Ql),{"custom-mask-event":"",mask:R.modal,"overlay-class":R.modalClass,"z-index":h(v)},{default:$(()=>[N("div",{role:"dialog","aria-modal":"true","aria-label":R.title||void 0,"aria-labelledby":R.title?void 0:h(u),"aria-describedby":h(c),class:P(`${h(a).namespace.value}-overlay-dialog`),style:re(h(f)),onClick:V[0]||(V[0]=(...j)=>h(H).onClick&&h(H).onClick(...j)),onMousedown:V[1]||(V[1]=(...j)=>h(H).onMousedown&&h(H).onMousedown(...j)),onMouseup:V[2]||(V[2]=(...j)=>h(H).onMouseup&&h(H).onMouseup(...j))},[A(h(mi),{loop:"",trapped:h(l),"focus-start-el":"container",onFocusAfterTrapped:h(k),onFocusAfterReleased:h(G),onFocusoutPrevented:h(F),onReleaseRequested:h(D)},{default:$(()=>[h(y)?(w(),K(td,is({key:0,ref_key:"dialogContentRef",ref:n},R.$attrs,{"custom-class":R.customClass,center:R.center,"align-center":R.alignCenter,"close-icon":R.closeIcon,draggable:h(q),fullscreen:R.fullscreen,"show-close":R.showClose,title:R.title,onClose:h(m)}),Wo({header:$(()=>[R.$slots.title?ee(R.$slots,"title",{key:1}):ee(R.$slots,"header",{key:0,close:h(m),titleId:h(u),titleClass:h(a).e("title")})]),default:$(()=>[ee(R.$slots,"default")]),_:2},[R.$slots.footer?{name:"footer",fn:$(()=>[ee(R.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):_("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,id)]),_:3},8,["mask","overlay-class","z-index"]),[[mt,h(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var ld=ce(nd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const dd=Ft(ld),ud=Oe({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:ze(String),default:"solid"}}),cd=U({name:"ElDivider"}),hd=U({...cd,props:ud,setup(s){const e=s,o=ae("divider"),t=T(()=>o.cssVar({"border-style":e.borderStyle}));return(a,i)=>(w(),E("div",{class:P([h(o).b(),h(o).m(a.direction)]),style:re(h(t)),role:"separator"},[a.$slots.default&&a.direction!=="vertical"?(w(),E("div",{key:0,class:P([h(o).e("text"),h(o).is(a.contentPosition)])},[ee(a.$slots,"default")],2)):_("v-if",!0)],6))}});var pd=ce(hd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const Ot=Ft(pd),wr=Symbol("ElSelectGroup"),vs=Symbol("ElSelect");function fd(s,e){const o=rt(vs),t=rt(wr,{disabled:!1}),a=T(()=>Object.prototype.toString.call(s.value).toLowerCase()==="[object object]"),i=T(()=>o.props.multiple?d(o.props.modelValue,s.value):f(s.value,o.props.modelValue)),r=T(()=>{if(o.props.multiple){const p=o.props.modelValue||[];return!i.value&&p.length>=o.props.multipleLimit&&o.props.multipleLimit>0}else return!1}),n=T(()=>s.label||(a.value?"":s.value)),l=T(()=>s.value||s.label||""),u=T(()=>s.disabled||e.groupDisabled||r.value),c=Ue(),d=(p=[],x)=>{if(a.value){const C=o.props.valueKey;return p&&p.some(m=>hs(Ee(m,C))===Ee(x,C))}else return p&&p.includes(x)},f=(p,x)=>{if(a.value){const{valueKey:C}=o.props;return Ee(p,C)===Ee(x,C)}else return p===x},y=()=>{!s.disabled&&!t.disabled&&(o.hoverIndex=o.optionsArray.indexOf(c.proxy))};X(()=>n.value,()=>{!s.created&&!o.props.remote&&o.setSelected()}),X(()=>s.value,(p,x)=>{const{remote:C,valueKey:m}=o.props;if(Object.is(p,x)||(o.onOptionDestroy(x,c.proxy),o.onOptionCreate(c.proxy)),!s.created&&!C){if(m&&typeof p=="object"&&typeof x=="object"&&p[m]===x[m])return;o.setSelected()}}),X(()=>t.disabled,()=>{e.groupDisabled=t.disabled},{immediate:!0});const{queryChange:v}=hs(o);return X(v,p=>{const{query:x}=h(p),C=new RegExp(vi(x),"i");e.visible=C.test(n.value)||s.created,e.visible||o.filteredOptionsCount--},{immediate:!0}),{select:o,currentLabel:n,currentValue:l,itemSelected:i,isDisabled:u,hoverItem:y}}const yd=U({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(s){const e=ae("select"),o=vt({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:t,itemSelected:a,isDisabled:i,select:r,hoverItem:n}=fd(s,o),{visible:l,hover:u}=Hs(o),c=Ue().proxy;r.onOptionCreate(c),Gt(()=>{const f=c.value,{selected:y}=r,p=(r.props.multiple?y:[y]).some(x=>x.value===c.value);Y(()=>{r.cachedOptions.get(f)===c&&!p&&r.cachedOptions.delete(f)}),r.onOptionDestroy(f,c)});function d(){s.disabled!==!0&&o.groupDisabled!==!0&&r.handleOptionSelect(c,!0)}return{ns:e,currentLabel:t,itemSelected:a,isDisabled:i,select:r,hoverItem:n,visible:l,hover:u,selectOptionClick:d,states:o}}});function gd(s,e,o,t,a,i){return De((w(),E("li",{class:P([s.ns.be("dropdown","item"),s.ns.is("disabled",s.isDisabled),{selected:s.itemSelected,hover:s.hover}]),onMouseenter:e[0]||(e[0]=(...r)=>s.hoverItem&&s.hoverItem(...r)),onClick:e[1]||(e[1]=We((...r)=>s.selectOptionClick&&s.selectOptionClick(...r),["stop"]))},[ee(s.$slots,"default",{},()=>[N("span",null,ye(s.currentLabel),1)])],34)),[[mt,s.visible]])}var Qs=ce(yd,[["render",gd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const md=U({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const s=rt(vs),e=ae("select"),o=T(()=>s.props.popperClass),t=T(()=>s.props.multiple),a=T(()=>s.props.fitInputWidth),i=M("");function r(){var n;i.value=`${(n=s.selectWrapper)==null?void 0:n.offsetWidth}px`}return ge(()=>{r(),gs(s.selectWrapper,r)}),{ns:e,minWidth:i,popperClass:o,isMultiple:t,isFitInputWidth:a}}});function vd(s,e,o,t,a,i){return w(),E("div",{class:P([s.ns.b("dropdown"),s.ns.is("multiple",s.isMultiple),s.popperClass]),style:re({[s.isFitInputWidth?"width":"minWidth"]:s.minWidth})},[ee(s.$slots,"default")],6)}var xd=ce(md,[["render",vd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function bd(s){const{t:e}=Zt();return vt({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:s.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:e("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1,mouseEnter:!1})}const wd=(s,e,o)=>{const{t}=Zt(),a=ae("select");Ds({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},T(()=>s.suffixTransition===!1));const i=M(null),r=M(null),n=M(null),l=M(null),u=M(null),c=M(null),d=M(null),f=M(-1),y=pt({query:""}),v=pt(""),p=M([]);let x=0;const{form:C,formItem:m}=Ws(),B=T(()=>!s.filterable||s.multiple||!e.visible),k=T(()=>s.disabled||(C==null?void 0:C.disabled)),G=T(()=>{const g=s.multiple?Array.isArray(s.modelValue)&&s.modelValue.length>0:s.modelValue!==void 0&&s.modelValue!==null&&s.modelValue!=="";return s.clearable&&!k.value&&e.inputHovering&&g}),D=T(()=>s.remote&&s.filterable&&!s.remoteShowSuffix?"":s.suffixIcon),F=T(()=>a.is("reverse",D.value&&e.visible&&s.suffixTransition)),H=T(()=>s.remote?300:0),q=T(()=>s.loading?s.loadingText||t("el.select.loading"):s.remote&&e.query===""&&e.options.size===0?!1:s.filterable&&e.query&&e.options.size>0&&e.filteredOptionsCount===0?s.noMatchText||t("el.select.noMatch"):e.options.size===0?s.noDataText||t("el.select.noData"):null),R=T(()=>{const g=Array.from(e.options.values()),b=[];return p.value.forEach(L=>{const O=g.findIndex(ie=>ie.currentLabel===L);O>-1&&b.push(g[O])}),b.length?b:g}),V=T(()=>Array.from(e.cachedOptions.values())),j=T(()=>{const g=R.value.filter(b=>!b.created).some(b=>b.currentLabel===e.query);return s.filterable&&s.allowCreate&&e.query!==""&&!g}),me=ks(),J=T(()=>["small"].includes(me.value)?"small":"default"),ne=T({get(){return e.visible&&q.value!==!1},set(g){e.visible=g}});X([()=>k.value,()=>me.value,()=>C==null?void 0:C.size],()=>{Y(()=>{I()})}),X(()=>s.placeholder,g=>{e.cachedPlaceHolder=e.currentPlaceholder=g}),X(()=>s.modelValue,(g,b)=>{s.multiple&&(I(),g&&g.length>0||r.value&&e.query!==""?e.currentPlaceholder="":e.currentPlaceholder=e.cachedPlaceHolder,s.filterable&&!s.reserveKeyword&&(e.query="",he(e.query))),te(),s.filterable&&!s.multiple&&(e.inputLength=20),!io(g,b)&&s.validateEvent&&(m==null||m.validate("change").catch(L=>Yt()))},{flush:"post",deep:!0}),X(()=>e.visible,g=>{var b,L,O,ie,le;g?((L=(b=l.value)==null?void 0:b.updatePopper)==null||L.call(b),s.filterable&&(e.filteredOptionsCount=e.optionsCount,e.query=s.remote?"":e.selectedLabel,(ie=(O=n.value)==null?void 0:O.focus)==null||ie.call(O),s.multiple?(le=r.value)==null||le.focus():e.selectedLabel&&(e.currentPlaceholder=`${e.selectedLabel}`,e.selectedLabel=""),he(e.query),!s.multiple&&!s.remote&&(y.value.query="",zt(y),zt(v)))):(s.filterable&&(Ie(s.filterMethod)&&s.filterMethod(""),Ie(s.remoteMethod)&&s.remoteMethod("")),r.value&&r.value.blur(),e.query="",e.previousQuery=null,e.selectedLabel="",e.inputLength=20,e.menuVisibleOnFocus=!1,Ye(),Y(()=>{r.value&&r.value.value===""&&e.selected.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}),s.multiple||(e.selected&&(s.filterable&&s.allowCreate&&e.createdSelected&&e.createdLabel?e.selectedLabel=e.createdLabel:e.selectedLabel=e.selected.currentLabel,s.filterable&&(e.query=e.selectedLabel)),s.filterable&&(e.currentPlaceholder=e.cachedPlaceHolder))),o.emit("visible-change",g)}),X(()=>e.options.entries(),()=>{var g,b,L;if(!it)return;(b=(g=l.value)==null?void 0:g.updatePopper)==null||b.call(g),s.multiple&&I();const O=((L=c.value)==null?void 0:L.querySelectorAll("input"))||[];Array.from(O).includes(document.activeElement)||te(),s.defaultFirstOption&&(s.filterable||s.remote)&&e.filteredOptionsCount&&z()},{flush:"post"}),X(()=>e.hoverIndex,g=>{et(g)&&g>-1?f.value=R.value[g]||{}:f.value={},R.value.forEach(b=>{b.hover=f.value===b})});const I=()=>{Y(()=>{var g,b;if(!i.value)return;const L=i.value.$el.querySelector("input");x=x||(L.clientHeight>0?L.clientHeight+2:0);const O=u.value,ie=_n(me.value||(C==null?void 0:C.size)),le=me.value||ie===x||x<=0?ie:x;!(L.offsetParent===null)&&(L.style.height=`${(e.selected.length===0?le:Math.max(O?O.clientHeight+(O.clientHeight>le?6:0):0,le))-2}px`),e.tagInMultiLine=Number.parseFloat(L.style.height)>=le,e.visible&&q.value!==!1&&((b=(g=l.value)==null?void 0:g.updatePopper)==null||b.call(g))})},he=async g=>{if(!(e.previousQuery===g||e.isOnComposition)){if(e.previousQuery===null&&(Ie(s.filterMethod)||Ie(s.remoteMethod))){e.previousQuery=g;return}e.previousQuery=g,Y(()=>{var b,L;e.visible&&((L=(b=l.value)==null?void 0:b.updatePopper)==null||L.call(b))}),e.hoverIndex=-1,s.multiple&&s.filterable&&Y(()=>{const b=r.value.value.length*15+20;e.inputLength=s.collapseTags?Math.min(50,b):b,Le(),I()}),s.remote&&Ie(s.remoteMethod)?(e.hoverIndex=-1,s.remoteMethod(g)):Ie(s.filterMethod)?(s.filterMethod(g),zt(v)):(e.filteredOptionsCount=e.optionsCount,y.value.query=g,zt(y),zt(v)),s.defaultFirstOption&&(s.filterable||s.remote)&&e.filteredOptionsCount&&(await Y(),z())}},Le=()=>{e.currentPlaceholder!==""&&(e.currentPlaceholder=r.value.value?"":e.cachedPlaceHolder)},z=()=>{const g=R.value.filter(O=>O.visible&&!O.disabled&&!O.states.groupDisabled),b=g.find(O=>O.created),L=g[0];e.hoverIndex=nt(R.value,b||L)},te=()=>{var g;if(s.multiple)e.selectedLabel="";else{const L=ve(s.modelValue);(g=L.props)!=null&&g.created?(e.createdLabel=L.props.value,e.createdSelected=!0):e.createdSelected=!1,e.selectedLabel=L.currentLabel,e.selected=L,s.filterable&&(e.query=e.selectedLabel);return}const b=[];Array.isArray(s.modelValue)&&s.modelValue.forEach(L=>{b.push(ve(L))}),e.selected=b,Y(()=>{I()})},ve=g=>{let b;const L=Ps(g).toLowerCase()==="object",O=Ps(g).toLowerCase()==="null",ie=Ps(g).toLowerCase()==="undefined";for(let Ve=e.cachedOptions.size-1;Ve>=0;Ve--){const Ce=V.value[Ve];if(L?Ee(Ce.value,s.valueKey)===Ee(g,s.valueKey):Ce.value===g){b={value:g,currentLabel:Ce.currentLabel,isDisabled:Ce.isDisabled};break}}if(b)return b;const le=L?g.label:!O&&!ie?g:"",Ke={value:g,currentLabel:le};return s.multiple&&(Ke.hitState=!1),Ke},Ye=()=>{setTimeout(()=>{const g=s.valueKey;s.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map(b=>R.value.findIndex(L=>Ee(L,g)===Ee(b,g)))):e.hoverIndex=-1:e.hoverIndex=R.value.findIndex(b=>Ct(b)===Ct(e.selected))},300)},Xe=()=>{var g,b;Et(),(b=(g=l.value)==null?void 0:g.updatePopper)==null||b.call(g),s.multiple&&I()},Et=()=>{var g;e.inputWidth=(g=i.value)==null?void 0:g.$el.offsetWidth},_e=()=>{s.filterable&&e.query!==e.selectedLabel&&(e.query=e.selectedLabel,he(e.query))},Jt=As(()=>{_e()},H.value),Lt=As(g=>{he(g.target.value)},H.value),xe=g=>{io(s.modelValue,g)||o.emit(qs,g)},Re=g=>{if(g.code!==ao.delete){if(g.target.value.length<=0&&!dt()){const b=s.modelValue.slice();b.pop(),o.emit(ue,b),xe(b)}g.target.value.length===1&&s.modelValue.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}},bt=(g,b)=>{const L=e.selected.indexOf(b);if(L>-1&&!k.value){const O=s.modelValue.slice();O.splice(L,1),o.emit(ue,O),xe(O),o.emit("remove-tag",b.value)}g.stopPropagation()},at=g=>{g.stopPropagation();const b=s.multiple?[]:"";if(!st(b))for(const L of e.selected)L.isDisabled&&b.push(L.value);o.emit(ue,b),xe(b),e.hoverIndex=-1,e.visible=!1,o.emit("clear")},Ge=(g,b)=>{var L;if(s.multiple){const O=(s.modelValue||[]).slice(),ie=nt(O,g.value);ie>-1?O.splice(ie,1):(s.multipleLimit<=0||O.length<s.multipleLimit)&&O.push(g.value),o.emit(ue,O),xe(O),g.created&&(e.query="",he(""),e.inputLength=20),s.filterable&&((L=r.value)==null||L.focus())}else o.emit(ue,g.value),xe(g.value),e.visible=!1;e.isSilentBlur=b,lt(),!e.visible&&Y(()=>{Pe(g)})},nt=(g=[],b)=>{if(!kt(b))return g.indexOf(b);const L=s.valueKey;let O=-1;return g.some((ie,le)=>hs(Ee(ie,L))===Ee(b,L)?(O=le,!0):!1),O},lt=()=>{e.softFocus=!0;const g=r.value||i.value;g&&(g==null||g.focus())},Pe=g=>{var b,L,O,ie,le;const Ke=Array.isArray(g)?g[0]:g;let Ve=null;if(Ke!=null&&Ke.value){const Ce=R.value.filter(Ts=>Ts.value===Ke.value);Ce.length>0&&(Ve=Ce[0].$el)}if(l.value&&Ve){const Ce=(ie=(O=(L=(b=l.value)==null?void 0:b.popperRef)==null?void 0:L.contentRef)==null?void 0:O.querySelector)==null?void 0:ie.call(O,`.${a.be("dropdown","wrap")}`);Ce&&Hn(Ce,Ve)}(le=d.value)==null||le.handleScroll()},Rt=g=>{e.optionsCount++,e.filteredOptionsCount++,e.options.set(g.value,g),e.cachedOptions.set(g.value,g)},wt=(g,b)=>{e.options.get(g)===b&&(e.optionsCount--,e.filteredOptionsCount--,e.options.delete(g))},Bt=g=>{g.code!==ao.backspace&&dt(!1),e.inputLength=r.value.value.length*15+20,I()},dt=g=>{if(!Array.isArray(e.selected))return;const b=e.selected[e.selected.length-1];if(b)return g===!0||g===!1?(b.hitState=g,g):(b.hitState=!b.hitState,b.hitState)},$t=g=>{const b=g.target.value;if(g.type==="compositionend")e.isOnComposition=!1,Y(()=>he(b));else{const L=b[b.length-1]||"";e.isOnComposition=!sr(L)}},St=()=>{Y(()=>Pe(e.selected))},At=g=>{e.softFocus?e.softFocus=!1:((s.automaticDropdown||s.filterable)&&(s.filterable&&!e.visible&&(e.menuVisibleOnFocus=!0),e.visible=!0),o.emit("focus",g))},Me=()=>{var g,b,L;e.visible=!1,(g=i.value)==null||g.blur(),(L=(b=n.value)==null?void 0:b.blur)==null||L.call(b)},S=g=>{Y(()=>{e.isSilentBlur?e.isSilentBlur=!1:o.emit("blur",g)}),e.softFocus=!1},W=g=>{at(g)},pe=()=>{e.visible=!1},Qe=g=>{e.visible&&(g.preventDefault(),g.stopPropagation(),e.visible=!1)},ut=g=>{var b;g&&!e.mouseEnter||k.value||(e.menuVisibleOnFocus?e.menuVisibleOnFocus=!1:(!l.value||!l.value.isFocusInsideContent())&&(e.visible=!e.visible),e.visible&&((b=r.value||i.value)==null||b.focus()))},Bs=()=>{e.visible?R.value[e.hoverIndex]&&Ge(R.value[e.hoverIndex],void 0):ut()},Ct=g=>kt(g.value)?Ee(g.value,s.valueKey):g.value,Ss=T(()=>R.value.filter(g=>g.visible).every(g=>g.disabled)),Cs=T(()=>e.selected.slice(0,s.maxCollapseTags)),Dt=T(()=>e.selected.slice(s.maxCollapseTags)),It=g=>{if(!e.visible){e.visible=!0;return}if(!(e.options.size===0||e.filteredOptionsCount===0)&&!e.isOnComposition&&!Ss.value){g==="next"?(e.hoverIndex++,e.hoverIndex===e.options.size&&(e.hoverIndex=0)):g==="prev"&&(e.hoverIndex--,e.hoverIndex<0&&(e.hoverIndex=e.options.size-1));const b=R.value[e.hoverIndex];(b.disabled===!0||b.states.groupDisabled===!0||!b.visible)&&It(g),Y(()=>Pe(f.value))}};return{optionList:p,optionsArray:R,selectSize:me,handleResize:Xe,debouncedOnInputChange:Jt,debouncedQueryChange:Lt,deletePrevTag:Re,deleteTag:bt,deleteSelected:at,handleOptionSelect:Ge,scrollToOption:Pe,readonly:B,resetInputHeight:I,showClose:G,iconComponent:D,iconReverse:F,showNewOption:j,collapseTagSize:J,setSelected:te,managePlaceholder:Le,selectDisabled:k,emptyText:q,toggleLastOptionHitState:dt,resetInputState:Bt,handleComposition:$t,onOptionCreate:Rt,onOptionDestroy:wt,handleMenuEnter:St,handleFocus:At,blur:Me,handleBlur:S,handleClearClick:W,handleClose:pe,handleKeydownEscape:Qe,toggleMenu:ut,selectOption:Bs,getValueKey:Ct,navigateOptions:It,dropMenuVisible:ne,queryChange:y,groupQueryChange:v,showTagList:Cs,collapseTagList:Dt,reference:i,input:r,iOSInput:n,tooltipRef:l,tags:u,selectWrapper:c,scrollbar:d,handleMouseEnter:()=>{e.mouseEnter=!0},handleMouseLeave:()=>{e.mouseEnter=!1}}};var Bd=U({name:"ElOptions",emits:["update-options"],setup(s,{slots:e,emit:o}){let t=[];function a(i,r){if(i.length!==r.length)return!1;for(const[n]of i.entries())if(i[n]!=r[n])return!1;return!0}return()=>{var i,r;const n=(i=e.default)==null?void 0:i.call(e),l=[];function u(c){Array.isArray(c)&&c.forEach(d=>{var f,y,v,p;const x=(f=(d==null?void 0:d.type)||{})==null?void 0:f.name;x==="ElOptionGroup"?u(!st(d.children)&&!Array.isArray(d.children)&&Ie((y=d.children)==null?void 0:y.default)?(v=d.children)==null?void 0:v.default():d.children):x==="ElOption"?l.push((p=d.props)==null?void 0:p.label):Array.isArray(d.children)&&u(d.children)})}return n.length&&u((r=n[0])==null?void 0:r.children),a(l,t)||(t=l,o("update-options",l)),n}}});const Po="ElSelect",Sd=U({name:Po,componentName:Po,components:{ElInput:gr,ElSelectMenu:xd,ElOption:Qs,ElOptions:Bd,ElTag:xi,ElScrollbar:gl,ElTooltip:ir,ElIcon:ke},directives:{ClickOutside:or},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:bi},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},teleported:wi.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ut,default:tr},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:Ut,default:rr},tagType:{...Bi.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:{type:Boolean,default:!1},suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:Si,default:"bottom-start"}},emits:[ue,qs,"remove-tag","clear","visible-change","focus","blur"],setup(s,e){const o=ae("select"),t=ae("input"),{t:a}=Zt(),i=bd(s),{optionList:r,optionsArray:n,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:f,debouncedQueryChange:y,deletePrevTag:v,deleteTag:p,deleteSelected:x,handleOptionSelect:C,scrollToOption:m,setSelected:B,resetInputHeight:k,managePlaceholder:G,showClose:D,selectDisabled:F,iconComponent:H,iconReverse:q,showNewOption:R,emptyText:V,toggleLastOptionHitState:j,resetInputState:me,handleComposition:J,onOptionCreate:ne,onOptionDestroy:I,handleMenuEnter:he,handleFocus:Le,blur:z,handleBlur:te,handleClearClick:ve,handleClose:Ye,handleKeydownEscape:Xe,toggleMenu:Et,selectOption:_e,getValueKey:Jt,navigateOptions:Lt,dropMenuVisible:xe,reference:Re,input:bt,iOSInput:at,tooltipRef:Ge,tags:nt,selectWrapper:lt,scrollbar:Pe,queryChange:Rt,groupQueryChange:wt,handleMouseEnter:Bt,handleMouseLeave:dt,showTagList:$t,collapseTagList:St}=wd(s,i,e),{focus:At}=qn(Re),{inputWidth:Me,selected:S,inputLength:W,filteredOptionsCount:pe,visible:Qe,softFocus:ut,selectedLabel:Bs,hoverIndex:Ct,query:Ss,inputHovering:Cs,currentPlaceholder:Dt,menuVisibleOnFocus:It,isOnComposition:Js,isSilentBlur:Is,options:g,cachedOptions:b,optionsCount:L,prefixWidth:O,tagInMultiLine:ie}=Hs(i),le=T(()=>{const be=[o.b()],ct=h(l);return ct&&be.push(o.m(ct)),s.disabled&&be.push(o.m("disabled")),be}),Ke=T(()=>({maxWidth:`${h(Me)-32}px`,width:"100%"})),Ve=T(()=>({maxWidth:`${h(Me)>123?h(Me)-123:h(Me)-75}px`}));Qt(vs,vt({props:s,options:g,optionsArray:n,cachedOptions:b,optionsCount:L,filteredOptionsCount:pe,hoverIndex:Ct,handleOptionSelect:C,onOptionCreate:ne,onOptionDestroy:I,selectWrapper:lt,selected:S,setSelected:B,queryChange:Rt,groupQueryChange:wt})),ge(()=>{i.cachedPlaceHolder=Dt.value=s.placeholder||(()=>a("el.select.placeholder")),s.multiple&&Array.isArray(s.modelValue)&&s.modelValue.length>0&&(Dt.value=""),gs(lt,c),s.remote&&s.multiple&&k(),Y(()=>{const be=Re.value&&Re.value.$el;if(be&&(Me.value=be.getBoundingClientRect().width,e.slots.prefix)){const ct=be.querySelector(`.${t.e("prefix")}`);O.value=Math.max(ct.getBoundingClientRect().width+5,30)}}),B()}),s.multiple&&!Array.isArray(s.modelValue)&&e.emit(ue,[]),!s.multiple&&Array.isArray(s.modelValue)&&e.emit(ue,"");const Ce=T(()=>{var be,ct;return(ct=(be=Ge.value)==null?void 0:be.popperRef)==null?void 0:ct.contentRef});return{isIOS:Ci,onOptionsRendered:be=>{r.value=be},tagInMultiLine:ie,prefixWidth:O,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:f,debouncedQueryChange:y,deletePrevTag:v,deleteTag:p,deleteSelected:x,handleOptionSelect:C,scrollToOption:m,inputWidth:Me,selected:S,inputLength:W,filteredOptionsCount:pe,visible:Qe,softFocus:ut,selectedLabel:Bs,hoverIndex:Ct,query:Ss,inputHovering:Cs,currentPlaceholder:Dt,menuVisibleOnFocus:It,isOnComposition:Js,isSilentBlur:Is,options:g,resetInputHeight:k,managePlaceholder:G,showClose:D,selectDisabled:F,iconComponent:H,iconReverse:q,showNewOption:R,emptyText:V,toggleLastOptionHitState:j,resetInputState:me,handleComposition:J,handleMenuEnter:he,handleFocus:Le,blur:z,handleBlur:te,handleClearClick:ve,handleClose:Ye,handleKeydownEscape:Xe,toggleMenu:Et,selectOption:_e,getValueKey:Jt,navigateOptions:Lt,dropMenuVisible:xe,focus:At,reference:Re,input:bt,iOSInput:at,tooltipRef:Ge,popperPaneRef:Ce,tags:nt,selectWrapper:lt,scrollbar:Pe,wrapperKls:le,selectTagsStyle:Ke,nsSelect:o,tagTextStyle:Ve,handleMouseEnter:Bt,handleMouseLeave:dt,showTagList:$t,collapseTagList:St}}}),Cd=["disabled","autocomplete"],Td=["disabled"],Pd={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function Md(s,e,o,t,a,i){const r=Ze("el-tag"),n=Ze("el-tooltip"),l=Ze("el-icon"),u=Ze("el-input"),c=Ze("el-option"),d=Ze("el-options"),f=Ze("el-scrollbar"),y=Ze("el-select-menu"),v=zr("click-outside");return De((w(),E("div",{ref:"selectWrapper",class:P(s.wrapperKls),onMouseenter:e[21]||(e[21]=(...p)=>s.handleMouseEnter&&s.handleMouseEnter(...p)),onMouseleave:e[22]||(e[22]=(...p)=>s.handleMouseLeave&&s.handleMouseLeave(...p)),onClick:e[23]||(e[23]=We((...p)=>s.toggleMenu&&s.toggleMenu(...p),["stop"]))},[A(n,{ref:"tooltipRef",visible:s.dropMenuVisible,placement:s.placement,teleported:s.teleported,"popper-class":[s.nsSelect.e("popper"),s.popperClass],"popper-options":s.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:s.effect,pure:"",trigger:"click",transition:`${s.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:s.persistent,onShow:s.handleMenuEnter},{default:$(()=>[N("div",{class:"select-trigger",onMouseenter:e[19]||(e[19]=p=>s.inputHovering=!0),onMouseleave:e[20]||(e[20]=p=>s.inputHovering=!1)},[s.multiple?(w(),E("div",{key:0,ref:"tags",class:P([s.nsSelect.e("tags"),s.nsSelect.is("disabled",s.selectDisabled)]),style:re(s.selectTagsStyle)},[s.collapseTags&&s.selected.length?(w(),K(cs,{key:0,onAfterLeave:s.resetInputHeight},{default:$(()=>[N("span",{class:P([s.nsSelect.b("tags-wrapper"),{"has-prefix":s.prefixWidth&&s.selected.length}])},[(w(!0),E(Ae,null,Kt(s.showTagList,p=>(w(),K(r,{key:s.getValueKey(p),closable:!s.selectDisabled&&!p.isDisabled,size:s.collapseTagSize,hit:p.hitState,type:s.tagType,"disable-transitions":"",onClose:x=>s.deleteTag(x,p)},{default:$(()=>[N("span",{class:P(s.nsSelect.e("tags-text")),style:re(s.tagTextStyle)},ye(p.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),s.selected.length>s.maxCollapseTags?(w(),K(r,{key:0,closable:!1,size:s.collapseTagSize,type:s.tagType,"disable-transitions":""},{default:$(()=>[s.collapseTagsTooltip?(w(),K(n,{key:0,disabled:s.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:s.effect,placement:"bottom",teleported:s.teleported},{default:$(()=>[N("span",{class:P(s.nsSelect.e("tags-text"))},"+ "+ye(s.selected.length-s.maxCollapseTags),3)]),content:$(()=>[N("div",{class:P(s.nsSelect.e("collapse-tags"))},[(w(!0),E(Ae,null,Kt(s.collapseTagList,p=>(w(),E("div",{key:s.getValueKey(p),class:P(s.nsSelect.e("collapse-tag"))},[A(r,{class:"in-tooltip",closable:!s.selectDisabled&&!p.isDisabled,size:s.collapseTagSize,hit:p.hitState,type:s.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:x=>s.deleteTag(x,p)},{default:$(()=>[N("span",{class:P(s.nsSelect.e("tags-text")),style:re({maxWidth:s.inputWidth-75+"px"})},ye(p.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(w(),E("span",{key:1,class:P(s.nsSelect.e("tags-text"))},"+ "+ye(s.selected.length-s.maxCollapseTags),3))]),_:1},8,["size","type"])):_("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):_("v-if",!0),s.collapseTags?_("v-if",!0):(w(),K(cs,{key:1,onAfterLeave:s.resetInputHeight},{default:$(()=>[N("span",{class:P([s.nsSelect.b("tags-wrapper"),{"has-prefix":s.prefixWidth&&s.selected.length}])},[(w(!0),E(Ae,null,Kt(s.selected,p=>(w(),K(r,{key:s.getValueKey(p),closable:!s.selectDisabled&&!p.isDisabled,size:s.collapseTagSize,hit:p.hitState,type:s.tagType,"disable-transitions":"",onClose:x=>s.deleteTag(x,p)},{default:$(()=>[N("span",{class:P(s.nsSelect.e("tags-text")),style:re({maxWidth:s.inputWidth-75+"px"})},ye(p.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],2)]),_:1},8,["onAfterLeave"])),s.filterable?De((w(),E("input",{key:2,ref:"input","onUpdate:modelValue":e[0]||(e[0]=p=>s.query=p),type:"text",class:P([s.nsSelect.e("input"),s.nsSelect.is(s.selectSize),s.nsSelect.is("disabled",s.selectDisabled)]),disabled:s.selectDisabled,autocomplete:s.autocomplete,style:re({marginLeft:s.prefixWidth&&!s.selected.length||s.tagInMultiLine?`${s.prefixWidth}px`:"",flexGrow:1,width:`${s.inputLength/(s.inputWidth-32)}%`,maxWidth:`${s.inputWidth-42}px`}),onFocus:e[1]||(e[1]=(...p)=>s.handleFocus&&s.handleFocus(...p)),onBlur:e[2]||(e[2]=(...p)=>s.handleBlur&&s.handleBlur(...p)),onKeyup:e[3]||(e[3]=(...p)=>s.managePlaceholder&&s.managePlaceholder(...p)),onKeydown:[e[4]||(e[4]=(...p)=>s.resetInputState&&s.resetInputState(...p)),e[5]||(e[5]=Be(We(p=>s.navigateOptions("next"),["prevent"]),["down"])),e[6]||(e[6]=Be(We(p=>s.navigateOptions("prev"),["prevent"]),["up"])),e[7]||(e[7]=Be((...p)=>s.handleKeydownEscape&&s.handleKeydownEscape(...p),["esc"])),e[8]||(e[8]=Be(We((...p)=>s.selectOption&&s.selectOption(...p),["stop","prevent"]),["enter"])),e[9]||(e[9]=Be((...p)=>s.deletePrevTag&&s.deletePrevTag(...p),["delete"])),e[10]||(e[10]=Be(p=>s.visible=!1,["tab"]))],onCompositionstart:e[11]||(e[11]=(...p)=>s.handleComposition&&s.handleComposition(...p)),onCompositionupdate:e[12]||(e[12]=(...p)=>s.handleComposition&&s.handleComposition(...p)),onCompositionend:e[13]||(e[13]=(...p)=>s.handleComposition&&s.handleComposition(...p)),onInput:e[14]||(e[14]=(...p)=>s.debouncedQueryChange&&s.debouncedQueryChange(...p))},null,46,Cd)),[[Hr,s.query]]):_("v-if",!0)],6)):_("v-if",!0),_(" fix: https://github.com/element-plus/element-plus/issues/11415 "),s.isIOS&&!s.multiple&&s.filterable&&s.readonly?(w(),E("input",{key:1,ref:"iOSInput",class:P([s.nsSelect.e("input"),s.nsSelect.is(s.selectSize),s.nsSelect.em("input","iOS")]),disabled:s.selectDisabled,type:"text"},null,10,Td)):_("v-if",!0),A(u,{id:s.id,ref:"reference",modelValue:s.selectedLabel,"onUpdate:modelValue":e[15]||(e[15]=p=>s.selectedLabel=p),type:"text",placeholder:typeof s.currentPlaceholder=="function"?s.currentPlaceholder():s.currentPlaceholder,name:s.name,autocomplete:s.autocomplete,size:s.selectSize,disabled:s.selectDisabled,readonly:s.readonly,"validate-event":!1,class:P([s.nsSelect.is("focus",s.visible)]),tabindex:s.multiple&&s.filterable?-1:void 0,onFocus:s.handleFocus,onBlur:s.handleBlur,onInput:s.debouncedOnInputChange,onPaste:s.debouncedOnInputChange,onCompositionstart:s.handleComposition,onCompositionupdate:s.handleComposition,onCompositionend:s.handleComposition,onKeydown:[e[16]||(e[16]=Be(We(p=>s.navigateOptions("next"),["stop","prevent"]),["down"])),e[17]||(e[17]=Be(We(p=>s.navigateOptions("prev"),["stop","prevent"]),["up"])),Be(We(s.selectOption,["stop","prevent"]),["enter"]),Be(s.handleKeydownEscape,["esc"]),e[18]||(e[18]=Be(p=>s.visible=!1,["tab"]))]},Wo({suffix:$(()=>[s.iconComponent&&!s.showClose?(w(),K(l,{key:0,class:P([s.nsSelect.e("caret"),s.nsSelect.e("icon"),s.iconReverse])},{default:$(()=>[(w(),K(je(s.iconComponent)))]),_:1},8,["class"])):_("v-if",!0),s.showClose&&s.clearIcon?(w(),K(l,{key:1,class:P([s.nsSelect.e("caret"),s.nsSelect.e("icon")]),onClick:s.handleClearClick},{default:$(()=>[(w(),K(je(s.clearIcon)))]),_:1},8,["class","onClick"])):_("v-if",!0)]),_:2},[s.$slots.prefix?{name:"prefix",fn:$(()=>[N("div",Pd,[ee(s.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]),content:$(()=>[A(y,null,{default:$(()=>[De(A(f,{ref:"scrollbar",tag:"ul","wrap-class":s.nsSelect.be("dropdown","wrap"),"view-class":s.nsSelect.be("dropdown","list"),class:P([s.nsSelect.is("empty",!s.allowCreate&&!!s.query&&s.filteredOptionsCount===0)])},{default:$(()=>[s.showNewOption?(w(),K(c,{key:0,value:s.query,created:!0},null,8,["value"])):_("v-if",!0),A(d,{onUpdateOptions:s.onOptionsRendered},{default:$(()=>[ee(s.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["wrap-class","view-class","class"]),[[mt,s.options.size>0&&!s.loading]]),s.emptyText&&(!s.allowCreate||s.loading||s.allowCreate&&s.options.size===0)?(w(),E(Ae,{key:0},[s.$slots.empty?ee(s.$slots,"empty",{key:0}):(w(),E("p",{key:1,class:P(s.nsSelect.be("dropdown","empty"))},ye(s.emptyText),3))],64)):_("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[v,s.handleClose,s.popperPaneRef]])}var Nd=ce(Sd,[["render",Md],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const Fd=U({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(s){const e=ae("select"),o=M(!0),t=Ue(),a=M([]);Qt(wr,vt({...Hs(s)}));const i=rt(vs);ge(()=>{a.value=r(t.subTree)});const r=l=>{const u=[];return Array.isArray(l.children)&&l.children.forEach(c=>{var d;c.type&&c.type.name==="ElOption"&&c.component&&c.component.proxy?u.push(c.component.proxy):(d=c.children)!=null&&d.length&&u.push(...r(c))}),u},{groupQueryChange:n}=hs(i);return X(n,()=>{o.value=a.value.some(l=>l.visible===!0)},{flush:"post"}),{visible:o,ns:e}}});function Ed(s,e,o,t,a,i){return De((w(),E("ul",{class:P(s.ns.be("group","wrap"))},[N("li",{class:P(s.ns.be("group","title"))},ye(s.label),3),N("li",null,[N("ul",{class:P(s.ns.b("group"))},[ee(s.$slots,"default")],2)])],2)),[[mt,s.visible]])}var Br=ce(Fd,[["render",Ed],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const Ld=Ft(Nd,{Option:Qs,OptionGroup:Br}),Rd=ar(Qs);ar(Br);class $d extends xt{constructor(e,o){super(),this.x=0,this.y=0,this.w=20,this.h=14,this.fillStyle="#eeb174",this.strokeStyle="#333",this.ctx=e,this.analysisOptions(o)}analysisOptions(e){e.x&&(this.x=e.x),e.y&&(this.y=e.y),e.w&&(this.w=e.w),e.h&&(this.h=e.h),e.fillStyle&&(this.fillStyle=e.fillStyle),e.strokeStyle&&(this.strokeStyle=e.strokeStyle),e.tiggerFunc&&(this.tiggerFunc=e.tiggerFunc)}draw(){const{ctx:e,x:o,y:t,w:a,h:i,fillStyle:r,strokeStyle:n}=this;e.save(),e.fillStyle=r,e.strokeStyle=n,e.lineWidth=3,e.beginPath(),e.arc(o+a/2,t-3,a/3,0,Math.PI,!0),e.stroke(),e.drawRoundedRect(o,t,a,i,2,2,2,2,!0,!0,!1,!1),e.restore()}containsPoint(e,o=!1){var f;const{x:t,y:a,w:i,h:r}=this,{x:n,y:l}=e,u=this.getImageLines({tl:{x:t,y:a},tr:{x:t+i,y:a},bl:{x:t,y:a+r},br:{x:t+i,y:a+r}}),d=!!(this.findCrossPoints(n,l,u)%2);return d&&o&&((f=this.tiggerFunc)==null||f.call(this)),d}}const Ad=function(s){return s.length===4&&(s=s.slice(0,2)+s.slice(1,2)+s.slice(2,3)+s.slice(2,3)+s.slice(3,4)+s.slice(3,4)),"rgb("+parseInt("0x"+s.slice(1,3))+","+parseInt("0x"+s.slice(3,5))+","+parseInt("0x"+s.slice(5,7))+")"},Dd=function(s){const o=(s.includes("rgb")?s:Ad(s)).replace(/rgb\(|rgba\(|\)/g,"").split(",");return .213*o[0]+.715*o[1]+.072*o[2]>255/2},zd="L";function Je(){return((1+Math.random())*65536|0).toString(16).substring(1)}function Hd(){return`${zd}${Je()}${Je()}-${Je()}-${Je()}-${Je()}-${Je()}${Je()}${Je()}`}class de extends xt{constructor(e,o){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=12,this.padding=10,this.attrHeight=14,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.bgColor="#FFFFFF",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o,y:t,width:a,height:i,id:r,enName:n,cnName:l,type:u,attributes:c,bgC:d,bdC:f,quotePrimaryKey:y,physicalTables:v,manualChange:p,activeAttributeId:x}=e;Te(o)&&(this.x=o),Te(t)&&(this.y=t),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),Te(a)&&(this.width=a),Te(i)&&(this.height=i),u&&(this.type=u),x&&(this.activeAttributeId=x),c&&(this.attributes=c,this.attributesPartition()),d&&(this.bgColor=d),f&&(this.borderColor=f),Pt(y)&&(this.quotePrimaryKey=y),Pt(v)&&(this.physicalTables=v),Pt(p)&&(this.manualChange=p)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){var p;const{x:o,y:t}=e,{x:a,y:i,width:r,height:n,attrHeight:l}=this,u=this.getImageLines({tl:{x:a,y:i},tr:{x:a+r,y:i},bl:{x:a,y:i+n},br:{x:a+r,y:i+n}});if(!!!(this.findCrossPoints(o,t,u)%2))return!1;const f=t-i-this.padding-(this.attributesPrimary.length?0:l),y=Math.floor(f/l);return((p=[...this.attributesPrimary,{},...this.attributesPrimaryNon][y])==null?void 0:p.id)??!0}draw(e){this.updateOptions(e),this.drawContainer(),this.drawTitle(),this.drawbody()}drawContainer(){const{ctx:e,x:o,y:t,width:a,height:i,type:r,bgColor:n,borderColor:l,quotePrimaryKey:u,physicalTables:c}=this;if(e.save(),e.strokeStyle=l,e.fillStyle=n,["exclusive","inclusive"].includes(r))e.beginPath(),e.arc(o+a/2,t+a/2,a/2,0,Math.PI,!0),e.closePath(),e.fill(),e.stroke(),r==="exclusive"&&(e.moveTo(o+12,t+6),e.lineTo(o+a-12,t+i-3),e.moveTo(o+a-12,t+6),e.lineTo(o+12,t+i-3),e.stroke());else{const d=u?4:0;e.drawRoundedRect(o,t,a,i,d,d,d,d,!0,!0,c,!0)}e.restore()}drawDataType(e,o,t){const a=e==null?void 0:e.toLocaleUpperCase();let i;a in Ti?i=Ms.get("date"):a in Pi?i=Ms.get("number"):a in Mi&&(i=Ms.get("string"));const{ctx:r}=this;if(!i)return r.save(),r.fillStyle="#808080",r.fillText("?",o,t,this.fontSize),r.restore(),!1;r.drawImage(i,o,t,this.fontSize,this.fontSize)}drawTitle(){const{ctx:e,textColor:o,enName:t,width:a,x:i,y:r,titleHeight:n,fontSize:l}=this;e.save(),e.font=`${l}px`,e.fillStyle=o,e.textAlign="left",e.textBaseline="top",e.fillText(e.fittingString(t,a-14),i,r-n),e.restore()}drawbody(){const{ctx:e,x:o,y:t,bgColor:a,fontSize:i,padding:r,attrHeight:n,attributesPrimary:l,attributesPrimaryNon:u}=this;e.save(),e.font=`${i}px Arial`,e.fillStyle=Dd(a)?"#000":"#fff",e.textAlign="left",e.textBaseline="top";const c=r+o;let d=t+r-n;for(let f=0;f<l.length;f++){const y=l[f];d=this.drawAttrRow(y,c,d)}d=this.drawSplitLine(d);for(let f=0;f<u.length;f++){const y=u[f];d=this.drawAttrRow(y,c,d)}e.restore()}drawAttrRow(e,o,t){var x;const{ctx:a,attrHeight:i,padding:r,fontSize:n,x:l,y:u,width:c,height:d,attrFocusStyle:f}=this;if(t+=i,t+16>d+u)return;this.activeAttributeId===e.id&&(a.save(),a.fillStyle=f.backgroundColor,a.fillRect(o+n,t-1,c-(o-l)-r-n,i),a.restore()),this.drawDataType(e.type,o,t);const y=e.foreignKey?"(FK)":"",v=a.fittingString(e.name+y,c-(o-l)-r-n);a.fillText(v,o+n,t);const p=o+a.measureText(v).width+n;if(this.drawIcons(e.icons,p,t),(x=e.children)!=null&&x.length){const C=this.expandAttrs.includes(e);this.drawTreeExpandArrow.call(this,{x:o,y:t,size:n,expand:C}),C&&e.children.forEach(m=>{t=this.drawAttrRow(m,o+10,t)})}return t}drawIcons(e=[],o,t){const{fontSize:a,x:i,width:r,padding:n}=this;for(let l=0;l<e.length;l++){const u=e[l],c=o+a*.7+l*(a*1.2);if(c+a/2*3>i+r+n)return;this.drawIcon(u,c,t)}}drawIcon(e,o,t){const{ctx:a,attrHeight:i,fontSize:r}=this;a.save(),a.beginPath(),a.strokeStyle=e.bdC||"#0C64EB",a.fillStyle=e.bgC||"#ECF5FF",a.arc(o,t+Math.floor(i/2)-1,r/2,0,2*Math.PI),a.fill(),a.stroke(),a.fillStyle=e.color||"#0C64EB",a.font=`${Math.ceil(r/1.2)}px Arial`,a.textAlign="center",a.fillText(e.text,o,t+(i-r)/2+1),a.restore()}drawSplitLine(e){const{ctx:o,attributesPrimary:t,attrHeight:a,x:i,y:r,width:n,height:l}=this;return e+=(t.length?1:2)*a,o.save(),e<l+r&&(o.beginPath(),o.strokeStyle="#000",o.moveTo(i+.5,e+a/3+.5),o.lineTo(i+n+.5,e+a/3+.5),o.stroke()),o.restore(),e}drawTreeExpandArrow({x:e,y:o,size:t,expand:a}){const{ctx:i}=this;i.save(),i.beginPath(),i.translate(e-4,o+t/2),a&&i.rotate(90*Math.PI/180),i.moveTo(-2,-4),i.lineTo(-2,4),i.lineTo(2,0),i.fill(),i.restore()}drawFocusAttr({attrItem:e,finalText:o,curX:t,curY:a,fullWidth:i,nodePadding:r}){var d,f;const{ctx:n,attrFocusStyle:l}=this,u=(d=e==null?void 0:e.children)!=null&&d.length?t:t-r/2,c=(f=e==null?void 0:e.children)!=null&&f.length?i-r/2:i;n.save(),n.fillStyle=l.backgroundColor,n.fillRect(u,a-1,c,16),n.fillStyle=l.color,n.fillText(o,t,a),n.restore()}attributesPartition(){this.attributesPrimary=[],this.attributesPrimaryNon=[];const{attributes:e,attributesPrimary:o,attributesPrimaryNon:t}=this;for(let a=0;a<e.length;a++){const i=e[a];i.primaryKey?o.push(i):t.push(i),i.id||(i.id=Hd())}}getAttributeInfo(e){const{attributesPrimary:o,attributesPrimaryNon:t,x:a,y:i,width:r,height:n,padding:l,attrHeight:u}=this,c=[...o,{id:null},...t],d=c.findIndex(y=>y.id===e);return{x:a+l,y:i+l+(o.length?d:d+1)*u,width:r-2*l,height:u,info:c[d]}}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}class qe extends xt{constructor(e,o){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=16,this.padding=10,this.attrHeight=16,this.borderWidth=1,this.datatypeIconWidth=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.borderColor="#000000",this.textColor="#000000",this.hoverColor="#477DE9",this.attrFocusStyle={color:"#fff",backgroundColor:"#0000ff"},this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=e,this.analysisOptions(o),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{x:o,y:t,width:a,height:i,id:r,enName:n,cnName:l,type:u,bgC:c,bdC:d,quotePrimaryKey:f,physicalTables:y,manualChange:v}=e;Te(o)&&(this.x=o),Te(t)&&(this.y=t),r&&(this.id=r),n&&(this.enName=n),l&&(this.cnName=l),Te(a)&&(this.width=a),Te(i)&&(this.height=i),u&&(this.type=u),c&&(this.bgColor=c),d&&(this.borderColor=d),Pt(f)&&(this.quotePrimaryKey=f),Pt(y)&&(this.physicalTables=y),Pt(v)&&(this.manualChange=v)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:o,y:t}=e,{x:a,y:i,width:r,height:n}=this,l=this.getImageLines({tl:{x:a,y:i},tr:{x:a+r,y:i},bl:{x:a,y:i+n},br:{x:a+r,y:i+n}});return!!(this.findCrossPoints(o,t,l)%2)}draw(e){this.analysisOptions(e),this.drawRect()}drawRect(){const{ctx:e,x:o,y:t,width:a,height:i,bgColor:r,borderColor:n}=this;e.save(),e.lineWidth=2.5,e.strokeStyle=n||"#000000",e.fillStyle=r||"#ffffff",e.drawRoundedRect(o,t,a,i,0,0,0,0,!!r,!0,!1,!1),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}const Mo=(s,e,o=0)=>{const{x:t,y:a}=s,i=o||0,r=o||0;for(let n=0;n<e.length-1;n++){const l=e[n],u=e[n+1],c=l.y-u.y,d=u.x-l.x,f=l.x*u.y-u.x*l.y;if(Math.abs(c*t+d*a+f)/Math.sqrt(c*c+d*d)<=i&&t>=Math.min(l.x,u.x)-i&&t<=Math.max(l.x,u.x)+i&&a>=Math.min(l.y,u.y)-r&&a<=Math.max(l.y,u.y)+r)return n}return!1};class Se extends xt{constructor(e,o){super(),this.pos=[],this.lineWidth=1,this.strokeStyle="#000000",this.ctx=e,this.analysisOptions(o),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{pos:o,type:t,from:a,to:i,id:r,lineWidth:n,numLineTypes:l,strokeStyle:u}=e;r&&(this.id=r),a&&(this.from=a),i&&(this.to=i),o&&(this.pos=o),t&&(this.type=t),l&&(this.numLineTypes=l),n&&(this.lineWidth=n),u&&(this.strokeStyle=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}draw(e){this.analysisOptions(e),this.drawLine(),this.drawEnds(),this.drawNote()}containsPoint(e){const{pos:o}=this;return Te(Mo(e,o,5))}getIndexInPos(e){return Mo(e,this.pos,5)}drawLine(){const{ctx:e,strokeStyle:o,lineWidth:t,type:a,pos:i}=this;e.save(),e.strokeStyle=o,e.lineWidth=t,a==="foreignKey"&&e.setLineDash([8,5]),i.forEach((r,n)=>{n===0?(e.beginPath(),e.moveTo(r.x,r.y)):e.lineTo(r.x,r.y)}),e.stroke(),e.restore()}drawEnds(){const{ctx:e,pos:o,strokeStyle:t,lineWidth:a,numLineTypes:i}=this,r=15,n=o.length||0;if(!(n<2)){if(e.save(),e.beginPath(),e.setLineDash([0,0]),e.strokeStyle=t,e.lineWidth=a,o[0].x===o[1].x){const l=o[1].y-o[0].y,u=Math.abs(l)<10?l<0?o[0].y-1:o[0].y+1:l<0?o[0].y-10:o[0].y+10;e.moveTo(o[0].x-r/2,u),e.lineTo(o[0].x+r/2,u)}else{const l=o[1].x-o[0].x,u=Math.abs(l)<10?l<0?o[0].x-1:o[0].x+1:l<0?o[0].x-10:o[0].x+10;e.moveTo(u,o[0].y-r/2),e.lineTo(u,o[0].y+r/2)}if(o[n-2].x===o[n-1].x){const l=o[n-1].y-o[n-2].y,u=Math.abs(l)<10?l<0?o[n-1].y+1:o[n-1].y-1:l<0?o[n-1].y+10:o[n-1].y-10;if(e.moveTo(o[n-1].x-r/2,u),e.lineTo(o[n-1].x+r/2,u),e.stroke(),[1,2].includes(i)&&(e.moveTo(o[n-1].x-r/2,o[n-1].y),e.lineTo(o[n-1].x,u),e.lineTo(o[n-1].x+r/2,o[n-1].y),e.stroke()),[1,4].includes(i)){e.beginPath();const c=o[n-1].x,d=l<0?u+r/2:u-r/2;e.arc(c,d,(r-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}else{const l=o[n-1].x-o[n-2].x,u=Math.abs(l)<10?l<0?o[n-1].x+1:o[n-1].x-1:l<0?o[n-1].x+10:o[n-1].x-10;if(e.moveTo(u,o[n-1].y-r/2),e.lineTo(u,o[n-1].y+r/2),e.stroke(),[1,2].includes(i)&&(e.moveTo(o[n-1].x,o[n-1].y-r/2),e.lineTo(u,o[n-1].y),e.lineTo(o[n-1].x,o[n-1].y+r/2),e.stroke()),[1,4].includes(i)){e.beginPath();const c=l<0?u+r/2:u-r/2,d=o[n-1].y;e.arc(c,d,(r-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}e.restore()}}drawNote(){const{ctx:e,pos:o,remark:t}=this;if(!t)return;const a=Math.floor(o.length/2)-1;let i,r,n;o[a].y===o[a+1].y?(n=!1,i=Math.abs(o[a+1].x-o[a].x)/2+Math.min(o[a+1].x,o[a].x),r=o[a].y-10):(n=!0,i=o[a].x+10,r=Math.abs(o[a+1].y-o[a].y)/2+Math.min(o[a+1].y,o[a].y)-e.measureText(t).width/2),e.textAlign="center",n?e.fillRowText(t,i,r,16,16):e.fillText(t,i,r)}calcBoundingBox(){const{pos:e}=this,o=[],t=[];for(let a=0;a<e.length;a++){const i=e[a];o.push(i.x),t.push(i.y)}this.boundingBox=[[Math.min(...o),Math.min(...t)],[Math.max(...o),Math.max(...t)]]}}const Od=(s,e=-1/0,o=1/0)=>Math.max(Math.min(s,o),e);class _d{constructor(e){this.originData={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},this.originDataMap=new Map,this.update(e),this.mountAutoUpdate()}update(e){this.analysisOptions(e)}analysisOptions(e){const{data:o={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},context:t}=e;t&&(this.context=t),this.originData=o,this.initMap()}initMap(){const{originData:{nodeDataArray:e=[],linkDataArray:o=[],markDataArray:t=[],noteDataArray:a=[]},originDataMap:i}=this;i.clear();for(let r=0;r<e.length;r++){const n=e[r];i.set(n.id,n)}for(let r=0;r<o.length;r++){const n=o[r];i.set(n.id,n)}for(let r=0;r<t.length;r++){const n=t[r];i.set(n.id,n)}for(let r=0;r<a.length;r++){const n=a[r];i.set(n.id,n)}}mountAutoUpdate(){const{originDataMap:e,context:o}=this;o.on("node:move",t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height}),o.on("node:resize",t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height}),o.on("line:move",t=>{const a=e.get(t.id);a.pos=t.pos}),o.on("note:move",t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y}),o.on("mark:move",t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height}),o.on("mark:resize",t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height})}unmountAutoUpdate(){const{context:e}=this;e.off()}freeVariable(){this.originData=null,this.originDataMap=null}destroy(){this.unmountAutoUpdate(),this.freeVariable()}}class ot extends xt{constructor(e,o){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.borderColor="#0C64EB",this.textColor="#0C64EB",this.bgColor="#D0E2FF",this.borderWidth=1,this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o=0,y:t=0,id:a,borderColor:i,textColor:r,bgColor:n,borderWidth:l,content:u}=e;Te(o)&&(this.x=o),Te(t)&&(this.y=t),a&&(this.id=a),i&&(this.borderColor=i),r&&(this.textColor=r),n&&(this.bgColor=n),Te(l)&&(this.borderWidth=l),u&&(this.content=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:o,y:t}=e,{x:a,y:i,width:r,height:n}=this;return o>=a&&o<=a+r&&t>=i&&t<=i+n}draw(e){this.updateOptions(e);const{ctx:o,content:t,x:a,y:i,textColor:r}=this;o.save(),o.textBaseline="top",o.fillStyle=r,o.fillText(t,a,i),o.restore()}calcBoundingBox(){const{x:e,y:o,ctx:t,content:a}=this,i=t.measureText(a),r=this.width=i.width,n=this.height=i.actualBoundingBoxAscent+i.actualBoundingBoxDescent;this.boundingBox=[[e,o],[e+r,o],[e,o+n],[e+r,o+n]]}}class Kd extends xt{constructor(e,o){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=1,this.borderColor="blue",this.targetWidth=6,this.targetBgColor="#FFFFFF",this.targetBdColor="#B4B4B4",this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o=0,y:t=0,width:a,height:i,targetBgColor:r,targetBdColor:n,bdC:l,lineWidth:u}=e;o&&(this.x=o),t&&(this.y=t),a&&(this.width=a),i&&(this.height=i),r&&(this.targetBgColor=r),n&&(this.targetBdColor=n),l&&(this.borderColor=l),u&&(this.lineWidth=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return!1}draw(e){this.updateOptions(e),this.drawBorder(),this.drawTargets()}drawBorder(){const{ctx:e,borderColor:o,lineWidth:t,x:a,y:i,width:r,height:n}=this;e.save(),e.lineWidth=t,e.strokeStyle=o,e.strokeRect(a,i,r,n),e.restore()}drawTargets(){const{ctx:e,targetBdColor:o,targetBgColor:t,targetWidth:a,x:i,y:r,width:n,height:l}=this,u=a/2,c=i-u,d=r-u;e.save(),e.strokeStyle=o,e.fillStyle=t,e.fillRect(c,d,a,a),e.fillRect(c,d+l/2,a,a),e.fillRect(c,d+l,a,a),e.fillRect(c+n/2,d,a,a),e.fillRect(c+n/2,d+l,a,a),e.fillRect(c+n,d,a,a),e.fillRect(c+n,d+l/2,a,a),e.fillRect(c+n,d+l,a,a),e.strokeRect(c,d,a,a),e.strokeRect(c,d+l/2,a,a),e.strokeRect(c,d+l,a,a),e.strokeRect(c+n/2,d,a,a),e.strokeRect(c+n/2,d+l,a,a),e.strokeRect(c+n,d,a,a),e.strokeRect(c+n,d+l/2,a,a),e.strokeRect(c+n,d+l,a,a),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}class Vd extends xt{constructor(e,o){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=2,this.borderColor="blue",this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o=0,y:t=0,width:a,height:i,bdC:r,lineWidth:n}=e;o&&(this.x=o),t&&(this.y=t),a&&(this.width=a),i&&(this.height=i),r&&(this.borderColor=r),r&&(this.lineWidth=n)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return!1}draw(e){this.updateOptions(e),this.drawBorder()}drawBorder(){const{ctx:e,borderColor:o,lineWidth:t,x:a,y:i,width:r,height:n}=this;e.save(),e.lineWidth=t,e.strokeStyle=o,e.strokeRect(a,i,r,n),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}var oe=(s=>(s.None="",s.addNode="addNode",s.primaryKey="primaryKey",s.foreignKey="foreignKey",s.branchLine="branchLine",s.addMark="addMark",s.addNote="addNote",s.copy="copy",s))(oe||{}),se=(s=>(s.NONE="",s.LT="LT",s.TM="TM",s.RT="RT",s.LM="LM",s.RM="RM",s.LB="LB",s.BM="BM",s.RB="RB",s))(se||{}),Z=(s=>(s.default="default",s.none="none",s.wait="wait",s.progress="progress",s.crosshair="crosshair",s.cell="cell",s.text="text",s.move="move",s.colResize="col-resize",s.rowResize="row-resize",s.ewResize="ew-resize",s.nsResize="ns-resize",s.neswResize="nesw-resize",s.nwseResize="nwse-resize",s.copy="copy",s.help="help",s.grab="grab",s.grabbing="grabbing",s.pointer="pointer",s.notAllowed="not-allowed",s.zoomIn="zoom-in",s.zoomOut="zoom-out",s.contextMenu="context-menu",s))(Z||{}),zs=(s=>(s.Summary="summary",s.Simple="simple",s.Normal="normal",s.Detail="detail",s))(zs||{});const Sr=(s,e)=>{if(!(s instanceof de||s instanceof qe))return!1;const{x:t,y:a,width:i,height:r}=s,n=t+i/2,l=a+r/2,u=t+i,c=a+r,d=5;let f=se.NONE;return Math.abs(t-e.x)<=d&&Math.abs(a-e.y)<=d?f=se.LT:Math.abs(n-e.x)<=d&&Math.abs(a-e.y)<=d?f=se.TM:Math.abs(u-e.x)<=d&&Math.abs(a-e.y)<=d?f=se.RT:Math.abs(t-e.x)<=d&&Math.abs(l-e.y)<=d?f=se.LM:Math.abs(u-e.x)<=d&&Math.abs(l-e.y)<=d?f=se.RM:Math.abs(t-e.x)<=d&&Math.abs(c-e.y)<=d?f=se.LB:Math.abs(n-e.x)<=d&&Math.abs(c-e.y)<=d?f=se.BM:Math.abs(u-e.x)<=d&&Math.abs(c-e.y)<=d&&(f=se.RB),f},Wd=function(s,e){const o=()=>{const{eventObj:d}=this,f={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},y={x:d.target.x+f.x,y:d.target.y+f.y};this.markMap.get(d.target.id).updateOptions(y),this.emit(Mt.Move,this.markMap.get(d.target.id)),this.update()},t=()=>{const{eventObj:d}=this,f={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},y={x:d.target.x+f.x,y:d.target.y+f.y};this.noteMap.get(d.target.id).updateOptions(y),this.emit(Vt.Move,d.target),this.update()},a=()=>{const{eventObj:d}=this,{x:f,y}=e;d.target.type==="mark"?this.resizeNode(f,y,d,null):this.resizeNode(f,y,d),this.update()},i=()=>{const{focusTarget:d,eventObj:f,nodeRelatedLineMap:y}=this,v={x:e.x-f.targetOffsetX-f.target.x,y:e.y-f.targetOffsetY-f.target.y};d.forEach(p=>{if(!(p instanceof de))return;const x={x:p.x+v.x,y:p.y+v.y};y.has(p.id)&&[...y.get(p.id).from,...y.get(p.id).to].forEach(m=>{m.from===m.to?this.moveLineForSameNode(m,{target:p}):this.moveLineForNode(m,{target:p},x)}),this.nodeMap.get(p.id).updateOptions(x),this.emit(ft.Move,p)}),this.update()},r=()=>{console.log("attr");const{eventObj:d}=this;d.target,d.targetAttrId,this.updateEventCanvas()},n=()=>{const{eventObj:d}=this,f=d.target.getIndexInPos(d.lastEvLoc);d.targetLineStartPointIdx=f,d.lastEvLoc=e,f!==!1&&(this.moveLineForLine(d,e),this.update())};return{changeMouseCursor:()=>{const{editType:d,renderElements:f}=this,v={[oe.addNode]:Z.cell,[oe.primaryKey]:Z.crosshair,[oe.foreignKey]:Z.crosshair,[oe.branchLine]:Z.crosshair,[oe.addMark]:Z.cell,[oe.addNote]:Z.text,[oe.copy]:Z.copy}[d];if(v)return this.canvas.eventEl.style.cursor=v||Z.default;let p=null,x=Z.grab;for(let C=f.length-1;C>=0;C--){const m=f[C],B=m.containsPoint(e)||Sr(m,e);if(B){p=m,x=B===se.LT?Z.nwseResize:B===se.TM?Z.nsResize:B===se.RT?Z.neswResize:B===se.LM||B===se.RM?Z.ewResize:B===se.LB?Z.neswResize:B===se.BM?Z.nsResize:B===se.RB?Z.nwseResize:Z.move;break}}if(this.hoverTarget!==p){const C=this.hoverTarget instanceof de?ft:this.hoverTarget instanceof Se?tt:this.hoverTarget instanceof qe?Mt:this.hoverTarget instanceof ot?Vt:null,m=p instanceof de?ft:p instanceof Se?tt:p instanceof qe?Mt:p instanceof ot?Vt:null;C&&this.emit(C.Leave,this.hoverTarget),m&&this.emit(m.Enter,p)}this.hoverTarget=p,this.canvas.eventEl.style.cursor=x,this.updateEventCanvas()},moveCanvas:()=>{this.canvas.setTranslate(s),this.canvas.clearEventCanvas();const d=this.canvas.getTranslate();this.emit(ns.Move,d),this.update()},moveElement:()=>{const{eventObj:d}=this,f=d.targetAttrId,y=!!d.targetDirection,v=d.target instanceof de,p=d.target instanceof Se,x=d.target instanceof qe,C=d.target instanceof ot;if(f)return r();if(y)return a();if(v)return i();if(p)return n();if(x)return o();if(C)return t()}}},kd=function(s,e){const{x:o,y:t}=e;return{execTask:()=>{var u,c,d,f,y;const{editType:r,defaultWidth:n,defaultHeight:l}=this;switch(r){case oe.copy:{const v={x:o-((c=(u=this.copyTarget)==null?void 0:u[0])==null?void 0:c.x),y:t-((f=(d=this.copyTarget)==null?void 0:d[0])==null?void 0:f.y)},p=this.copyTarget.filter(x=>!!x.attributes).map(x=>(x.x=x.x+v.x,x.y=x.y+v.y,x));(y=this.externalFn)==null||y.handlePaste(p),this.editType=oe.None,this.canvas.eventEl.style.cursor=Z.default,this.update();break}case oe.addNode:{const v={x:o-n/2,y:t-l/2,width:n,height:l};this.externalFn.addNode(v),this.editType=oe.None,this.canvas.eventEl.style.cursor=Z.default,this.update();break}case oe.addMark:{const v={id:this.createKey(),x:o,y:t,width:n,height:l,type:"mark"};this.externalFn.addMark(v),this.editType=oe.None,this.canvas.eventEl.style.cursor=Z.default,this.update();break}case oe.addNote:{const v={id:this.createKey(),x:o,y:t,text:"",type:"note"};this.externalFn.addNote(v),this.editType=oe.None,this.canvas.eventEl.style.cursor=Z.default;break}}},setEventTarget:r=>{const{metaKey:n,ctrlKey:l}=r,{hoverTarget:u,focusTarget:c,eventObj:d}=this;if(d.target=u,this.canvas.eventEl.style.cursor=Z.grabbing,!u){c.clear(),this.updateEventCanvas();return}const f=u instanceof de?ft:u instanceof Se?tt:u instanceof qe?Mt:u instanceof ot?Vt:null;this.emit(f.MouseDown,u);const y=Sr(u,e),v=u.containsPoint(e);if(u instanceof de&&c.has(u)&&!y&&!_t(v))return d.targetAttrId=v;!l&&!n&&c.clear(),u instanceof Se?(c.clear(),d.lastEvLoc=e):(u instanceof de||u instanceof ot||u instanceof qe)&&(d.targetOffsetX=e.x-u.x,d.targetOffsetY=e.y-u.y,d.targetDirection=y||null),c.add(u),this.updateEventCanvas()}}},qd=function(){return{resetMouseState:()=>{const{hoverTarget:e}=this,o=e instanceof de?ft:e instanceof Se?tt:e instanceof qe?Mt:e instanceof ot?Vt:null;o&&this.emit(o.MouseUp,e),this.canvas.eventEl.style.cursor=Z.default,this.eventObj={target:null,targetAttrId:null,targetDirection:se.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}}}}};function Ud(s,e){const o={id:e},t=[o];for(;t.length>0;){const a=t.shift(),i=[];for(const[r,n]of s){const l=s.has(r),u=n.has(a.id);if(l&&u){const c={id:r};i.push(c),t.push(c),s.delete(r)}}a.children=i}return o}const Cr=100,xs=100,No=12,Yd="sans-serif",Xd=14,Fo=10,Zs=100,gt=100,bs=1e3;function Gd(s,e,o="sans-serif"){const a=document.createElement("canvas").getContext("2d");return a.font=`${e}px ${o}`,a.measureText(s).width}const Qd=s=>({width:Math.max(Math.floor(Math.max(...(s.attributes||[]).map(e=>Gd(e.name,No,Yd)))+Fo*2+No*2),Zs),height:Math.floor(Math.max(((s.attributes||[]).length+1)*Xd+Fo*2,gt))}),Zd=async(s,e)=>{const{nodeDataArray:o,linkDataArray:t,markDataArray:a,noteDataArray:i}=s,r=Jd(o,t).sort((l,u)=>u.children.length-l.children.length);Id(o,r).then(l=>{const u=eu(a,l,-gt);tu(i,l,u)});function n(){console.log("ani"),He.getAll().length&&(requestAnimationFrame(n),He.update(),e==null||e())}n()},Jd=(s,e)=>{var i;const o=new Map;for(const r of s)o.set(r.id,new Set);for(const r of e){const n=o.get(r.to),l=!!n;!o.get(r.from)||!l||n.add(r.from)}const t=[];let a=!1;for(;!a;){if(!o.size){a=!1;break}let r=null;for(const[l,u]of o){const c=r===null,d=u.size<((i=o.get(r))==null?void 0:i.size),f=r===0;if((c||d)&&(r=l),f)break}o.delete(r);const n=Ud(o,r);t.push(n)}return t},Id=async(s,e)=>{const o=new Map;return s.map(t=>o.set(t.id,t)),await Promise.all(jd(s)),Promise.resolve(e.reduce((t,a)=>t=Tr(o,[a],t,xs),Cr))},jd=s=>s.map(e=>{if(e.type==="inclusive")return;const o=Qd(e);return new Promise(t=>{new He.Tween(e).to({width:o.width,height:o.height},bs).easing(He.Easing.Quadratic.InOut).start().onComplete(()=>t())})}),Tr=(s,e,o,t)=>{var n;const a=Math.max(...e.map(l=>s.get(l.id).height||gt)),i=t+a+xs;let r=o;for(let l=0;l<e.length;l++){const u=s.get(e[l].id);new He.Tween(u).to({x:r,y:t},bs).easing(He.Easing.Quadratic.InOut).start();const c=r;r+=u.width+Cr,(n=e[l].children)!=null&&n.length&&(r=Math.max(Tr(s,e[l].children,c,i),r))}return r},eu=(s,e,o)=>{let t=o;return s==null||s.map(a=>{t+=xs+gt,new He.Tween(a).to({x:e,y:t,width:Zs,height:gt},bs).easing(He.Easing.Quadratic.InOut).start()}),t},tu=(s,e,o)=>{let t=o;return s==null||s.map(a=>{t+=xs+gt,new He.Tween(a).to({x:e,y:t,width:Zs,height:gt},bs).easing(He.Easing.Quadratic.InOut).start()}),t};class Pr extends Ni{constructor(e){super(),this.eventObj={target:null,targetDirection:se.NONE,targetOffsetX:0,targetOffsetY:0,targetAttrId:null,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}},this.plugins=new Fi,this.rightMenuConfig=[],this.chooseTargets=[],this.editable=Ns.Edit,this.defaultWidth=100,this.defaultHeight=50,this.focusTarget=new Set,this.expandAttrs=[],this.updateConfig(e),this.mountDataHandler(e),this.mountCanvas(),this.mountCanvasEvents(),this.mountPlugins(),Ei().then(()=>this.update())}updateConfig(e){const{el:o,externalFn:t,editable:a,fontFamily:i,rightMenu:r,useRightMenu:n,useAttrFocus:l,useThumbnail:u,useHistory:c}=e;o&&(this.el=o),a&&(this.editable=a||Ns.Edit),i&&(this.fontFamily=i),r&&(this.rightMenuConfig=r),_t(n)&&(this.useRightMenu=n),_t(l)&&(this.useAttrFocus=l),_t(u)&&(this.useThumbnail=u),_t(c)&&(this.useHistory=c),this.mountPlugins(),t&&(this.externalFn=t)}mountDataHandler(e){this.dataHandler=new _d({context:this,data:e.data})}destroy(){this.unmountPlugins(),this.unmountCanvasEvents(),this.canvas.destroy(),this.dataHandler.destroy()}mountCanvas(){this.canvas=new Li({mountEl:this.el,backgroundType:Ri.Checker}),this.cacheCtx=this.canvas.cacheCtx}mountPlugins(){this.useHistory?this.plugins.use(Ne.History):this.plugins.off(Ne.History),this.useThumbnail?this.canvas&&this.plugins.use(Ne.Thumbnail,{mountEl:this.canvas.boxEl,mainCanvas:this.canvas}):this.plugins.off(Ne.Thumbnail),this.useRightMenu?this.plugins.use(Ne.RightMenu,this.el,this.rightMenuConfig).off(jt.Click).on(jt.Click,e=>{this.emit(jt.Click,{value:e,target:this.hoverTarget})}):this.plugins.off(Ne.RightMenu)}unmountPlugins(){this.plugins.destroy()}mountCanvasEvents(){this._bindEventMousedown=this.onMouseDown.bind(this),this._bindEventMousemove=this.onMouseMove.bind(this),this._bindEventMouseup=this.onMouseUp.bind(this),this._bindEventResize=this.onResize.bind(this),this._bindEventWheel=this.onWheel.bind(this),this._bindEventContextmenu=this.onContextmenu.bind(this),this._bindEventUndo=this.onUndo.bind(this),this._bindEventRedo=this.onRedo.bind(this),this.canvas.on("canvas:resize",this._bindEventResize),this.canvas.on("canvas:wheel",this._bindEventWheel),this.canvas.on("canvas:mouseup",this._bindEventMouseup),this.canvas.on("canvas:mousedown",this._bindEventMousedown),this.canvas.on("canvas:mousemove",this._bindEventMousemove),this.canvas.on("canvas:contextmenu",this._bindEventContextmenu),this.canvas.on("canvas:undo",this._bindEventUndo),this.canvas.on("canvas:redo",this._bindEventRedo)}unmountCanvasEvents(){this.canvas.off("canvas:resize",this._bindEventResize),this.canvas.off("canvas:wheel",this._bindEventWheel),this.canvas.off("canvas:mouseup",this._bindEventMouseup),this.canvas.off("canvas:mousedown",this._bindEventMousedown),this.canvas.off("canvas:mousemove",this._bindEventMousemove),this.canvas.off("canvas:contextmenu",this._bindEventContextmenu),this.canvas.off("canvas:undo",this._bindEventUndo),this.canvas.off("canvas:redo",this._bindEventRedo)}onUndo(){const e=this.plugins.get(Ne.History).undo();e==null||e.reverse(),e||console.warn("撤无可撤")}onRedo(){const e=this.plugins.get(Ne.History).redo();e==null||e.reverse(),e||console.warn("恢无可恢")}onMouseUp(e,o){const{resetMouseState:t}=qd.call(this,e,o);t()}onMouseDown(e,o){const{editType:t}=this,{execTask:a,setEventTarget:i}=kd.call(this,e,o);if(t)return a();i(e)}onMouseMove(e,o){const{canvas:t,eventObj:a}=this,{changeMouseCursor:i,moveCanvas:r,moveElement:n}=Wd.call(this,e,o),l=!t.isMouseDown,u=t.isMouseDown&&!a.target,c=t.isMouseDown&&a.target;if(l)return i();if(u)return r();if(c){if(this.useHistory){const d=[...this.focusTarget];for(let f=0;f<d.length;f++){const y=d[f],v={target:y,originValue:{}};if(y instanceof de){const p=xo(y,"x","y","width","height");v.originValue=vo(p);const x=this.nodeRelatedLineMap.get(y.id);d.push(...x.from,...x.to)}if(y instanceof Se){const p=xo(y,"pos");v.originValue=vo(p)}d[f]=v}this.plugins.get(Ne.History).push(()=>{for(let f=0;f<d.length;f++){const{target:y,originValue:v}=d[f];y.updateOptions(v),y instanceof de&&this.emit(ft.Resize,y),y instanceof Se&&this.emit(tt.Move,y)}this.update()})}return n()}}onContextmenu(e){if(!this.useRightMenu)return;const{offsetX:o,offsetY:t}=e,{offsetWidth:a,offsetHeight:i}=e.target;this.emit(jt.Show,{target:this.hoverTarget}),this.plugins.get(Ne.RightMenu).show({top:t,left:o,innerWidth:a,innerHeight:i,menuConfig:this.rightMenuConfig})}onWheel(e){const{deltaY:o,deltaX:t,ctrlKey:a}=e;if(Math.abs(o)>2||Math.abs(t)>2)if(a){const r=this.canvas.zoomRate,n=Math.floor(Od(r*100+o,10,200));this.zoom(n)}else{const r=this.canvas.getTranslate();this.canvas.setTranslate({x:r.x-t,y:r.y-o}),this.update()}}onResize(){this.update()}initNodes(){const{dataHandler:{originData:{nodeDataArray:e}},nodeRelatedLineMap:o}=this;if(e!=null&&e.length)for(let t=0;t<e.length;t++){const a=e[t];let i=this.nodeMap.get(a.id);i||(i=new de(this.canvas.cacheCtx,{id:a.id,enName:a.name,cnName:a.cnName,type:a.type,x:a.x,y:a.y,width:a.width,height:a.height,attributes:a.attributes,bdC:a.bdC,bgC:a.bgC,quotePrimaryKey:a.quotePrimaryKey,physicalTables:a.physicalTables}),this.nodeMap.set(a.id,i),o.has(a.id)||o.set(a.id,{from:new Set,to:new Set}))}}renderNodes(){const{nodeMap:e,dataHandler:{originData:o},renderElements:t}=this,a=o.nodeDataArray;for(let i=0;i<a.length;i++){const r=a[i],n=e.get(r.id);n.updateOptions(r),this.canvas.isVisible(n.boundingBox)&&(t.push(n),n.draw())}}renderLines(){const{lineMap:e,dataHandler:{originData:o},renderElements:t,nodeRelatedLineMap:a}=this,i=o.linkDataArray;for(let r=0;r<i.length;r++){const n=i[r];let l=e.get(n.id);this._checkLinePos(n),l?l.updateOptions(n):(l=new Se(this.canvas.cacheCtx,{pos:n.pos,type:n.type,from:n.from,to:n.to,id:n.id,numLineTypes:n.numLineTypes}),this.lineMap.set(n.id,l)),a.has(l.from)||a.set(l.from,{from:new Set,to:new Set}),a.has(l.to)||a.set(l.to,{from:new Set,to:new Set}),a.get(l.from).from.add(l),a.get(l.to).to.add(l),this.canvas.isVisible(l.boundingBox)&&(t.push(l),l.draw())}}renderNote(){const{dataHandler:{originData:{noteDataArray:e}},noteMap:o,renderElements:t}=this;for(let a=0;a<e.length;a++){const i=e[a];let r=o.get(i.id);r?r.updateOptions(i):(r=new ot(this.canvas.cacheCtx,{id:i.id,content:i.text,textColor:i.color,x:i.x,y:i.y}),this.noteMap.set(i.id,r)),this.canvas.isVisible(r.boundingBox)&&(t.push(r),r.draw())}}updateLayout(){const e=this.dataHandler.originData,o=this.update.bind(this);Zd(e,o)}update(e){this.renderElements=[],e&&(this.dataHandler.update({data:e}),this.lineMap=new Map,this.markMap=new Map,this.noteMap=new Map,this.nodeMap=new Map,this.nodeRelatedLineMap=new Map,this.focusTarget.clear(),this.initNodes()),this.canvas.clearCacheCanvas();const o=this.cacheCtx;o.font="15px "+this.fontFamily,o.save(),this.renderMarks(),this.renderLines(),this.renderNodes(),this.renderNote(),o.restore(),this.canvas.update(),this.updateEventCanvas(),this.updateThumbnail()}async updateThumbnail(){const{dataHandler:{originData:{nodeDataArray:e}}}=this,o=this.plugins.get(Ne.Thumbnail);if(!o)return!1;await $i();const{width:t,height:a}=this.canvas.getRenderSize();let i=0,r=0,n=t,l=a;for(let u=0;u<e.length;u++){const c=e[u],{x:d,y:f,width:y,height:v}=c;d<i&&(i=d),f<r&&(r=f),d+y>n&&(n=d+y),f+v>l&&(l=f+v)}o.draw(i,r,n,l,u=>{for(let c=0;c<e.length;c++){const d=e[c],{x:f,y,width:v,height:p,bgC:x,bdC:C}=d;u.save(),u.fillStyle=x||"#fff",u.fillRect(f,y,v,p),u.strokeStyle=C||"#000",u.strokeRect(f,y,v,p),u.restore()}})}updateEventCanvas(){this.canvas.clearEventCanvas(),this.emit(ns.BeforeUpdate,this.canvas.eventCtx),this.drawFocusElement(),this.drawFocusAttribute(),this.drawHoverElement(),this.drawLockIcon(),this.emit(ns.AfterUpdate,this.canvas.eventCtx)}drawFocusElement(){const{canvas:e,focusTarget:o}=this;o.forEach(t=>{t instanceof de?new Kd(e.eventCtx,{x:t.x,y:t.y,width:t.width,height:t.height}).draw():t instanceof Se&&new Se(e.eventCtx,{...t,lineWidth:3,strokeStyle:"blue"}).draw()})}drawFocusAttribute(){const{canvas:e,eventObj:{targetAttrId:o,target:t}}=this;if(!o)return;const a=t.getAttributeInfo(o);e.eventCtx.save(),e.eventCtx.fillStyle=t.attrFocusStyle.backgroundColor,e.eventCtx.fillRect(a.x,a.y,a.width,a.height),e.eventCtx.restore()}drawHoverElement(){const{canvas:e,hoverTarget:o,focusTarget:t}=this,a=t.has(o);!o||a||(o instanceof de?new Vd(e.eventCtx,{x:o.x,y:o.y,width:o.width,height:o.height}).draw():o instanceof Se&&new Se(e.eventCtx,{...o,lineWidth:2,strokeStyle:"blue"}).draw())}copy(){if(!this.focusTarget.size)return;const e=JSON.parse(JSON.stringify([...this.focusTarget])),{handleCopy:o}=this.externalFn;if(!((o==null?void 0:o(e,this.copyTarget))!==!1))return!1;this.copyTarget=e,this.editType=oe.copy,this.el.style.cursor=Z.copy}setEditable(e){this.editable=e,this.update()}drawLockIcon(){if(this.editable===Ns.Edit)return;const e=this.canvas.getTranslate();new $d(this.canvas.eventCtx,{x:-e.x+this.canvas.width-40,y:-e.y+25}).draw()}_checkLinePos(e){var l,u;const{dataHandler:{originDataMap:o}}=this;if(((l=e.pos)==null?void 0:l.length)<2||((u=e.pos)==null?void 0:u.length)>4)return this.mergeLines([e]);const a=o.get(e.from),i=o.get(e.to),r=this.getPointBelongBord(a,e.pos[0]),n=this.getPointBelongBord(i,e.pos[e.pos.length-1]);if(r&&n)return!0;this.mergeLines([e])}_drawFocus(e,o,t,a){const i=this.cacheCtx;i.save(),i.fillStyle="#fff",i.strokeStyle="#B4B4B4",i.shadowColor="#DADADA",i.shadowBlur=5,i.fillRect(e-3,o-3,6,6),i.fillRect(e+t/2-3,o-3,6,6),i.fillRect(e+t-3,o-3,6,6),i.fillRect(e-3,o+a/2-3,6,6),i.fillRect(e+t-3,o+a/2-3,6,6),i.fillRect(e-3,o+a-3,6,6),i.fillRect(e+t/2-3,o+a-3,6,6),i.fillRect(e+t-3,o+a-3,6,6),i.strokeRect(e-3,o-3,6,6),i.strokeRect(e+t/2-3,o-3,6,6),i.strokeRect(e+t-3,o-3,6,6),i.strokeRect(e-3,o+a/2-3,6,6),i.strokeRect(e+t-3,o+a/2-3,6,6),i.strokeRect(e-3,o+a-3,6,6),i.strokeRect(e+t/2-3,o+a-3,6,6),i.strokeRect(e+t-3,o+a-3,6,6),i.restore()}_drawTitle(e,o,t,a){const i=this.cacheCtx;i.save(),i.font="15px "+this.fontFamily,i.fillStyle="#000",i.textAlign="left",i.textBaseline="top",i.fillText(i.fittingString(e,o-14),t,a-24),i.restore()}_drawIcon(e,o,t,a,i){const r=this.cacheCtx;r.save(),r.beginPath(),r.strokeStyle=i,r.lineWidth=3,r.arc(t+o-6,a-18,9,0,2*Math.PI),r.clip(),r.drawImage(e,t+o-15,a-27,18,18),r.stroke(),r.restore()}renderMarks(){var t;const e=this,o=this.dataHandler.originData;(t=o==null?void 0:o.markDataArray)==null||t.forEach(a=>{const i=a.width,r=a.height,n=Number(a.x),l=Number(a.y),u=a;let c=this.markMap.get(u.id);c?c.updateOptions(u):(c=new qe(this.canvas.cacheCtx,{id:u.id,x:n,y:l,width:i,height:r}),this.markMap.set(u.id,c)),this.canvas.isVisible(c.boundingBox)&&(this.renderElements.push(c),c.draw()),e.focusTarget.has(c)&&e._drawFocus(n,l,i,r)})}zoom(e){const o=e/100;this.canvas.zoom(o),this.update(),this.emit(ns.Zoom,this.canvas.zoomRate)}getPointBelongBord(e,o){if(o.x===e.x)return"L";if(o.x===e.x+e.width)return"R";if(o.y===e.y)return"T";if(o.y===e.y+e.height)return"B";console.warn("getPointBelongBord未找到匹配边，detail:",e,JSON.parse(JSON.stringify(e)),JSON.parse(JSON.stringify(o)))}resizeNode(e,o,t,a=50){if(["exclusive","inclusive"].includes(t.target.type))return;const i=this,r={x:t.target.x,y:t.target.y,width:t.target.width,height:t.target.height};if(t.targetDirection==="LT"){const l=t.target.width+t.target.x-e,u=t.target.height+t.target.y-o;t.target.updateOptions({x:l<a?t.target.x:e,y:u<a?t.target.y:o,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="TM"){const l=t.target.height+t.target.y-o;t.target.updateOptions({y:l<a?t.target.y:o,height:l<a?t.target.height:l}),n()}else if(t.targetDirection==="RT"){const l=e-t.target.x,u=t.target.height+t.target.y-o;t.target.updateOptions({y:u<a?t.target.y:o,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="LM"){const l=t.target.width+t.target.x-e;t.target.updateOptions({x:l<a?t.target.x:e,width:l<a?t.target.width:l}),n()}else if(t.targetDirection==="RM"){const l=e-t.target.x;t.target.updateOptions({width:l<a?t.target.width:l}),n()}else if(t.targetDirection==="LB"){const l=t.target.width+t.target.x-e,u=o-t.target.y;t.target.updateOptions({x:l<a?t.target.x:e,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="BM"){const l=o-t.target.y;t.target.updateOptions({height:l<a?t.target.height:l}),n()}else if(t.targetDirection==="RB"){const l=e-t.target.x,u=o-t.target.y;t.target.updateOptions({width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}t.target.type==="mark"?this.emit(Mt.Resize,t.target):this.emit(ft.Resize,t.target);function n(){if(!(t.target instanceof de))return;i.nodeMap.get(t.target.id).updateOptions(t.target);const l=i.nodeRelatedLineMap.get(t.target.id);[...l.from,...l.to].forEach(c=>{const d=c.from!==c.to,f=l.from.has(c)?0:c.pos.length-1;d&&u(c,f),d?i.moveLineForNode(c,t,t.target):i.moveLineForSameNode(c,t)});function u(c,d){c.pos[d].x===r.x?(c.pos[d].x=t.target.x,c.pos[d].y=c.pos[d].y<t.target.y?t.target.y+1:c.pos[d].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[d].y):c.pos[d].x===r.x+r.width?(c.pos[d].x=t.target.x+t.target.width,c.pos[d].y=c.pos[d].y<t.target.y?t.target.y+1:c.pos[d].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[d].y):c.pos[d].y===r.y?(c.pos[d].x=c.pos[d].x<=t.target.x?t.target.x+1:c.pos[d].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[d].x,c.pos[d].y=t.target.y):c.pos[d].y===r.y+r.height&&(c.pos[d].x=c.pos[d].x<=t.target.x?t.target.x+1:c.pos[d].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[d].x,c.pos[d].y=t.target.y+t.target.height)}}}getNodePosFromBoreder(e,o){let t={start:{x:null,y:null},end:{x:null,y:null}};switch(o){case"T":t={start:{x:e.x,y:e.y},end:{x:e.x+e.width,y:e.y}};break;case"B":t={start:{x:e.x,y:e.y+e.height},end:{x:e.x+e.width,y:e.y+e.height}};break;case"L":t={start:{x:e.x,y:e.y},end:{x:e.x,y:e.y+e.height}};break;case"R":t={start:{x:e.x+e.width,y:e.y},end:{x:e.x+e.width,y:e.y+e.height}};break}return t}moveLineForNode(e,o,t){const a=e.pos.length-1,i={x:t.x-o.target.x,y:t.y-o.target.y},r=this.nodeMap.get(e.from),n=this.nodeMap.get(e.to),l=this.getPointBelongBord(r,e.pos[0]),u=this.getPointBelongBord(n,e.pos[a]);(!l||!u)&&this.mergeLines([e]);const c=o.target.id===r.id;if(c?(e.pos[0].x=t.x+(e.pos[0].x-o.target.x),e.pos[0].y=t.y+(e.pos[0].y-o.target.y)):(e.pos[a].x=t.x+(e.pos[a].x-o.target.x),e.pos[a].y=t.y+(e.pos[a].y-o.target.y)),a===1)e.pos.splice(1,0,{x:e.pos[0].x,y:e.pos[0].y},{x:e.pos[0].x,y:e.pos[0].y});else if(a===2)if(l==="R"&&u==="B"){if(this.getNodePosFromBoreder(n,"B").start.y<e.pos[0].y)e.pos[1]={x:e.pos[2].x,y:e.pos[0].y};else{const d=this.getNodePosFromBoreder(r,"R").start.x<this.getNodePosFromBoreder(n,"L").start.x?this.getNodePosFromBoreder(n,"L").start.x:this.getNodePosFromBoreder(n,"R").start.x;e.pos[1]={x:d+(c?0:i.x),y:e.pos[0].y+i.y},e.pos.splice(2)}e.pos[2]&&e.pos[2].x<=e.pos[0].x&&(e.pos[0]={x:e.pos[0].x-1,y:r.y+(c?i.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))}else l==="B"&&u==="R"?(r.y+r.height<e.pos[1].y?e.pos[1]={x:e.pos[0].x,y:e.pos[2].y}:["exclusive","inclusive"].includes(r.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},e.pos[2]={x:n.x+Math.floor(n.width/2)+(c?0:i.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(c?0:i.y)}):(e.pos[0]={x:r.x+(o.target.id===r.id?i.x:0),y:e.pos[1].y},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2)),e.pos[1].x<n.x+n.width&&(e.pos[1].y=n.y+(o.target.id===n.id?i.y:0),e.pos.splice(2))):l==="L"&&u==="B"?(this.getNodePosFromBoreder(n,"B").start.y<e.pos[0].y?e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}:(e.pos[1]={x:n.x+n.width+(o.target.id===n.id?i.x:0),y:e.pos[0].y},e.pos.splice(2)),e.pos[1].x>=o.target.x&&this.getNodePosFromBoreder(n,"B").start.y<this.getNodePosFromBoreder(r,"T").start.y&&(e.pos[0]={x:e.pos[0].x+(c?i.x:0)-1,y:r.y+(c?i.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))):l==="B"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>n.x&&(e.pos[1].y=n.y+(o.target.id===n.id?i.y:0),e.pos.splice(2)),e.pos[1].y<e.pos[0].y&&(["exclusive","inclusive"].includes(r.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBoreder(r,"B").start.y,this.getNodePosFromBoreder(n,"B").start.y)+20},e.pos[2]={x:n.x+Math.floor(n.width/2)+(c?0:i.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBoreder(n,"B").start.y+(c?0:i.y)}):(e.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(o.target.id===r.id?i.x:0),e.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(o.target.id===r.id?i.y:0),e.pos.splice(0,1)))):l==="R"&&u==="T"?(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].x<e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(o.target.id===r.id?i.y:0),e.pos.splice(0,1)),e.pos[2]&&e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(c?i.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:n.y+(c?0:i.y)}):(e.pos[1].x=n.x+(c?0:i.x),e.pos[1].y=n.y+(c?0:i.y),e.pos.splice(2)))):l==="T"&&u==="R"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x<e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(o.target.id===n.id?i.y:0),e.pos.splice(2)),e.pos[0].y<e.pos[1].y&&(e.pos[1].x=r.x+(o.target.id===r.id?i.x:0),e.pos[1].y=r.y+(o.target.id===r.id?i.y:0),e.pos.splice(0,1))):l==="T"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBoreder(n,"B").start.y+(o.target.id===n.id?i.y:0),e.pos.splice(2)),e.pos[1].y>e.pos[0].y&&(e.pos[1].x=this.getNodePosFromBoreder(r,"R").start.x+(o.target.id===r.id?i.x:0),e.pos.splice(0,1))):l==="L"&&u==="T"&&(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:r.x+Math.floor(r.width/2),y:r.y+(c?i.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:n.y+(c?0:i.y)}):(e.pos[1].x=this.getNodePosFromBoreder(n,"R").start.x+(o.target.id===n.id?i.x:0),e.pos.splice(2))),e.pos[1].x>e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBoreder(r,"B").start.y+(o.target.id===r.id?i.y:0),e.pos.splice(0,1)));else if(a===3){const d=Math.floor(Math.abs(e.pos[0].x-e.pos[a].x)/2),f=Math.floor(Math.abs(e.pos[0].y-e.pos[a].y)/2);if(l==="B"&&u==="B")if(this.getNodePosFromBoreder(r,"T").start.y<this.getNodePosFromBoreder(n,"B").start.y)if(this.getNodePosFromBoreder(r,"B").start.y<e.pos[1].y){const y=e.pos[2].y-n.y-n.height+e.pos[3].y;e.pos[1]={x:e.pos[0].x,y},e.pos[2]={x:e.pos[3].x,y}}else{const y=r.x+r.width>e.pos[3].x?r.x:r.x+r.width,v=e.pos[2].y-n.y-n.height+e.pos[3].y;e.pos[0]={x:y+(o.target.id===r.id?i.x:0),y:v},e.pos[1]={x:e.pos[3].x,y:v},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y},e.pos.splice(3)}else["exclusive","inclusive"].includes(r.type)?(e.pos[1]={x:e.pos[0].x,y:r.y+r.height+20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-r.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+Math.floor((r.y-n.y-n.height)/2)},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+Math.floor((r.y-n.y-n.height)/2)});else if(l==="B"&&u==="T")r.y+r.height<n.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+f},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+f}):r.y+r.height>=n.y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-r.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[1]={x:e.pos[0].x,y:n.y+n.height+20},e.pos[2]={x:e.pos[3].x,y:n.y+n.height+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+n.height}));else if(l==="T"&&u==="T")if(["exclusive","inclusive"].includes(r.type)||["exclusive","inclusive"].includes(n.type)){const y=e.pos[1].y+i.y>Math.min(r.y,n.y)-20?Math.min(r.y,n.y)-20:e.pos[1].y+i.y;e.pos[1]={x:e.pos[0].x,y},e.pos[2]={x:e.pos[3].x,y}}else e.pos[1].y<o.target.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[1].y},e.pos[2]={x:e.pos[3].x,y:e.pos[2].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+r.height},e.pos[1]={x:e.pos[0].x,y:Math.max(r.y+r.height,n.y+n.height)+20},e.pos[2]={x:e.pos[3].x,y:Math.max(r.y+r.height,n.y+n.height)+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+n.height});else l==="T"&&u==="B"?r.y>n.y+n.height?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-f},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y+f}):r.y<=n.y+n.height&&(console.log("B->B"),e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+r.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+20},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+20}):l==="L"&&u==="L"?(o.target.id===n.id?(e.pos[2]={x:t.x-(n.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>r.x&&e.pos[1].x<r.x+r.width&&(e.pos.splice(0,1),++e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(o.target.id===r.id?i.y:0))):l==="L"&&u==="R"?r.x>n.x+n.width?(e.pos[1]={x:e.pos[0].x-d,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[3].y}):(e.pos[0]={x:e.pos[0].x+r.width,y:e.pos[0].y},e.pos[1]={x:e.pos[0].x+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+20,y:e.pos[3].y}):l==="R"&&u==="L"?r.x+r.width<n.x?(e.pos[1]={x:e.pos[0].x+d,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+d,y:e.pos[3].y}):(e.pos[1]={x:e.pos[0].x+n.width+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+n.width+20,y:e.pos[3].y},e.pos[3]={x:e.pos[3].x+n.width,y:e.pos[3].y}):l==="R"&&u==="R"&&(o.target.id===n.id?(e.pos[2]={x:t.x-(n.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>r.x&&e.pos[1].x<r.x+r.width&&(e.pos.splice(0,1),--e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y)+(o.target.id===r.id?i.y:0)))}this.emit(tt.Move,e)}moveLineForSameNode(e,o){const i=e.pos[1].x-e.pos[0].x,r=e.pos[2].y-e.pos[1].y;e.pos[0]={x:o.target.x+o.target.width,y:o.target.y+o.target.height-20},e.pos[4]={x:o.target.x+o.target.width-20,y:o.target.y+o.target.height},e.pos[1]={x:e.pos[0].x+i,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[1].y+r},e.pos[3]={x:e.pos[4].x,y:e.pos[2].y},this.emit(tt.Move,e)}moveLineForLine(e,o){var c;const t=e.target.pos,a=t.length-1;let i,r,n=0;if((c=this.dataHandler.originData.nodeDataArray)==null||c.forEach(d=>{d.id===e.target.from&&(i=d,n++),d.id===e.target.to&&(r=d,n++)}),["exclusive","inclusive"].includes(i.type)){if(e.targetLineStartPointIdx===0&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(i,"L").start.x>=o.x||this.getNodePosFromBoreder(i,"R").start.x<=o.x)||e.targetLineStartPointIdx===1&&t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y&&this.getNodePosFromBoreder(i,"B").start.y>=o.y||e.targetLineStartPointIdx===2&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBoreder(r,"L").start.x>=o.x||this.getNodePosFromBoreder(r,"R").start.x<=o.x))return}else if(["exclusive","inclusive"].includes(r.type)&&(a===1||a===2&&e.targetLineStartPointIdx===1||a===2&&e.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"T").start.y<o.y||a===3&&e.targetLineStartPointIdx===2||a===3&&e.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(r,"T").start.y<o.y||a===3&&e.targetLineStartPointIdx===0&&(this.getNodePosFromBoreder(i,"L").start.x>=o.x||this.getNodePosFromBoreder(i,"R").start.x<=o.x)))return;a===1?t[0].y===t[1].y?(t[0].y=o.y,t[1].y=o.y,(this.getNodePosFromBoreder(i,"T").start.y>o.y||this.getNodePosFromBoreder(i,"B").start.y<o.y)&&(t[0].x=i.x+i.width/2,t.unshift({x:i.x+i.width/2,y:this.getNodePosFromBoreder(i,"T").start.y>o.y?i.y:i.y+i.height})),(this.getNodePosFromBoreder(r,"T").start.y>o.y||this.getNodePosFromBoreder(r,"B").start.y<o.y)&&(t[t.length-1].x=r.x+r.width/2,t.push({x:r.x+r.width/2,y:this.getNodePosFromBoreder(r,"T").start.y>o.y?r.y:r.y+r.height}))):(t[0].x=o.x,t[1].x=o.x,(this.getNodePosFromBoreder(i,"L").start.x>o.x||this.getNodePosFromBoreder(i,"R").start.x<o.x)&&(t[0].y=i.y+i.height/2,t.unshift({x:this.getNodePosFromBoreder(i,"R").start.x<o.x?i.x+i.width:i.x,y:i.y+i.height/2})),(this.getNodePosFromBoreder(r,"L").start.x>o.x||this.getNodePosFromBoreder(r,"R").start.x<o.x)&&(t[t.length-1].y=r.y+r.height/2,t.push({x:this.getNodePosFromBoreder(r,"R").start.x<o.x?r.x+r.width:r.x,y:r.y+r.height/2}))):a===2?t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=o.y,t[e.targetLineStartPointIdx+1].y=o.y,(this.getNodePosFromBoreder(i,"B").start.y<o.y||this.getNodePosFromBoreder(i,"T").start.y>o.y)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].x=i.x+i.width/2,t.unshift({x:i.x+i.width/2,y:this.getNodePosFromBoreder(i,"T").start.y>o.y?i.y:i.y+i.height})),(this.getNodePosFromBoreder(r,"B").start.y<o.y||this.getNodePosFromBoreder(r,"T").start.y>o.y)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].x=r.x+r.width/2,t.push({x:r.x+r.width/2,y:this.getNodePosFromBoreder(r,"T").start.y>o.y?r.y:r.y+r.height})),e.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(i,"B").start.y>o.y&&this.getNodePosFromBoreder(i,"T").start.y<o.y&&(t.splice(0,1),t[0].x=r.x>i.x?i.x+i.width:i.x),e.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"B").start.y>o.y&&this.getNodePosFromBoreder(r,"T").start.y<o.y&&(t.splice(t.length-1,1),t[t.length-1].x=i.x>r.x?r.x+r.width:r.x)):(t[e.targetLineStartPointIdx].x=o.x,t[e.targetLineStartPointIdx+1].x=o.x,(this.getNodePosFromBoreder(i,"L").start.x>o.x||this.getNodePosFromBoreder(i,"R").start.x<o.x)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].y=i.y+i.height/2,t.unshift({x:this.getNodePosFromBoreder(i,"L").start.x>o.x?i.x:i.x+i.width,y:i.y+i.height/2})),(this.getNodePosFromBoreder(r,"L").start.x>o.x||this.getNodePosFromBoreder(r,"R").start.x<o.x)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].y=r.y+r.height/2,t.push({x:this.getNodePosFromBoreder(r,"L").start.x>o.x?r.x:r.x+r.width,y:r.y+r.height/2})),e.targetLineStartPointIdx===1&&this.getNodePosFromBoreder(i,"L").start.x<o.x&&this.getNodePosFromBoreder(i,"R").start.x>o.x&&(t.splice(0,1),t[0].y=r.y>i.y?i.y+i.height:i.y),e.targetLineStartPointIdx===0&&this.getNodePosFromBoreder(r,"L").start.x<o.x&&this.getNodePosFromBoreder(r,"R").start.x>o.x&&(t.splice(t.length-1,1),t[t.length-1].y=i.y>r.y?r.y+r.height:r.y)):a===3&&(t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=o.y,t[e.targetLineStartPointIdx+1].y=o.y,e.targetLineStartPointIdx===0?l(t)?t[0].y<this.getNodePosFromBoreder(i,"T").start.y?(t[0]={x:this.getNodePosFromBoreder(i,"T").start.x+i.width/2,y:i.y},t[1]={x:t[0].x,y:o.y},o.y<this.getNodePosFromBoreder(r,"T").start.y||o.y>this.getNodePosFromBoreder(r,"B").start.y?(t[2]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:o.y},t[3]={x:t[2].x,y:o.y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBoreder(r,"R").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:o.y},t.splice(3))):t[0].y>this.getNodePosFromBoreder(i,"B").start.y&&(t[0]={x:this.getNodePosFromBoreder(i,"T").start.x+i.width/2,y:this.getNodePosFromBoreder(i,"B").start.y},t[1]={x:t[0].x,y:o.y},o.y<this.getNodePosFromBoreder(r,"T").start.y||o.y>this.getNodePosFromBoreder(r,"B").start.y?(t[2]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:o.y},t[3]={x:t[2].x,y:o.y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBoreder(r,"R").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:o.y},t.splice(3))):o.y<this.getNodePosFromBoreder(i,"T").start.y?(t[0].y=this.getNodePosFromBoreder(i,"T").start.y,t[1].y=this.getNodePosFromBoreder(i,"T").start.y):o.y>this.getNodePosFromBoreder(i,"B").start.y&&(t[0].y=this.getNodePosFromBoreder(i,"B").start.y,t[1].y=this.getNodePosFromBoreder(i,"B").start.y):e.targetLineStartPointIdx===t.length-2?l(t)?t[3].y<this.getNodePosFromBoreder(r,"T").start.y?(t[3]={x:this.getNodePosFromBoreder(r,"T").start.x+r.width/2,y:r.y},t[2]={x:t[3].x,y:o.y},o.y<this.getNodePosFromBoreder(i,"T").start.y||o.y>this.getNodePosFromBoreder(i,"B").start.y?(t[1]={x:this.getNodePosFromBoreder(i,"L").start.x+i.width/2,y:o.y},t[0]={x:t[1].x,y:o.y<this.getNodePosFromBoreder(i,"T").start.y?this.getNodePosFromBoreder(i,"T").start.y:this.getNodePosFromBoreder(i,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBoreder(i,"R").start.x?this.getNodePosFromBoreder(i,"R").start.x:this.getNodePosFromBoreder(i,"L").start.x,y:o.y},t.splice(0,1))):t[3].y>this.getNodePosFromBoreder(r,"B").start.y&&(t[3]={x:this.getNodePosFromBoreder(r,"L").start.x+r.width/2,y:this.getNodePosFromBoreder(r,"B").start.y},t[2]={x:t[3].x,y:o.y},o.y<this.getNodePosFromBoreder(i,"T").start.y||o.y>this.getNodePosFromBoreder(i,"B").start.y?(t[1]={x:this.getNodePosFromBoreder(i,"L").start.x+i.width/2,y:o.y},t[0]={x:t[1].x,y:o.y<this.getNodePosFromBoreder(i,"T").start.y?this.getNodePosFromBoreder(i,"T").start.y:this.getNodePosFromBoreder(i,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBoreder(i,"R").start.x?this.getNodePosFromBoreder(i,"R").start.x:this.getNodePosFromBoreder(i,"L").start.x,y:o.y},t.splice(0,1))):o.y<this.getNodePosFromBoreder(r,"T").start.y?(t[2].y=this.getNodePosFromBoreder(r,"T").start.y,t[3].y=this.getNodePosFromBoreder(r,"T").start.y):o.y>this.getNodePosFromBoreder(r,"B").start.y&&(t[2].y=this.getNodePosFromBoreder(r,"B").start.y,t[3].y=this.getNodePosFromBoreder(r,"B").start.y):(o.y>this.getNodePosFromBoreder(i,"T").start.y&&o.y<this.getNodePosFromBoreder(i,"B").start.y&&(t.splice(0,1),t[0].x=t[1].x<this.getNodePosFromBoreder(i,"L").start.x?this.getNodePosFromBoreder(i,"L").start.x:this.getNodePosFromBoreder(i,"R").start.x),o.y>this.getNodePosFromBoreder(r,"T").start.y&&o.y<this.getNodePosFromBoreder(r,"B").start.y&&(t[t.length-2].x=t[t.length-3].x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,t.splice(t.length-1)))):(t[e.targetLineStartPointIdx].x=o.x,t[e.targetLineStartPointIdx+1].x=o.x,e.targetLineStartPointIdx===0?u(t)?t[0].x<this.getNodePosFromBoreder(i,"L").start.x?(t[0]={x:this.getNodePosFromBoreder(i,"L").start.x,y:this.getNodePosFromBoreder(i,"L").start.y+i.height/2},t[1]={x:o.x,y:t[0].y},o.x<this.getNodePosFromBoreder(r,"L").start.x||o.x>this.getNodePosFromBoreder(r,"R").start.x?(t[2]={x:o.x,y:this.getNodePosFromBoreder(r,"T").start.y+r.height/2},t[3]={x:o.x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:t[2].y}):(t[2]={x:o.x,y:t[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y},t.splice(3))):t[0].x>this.getNodePosFromBoreder(i,"R").start.x&&(t[0]={x:this.getNodePosFromBoreder(i,"R").start.x,y:this.getNodePosFromBoreder(i,"R").start.y+i.height/2},t[1]={x:o.x,y:t[0].y},o.x<this.getNodePosFromBoreder(r,"L").start.x||o.x>this.getNodePosFromBoreder(r,"R").start.x?(t[2]={x:o.x,y:this.getNodePosFromBoreder(r,"T").start.y+r.height/2},t[3]={x:o.x<this.getNodePosFromBoreder(r,"L").start.x?this.getNodePosFromBoreder(r,"L").start.x:this.getNodePosFromBoreder(r,"R").start.x,y:t[2].y}):(t[2]={x:o.x,y:t[1].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y},t.splice(3))):o.x<this.getNodePosFromBoreder(i,"L").start.x?(t[0].x=this.getNodePosFromBoreder(i,"L").start.x+1,t[1].x=this.getNodePosFromBoreder(i,"L").start.x+1):o.x>this.getNodePosFromBoreder(i,"R").start.x&&(t[0].x=this.getNodePosFromBoreder(i,"R").start.x-1,t[1].x=this.getNodePosFromBoreder(i,"R").start.x-1):e.targetLineStartPointIdx===t.length-2?u(t)?t[3].x<this.getNodePosFromBoreder(r,"L").start.x?(t[3]={x:this.getNodePosFromBoreder(r,"L").start.x,y:this.getNodePosFromBoreder(r,"L").start.y+r.height/2},t[2]={x:o.x,y:t[3].y},o.x<this.getNodePosFromBoreder(i,"L").start.x||o.x>this.getNodePosFromBoreder(i,"R").start.x?(t[1]={x:o.x,y:this.getNodePosFromBoreder(i,"T").start.y+i.height/2},t[0]={x:o.x<this.getNodePosFromBoreder(i,"L").start.x?this.getNodePosFromBoreder(i,"L").start.x:this.getNodePosFromBoreder(i,"R").start.x,y:t[1].y}):(t[1]={x:o.x,y:t[2].y>this.getNodePosFromBoreder(i,"B").start.y?this.getNodePosFromBoreder(i,"B").start.y:this.getNodePosFromBoreder(i,"T").start.y},t.splice(0,1))):t[3].x>this.getNodePosFromBoreder(r,"R").start.x&&(t[3]={x:this.getNodePosFromBoreder(r,"R").start.x,y:this.getNodePosFromBoreder(r,"R").start.y+r.height/2},t[2]={x:o.x,y:t[3].y},o.x<this.getNodePosFromBoreder(i,"L").start.x||o.x>this.getNodePosFromBoreder(i,"R").start.x?(t[1]={x:o.x,y:this.getNodePosFromBoreder(i,"T").start.y+i.height/2},t[0]={x:o.x<this.getNodePosFromBoreder(i,"L").start.x?this.getNodePosFromBoreder(i,"L").start.x:this.getNodePosFromBoreder(i,"R").start.x,y:t[1].y}):(t[1]={x:o.x,y:t[2].y>this.getNodePosFromBoreder(i,"B").start.y?this.getNodePosFromBoreder(i,"B").start.y:this.getNodePosFromBoreder(i,"T").start.y},t.splice(0,1))):o.x<this.getNodePosFromBoreder(r,"L").start.x?(t[2].x=this.getNodePosFromBoreder(r,"L").start.x+1,t[3].x=this.getNodePosFromBoreder(r,"L").start.x+1):o.x>this.getNodePosFromBoreder(r,"R").start.x&&(t[2].x=this.getNodePosFromBoreder(r,"R").start.x-1,t[3].x=this.getNodePosFromBoreder(r,"R").start.x-1):(o.x>this.getNodePosFromBoreder(i,"L").start.x&&o.x<this.getNodePosFromBoreder(i,"R").start.x&&(t.splice(0,1),t[0].y=t[1].y<this.getNodePosFromBoreder(i,"T").start.y?this.getNodePosFromBoreder(i,"T").start.y:this.getNodePosFromBoreder(i,"B").start.y),o.x>this.getNodePosFromBoreder(r,"L").start.x&&o.x<this.getNodePosFromBoreder(r,"R").start.x&&(t[t.length-2].y=t[t.length-3].y<this.getNodePosFromBoreder(r,"T").start.y?this.getNodePosFromBoreder(r,"T").start.y:this.getNodePosFromBoreder(r,"B").start.y,t.splice(t.length-1)))),t.length===4&&t[1].x===t[2].x&&t[1].y===t[2].y&&t.splice(1,2));function l(d){let f=0;for(let y=0,v=d.length-1;y<v;y++)f+=Math.abs(d[y].x-d[y+1].x);return f===Math.abs(d[0].x-d[d.length-1].x)}function u(d){let f=0;for(let y=0,v=d.length-1;y<v;y++)f+=Math.abs(d[y].y-d[y+1].y);return f===Math.abs(d[0].y-d[d.length-1].y)}this.emit(tt.Move,e.target)}addNode(){this.editType=oe.addNote}packNodeInfo(e,o){const{x:t,y:a}=this.transLoc(o);return Object.assign(e,{x:t,y:a+24,width:50,height:50})}getOverlapNode(){const e=this.dataHandler.originData;for(let o=0,t=e.nodeDataArray.length;o<t;o++){const a=Number(e.nodeDataArray[o].width)||100,i=Number(e.nodeDataArray[o].height)||50,r=Number(e.nodeDataArray[o].x),n=Number(e.nodeDataArray[o].y);if(r>r&&r<a+r&&n>n&&n<i+n)return e.nodeDataArray[o]}}transLoc(e){const o=this.canvas.getTranslate(),t=this.canvas.zoomRate,a=Math.floor((e.x+o.x)/t),i=Math.floor((e.y+o.y)/t);return{x:a,y:i}}addLine(e){this.editType=e}addMark(){this.editType=oe.addMark}addNote(){this.editType=oe.addNote}addRemark(e=""){var o;(o=this.focusTarget)==null||o.forEach(t=>{t.remark=e}),this.update()}changeColor(e,o){var t;(t=this.focusTarget)==null||t.forEach(a=>{a instanceof de?o!=="color"?a[o]=e:console.log("修改的是属性文字颜色, 逻辑待完善."):a instanceof qe?a[o]=e:a instanceof ot&&(a.textColor=e)}),this.update()}createLineInfo(e,o){const t=this.chooseTargets,a=this.getNodePosFromBoreder(t[0],"L"),i=this.getNodePosFromBoreder(t[1],"L"),r=[];if(t[0].id===t[1].id)r[0]={x:t[0].x+t[0].width,y:t[0].y+t[0].height-20},r[1]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height-20},r[2]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height+20},r[3]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height+20},r[4]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height};else if(["exclusive","inclusive"].includes(t[0].type))a.end.y<i.start.y?(r[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((i.start.y-a.end.y)/2)},r[2]={x:i.start.x+Math.floor(t[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:i.start.y}):(r[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:Math.max(a.end.y,i.start.y)+20},r[2]={x:i.start.x+Math.floor(t[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:i.end.y});else if(["exclusive","inclusive"].includes(t[1].type))a.end.y<i.start.y?(r[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},r[1]={x:r[0].x,y:r[0].y+Math.floor((i.start.y-a.end.y)/2)},r[2]={x:i.start.x+Math.floor(t[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:i.start.y}):(r[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:Math.min(a.end.y,i.start.y)-20},r[2]={x:i.start.x+Math.floor(t[1].width/2),y:r[1].y},r[3]={x:r[2].x,y:i.start.y});else if(this.getNodePosFromBoreder(t[0],"R").start.x<this.getNodePosFromBoreder(t[1],"L").start.x)if((i.start.y-a.end.y)*(i.end.y-a.start.y)<0){const n=Math.max(a.start.y,i.start.y)+Math.abs(Math.floor((Math.min(a.end.y,i.end.y)-Math.max(a.start.y,i.start.y))/2));r[0]={x:this.getNodePosFromBoreder(t[0],"R").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(t[1],"L").start.x,y:n}}else a.start.y>i.end.y?(r[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:i.start.y+Math.floor(t[1].height/2)},r[2]={x:i.start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(t[0],"R").start.x,y:a.start.y+Math.floor(t[0].height/2)},r[1]={x:this.getNodePosFromBoreder(t[1],"L").start.x+Math.floor(t[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(t[1],"L").start.y});else if(this.getNodePosFromBoreder(t[0],"L").start.x>this.getNodePosFromBoreder(t[1],"R").start.x)if((i.start.y-a.end.y)*(i.end.y-a.start.y)<0){const n=Math.max(a.start.y,i.start.y)+Math.abs(Math.floor((Math.min(a.end.y,i.end.y)-Math.max(a.start.y,i.start.y))/2));r[0]={x:this.getNodePosFromBoreder(t[0],"L").start.x,y:n},r[1]={x:this.getNodePosFromBoreder(t[1],"R").start.x,y:n}}else a.start.y>i.end.y?(r[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},r[1]={x:r[0].x,y:i.start.y+Math.floor(t[1].height/2)},r[2]={x:this.getNodePosFromBoreder(t[1],"R").start.x,y:r[1].y}):(r[0]={x:this.getNodePosFromBoreder(t[0],"L").start.x,y:a.start.y+Math.floor(t[0].height/2)},r[1]={x:this.getNodePosFromBoreder(t[1],"L").start.x+Math.floor(t[1].width/2),y:r[0].y},r[2]={x:r[1].x,y:this.getNodePosFromBoreder(t[1],"L").start.y});else if(a.start.y>i.end.y){const n=Math.max(a.start.x,i.start.x),l=Math.min(this.getNodePosFromBoreder(t[0],"R").start.x,this.getNodePosFromBoreder(t[1],"R").start.x),u=n+Math.floor((l-n)/2);r[0]={x:u,y:a.start.y},r[1]={x:u,y:i.end.y}}else{const n=Math.max(a.start.x,i.start.x),l=Math.min(this.getNodePosFromBoreder(t[0],"R").start.x,this.getNodePosFromBoreder(t[1],"R").start.x),u=n+Math.floor((l-n)/2);r[0]={x:u,y:a.end.y},r[1]={x:u,y:i.start.y}}if(r.length){const n={};return o?(o.pos=r,Object.assign(n,o)):Object.assign(n,{id:this.createKey(),from:t[0].id,to:t[1].id,pos:r,type:e}),n}else console.error("createLine方法错误：未生成对应关键点坐标")}createLine(e,o){const t=this.createLineInfo(e,o);["primaryKey","foreignKey"].includes(e)&&this.externalFn.addLine(t)}mergeLine(e,o){const t=this.createLineInfo(e,o);return Object.assign(o,t)}createBranchLine(){const e=[].concat(this.chooseTargets),o=this.getNodePosFromBoreder(e[0],"L"),t=this.getNodePosFromBoreder(e[1],"L");if(["inclusive","exclusive"].includes(e[1].type))this.$message({message:"未将对象引用设置到对象的实例。",type:"error",showClose:!0});else if(["inclusive","exclusive"].includes(e[0].type)){const a=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({fromFilter:a})}else{const a=o.end.y+50<t.start.y?{x:o.start.x+Math.floor(e[0].width/2)-20,y:o.end.y+Math.floor((t.start.y-o.end.y)/2)-10}:{x:t.start.x+Math.floor(e[1].width/2)-20,y:Math.min(o.start.y,t.start.y)-50},i={id:this.createKey(),x:a.x,y:a.y,width:40,height:20,type:"exclusive",fromKey:e[0].id};this.chooseTargets=[e[0],i];const r=this.createLine("toFilter");this.chooseTargets=[i,e[1]];const n=this.createLine("fromFilterPrimaryKey");this.externalFn.addFilter({filter:i,toFilter:r,fromFilter:n}),this.chooseTargets=[]}}getNodeWithKey(e){for(const o of this.dataHandler.originData.nodeDataArray)if(o.id===e)return o}createLines(e){for(const o of e){const t=this.getNodeWithKey(o.from),a=this.getNodeWithKey(o.to);t&&a&&(this.chooseTargets=[t,a],this.createLine(o.type,o))}this.chooseTargets=[],this.update()}mergeLines(e){const o=[];for(const t of e){const a=this.getNodeWithKey(t.from),i=this.getNodeWithKey(t.to);a&&i&&(this.chooseTargets=[a,i],o.push(this.mergeLine(t.type,t)))}return this.chooseTargets=[],o}createKey(){return+new Date+""+Math.floor(Math.random()*1e5)}$message(e){this.externalFn.$message&&this.externalFn.$message(e)}}const $e={nodeDataArray:[{id:"Entity1",x:100,y:100,width:100,height:100,bgC:"#FF8080",bdC:"red",name:"Entity1",physicalTables:!0,quotePrimaryKey:!0,attributes:[{name:"attr1",id:"1",primaryKey:!0,foreignKey:!0,type:"INT",icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"L",bdC:"green"}]},{name:"attr2",id:"2",type:"DATE",primaryKey:!0},{name:"属性名3",id:"3",primaryKey:!0,type:"char",children:[{name:"属性名3-1",id:"3-1",primaryKey:!0,foreignKey:!0,children:[{name:"属性名3-1-1",primaryKey:!0,foreignKey:!0,children:[{name:"属性名3-1-1-1",primaryKey:!0,foreignKey:!0}],icons:[{text:"A",bdC:"green"}]}]},{name:"属性名3-2",primaryKey:!0,foreignKey:!0},{name:"属性名3-3",primaryKey:!0,foreignKey:!0}]},{name:"attr4",primaryKey:!1,foreignKey:!0,icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"标"}]},{name:"attr5",primaryKey:!1},{name:"attr6",primaryKey:!1,icons:[{text:"A",bdC:"green"}]}]},{id:"Entity2",x:400,y:100,width:50,height:100,bgC:"#8080FF",name:"Entity2",quotePrimaryKey:!0,attributes:[{name:"属性名1",primaryKey:!0,foreignKey:!1},{name:"属性名2",primaryKey:!0},{name:"属性名3",primaryKey:!0}]},{id:"Entity3",x:100,y:400,width:50,height:100,bgC:"#FFFF80",name:"Entity3",attributes:[{name:"属性名1",primaryKey:!1,foreignKey:!1},{name:"属性名2",primaryKey:!1}]},{id:"Entity4",x:100,y:250,width:40,height:20,type:"inclusive"},{id:"Entity5",x:705,y:92,width:260,height:100,name:"Entity5",type:"inside"},{id:"Entity6",x:600,y:280,width:260,height:100,name:"Entity6",type:"explain",attributes:[{label:"说明",content:"表示与银行有利害关系，以及银行希望保留其信息"},{label:"示例",content:"个人 组织 客户"},{label:"所属部门",content:"数据研究院"},{label:"负责人",content:"杨中旭"}]},{id:"Entity7",x:2999,y:2999,width:260,height:100,name:"Entity7",type:"inside"},{id:"Entity8",x:-2999,y:-2999,width:260,height:100,name:"Entity8",type:"inside"},{id:"Entity9",x:500,y:500,width:260,height:100,name:"Entity9",type:"inside"},{id:"Entity10",x:-500,y:-500,width:260,height:100,name:"Entity10",type:"inside"},{id:"Entity11",x:-300,y:-300,width:260,height:100,name:"Entity11",type:"inside"},{id:"Entity12",x:-200,y:-200,width:260,height:100,name:"Entity12",type:"inside"}],linkDataArray:[{id:1,from:"Entity1",to:"Entity2",pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1,remark:"主键"},{id:3,from:"Entity2",to:"Entity3",pos:[{x:400,y:150},{x:300,y:150},{x:300,y:450},{x:150,y:450}],type:"foreignKey",numLineTypes:1},{id:4,from:"Entity1",to:"Entity4",pos:[{x:120,y:200},{x:120,y:250}],type:"toFilter",numLineTypes:2},{id:5,from:"Entity4",to:"Entity3",pos:[{x:120,y:270},{x:120,y:400}],type:"fromFilter",numLineTypes:4},{id:6,from:"Entity5",to:"Entity6",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:7,from:"Entity9",to:"Entity10",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:8,from:"Entity2",to:"Entity9",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:9,from:"Entity2",to:"Entity1",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:10,from:"Entity9",to:"Entity11",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:11,from:"Entity2",to:"Entity12",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"}],markDataArray:[{id:"Mark1",x:50,y:50,width:500,height:500,name:"Mark1"}],noteDataArray:[{id:"157837643603536658",x:525,y:408,text:"啦啦啦啦啦111",type:"note",color:"#0000ff"}]},we=""+new URL("symbol-defs-01fb22be.svg",import.meta.url).href,su={class:"erg"},ou={class:"toobar"},ru=["xlink:href"],iu=["xlink:href"],au=["xlink:href"],nu=["xlink:href"],lu=["xlink:href"],du=["xlink:href"],uu=["xlink:href"],cu=["xlink:href"],hu=["xlink:href"],pu=["xlink:href"],fu=["xlink:href"],yu=["xlink:href"],gu=["xlink:href"],mu=N("div",{id:"canvas",class:"canvas"},null,-1),ws=U({__name:"Base",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(s,{expose:e}){const o=s,t=M(),a=vt({scale:100,bgC:"",bdC:"",color:"",lock:"edit",viewType:zs.Detail}),i=()=>{const C="-apple-system, Noto Sans, Helvetica Neue, Helvetica, Nimbus Sans L, Arial, Liberation Sans, PingFang SC, Hiragino Sans GB, Noto Sans CJK SC, Source Han Sans SC, Source Han Sans CN, Microsoft YaHei, Wenquanyi Micro Hei, WenQuanYi Zen Hei, ST Heiti, SimHei, WenQuanYi Zen Hei Sharp, sans-serif";t.value=new Pr({el:document.getElementById("canvas"),fontFamily:C,editable:a.lock,useThumbnail:o.useThumbnail,useAttrFocus:o.useAttrFocus,externalFn:{addNode:function(m){const B=prompt("请输入表名：");B&&(m.name=B,$e.nodeDataArray.push(m))},delNode:function(m){console.log(m)},addLine:function(m){console.log("添加线了"),m.numLineTypes=2,$e.linkDataArray.push(m)},delLine:function(m){console.log(m)},addFilter:function(m){m.filter&&$e.nodeDataArray.push(m.filter),m.toFilter&&$e.linkDataArray.push(m.toFilter),$e.linkDataArray.push(m.fromFilter)},delFilter:function(m){console.log(m)},addMark:function(m){$e.markDataArray.push(m),markMap.set(m.id,m)},delMark:function(m){console.log(m)},addNote:function(m){const B=prompt("请输入备注内容：");B&&(m.text=B,$e.noteDataArray.push(m))},delNote:function(m){console.log(m)},$message:function(m){console.log(m.message)},handleCopy(m,B){return console.log(m,B),!0},handlePaste(m){$e.nodeDataArray.push(...m)}}}),t.value.update($e)},r=()=>{t.value.destroy()},n=C=>{a.scale>20&&(a.scale+=C),t.value.zoom(a.scale)},l=()=>{t.value.addNode({id:t.value.createKey(),attributes:[]})},u=C=>{t.value.addLine(C)},c=()=>{t.value.addMark()},d=()=>{t.value.addNote()},f=(C,m)=>{t.value.changeColor(C,m)},y=()=>{a.lock=a.lock===1?2:1,t.value.setEditable(a.lock)},v=()=>{t.value.copy()},p=()=>{const C=[{from:0,to:1,pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1}];t.value.createLines(C)},x=()=>t.value.updateLayout();return ge(i),Gt(r),e({graph:t}),(C,m)=>(w(),E("div",su,[N("div",ou,[A(h(fe),{size:"small",circle:"",title:"新增实体",onClick:l},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-add`},null,8,ru)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"复制",onClick:v},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#copy`},null,8,iu)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"新增主键",onClick:m[0]||(m[0]=B=>u("primaryKey"))},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-primary`},null,8,au)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"新增非主键",onClick:m[1]||(m[1]=B=>u("foreignKey"))},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-foreign`},null,8,nu)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"新增过滤器",onClick:m[2]||(m[2]=B=>u("branchLine"))},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-subtype`},null,8,lu)]))]),_:1}),A(h(Ot),{direction:"vertical"}),A(h(fe),{size:"small",circle:"",title:"新增框",onClick:c},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-square`},null,8,du)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"新增备注",onClick:d},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#icon-tool-text`},null,8,uu)]))]),_:1}),A(h(Ot),{direction:"vertical"}),a.lock===1?(w(),K(h(fe),{key:0,size:"small",circle:"",title:"只读",onClick:y},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#lock`},null,8,cu)]))]),_:1})):(w(),K(h(fe),{key:1,size:"small",circle:"",title:"编辑",onClick:y},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#unlock`},null,8,hu)]))]),_:1})),A(h(fe),{size:"small",circle:"",title:"批量创建连线",onClick:p},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#copy`},null,8,pu)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"放大",onClick:m[3]||(m[3]=B=>n(20))},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#plus-circle`},null,8,fu)]))]),_:1}),A(h(fe),{size:"small",circle:"",title:"缩小",onClick:m[4]||(m[4]=B=>n(-20))},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#minus-circle`},null,8,yu)]))]),_:1}),A(h(Ot),{direction:"vertical"}),A(h(Ls),{modelValue:a.bgC,"onUpdate:modelValue":m[5]||(m[5]=B=>a.bgC=B),size:"small",onChange:m[6]||(m[6]=B=>f(B,"bgC"))},null,8,["modelValue"]),A(h(Ls),{modelValue:a.bdC,"onUpdate:modelValue":m[7]||(m[7]=B=>a.bdC=B),size:"small",onChange:m[8]||(m[8]=B=>f(B,"bdC"))},null,8,["modelValue"]),A(h(Ls),{modelValue:a.color,"onUpdate:modelValue":m[9]||(m[9]=B=>a.color=B),size:"small",onChange:m[10]||(m[10]=B=>f(B,"color"))},null,8,["modelValue"]),A(h(Ot),{direction:"vertical"}),A(h(fe),{size:"small",circle:"",title:"自动布局",onClick:m[11]||(m[11]=B=>x())},{icon:$(()=>[(w(),E("svg",null,[N("use",{"xlink:href":`${h(we)}#layout-o`},null,8,gu)]))]),_:1}),A(h(Ot),{direction:"vertical"}),A(h(Ld),{modelValue:a.viewType,"onUpdate:modelValue":m[12]||(m[12]=B=>a.viewType=B),size:"small",placeholder:"选择视图"},{default:$(()=>[(w(!0),E(Ae,null,Kt(h(zs),(B,k)=>(w(),K(h(Rd),{label:k,value:B},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),mu]))}});ws.__docgenInfo={exportName:"default",displayName:"Base",description:"",tags:{},expose:[{name:"graph"}],props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/Base.vue"]};const vu=[[{icon:"",value:"copy",label:"复制"},{icon:"",value:"extend-copy",label:"继承复制"},{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"parent",label:"显示父级关联",children:[{icon:"",value:"level-1",label:"显示1级"},{icon:"",value:"level-2",label:"显示2级"},{icon:"",value:"level-all",label:"显示全部"}]}],[{icon:"",value:"auto-size",label:"自适应大小"},{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}],{icon:"",value:"delete",label:"删除"}],xu=[[{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}]],bu=N("div",{class:"association__content"},[N("div",{id:"association",class:"association"})],-1),Mr=U({__name:"parent-association",props:{dialogVisible:{type:Boolean,required:!0}},emits:["update:dialogVisible"],setup(s,{emit:e}){const o=s,t=T(l=>o.dialogVisible),a=()=>e("update:dialogVisible",!1);let i;const r=()=>{i=new Pr({el:document.getElementById("association"),useThumbnail:!0})},n=()=>i.destroy();return ge(()=>Y(r)),Gt(n),(l,u)=>(w(),K(h(dd),{title:"Preview",modelValue:h(t),"onUpdate:modelValue":u[0]||(u[0]=c=>Ko(t)?t.value=c:null),"append-to-body":!0,"close-on-click-modal":!1,"before-close":a,width:"80%",class:"dialog-association"},{default:$(()=>[bu]),_:1},8,["modelValue"]))}});Mr.__docgenInfo={exportName:"default",displayName:"parent-association",description:"",tags:{},props:[{name:"dialogVisible",type:{name:"boolean"},required:!0}],events:[{name:"update:dialogVisible"}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/components/parent-association.vue"]};const wu={class:"erg-right-menu"},Nr=U({__name:"RightMenu",setup(s){const e=M(),o=M(!1),t=T(()=>e.value.graph);return ge(()=>{t.value.updateConfig({useRightMenu:!0}),t.value.on("contextmenu:show",i=>{console.log(i.target),t.value.updateConfig({rightMenu:i.target?vu:xu})}),t.value.on("contextmenu:click",i=>{switch(console.log(i.target),i.value){case"level-1":o.value=!0;break;case"level-2":o.value=!0;break;case"level-all":o.value=!0;break}})}),(i,r)=>(w(),E("div",wu,[A(ws,{ref_key:"erg",ref:e},null,512),o.value?(w(),K(Mr,{key:0,id:"11",dialogVisible:o.value,"onUpdate:dialogVisible":r[0]||(r[0]=n=>o.value=n)},null,8,["dialogVisible"])):_("",!0)]))}});Nr.__docgenInfo={exportName:"default",displayName:"RightMenu",description:"",tags:{},sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/RightMenu.vue"]};const Bu={class:"erg-extra-drawing"},Fr=U({__name:"ExtraDrawing",setup(s){const e=M(),o=T(()=>e.value.graph);return ge(()=>{o.value.on("graph:beforeUpdate",a=>{$e.nodeDataArray.map(({id:i},r)=>{if(r%2)return;const n=o.value.dataHandler.originDataMap.get(i);n&&(a.save(),a.font="16px",a.fillStyle="#F59A23",a.strokeStyle="#F59A23",a.textAlign="right",a.textBaseline="top",a.fillText("正在编辑",n.x+n.width,n.y-22),a.lineWidth=2,a.strokeRect(n.x,n.y,n.width,n.height),a.restore())})})}),(a,i)=>(w(),E("div",Bu,[A(ws,{ref_key:"erg",ref:e},null,512)]))}});Fr.__docgenInfo={exportName:"default",displayName:"ExtraDrawing",description:"",tags:{},sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/ExtraDrawing.vue"]};const Tu={title:"Example/Erg",component:ws,argTypes:{editable:{control:"select",options:[1,2,3]}},args:{useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:!0}},ts={},ss=()=>Nr,os=()=>Fr;var Eo,Lo,Ro;ts.parameters={...ts.parameters,docs:{...(Eo=ts.parameters)==null?void 0:Eo.docs,source:{originalSource:"{}",...(Ro=(Lo=ts.parameters)==null?void 0:Lo.docs)==null?void 0:Ro.source}}};var $o,Ao,Do;ss.parameters={...ss.parameters,docs:{...($o=ss.parameters)==null?void 0:$o.docs,source:{originalSource:"() => RightMenuCom",...(Do=(Ao=ss.parameters)==null?void 0:Ao.docs)==null?void 0:Do.source}}};var zo,Ho,Oo;os.parameters={...os.parameters,docs:{...(zo=os.parameters)==null?void 0:zo.docs,source:{originalSource:"() => ExtraDrawingCom",...(Oo=(Ho=os.parameters)==null?void 0:Ho.docs)==null?void 0:Oo.source}}};const Pu=["Base","RightMenu","ExtraDrawing"];export{ts as Base,os as ExtraDrawing,ss as RightMenu,Pu as __namedExportsOrder,Tu as default};
//# sourceMappingURL=Erg.stories-2bb42429.js.map
