import{i as je,a as T,g as dt,o as pe,w as gi,b as ds,d as yi,e as bn,f as G,j as xn,N as ws,k as S,l as k,m as Q,n as st,u as wn,p as mi,s as Et,q as X,v as Gs,x as ze,y as ut,z as x,A as O,B as _,F as Ye,C as N,D as p,E,G as K,H as R,I as rt,J as Cs,K as H,L as et,M as fe,O as ne,P as ns,Q as mt,T as kt,R as us,r as Rt,S as Cn,U as bo,V as ss,W as Fe,X as xo,h as Bn,Y as vi,Z as Tn,t as Ps,_ as so,$ as Qt,a0 as Ks,a1 as gt,a2 as Nn,a3 as Mn,a4 as Pn,a5 as bi,a6 as wo}from"./vue.esm-bundler-0f7b14ab.js";import{i as as,g as Sn,e as En,a as xi,b as Fn,c as On,S as Ss,d as Rs,f as wi,h as Ci,o as Rn,k as Bi,r as An,j as Ti,s as Ln,l as Dn,U as Co,m as As,n as oo,p as Es,q as Ni,t as $n,u as Hn,v as _n,w as io,x as Mi,y as zn,z as Pi,A as Si,B as Vn,C as ot,D as Wn,E as Kn,F as Ft,G as Ei,H as le,I as Bo,J as kn,K as Un,L as jn,M as Ae,N as be,O as no,P as qn,Q as Ge,R as Yn,T as Ut,V as Fi,W as ve,X as ao,Y as Oi,Z as ro,_ as Ri,$ as Gn,a0 as Xn,a1 as In,a2 as Bs,a3 as cs,a4 as rs,a5 as qe,a6 as Ai,a7 as ce,a8 as Li,a9 as At,aa as Zn,ab as Qn,ac as Fs,ad as Wt,ae as lo,af as hs,ag as Xs,ah as Ne,ai as Di,aj as $i,ak as Jn,al as Hi,am as ea,an as ta,ao as sa,ap as oa,aq as To,ar as ia,as as na,at as Is,au as Zs,av as aa,aw as Ue,ax as ra,ay as No,az as Qs,aA as la,aB as da,aC as ua,aD as ca,aE as ha,aF as fa,aG as _i,aH as pa,aI as Mo,aJ as ga,aK as ya,aL as ma,aM as Lt,aN as Nt,aO as _e,aP as zi,aQ as tt,aR as Vi,aS as Wi,aT as Ki,aU as ki,aV as va,aW as $e,aX as j,aY as Re,aZ as re,a_ as me,a$ as Oe,b0 as Mt,b1 as ue,b2 as J,b3 as oe,b4 as ba,b5 as Ve,b6 as xa,b7 as wa,b8 as He,b9 as Ca,ba as Po,bb as Ba,bc as Ta,bd as Ee,be as Vt,bf as Pt,bg as se,bh as So,bi as ks}from"./tween.esm-6e2a2569.js";const uo=o=>{let e,s;return o.type==="touchend"?(s=o.changedTouches[0].clientY,e=o.changedTouches[0].clientX):o.type.startsWith("touch")?(s=o.touches[0].clientY,e=o.touches[0].clientX):(s=o.clientY,e=o.clientX),{clientX:e,clientY:s}};function Na(o){return o}var Eo=Object.create,Ma=function(){function o(){}return function(e){if(!as(e))return{};if(Eo)return Eo(e);o.prototype=e;var s=new o;return o.prototype=void 0,s}}();const Pa=Ma;function Sa(o,e,s){switch(s.length){case 0:return o.call(e);case 1:return o.call(e,s[0]);case 2:return o.call(e,s[0],s[1]);case 3:return o.call(e,s[0],s[1],s[2])}return o.apply(e,s)}function Ea(o,e){var s=-1,t=o.length;for(e||(e=Array(t));++s<t;)e[s]=o[s];return e}var Fa=800,Oa=16,Ra=Date.now;function Aa(o){var e=0,s=0;return function(){var t=Ra(),a=Oa-(t-s);if(s=t,a>0){if(++e>=Fa)return arguments[0]}else e=0;return o.apply(void 0,arguments)}}function La(o){return function(){return o}}var Da=function(){try{var o=Sn(Object,"defineProperty");return o({},"",{}),o}catch{}}();const Os=Da;var $a=Os?function(o,e){return Os(o,"toString",{configurable:!0,enumerable:!1,value:La(e),writable:!0})}:Na;const Ha=$a;var _a=Aa(Ha);const za=_a;function Va(o,e){for(var s=-1,t=o==null?0:o.length;++s<t&&e(o[s],s,o)!==!1;);return o}function Ui(o,e,s){e=="__proto__"&&Os?Os(o,e,{configurable:!0,enumerable:!0,value:s,writable:!0}):o[e]=s}var Wa=Object.prototype,Ka=Wa.hasOwnProperty;function co(o,e,s){var t=o[e];(!(Ka.call(o,e)&&En(t,s))||s===void 0&&!(e in o))&&Ui(o,e,s)}function Ls(o,e,s,t){var a=!s;s||(s={});for(var n=-1,i=e.length;++n<i;){var r=e[n],l=t?t(s[r],o[r],r,s,o):void 0;l===void 0&&(l=o[r]),a?Ui(s,r,l):co(s,r,l)}return s}var Fo=Math.max;function ka(o,e,s){return e=Fo(e===void 0?o.length-1:e,0),function(){for(var t=arguments,a=-1,n=Fo(t.length-e,0),i=Array(n);++a<n;)i[a]=t[e+a];a=-1;for(var r=Array(e+1);++a<e;)r[a]=t[a];return r[e]=s(i),Sa(o,this,r)}}function Ua(o){var e=[];if(o!=null)for(var s in Object(o))e.push(s);return e}var ja=Object.prototype,qa=ja.hasOwnProperty;function Ya(o){if(!as(o))return Ua(o);var e=xi(o),s=[];for(var t in o)t=="constructor"&&(e||!qa.call(o,t))||s.push(t);return s}function ho(o){return Fn(o)?On(o,!0):Ya(o)}var Oo=Ss?Ss.isConcatSpreadable:void 0;function Ga(o){return Rs(o)||wi(o)||!!(Oo&&o&&o[Oo])}function ji(o,e,s,t,a){var n=-1,i=o.length;for(s||(s=Ga),a||(a=[]);++n<i;){var r=o[n];e>0&&s(r)?e>1?ji(r,e-1,s,t,a):Ci(a,r):t||(a[a.length]=r)}return a}function Xa(o){var e=o==null?0:o.length;return e?ji(o,1):[]}function Ia(o){return za(ka(o,void 0,Xa),o+"")}var Za=Rn(Object.getPrototypeOf,Object);const qi=Za;function Qa(o,e){return o&&Ls(e,Bi(e),o)}function Ja(o,e){return o&&Ls(e,ho(e),o)}var Yi=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ro=Yi&&typeof module=="object"&&module&&!module.nodeType&&module,er=Ro&&Ro.exports===Yi,Ao=er?An.Buffer:void 0,Lo=Ao?Ao.allocUnsafe:void 0;function tr(o,e){if(e)return o.slice();var s=o.length,t=Lo?Lo(s):new o.constructor(s);return o.copy(t),t}function sr(o,e){return Ls(o,Ti(o),e)}var or=Object.getOwnPropertySymbols,ir=or?function(o){for(var e=[];o;)Ci(e,Ti(o)),o=qi(o);return e}:Ln;const Gi=ir;function nr(o,e){return Ls(o,Gi(o),e)}function ar(o){return Dn(o,ho,Gi)}var rr=Object.prototype,lr=rr.hasOwnProperty;function dr(o){var e=o.length,s=new o.constructor(e);return e&&typeof o[0]=="string"&&lr.call(o,"index")&&(s.index=o.index,s.input=o.input),s}function fo(o){var e=new o.constructor(o.byteLength);return new Co(e).set(new Co(o)),e}function ur(o,e){var s=e?fo(o.buffer):o.buffer;return new o.constructor(s,o.byteOffset,o.byteLength)}var cr=/\w*$/;function hr(o){var e=new o.constructor(o.source,cr.exec(o));return e.lastIndex=o.lastIndex,e}var Do=Ss?Ss.prototype:void 0,$o=Do?Do.valueOf:void 0;function fr(o){return $o?Object($o.call(o)):{}}function pr(o,e){var s=e?fo(o.buffer):o.buffer;return new o.constructor(s,o.byteOffset,o.length)}var gr="[object Boolean]",yr="[object Date]",mr="[object Map]",vr="[object Number]",br="[object RegExp]",xr="[object Set]",wr="[object String]",Cr="[object Symbol]",Br="[object ArrayBuffer]",Tr="[object DataView]",Nr="[object Float32Array]",Mr="[object Float64Array]",Pr="[object Int8Array]",Sr="[object Int16Array]",Er="[object Int32Array]",Fr="[object Uint8Array]",Or="[object Uint8ClampedArray]",Rr="[object Uint16Array]",Ar="[object Uint32Array]";function Lr(o,e,s){var t=o.constructor;switch(e){case Br:return fo(o);case gr:case yr:return new t(+o);case Tr:return ur(o,s);case Nr:case Mr:case Pr:case Sr:case Er:case Fr:case Or:case Rr:case Ar:return pr(o,s);case mr:return new t;case vr:case wr:return new t(o);case br:return hr(o);case xr:return new t;case Cr:return fr(o)}}function Dr(o){return typeof o.constructor=="function"&&!xi(o)?Pa(qi(o)):{}}var $r="[object Map]";function Hr(o){return As(o)&&oo(o)==$r}var Ho=Es&&Es.isMap,_r=Ho?Ni(Ho):Hr;const zr=_r;var Vr="[object Set]";function Wr(o){return As(o)&&oo(o)==Vr}var _o=Es&&Es.isSet,Kr=_o?Ni(_o):Wr;const kr=Kr;var Ur=1,jr=2,qr=4,Xi="[object Arguments]",Yr="[object Array]",Gr="[object Boolean]",Xr="[object Date]",Ir="[object Error]",Ii="[object Function]",Zr="[object GeneratorFunction]",Qr="[object Map]",Jr="[object Number]",Zi="[object Object]",el="[object RegExp]",tl="[object Set]",sl="[object String]",ol="[object Symbol]",il="[object WeakMap]",nl="[object ArrayBuffer]",al="[object DataView]",rl="[object Float32Array]",ll="[object Float64Array]",dl="[object Int8Array]",ul="[object Int16Array]",cl="[object Int32Array]",hl="[object Uint8Array]",fl="[object Uint8ClampedArray]",pl="[object Uint16Array]",gl="[object Uint32Array]",I={};I[Xi]=I[Yr]=I[nl]=I[al]=I[Gr]=I[Xr]=I[rl]=I[ll]=I[dl]=I[ul]=I[cl]=I[Qr]=I[Jr]=I[Zi]=I[el]=I[tl]=I[sl]=I[ol]=I[hl]=I[fl]=I[pl]=I[gl]=!0;I[Ir]=I[Ii]=I[il]=!1;function Ts(o,e,s,t,a,n){var i,r=e&Ur,l=e&jr,u=e&qr;if(s&&(i=a?s(o,t,a,n):s(o)),i!==void 0)return i;if(!as(o))return o;var h=Rs(o);if(h){if(i=dr(o),!r)return Ea(o,i)}else{var d=oo(o),c=d==Ii||d==Zr;if($n(o))return tr(o,r);if(d==Zi||d==Xi||c&&!a){if(i=l||c?{}:Dr(o),!r)return l?nr(o,Ja(i,o)):sr(o,Qa(i,o))}else{if(!I[d])return a?o:{};i=Lr(o,d,r)}}n||(n=new Hn);var f=n.get(o);if(f)return f;n.set(o,i),kr(o)?o.forEach(function(b){i.add(Ts(b,e,s,b,o,n))}):zr(o)&&o.forEach(function(b,v){i.set(v,Ts(b,e,s,v,o,n))});var y=u?l?ar:_n:l?ho:Bi,g=h?void 0:y(o);return Va(g||o,function(b,v){g&&(v=b,b=o[v]),co(i,v,Ts(b,e,s,v,o,n))}),i}var yl=1,ml=4;function Js(o){return Ts(o,yl|ml)}function vl(o,e){return o!=null&&e in Object(o)}function bl(o,e,s){e=io(e,o);for(var t=-1,a=e.length,n=!1;++t<a;){var i=Mi(e[t]);if(!(n=o!=null&&s(o,i)))break;o=o[i]}return n||++t!=a?n:(a=o==null?0:o.length,!!a&&zn(a)&&Pi(i,a)&&(Rs(o)||wi(o)))}function xl(o,e){return o!=null&&bl(o,e,vl)}var wl="[object String]";function zo(o){return typeof o=="string"||!Rs(o)&&As(o)&&Si(o)==wl}var Cl="[object Boolean]";function Jt(o){return o===!0||o===!1||As(o)&&Si(o)==Cl}function Bl(o,e,s,t){if(!as(o))return o;e=io(e,o);for(var a=-1,n=e.length,i=n-1,r=o;r!=null&&++a<n;){var l=Mi(e[a]),u=s;if(l==="__proto__"||l==="constructor"||l==="prototype")return o;if(a!=i){var h=r[l];u=t?t(h,l,r):void 0,u===void 0&&(u=as(h)?h:Pi(e[a+1])?[]:{})}co(r,l,u),r=r[l]}return o}function Tl(o,e,s){for(var t=-1,a=e.length,n={};++t<a;){var i=e[t],r=Vn(o,i);s(r,i)&&Bl(n,io(i,o),r)}return n}function Nl(o,e){return Tl(o,e,function(s,t){return xl(o,t)})}var Ml=Ia(function(o,e){return o==null?{}:Nl(o,e)});const Vo=Ml;let ys;const Pl=o=>{var e;if(!ot)return 0;if(ys!==void 0)return ys;const s=document.createElement("div");s.className=`${o}-scrollbar__wrap`,s.style.visibility="hidden",s.style.width="100px",s.style.position="absolute",s.style.top="-9999px",document.body.appendChild(s);const t=s.offsetWidth;s.style.overflow="scroll";const a=document.createElement("div");a.style.width="100%",s.appendChild(a);const n=a.offsetWidth;return(e=s.parentNode)==null||e.removeChild(s),ys=t-n,ys};function Sl(o,e){if(!ot)return;if(!e){o.scrollTop=0;return}const s=[];let t=e.offsetParent;for(;t!==null&&o!==t&&o.contains(t);)s.push(t),t=t.offsetParent;const a=e.offsetTop+s.reduce((l,u)=>l+u.offsetTop,0),n=a+e.offsetHeight,i=o.scrollTop,r=i+o.clientHeight;a<i?o.scrollTop=a:n>r&&(o.scrollTop=n-o.clientHeight)}const El=(...o)=>e=>{o.forEach(s=>{je(s)?s(e):s.value=e})},Fl=o=>Wn[o||"default"];var Ns=(o=>(o[o.TEXT=1]="TEXT",o[o.CLASS=2]="CLASS",o[o.STYLE=4]="STYLE",o[o.PROPS=8]="PROPS",o[o.FULL_PROPS=16]="FULL_PROPS",o[o.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",o[o.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",o[o.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",o[o.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",o[o.NEED_PATCH=512]="NEED_PATCH",o[o.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",o[o.HOISTED=-1]="HOISTED",o[o.BAIL=-2]="BAIL",o))(Ns||{});const Ol=["class","style"],Rl=/^on[A-Z]/,Al=(o={})=>{const{excludeListeners:e=!1,excludeKeys:s}=o,t=T(()=>((s==null?void 0:s.value)||[]).concat(Ol)),a=dt();return a?T(()=>{var n;return Kn(Object.entries((n=a.proxy)==null?void 0:n.$attrs).filter(([i])=>!t.value.includes(i)&&!(e&&Rl.test(i))))}):T(()=>({}))},Ll=(o,e,s)=>{let t={offsetX:0,offsetY:0};const a=r=>{const l=r.clientX,u=r.clientY,{offsetX:h,offsetY:d}=t,c=o.value.getBoundingClientRect(),f=c.left,y=c.top,g=c.width,b=c.height,v=document.documentElement.clientWidth,w=document.documentElement.clientHeight,M=-f+h,F=-y+d,z=v-f-g+h,D=w-y-b+d,P=U=>{const A=Math.min(Math.max(h+U.clientX-l,M),z),q=Math.min(Math.max(d+U.clientY-u,F),D);t={offsetX:A,offsetY:q},o.value.style.transform=`translate(${Ft(A)}, ${Ft(q)})`},$=()=>{document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",$)};document.addEventListener("mousemove",P),document.addEventListener("mouseup",$)},n=()=>{e.value&&o.value&&e.value.addEventListener("mousedown",a)},i=()=>{e.value&&o.value&&e.value.removeEventListener("mousedown",a)};pe(()=>{gi(()=>{s.value?n():i()})}),ds(()=>{i()})},Dl=o=>({focus:()=>{var e,s;(s=(e=o.value)==null?void 0:e.focus)==null||s.call(e)}}),$l=(o,e={})=>{yi(o)||Ei("[useLockscreen]","You need to pass a ref param to this function");const s=e.ns||le("popup"),t=bn(()=>s.bm("parent","hidden"));if(!ot||Bo(document.body,t.value))return;let a=0,n=!1,i="0";const r=()=>{setTimeout(()=>{jn(document==null?void 0:document.body,t.value),n&&document&&(document.body.style.width=i)},200)};G(o,l=>{if(!l){r();return}n=!Bo(document.body,t.value),n&&(i=document.body.style.width),a=Pl(s.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,h=kn(document.body,"overflowY");a>0&&(u||h==="scroll")&&n&&(document.body.style.width=`calc(100% - ${a}px)`),Un(document.body,t.value)}),xn(()=>r())},Qi=o=>{if(!o)return{onClick:ws,onMousedown:ws,onMouseup:ws};let e=!1,s=!1;return{onClick:i=>{e&&s&&o(i),e=s=!1},onMousedown:i=>{e=i.target===i.currentTarget},onMouseup:i=>{s=i.target===i.currentTarget}}};function Hl(o){const e=S();function s(){if(o.value==null)return;const{selectionStart:a,selectionEnd:n,value:i}=o.value;if(a==null||n==null)return;const r=i.slice(0,Math.max(0,a)),l=i.slice(Math.max(0,n));e.value={selectionStart:a,selectionEnd:n,value:i,beforeTxt:r,afterTxt:l}}function t(){if(o.value==null||e.value==null)return;const{value:a}=o.value,{beforeTxt:n,afterTxt:i,selectionStart:r}=e.value;if(n==null||i==null||r==null)return;let l=a.length;if(a.endsWith(i))l=a.length-i.length;else if(a.startsWith(n))l=n.length;else{const u=n[r-1],h=a.indexOf(u,r-1);h!==-1&&(l=h+1)}o.value.setSelectionRange(l,l)}return[s,t]}const _l=Ae({a11y:{type:Boolean,default:!0},locale:{type:be(Object)},size:no,button:{type:be(Object)},experimentalFeatures:{type:be(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:be(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),eo={};k({name:"ElConfigProvider",props:_l,setup(o,{slots:e}){G(()=>o.message,t=>{Object.assign(eo,t??{})},{immediate:!0,deep:!0});const s=qn(o);return()=>Q(e,"default",{config:s==null?void 0:s.value})}});let ke;const zl=`
  height:0 !important;
  visibility:hidden !important;
  ${Yn()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Vl=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Wl(o){const e=window.getComputedStyle(o),s=e.getPropertyValue("box-sizing"),t=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),a=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:Vl.map(i=>`${i}:${e.getPropertyValue(i)}`).join(";"),paddingSize:t,borderSize:a,boxSizing:s}}function Wo(o,e=1,s){var t;ke||(ke=document.createElement("textarea"),document.body.appendChild(ke));const{paddingSize:a,borderSize:n,boxSizing:i,contextStyle:r}=Wl(o);ke.setAttribute("style",`${r};${zl}`),ke.value=o.value||o.placeholder||"";let l=ke.scrollHeight;const u={};i==="border-box"?l=l+n:i==="content-box"&&(l=l-a),ke.value="";const h=ke.scrollHeight-a;if(Ge(e)){let d=h*e;i==="border-box"&&(d=d+a+n),l=Math.max(d,l),u.minHeight=`${d}px`}if(Ge(s)){let d=h*s;i==="border-box"&&(d=d+a+n),l=Math.min(d,l)}return u.height=`${l}px`,(t=ke.parentNode)==null||t.removeChild(ke),ke=void 0,u}const Kl=Ae({id:{type:String,default:void 0},size:no,disabled:Boolean,modelValue:{type:be([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:be([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Ut},prefixIcon:{type:Ut},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:be([Object,Array,String]),default:()=>Fi({})}}),kl={[ve]:o=>st(o),input:o=>st(o),change:o=>st(o),focus:o=>o instanceof FocusEvent,blur:o=>o instanceof FocusEvent,clear:()=>!0,mouseleave:o=>o instanceof MouseEvent,mouseenter:o=>o instanceof MouseEvent,keydown:o=>o instanceof Event,compositionstart:o=>o instanceof CompositionEvent,compositionupdate:o=>o instanceof CompositionEvent,compositionend:o=>o instanceof CompositionEvent},Ul=["role"],jl=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],ql=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],Yl=k({name:"ElInput",inheritAttrs:!1}),Gl=k({...Yl,props:Kl,emits:kl,setup(o,{expose:e,emit:s}){const t=o,a=wn(),n=mi(),i=T(()=>{const B={};return t.containerRole==="combobox"&&(B["aria-haspopup"]=a["aria-haspopup"],B["aria-owns"]=a["aria-owns"],B["aria-expanded"]=a["aria-expanded"]),B}),r=T(()=>[t.type==="textarea"?b.b():g.b(),g.m(f.value),g.is("disabled",y.value),g.is("exceed",Be.value),{[g.b("group")]:n.prepend||n.append,[g.bm("group","append")]:n.append,[g.bm("group","prepend")]:n.prepend,[g.m("prefix")]:n.prefix||t.prefixIcon,[g.m("suffix")]:n.suffix||t.suffixIcon||t.clearable||t.showPassword,[g.bm("suffix","password-clear")]:xe.value&&Ie.value},a.class]),l=T(()=>[g.e("wrapper"),g.is("focus",M.value)]),u=Al({excludeKeys:T(()=>Object.keys(i.value))}),{form:h,formItem:d}=ao(),{inputId:c}=Oi(t,{formItemContext:d}),f=ro(),y=Ri(),g=le("input"),b=le("textarea"),v=Et(),w=Et(),M=S(!1),F=S(!1),z=S(!1),D=S(!1),P=S(),$=Et(t.inputStyle),U=T(()=>v.value||w.value),A=T(()=>{var B;return(B=h==null?void 0:h.statusIcon)!=null?B:!1}),q=T(()=>(d==null?void 0:d.validateState)||""),ie=T(()=>q.value&&Gn[q.value]),Ce=T(()=>D.value?Xn:In),ee=T(()=>[a.style,t.inputStyle]),he=T(()=>[t.inputStyle,$.value,{resize:t.resize}]),te=T(()=>Bs(t.modelValue)?"":String(t.modelValue)),xe=T(()=>t.clearable&&!y.value&&!t.readonly&&!!te.value&&(M.value||F.value)),Ie=T(()=>t.showPassword&&!y.value&&!t.readonly&&!!te.value&&(!!te.value||M.value)),V=T(()=>t.showWordLimit&&!!u.value.maxlength&&(t.type==="text"||t.type==="textarea")&&!y.value&&!t.readonly&&!t.showPassword),ae=T(()=>te.value.length),Be=T(()=>!!V.value&&ae.value>Number(u.value.maxlength)),ct=T(()=>!!n.suffix||!!t.suffixIcon||xe.value||t.showPassword||V.value||!!q.value&&A.value),[ht,qt]=Hl(v);cs(w,B=>{if(Yt(),!V.value||t.resize!=="both")return;const Y=B[0],{width:we}=Y.contentRect;P.value={right:`calc(100% - ${we+15+6}px)`}});const it=()=>{const{type:B,autosize:Y}=t;if(!(!ot||B!=="textarea"||!w.value))if(Y){const we=ns(Y)?Y.minRows:void 0,pt=ns(Y)?Y.maxRows:void 0,Ct=Wo(w.value,we,pt);$.value={overflowY:"hidden",...Ct},X(()=>{w.value.offsetHeight,$.value=Ct})}else $.value={minHeight:Wo(w.value).minHeight}},Yt=(B=>{let Y=!1;return()=>{var we;if(Y||!t.autosize)return;((we=w.value)==null?void 0:we.offsetParent)===null||(B(),Y=!0)}})(it),Pe=()=>{const B=U.value;!B||B.value===te.value||(B.value=te.value)},Ze=async B=>{ht();let{value:Y}=B.target;if(t.formatter&&(Y=t.parser?t.parser(Y):Y,Y=t.formatter(Y)),!z.value){if(Y===te.value){Pe();return}s(ve,Y),s("input",Y),await X(),Pe(),qt()}},Dt=B=>{s("change",B.target.value)},vt=B=>{s("compositionstart",B),z.value=!0},ft=B=>{var Y;s("compositionupdate",B);const we=(Y=B.target)==null?void 0:Y.value,pt=we[we.length-1]||"";z.value=!Li(pt)},bt=B=>{s("compositionend",B),z.value&&(z.value=!1,Ze(B))},xt=()=>{D.value=!D.value,We()},We=async()=>{var B;await X(),(B=U.value)==null||B.focus()},Gt=()=>{var B;return(B=U.value)==null?void 0:B.blur()},$t=B=>{M.value=!0,s("focus",B)},Ht=B=>{var Y;M.value=!1,s("blur",B),t.validateEvent&&((Y=d==null?void 0:d.validate)==null||Y.call(d,"blur").catch(we=>rs()))},wt=B=>{F.value=!1,s("mouseleave",B)},Xt=B=>{F.value=!0,s("mouseenter",B)},_t=B=>{s("keydown",B)},It=()=>{var B;(B=U.value)==null||B.select()},Ke=()=>{s(ve,""),s("change",""),s("clear"),s("input","")};return G(()=>t.modelValue,()=>{var B;X(()=>it()),t.validateEvent&&((B=d==null?void 0:d.validate)==null||B.call(d,"change").catch(Y=>rs()))}),G(te,()=>Pe()),G(()=>t.type,async()=>{await X(),Pe(),it()}),pe(()=>{!t.formatter&&t.parser,Pe(),X(it)}),e({input:v,textarea:w,ref:U,textareaStyle:he,autosize:Gs(t,"autosize"),focus:We,blur:Gt,select:It,clear:Ke,resizeTextarea:it}),(B,Y)=>ze((x(),O("div",Cs(p(i),{class:p(r),style:p(ee),role:B.containerRole,onMouseenter:Xt,onMouseleave:wt}),[_(" input "),B.type!=="textarea"?(x(),O(Ye,{key:0},[_(" prepend slot "),B.$slots.prepend?(x(),O("div",{key:0,class:N(p(g).be("group","prepend"))},[Q(B.$slots,"prepend")],2)):_("v-if",!0),E("div",{class:N(p(l))},[_(" prefix slot "),B.$slots.prefix||B.prefixIcon?(x(),O("span",{key:0,class:N(p(g).e("prefix"))},[E("span",{class:N(p(g).e("prefix-inner")),onClick:We},[Q(B.$slots,"prefix"),B.prefixIcon?(x(),K(p(qe),{key:0,class:N(p(g).e("icon"))},{default:R(()=>[(x(),K(rt(B.prefixIcon)))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0),E("input",Cs({id:p(c),ref_key:"input",ref:v,class:p(g).e("inner")},p(u),{type:B.showPassword?D.value?"text":"password":B.type,disabled:p(y),formatter:B.formatter,parser:B.parser,readonly:B.readonly,autocomplete:B.autocomplete,tabindex:B.tabindex,"aria-label":B.label,placeholder:B.placeholder,style:B.inputStyle,form:t.form,onCompositionstart:vt,onCompositionupdate:ft,onCompositionend:bt,onInput:Ze,onFocus:$t,onBlur:Ht,onChange:Dt,onKeydown:_t}),null,16,jl),_(" suffix slot "),p(ct)?(x(),O("span",{key:1,class:N(p(g).e("suffix"))},[E("span",{class:N(p(g).e("suffix-inner")),onClick:We},[!p(xe)||!p(Ie)||!p(V)?(x(),O(Ye,{key:0},[Q(B.$slots,"suffix"),B.suffixIcon?(x(),K(p(qe),{key:0,class:N(p(g).e("icon"))},{default:R(()=>[(x(),K(rt(B.suffixIcon)))]),_:1},8,["class"])):_("v-if",!0)],64)):_("v-if",!0),p(xe)?(x(),K(p(qe),{key:1,class:N([p(g).e("icon"),p(g).e("clear")]),onMousedown:et(p(ws),["prevent"]),onClick:Ke},{default:R(()=>[H(p(Ai))]),_:1},8,["class","onMousedown"])):_("v-if",!0),p(Ie)?(x(),K(p(qe),{key:2,class:N([p(g).e("icon"),p(g).e("password")]),onClick:xt},{default:R(()=>[(x(),K(rt(p(Ce))))]),_:1},8,["class"])):_("v-if",!0),p(V)?(x(),O("span",{key:3,class:N(p(g).e("count"))},[E("span",{class:N(p(g).e("count-inner"))},fe(p(ae))+" / "+fe(p(u).maxlength),3)],2)):_("v-if",!0),p(q)&&p(ie)&&p(A)?(x(),K(p(qe),{key:4,class:N([p(g).e("icon"),p(g).e("validateIcon"),p(g).is("loading",p(q)==="validating")])},{default:R(()=>[(x(),K(rt(p(ie))))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0)],2),_(" append slot "),B.$slots.append?(x(),O("div",{key:1,class:N(p(g).be("group","append"))},[Q(B.$slots,"append")],2)):_("v-if",!0)],64)):(x(),O(Ye,{key:1},[_(" textarea "),E("textarea",Cs({id:p(c),ref_key:"textarea",ref:w,class:p(b).e("inner")},p(u),{tabindex:B.tabindex,disabled:p(y),readonly:B.readonly,autocomplete:B.autocomplete,style:p(he),"aria-label":B.label,placeholder:B.placeholder,form:t.form,onCompositionstart:vt,onCompositionupdate:ft,onCompositionend:bt,onInput:Ze,onFocus:$t,onBlur:Ht,onChange:Dt,onKeydown:_t}),null,16,ql),p(V)?(x(),O("span",{key:0,style:ne(P.value),class:N(p(g).e("count"))},fe(p(ae))+" / "+fe(p(u).maxlength),7)):_("v-if",!0)],64))],16,Ul)),[[ut,B.type!=="hidden"]])}});var Xl=ce(Gl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const Ji=At(Xl),en=Symbol("scrollbarContextKey"),Il=Ae({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),Zl="Thumb",Ql=k({__name:"thumb",props:Il,setup(o){const e=o,s=mt(en),t=le("scrollbar");s||Ei(Zl,"can not inject scrollbar context");const a=S(),n=S(),i=S({}),r=S(!1);let l=!1,u=!1,h=ot?document.onselectstart:null;const d=T(()=>Zn[e.vertical?"vertical":"horizontal"]),c=T(()=>Qn({size:e.size,move:e.move,bar:d.value})),f=T(()=>a.value[d.value.offset]**2/s.wrapElement[d.value.scrollSize]/e.ratio/n.value[d.value.offset]),y=D=>{var P;if(D.stopPropagation(),D.ctrlKey||[1,2].includes(D.button))return;(P=window.getSelection())==null||P.removeAllRanges(),b(D);const $=D.currentTarget;$&&(i.value[d.value.axis]=$[d.value.offset]-(D[d.value.client]-$.getBoundingClientRect()[d.value.direction]))},g=D=>{if(!n.value||!a.value||!s.wrapElement)return;const P=Math.abs(D.target.getBoundingClientRect()[d.value.direction]-D[d.value.client]),$=n.value[d.value.offset]/2,U=(P-$)*100*f.value/a.value[d.value.offset];s.wrapElement[d.value.scroll]=U*s.wrapElement[d.value.scrollSize]/100},b=D=>{D.stopImmediatePropagation(),l=!0,document.addEventListener("mousemove",v),document.addEventListener("mouseup",w),h=document.onselectstart,document.onselectstart=()=>!1},v=D=>{if(!a.value||!n.value||l===!1)return;const P=i.value[d.value.axis];if(!P)return;const $=(a.value.getBoundingClientRect()[d.value.direction]-D[d.value.client])*-1,U=n.value[d.value.offset]-P,A=($-U)*100*f.value/a.value[d.value.offset];s.wrapElement[d.value.scroll]=A*s.wrapElement[d.value.scrollSize]/100},w=()=>{l=!1,i.value[d.value.axis]=0,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",w),z(),u&&(r.value=!1)},M=()=>{u=!1,r.value=!!e.size},F=()=>{u=!0,r.value=l};ds(()=>{z(),document.removeEventListener("mouseup",w)});const z=()=>{document.onselectstart!==h&&(document.onselectstart=h)};return Fs(Gs(s,"scrollbarElement"),"mousemove",M),Fs(Gs(s,"scrollbarElement"),"mouseleave",F),(D,P)=>(x(),K(kt,{name:p(t).b("fade"),persisted:""},{default:R(()=>[ze(E("div",{ref_key:"instance",ref:a,class:N([p(t).e("bar"),p(t).is(p(d).key)]),onMousedown:g},[E("div",{ref_key:"thumb",ref:n,class:N(p(t).e("thumb")),style:ne(p(c)),onMousedown:y},null,38)],34),[[ut,D.always||r.value]])]),_:1},8,["name"]))}});var Ko=ce(Ql,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const Jl=Ae({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),ed=k({__name:"bar",props:Jl,setup(o,{expose:e}){const s=o,t=S(0),a=S(0);return e({handleScroll:i=>{if(i){const r=i.offsetHeight-Wt,l=i.offsetWidth-Wt;a.value=i.scrollTop*100/r*s.ratioY,t.value=i.scrollLeft*100/l*s.ratioX}}}),(i,r)=>(x(),O(Ye,null,[H(Ko,{move:t.value,ratio:i.ratioX,size:i.width,always:i.always},null,8,["move","ratio","size","always"]),H(Ko,{move:a.value,ratio:i.ratioY,size:i.height,vertical:"",always:i.always},null,8,["move","ratio","size","always"])],64))}});var td=ce(ed,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const sd=Ae({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:be([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),od={scroll:({scrollTop:o,scrollLeft:e})=>[o,e].every(Ge)},id="ElScrollbar",nd=k({name:id}),ad=k({...nd,props:sd,emits:od,setup(o,{expose:e,emit:s}){const t=o,a=le("scrollbar");let n,i;const r=S(),l=S(),u=S(),h=S("0"),d=S("0"),c=S(),f=S(1),y=S(1),g=T(()=>{const P={};return t.height&&(P.height=Ft(t.height)),t.maxHeight&&(P.maxHeight=Ft(t.maxHeight)),[t.wrapStyle,P]}),b=T(()=>[t.wrapClass,a.e("wrap"),{[a.em("wrap","hidden-default")]:!t.native}]),v=T(()=>[a.e("view"),t.viewClass]),w=()=>{var P;l.value&&((P=c.value)==null||P.handleScroll(l.value),s("scroll",{scrollTop:l.value.scrollTop,scrollLeft:l.value.scrollLeft}))};function M(P,$){ns(P)?l.value.scrollTo(P):Ge(P)&&Ge($)&&l.value.scrollTo(P,$)}const F=P=>{Ge(P)&&(l.value.scrollTop=P)},z=P=>{Ge(P)&&(l.value.scrollLeft=P)},D=()=>{if(!l.value)return;const P=l.value.offsetHeight-Wt,$=l.value.offsetWidth-Wt,U=P**2/l.value.scrollHeight,A=$**2/l.value.scrollWidth,q=Math.max(U,t.minSize),ie=Math.max(A,t.minSize);f.value=U/(P-U)/(q/(P-q)),y.value=A/($-A)/(ie/($-ie)),d.value=q+Wt<P?`${q}px`:"",h.value=ie+Wt<$?`${ie}px`:""};return G(()=>t.noresize,P=>{P?(n==null||n(),i==null||i()):({stop:n}=cs(u,D),i=Fs("resize",D))},{immediate:!0}),G(()=>[t.maxHeight,t.height],()=>{t.native||X(()=>{var P;D(),l.value&&((P=c.value)==null||P.handleScroll(l.value))})}),us(en,Rt({scrollbarElement:r,wrapElement:l})),pe(()=>{t.native||X(()=>{D()})}),Cn(()=>D()),e({wrapRef:l,update:D,scrollTo:M,setScrollTop:F,setScrollLeft:z,handleScroll:w}),(P,$)=>(x(),O("div",{ref_key:"scrollbarRef",ref:r,class:N(p(a).b())},[E("div",{ref_key:"wrapRef",ref:l,class:N(p(b)),style:ne(p(g)),onScroll:w},[(x(),K(rt(P.tag),{ref_key:"resizeRef",ref:u,class:N(p(v)),style:ne(P.viewStyle)},{default:R(()=>[Q(P.$slots,"default")]),_:3},8,["class","style"]))],38),P.native?_("v-if",!0):(x(),K(td,{key:0,ref_key:"barRef",ref:c,height:d.value,width:h.value,always:P.always,"ratio-x":y.value,"ratio-y":f.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var rd=ce(ad,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const ld=At(rd),dd=Ae({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),ud=["textContent"],cd=k({name:"ElBadge"}),hd=k({...cd,props:dd,setup(o,{expose:e}){const s=o,t=le("badge"),a=T(()=>s.isDot?"":Ge(s.value)&&Ge(s.max)?s.max<s.value?`${s.max}+`:`${s.value}`:`${s.value}`);return e({content:a}),(n,i)=>(x(),O("div",{class:N(p(t).b())},[Q(n.$slots,"default"),H(kt,{name:`${p(t).namespace.value}-zoom-in-center`,persisted:""},{default:R(()=>[ze(E("sup",{class:N([p(t).e("content"),p(t).em("content",n.type),p(t).is("fixed",!!n.$slots.default),p(t).is("dot",n.isDot)]),textContent:fe(p(a))},null,10,ud),[[ut,!n.hidden&&(p(a)||n.isDot)]])]),_:1},8,["name"])],2))}});var fd=ce(hd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const pd=At(fd),gd=Ae({color:{type:be(Object),required:!0},vertical:{type:Boolean,default:!1}});let Us=!1;function ls(o,e){if(!ot)return;const s=function(n){var i;(i=e.drag)==null||i.call(e,n)},t=function(n){var i;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",t),document.onselectstart=null,document.ondragstart=null,Us=!1,(i=e.end)==null||i.call(e,n)},a=function(n){var i;Us||(n.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",t),document.addEventListener("touchmove",s),document.addEventListener("touchend",t),Us=!0,(i=e.start)==null||i.call(e,n))};o.addEventListener("mousedown",a),o.addEventListener("touchstart",a)}const yd=o=>{const e=dt(),s=Et(),t=Et();function a(i){i.target!==s.value&&n(i)}function n(i){if(!t.value||!s.value)return;const l=e.vnode.el.getBoundingClientRect(),{clientX:u,clientY:h}=uo(i);if(o.vertical){let d=h-l.top;d=Math.max(s.value.offsetHeight/2,d),d=Math.min(d,l.height-s.value.offsetHeight/2),o.color.set("alpha",Math.round((d-s.value.offsetHeight/2)/(l.height-s.value.offsetHeight)*100))}else{let d=u-l.left;d=Math.max(s.value.offsetWidth/2,d),d=Math.min(d,l.width-s.value.offsetWidth/2),o.color.set("alpha",Math.round((d-s.value.offsetWidth/2)/(l.width-s.value.offsetWidth)*100))}}return{thumb:s,bar:t,handleDrag:n,handleClick:a}},md=(o,{bar:e,thumb:s,handleDrag:t})=>{const a=dt(),n=le("color-alpha-slider"),i=S(0),r=S(0),l=S();function u(){if(!s.value||o.vertical)return 0;const w=a.vnode.el,M=o.color.get("alpha");return w?Math.round(M*(w.offsetWidth-s.value.offsetWidth/2)/100):0}function h(){if(!s.value)return 0;const w=a.vnode.el;if(!o.vertical)return 0;const M=o.color.get("alpha");return w?Math.round(M*(w.offsetHeight-s.value.offsetHeight/2)/100):0}function d(){if(o.color&&o.color.value){const{r:w,g:M,b:F}=o.color.toRgb();return`linear-gradient(to right, rgba(${w}, ${M}, ${F}, 0) 0%, rgba(${w}, ${M}, ${F}, 1) 100%)`}return""}function c(){i.value=u(),r.value=h(),l.value=d()}pe(()=>{if(!e.value||!s.value)return;const w={drag:M=>{t(M)},end:M=>{t(M)}};ls(e.value,w),ls(s.value,w),c()}),G(()=>o.color.get("alpha"),()=>c()),G(()=>o.color.value,()=>c());const f=T(()=>[n.b(),n.is("vertical",o.vertical)]),y=T(()=>n.e("bar")),g=T(()=>n.e("thumb")),b=T(()=>({background:l.value})),v=T(()=>({left:Ft(i.value),top:Ft(r.value)}));return{rootKls:f,barKls:y,barStyle:b,thumbKls:g,thumbStyle:v,update:c}},vd="ElColorAlphaSlider",bd=k({name:vd}),xd=k({...bd,props:gd,setup(o,{expose:e}){const s=o,{bar:t,thumb:a,handleDrag:n,handleClick:i}=yd(s),{rootKls:r,barKls:l,barStyle:u,thumbKls:h,thumbStyle:d,update:c}=md(s,{bar:t,thumb:a,handleDrag:n});return e({update:c,bar:t,thumb:a}),(f,y)=>(x(),O("div",{class:N(p(r))},[E("div",{ref_key:"bar",ref:t,class:N(p(l)),style:ne(p(u)),onClick:y[0]||(y[0]=(...g)=>p(i)&&p(i)(...g))},null,6),E("div",{ref_key:"thumb",ref:a,class:N(p(h)),style:ne(p(d))},null,6)],2))}});var wd=ce(xd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const Cd=k({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(o){const e=le("color-hue-slider"),s=dt(),t=S(),a=S(),n=S(0),i=S(0),r=T(()=>o.color.get("hue"));G(()=>r.value,()=>{c()});function l(f){f.target!==t.value&&u(f)}function u(f){if(!a.value||!t.value)return;const g=s.vnode.el.getBoundingClientRect(),{clientX:b,clientY:v}=uo(f);let w;if(o.vertical){let M=v-g.top;M=Math.min(M,g.height-t.value.offsetHeight/2),M=Math.max(t.value.offsetHeight/2,M),w=Math.round((M-t.value.offsetHeight/2)/(g.height-t.value.offsetHeight)*360)}else{let M=b-g.left;M=Math.min(M,g.width-t.value.offsetWidth/2),M=Math.max(t.value.offsetWidth/2,M),w=Math.round((M-t.value.offsetWidth/2)/(g.width-t.value.offsetWidth)*360)}o.color.set("hue",w)}function h(){if(!t.value)return 0;const f=s.vnode.el;if(o.vertical)return 0;const y=o.color.get("hue");return f?Math.round(y*(f.offsetWidth-t.value.offsetWidth/2)/360):0}function d(){if(!t.value)return 0;const f=s.vnode.el;if(!o.vertical)return 0;const y=o.color.get("hue");return f?Math.round(y*(f.offsetHeight-t.value.offsetHeight/2)/360):0}function c(){n.value=h(),i.value=d()}return pe(()=>{if(!a.value||!t.value)return;const f={drag:y=>{u(y)},end:y=>{u(y)}};ls(a.value,f),ls(t.value,f),c()}),{bar:a,thumb:t,thumbLeft:n,thumbTop:i,hueValue:r,handleClick:l,update:c,ns:e}}});function Bd(o,e,s,t,a,n){return x(),O("div",{class:N([o.ns.b(),o.ns.is("vertical",o.vertical)])},[E("div",{ref:"bar",class:N(o.ns.e("bar")),onClick:e[0]||(e[0]=(...i)=>o.handleClick&&o.handleClick(...i))},null,2),E("div",{ref:"thumb",class:N(o.ns.e("thumb")),style:ne({left:o.thumbLeft+"px",top:o.thumbTop+"px"})},null,6)],2)}var Td=ce(Cd,[["render",Bd],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const Nd=Ae({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:no,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:be(Array)},validateEvent:{type:Boolean,default:!0}}),Md={[ve]:o=>st(o)||Bs(o),[lo]:o=>st(o)||Bs(o),activeChange:o=>st(o)||Bs(o)},tn=Symbol("colorPickerContextKey"),ko=function(o,e,s){return[o,e*s/((o=(2-e)*s)<1?o:2-o)||0,o/2]},Pd=function(o){return typeof o=="string"&&o.includes(".")&&Number.parseFloat(o)===1},Sd=function(o){return typeof o=="string"&&o.includes("%")},Kt=function(o,e){Pd(o)&&(o="100%");const s=Sd(o);return o=Math.min(e,Math.max(0,Number.parseFloat(`${o}`))),s&&(o=Number.parseInt(`${o*e}`,10)/100),Math.abs(o-e)<1e-6?1:o%e/Number.parseFloat(e)},Uo={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Ms=o=>{o=Math.min(Math.round(o),255);const e=Math.floor(o/16),s=o%16;return`${Uo[e]||e}${Uo[s]||s}`},jo=function({r:o,g:e,b:s}){return Number.isNaN(+o)||Number.isNaN(+e)||Number.isNaN(+s)?"":`#${Ms(o)}${Ms(e)}${Ms(s)}`},js={A:10,B:11,C:12,D:13,E:14,F:15},Tt=function(o){return o.length===2?(js[o[0].toUpperCase()]||+o[0])*16+(js[o[1].toUpperCase()]||+o[1]):js[o[1].toUpperCase()]||+o[1]},Ed=function(o,e,s){e=e/100,s=s/100;let t=e;const a=Math.max(s,.01);s*=2,e*=s<=1?s:2-s,t*=a<=1?a:2-a;const n=(s+e)/2,i=s===0?2*t/(a+t):2*e/(s+e);return{h:o,s:i*100,v:n*100}},qo=(o,e,s)=>{o=Kt(o,255),e=Kt(e,255),s=Kt(s,255);const t=Math.max(o,e,s),a=Math.min(o,e,s);let n;const i=t,r=t-a,l=t===0?0:r/t;if(t===a)n=0;else{switch(t){case o:{n=(e-s)/r+(e<s?6:0);break}case e:{n=(s-o)/r+2;break}case s:{n=(o-e)/r+4;break}}n/=6}return{h:n*360,s:l*100,v:i*100}},es=function(o,e,s){o=Kt(o,360)*6,e=Kt(e,100),s=Kt(s,100);const t=Math.floor(o),a=o-t,n=s*(1-e),i=s*(1-a*e),r=s*(1-(1-a)*e),l=t%6,u=[s,i,n,n,r,s][l],h=[r,s,s,i,n,n][l],d=[n,n,r,s,s,i][l];return{r:Math.round(u*255),g:Math.round(h*255),b:Math.round(d*255)}};class os{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const s in e)bo(e,s)&&(this[s]=e[s]);e.value?this.fromString(e.value):this.doOnChange()}set(e,s){if(arguments.length===1&&typeof e=="object"){for(const t in e)bo(e,t)&&this.set(t,e[t]);return}this[`_${e}`]=s,this.doOnChange()}get(e){return e==="alpha"?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return es(this._hue,this._saturation,this._value)}fromString(e){if(!e){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const s=(t,a,n)=>{this._hue=Math.max(0,Math.min(360,t)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,n)),this.doOnChange()};if(e.includes("hsl")){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,n)=>n>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:n,v:i}=Ed(t[0],t[1],t[2]);s(a,n,i)}}else if(e.includes("hsv")){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,n)=>n>2?Number.parseFloat(a):Number.parseInt(a,10));t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3&&s(t[0],t[1],t[2])}else if(e.includes("rgb")){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,n)=>n>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:n,v:i}=qo(t[0],t[1],t[2]);s(a,n,i)}}else if(e.includes("#")){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return;let a,n,i;t.length===3?(a=Tt(t[0]+t[0]),n=Tt(t[1]+t[1]),i=Tt(t[2]+t[2])):(t.length===6||t.length===8)&&(a=Tt(t.slice(0,2)),n=Tt(t.slice(2,4)),i=Tt(t.slice(4,6))),t.length===8?this._alpha=Tt(t.slice(6))/255*100:(t.length===3||t.length===6)&&(this._alpha=100);const{h:r,s:l,v:u}=qo(a,n,i);s(r,l,u)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:s,_value:t,_alpha:a,format:n}=this;if(this.enableAlpha)switch(n){case"hsl":{const i=ko(e,s/100,t/100);this.value=`hsla(${e}, ${Math.round(i[1]*100)}%, ${Math.round(i[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${e}, ${Math.round(s)}%, ${Math.round(t)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${jo(es(e,s,t))}${Ms(a*255/100)}`;break}default:{const{r:i,g:r,b:l}=es(e,s,t);this.value=`rgba(${i}, ${r}, ${l}, ${this.get("alpha")/100})`}}else switch(n){case"hsl":{const i=ko(e,s/100,t/100);this.value=`hsl(${e}, ${Math.round(i[1]*100)}%, ${Math.round(i[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${e}, ${Math.round(s)}%, ${Math.round(t)}%)`;break}case"rgb":{const{r:i,g:r,b:l}=es(e,s,t);this.value=`rgb(${i}, ${r}, ${l})`;break}default:this.value=jo(es(e,s,t))}}}const Fd=k({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(o){const e=le("color-predefine"),{currentColor:s}=mt(tn),t=S(n(o.colors,o.color));G(()=>s.value,i=>{const r=new os;r.fromString(i),t.value.forEach(l=>{l.selected=r.compare(l)})}),gi(()=>{t.value=n(o.colors,o.color)});function a(i){o.color.fromString(o.colors[i])}function n(i,r){return i.map(l=>{const u=new os;return u.enableAlpha=!0,u.format="rgba",u.fromString(l),u.selected=u.value===r.value,u})}return{rgbaColors:t,handleSelect:a,ns:e}}}),Od=["onClick"];function Rd(o,e,s,t,a,n){return x(),O("div",{class:N(o.ns.b())},[E("div",{class:N(o.ns.e("colors"))},[(x(!0),O(Ye,null,ss(o.rgbaColors,(i,r)=>(x(),O("div",{key:o.colors[r],class:N([o.ns.e("color-selector"),o.ns.is("alpha",i._alpha<100),{selected:i.selected}]),onClick:l=>o.handleSelect(r)},[E("div",{style:ne({backgroundColor:i.value})},null,4)],10,Od))),128))],2)],2)}var Ad=ce(Fd,[["render",Rd],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const Ld=k({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(o){const e=le("color-svpanel"),s=dt(),t=S(0),a=S(0),n=S("hsl(0, 100%, 50%)"),i=T(()=>{const u=o.color.get("hue"),h=o.color.get("value");return{hue:u,value:h}});function r(){const u=o.color.get("saturation"),h=o.color.get("value"),d=s.vnode.el,{clientWidth:c,clientHeight:f}=d;a.value=u*c/100,t.value=(100-h)*f/100,n.value=`hsl(${o.color.get("hue")}, 100%, 50%)`}function l(u){const d=s.vnode.el.getBoundingClientRect(),{clientX:c,clientY:f}=uo(u);let y=c-d.left,g=f-d.top;y=Math.max(0,y),y=Math.min(y,d.width),g=Math.max(0,g),g=Math.min(g,d.height),a.value=y,t.value=g,o.color.set({saturation:y/d.width*100,value:100-g/d.height*100})}return G(()=>i.value,()=>{r()}),pe(()=>{ls(s.vnode.el,{drag:u=>{l(u)},end:u=>{l(u)}}),r()}),{cursorTop:t,cursorLeft:a,background:n,colorValue:i,handleDrag:l,update:r,ns:e}}}),Dd=E("div",null,null,-1),$d=[Dd];function Hd(o,e,s,t,a,n){return x(),O("div",{class:N(o.ns.b()),style:ne({backgroundColor:o.background})},[E("div",{class:N(o.ns.e("white"))},null,2),E("div",{class:N(o.ns.e("black"))},null,2),E("div",{class:N(o.ns.e("cursor")),style:ne({top:o.cursorTop+"px",left:o.cursorLeft+"px"})},$d,6)],6)}var _d=ce(Ld,[["render",Hd],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const zd=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],Vd=k({name:"ElColorPicker"}),Wd=k({...Vd,props:Nd,emits:Md,setup(o,{expose:e,emit:s}){const t=o,{t:a}=hs(),n=le("color"),{formItem:i}=ao(),r=ro(),l=Ri(),{inputId:u,isLabeledByFormItem:h}=Oi(t,{formItemContext:i}),d=S(),c=S(),f=S(),y=S();let g=!0;const b=Rt(new os({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue})),v=S(!1),w=S(!1),M=S(""),F=T(()=>!t.modelValue&&!w.value?"transparent":U(b,t.showAlpha)),z=T(()=>!t.modelValue&&!w.value?"":b.value),D=T(()=>h.value?void 0:t.label||a("el.colorpicker.defaultLabel")),P=T(()=>h.value?i==null?void 0:i.labelId:void 0),$=T(()=>[n.b("picker"),n.is("disabled",l.value),n.bm("picker",r.value)]);function U(V,ae){if(!(V instanceof os))throw new TypeError("color should be instance of _color Class");const{r:Be,g:ct,b:ht}=V.toRgb();return ae?`rgba(${Be}, ${ct}, ${ht}, ${V.get("alpha")/100})`:`rgb(${Be}, ${ct}, ${ht})`}function A(V){v.value=V}const q=Xs(A,100);function ie(){l.value||A(!0)}function Ce(){q(!1),ee()}function ee(){X(()=>{t.modelValue?b.fromString(t.modelValue):(b.value="",X(()=>{w.value=!1}))})}function he(){l.value||q(!v.value)}function te(){b.fromString(M.value)}function xe(){const V=b.value;s(ve,V),s("change",V),t.validateEvent&&(i==null||i.validate("change").catch(ae=>rs())),q(!1),X(()=>{const ae=new os({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue});b.compare(ae)||ee()})}function Ie(){q(!1),s(ve,null),s("change",null),t.modelValue!==null&&t.validateEvent&&(i==null||i.validate("change").catch(V=>rs())),ee()}return pe(()=>{t.modelValue&&(M.value=z.value)}),G(()=>t.modelValue,V=>{V?V&&V!==b.value&&(g=!1,b.fromString(V)):w.value=!1}),G(()=>z.value,V=>{M.value=V,g&&s("activeChange",V),g=!0}),G(()=>b.value,()=>{!t.modelValue&&!w.value&&(w.value=!0)}),G(()=>v.value,()=>{X(()=>{var V,ae,Be;(V=d.value)==null||V.update(),(ae=c.value)==null||ae.update(),(Be=f.value)==null||Be.update()})}),us(tn,{currentColor:z}),e({color:b,show:ie,hide:Ce}),(V,ae)=>(x(),K(p(Hi),{ref_key:"popper",ref:y,visible:v.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[p(n).be("picker","panel"),p(n).b("dropdown"),V.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${p(n).namespace.value}-zoom-in-top`,persistent:""},{content:R(()=>[ze((x(),O("div",null,[E("div",{class:N(p(n).be("dropdown","main-wrapper"))},[H(Td,{ref_key:"hue",ref:d,class:"hue-slider",color:p(b),vertical:""},null,8,["color"]),H(_d,{ref:"svPanel",color:p(b)},null,8,["color"])],2),V.showAlpha?(x(),K(wd,{key:0,ref_key:"alpha",ref:f,color:p(b)},null,8,["color"])):_("v-if",!0),V.predefine?(x(),K(Ad,{key:1,ref:"predefine",color:p(b),colors:V.predefine},null,8,["color","colors"])):_("v-if",!0),E("div",{class:N(p(n).be("dropdown","btns"))},[E("span",{class:N(p(n).be("dropdown","value"))},[H(p(Ji),{modelValue:M.value,"onUpdate:modelValue":ae[0]||(ae[0]=Be=>M.value=Be),"validate-event":!1,size:"small",onKeyup:Fe(te,["enter"]),onBlur:te},null,8,["modelValue","onKeyup"])],2),H(p(Ne),{class:N(p(n).be("dropdown","link-btn")),text:"",size:"small",onClick:Ie},{default:R(()=>[xo(fe(p(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),H(p(Ne),{plain:"",size:"small",class:N(p(n).be("dropdown","btn")),onClick:xe},{default:R(()=>[xo(fe(p(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[p(Di),Ce]])]),default:R(()=>[E("div",{id:p(u),class:N(p($)),role:"button","aria-label":p(D),"aria-labelledby":p(P),"aria-description":p(a)("el.colorpicker.description",{color:V.modelValue||""}),tabindex:V.tabindex,onKeydown:Fe(he,["enter"])},[p(l)?(x(),O("div",{key:0,class:N(p(n).be("picker","mask"))},null,2)):_("v-if",!0),E("div",{class:N(p(n).be("picker","trigger")),onClick:he},[E("span",{class:N([p(n).be("picker","color"),p(n).is("alpha",V.showAlpha)])},[E("span",{class:N(p(n).be("picker","color-inner")),style:ne({backgroundColor:p(F)})},[ze(H(p(qe),{class:N([p(n).be("picker","icon"),p(n).is("icon-arrow-down")])},{default:R(()=>[H(p($i))]),_:1},8,["class"]),[[ut,V.modelValue||w.value]]),!V.modelValue&&!w.value?(x(),K(p(qe),{key:0,class:N([p(n).be("picker","empty"),p(n).is("icon-close")])},{default:R(()=>[H(p(Jn))]),_:1},8,["class"])):_("v-if",!0)],6)],2)],2)],42,zd)]),_:1},8,["visible","popper-class","transition"]))}});var Kd=ce(Wd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const qs=At(Kd),kd=Ae({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:be([String,Array,Object])},zIndex:{type:be([String,Number])}}),Ud={click:o=>o instanceof MouseEvent},jd="overlay";var qd=k({name:"ElOverlay",props:kd,emits:Ud,setup(o,{slots:e,emit:s}){const t=le(jd),a=l=>{s("click",l)},{onClick:n,onMousedown:i,onMouseup:r}=Qi(o.customMaskEvent?void 0:a);return()=>o.mask?H("div",{class:[t.b(),o.overlayClass],style:{zIndex:o.zIndex},onClick:n,onMousedown:i,onMouseup:r},[Q(e,"default")],Ns.STYLE|Ns.CLASS|Ns.PROPS,["onClick","onMouseup","onMousedown"]):Bn("div",{class:o.overlayClass,style:{zIndex:o.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Q(e,"default")])}});const Yd=qd,sn=Symbol("dialogInjectionKey"),on=Ae({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:Ut},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),Gd={close:()=>!0},Xd=["aria-label"],Id=["id"],Zd=k({name:"ElDialogContent"}),Qd=k({...Zd,props:on,emits:Gd,setup(o){const e=o,{t:s}=hs(),{Close:t}=ta,{dialogRef:a,headerRef:n,bodyId:i,ns:r,style:l}=mt(sn),{focusTrapRef:u}=mt(ea),h=El(u,a),d=T(()=>e.draggable);return Ll(a,n,d),(c,f)=>(x(),O("div",{ref:p(h),class:N([p(r).b(),p(r).is("fullscreen",c.fullscreen),p(r).is("draggable",p(d)),p(r).is("align-center",c.alignCenter),{[p(r).m("center")]:c.center},c.customClass]),style:ne(p(l)),tabindex:"-1"},[E("header",{ref_key:"headerRef",ref:n,class:N(p(r).e("header"))},[Q(c.$slots,"header",{},()=>[E("span",{role:"heading",class:N(p(r).e("title"))},fe(c.title),3)]),c.showClose?(x(),O("button",{key:0,"aria-label":p(s)("el.dialog.close"),class:N(p(r).e("headerbtn")),type:"button",onClick:f[0]||(f[0]=y=>c.$emit("close"))},[H(p(qe),{class:N(p(r).e("close"))},{default:R(()=>[(x(),K(rt(c.closeIcon||p(t))))]),_:1},8,["class"])],10,Xd)):_("v-if",!0)],2),E("div",{id:p(i),class:N(p(r).e("body"))},[Q(c.$slots,"default")],10,Id),c.$slots.footer?(x(),O("footer",{key:0,class:N(p(r).e("footer"))},[Q(c.$slots,"footer")],2)):_("v-if",!0)],6))}});var Jd=ce(Qd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const eu=Ae({...on,appendToBody:{type:Boolean,default:!1},beforeClose:{type:be(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),tu={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ve]:o=>sa(o),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},su=(o,e)=>{const t=dt().emit,{nextZIndex:a}=oa();let n="";const i=To(),r=To(),l=S(!1),u=S(!1),h=S(!1),d=S(o.zIndex||a());let c,f;const y=ia("namespace",na),g=T(()=>{const ee={},he=`--${y.value}-dialog`;return o.fullscreen||(o.top&&(ee[`${he}-margin-top`]=o.top),o.width&&(ee[`${he}-width`]=Ft(o.width))),ee}),b=T(()=>o.alignCenter?{display:"flex"}:{});function v(){t("opened")}function w(){t("closed"),t(ve,!1),o.destroyOnClose&&(h.value=!1)}function M(){t("close")}function F(){f==null||f(),c==null||c(),o.openDelay&&o.openDelay>0?{stop:c}=Is(()=>$(),o.openDelay):$()}function z(){c==null||c(),f==null||f(),o.closeDelay&&o.closeDelay>0?{stop:f}=Is(()=>U(),o.closeDelay):U()}function D(){function ee(he){he||(u.value=!0,l.value=!1)}o.beforeClose?o.beforeClose(ee):z()}function P(){o.closeOnClickModal&&D()}function $(){ot&&(l.value=!0)}function U(){l.value=!1}function A(){t("openAutoFocus")}function q(){t("closeAutoFocus")}function ie(ee){var he;((he=ee.detail)==null?void 0:he.focusReason)==="pointer"&&ee.preventDefault()}o.lockScroll&&$l(l);function Ce(){o.closeOnPressEscape&&D()}return G(()=>o.modelValue,ee=>{ee?(u.value=!1,F(),h.value=!0,d.value=o.zIndex?d.value++:a(),X(()=>{t("open"),e.value&&(e.value.scrollTop=0)})):l.value&&z()}),G(()=>o.fullscreen,ee=>{e.value&&(ee?(n=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=n)}),pe(()=>{o.modelValue&&(l.value=!0,h.value=!0,F())}),{afterEnter:v,afterLeave:w,beforeLeave:M,handleClose:D,onModalClick:P,close:z,doClose:U,onOpenAutoFocus:A,onCloseAutoFocus:q,onCloseRequested:Ce,onFocusoutPrevented:ie,titleId:i,bodyId:r,closed:u,style:g,overlayDialogStyle:b,rendered:h,visible:l,zIndex:d}},ou=["aria-label","aria-labelledby","aria-describedby"],iu=k({name:"ElDialog",inheritAttrs:!1}),nu=k({...iu,props:eu,emits:tu,setup(o,{expose:e}){const s=o,t=mi();Zs({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},T(()=>!!t.title)),Zs({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},T(()=>!!s.customClass));const a=le("dialog"),n=S(),i=S(),r=S(),{visible:l,titleId:u,bodyId:h,style:d,overlayDialogStyle:c,rendered:f,zIndex:y,afterEnter:g,afterLeave:b,beforeLeave:v,handleClose:w,onModalClick:M,onOpenAutoFocus:F,onCloseAutoFocus:z,onCloseRequested:D,onFocusoutPrevented:P}=su(s,n);us(sn,{dialogRef:n,headerRef:i,bodyId:h,ns:a,rendered:f,style:d});const $=Qi(M),U=T(()=>s.draggable&&!s.fullscreen);return e({visible:l,dialogContentRef:r}),(A,q)=>(x(),K(Tn,{to:"body",disabled:!A.appendToBody},[H(kt,{name:"dialog-fade",onAfterEnter:p(g),onAfterLeave:p(b),onBeforeLeave:p(v),persisted:""},{default:R(()=>[ze(H(p(Yd),{"custom-mask-event":"",mask:A.modal,"overlay-class":A.modalClass,"z-index":p(y)},{default:R(()=>[E("div",{role:"dialog","aria-modal":"true","aria-label":A.title||void 0,"aria-labelledby":A.title?void 0:p(u),"aria-describedby":p(h),class:N(`${p(a).namespace.value}-overlay-dialog`),style:ne(p(c)),onClick:q[0]||(q[0]=(...ie)=>p($).onClick&&p($).onClick(...ie)),onMousedown:q[1]||(q[1]=(...ie)=>p($).onMousedown&&p($).onMousedown(...ie)),onMouseup:q[2]||(q[2]=(...ie)=>p($).onMouseup&&p($).onMouseup(...ie))},[H(p(aa),{loop:"",trapped:p(l),"focus-start-el":"container",onFocusAfterTrapped:p(F),onFocusAfterReleased:p(z),onFocusoutPrevented:p(P),onReleaseRequested:p(D)},{default:R(()=>[p(f)?(x(),K(Jd,Cs({key:0,ref_key:"dialogContentRef",ref:r},A.$attrs,{"custom-class":A.customClass,center:A.center,"align-center":A.alignCenter,"close-icon":A.closeIcon,draggable:p(U),fullscreen:A.fullscreen,"show-close":A.showClose,title:A.title,onClose:p(w)}),vi({header:R(()=>[A.$slots.title?Q(A.$slots,"title",{key:1}):Q(A.$slots,"header",{key:0,close:p(w),titleId:p(u),titleClass:p(a).e("title")})]),default:R(()=>[Q(A.$slots,"default")]),_:2},[A.$slots.footer?{name:"footer",fn:R(()=>[Q(A.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):_("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,ou)]),_:3},8,["mask","overlay-class","z-index"]),[[ut,p(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var au=ce(nu,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const ru=At(au),lu=Ae({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:be(String),default:"solid"}}),du=k({name:"ElDivider"}),uu=k({...du,props:lu,setup(o){const e=o,s=le("divider"),t=T(()=>s.cssVar({"border-style":e.borderStyle}));return(a,n)=>(x(),O("div",{class:N([p(s).b(),p(s).m(a.direction)]),style:ne(p(t)),role:"separator"},[a.$slots.default&&a.direction!=="vertical"?(x(),O("div",{key:0,class:N([p(s).e("text"),p(s).is(a.contentPosition)])},[Q(a.$slots,"default")],2)):_("v-if",!0)],6))}});var cu=ce(uu,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const ts=At(cu),nn=Symbol("ElSelectGroup"),Ds=Symbol("ElSelect");function hu(o,e){const s=mt(Ds),t=mt(nn,{disabled:!1}),a=T(()=>Object.prototype.toString.call(o.value).toLowerCase()==="[object object]"),n=T(()=>s.props.multiple?d(s.props.modelValue,o.value):c(o.value,s.props.modelValue)),i=T(()=>{if(s.props.multiple){const g=s.props.modelValue||[];return!n.value&&g.length>=s.props.multipleLimit&&s.props.multipleLimit>0}else return!1}),r=T(()=>o.label||(a.value?"":o.value)),l=T(()=>o.value||o.label||""),u=T(()=>o.disabled||e.groupDisabled||i.value),h=dt(),d=(g=[],b)=>{if(a.value){const v=s.props.valueKey;return g&&g.some(w=>Ps(Ue(w,v))===Ue(b,v))}else return g&&g.includes(b)},c=(g,b)=>{if(a.value){const{valueKey:v}=s.props;return Ue(g,v)===Ue(b,v)}else return g===b},f=()=>{!o.disabled&&!t.disabled&&(s.hoverIndex=s.optionsArray.indexOf(h.proxy))};G(()=>r.value,()=>{!o.created&&!s.props.remote&&s.setSelected()}),G(()=>o.value,(g,b)=>{const{remote:v,valueKey:w}=s.props;if(Object.is(g,b)||(s.onOptionDestroy(b,h.proxy),s.onOptionCreate(h.proxy)),!o.created&&!v){if(w&&typeof g=="object"&&typeof b=="object"&&g[w]===b[w])return;s.setSelected()}}),G(()=>t.disabled,()=>{e.groupDisabled=t.disabled},{immediate:!0});const{queryChange:y}=Ps(s);return G(y,g=>{const{query:b}=p(g),v=new RegExp(ra(b),"i");e.visible=v.test(r.value)||o.created,e.visible||s.filteredOptionsCount--},{immediate:!0}),{select:s,currentLabel:r,currentValue:l,itemSelected:n,isDisabled:u,hoverItem:f}}const fu=k({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(o){const e=le("select"),s=Rt({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:t,itemSelected:a,isDisabled:n,select:i,hoverItem:r}=hu(o,s),{visible:l,hover:u}=so(s),h=dt().proxy;i.onOptionCreate(h),ds(()=>{const c=h.value,{selected:f}=i,g=(i.props.multiple?f:[f]).some(b=>b.value===h.value);X(()=>{i.cachedOptions.get(c)===h&&!g&&i.cachedOptions.delete(c)}),i.onOptionDestroy(c,h)});function d(){o.disabled!==!0&&s.groupDisabled!==!0&&i.handleOptionSelect(h,!0)}return{ns:e,currentLabel:t,itemSelected:a,isDisabled:n,select:i,hoverItem:r,visible:l,hover:u,selectOptionClick:d,states:s}}});function pu(o,e,s,t,a,n){return ze((x(),O("li",{class:N([o.ns.be("dropdown","item"),o.ns.is("disabled",o.isDisabled),{selected:o.itemSelected,hover:o.hover}]),onMouseenter:e[0]||(e[0]=(...i)=>o.hoverItem&&o.hoverItem(...i)),onClick:e[1]||(e[1]=et((...i)=>o.selectOptionClick&&o.selectOptionClick(...i),["stop"]))},[Q(o.$slots,"default",{},()=>[E("span",null,fe(o.currentLabel),1)])],34)),[[ut,o.visible]])}var po=ce(fu,[["render",pu],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const gu=k({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const o=mt(Ds),e=le("select"),s=T(()=>o.props.popperClass),t=T(()=>o.props.multiple),a=T(()=>o.props.fitInputWidth),n=S("");function i(){var r;n.value=`${(r=o.selectWrapper)==null?void 0:r.offsetWidth}px`}return pe(()=>{i(),cs(o.selectWrapper,i)}),{ns:e,minWidth:n,popperClass:s,isMultiple:t,isFitInputWidth:a}}});function yu(o,e,s,t,a,n){return x(),O("div",{class:N([o.ns.b("dropdown"),o.ns.is("multiple",o.isMultiple),o.popperClass]),style:ne({[o.isFitInputWidth?"width":"minWidth"]:o.minWidth})},[Q(o.$slots,"default")],6)}var mu=ce(gu,[["render",yu],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function vu(o){const{t:e}=hs();return Rt({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:o.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:e("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1,mouseEnter:!1})}const bu=(o,e,s)=>{const{t}=hs(),a=le("select");Zs({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},T(()=>o.suffixTransition===!1));const n=S(null),i=S(null),r=S(null),l=S(null),u=S(null),h=S(null),d=S(null),c=S(-1),f=Et({query:""}),y=Et(""),g=S([]);let b=0;const{form:v,formItem:w}=ao(),M=T(()=>!o.filterable||o.multiple||!e.visible),F=T(()=>o.disabled||(v==null?void 0:v.disabled)),z=T(()=>{const m=o.multiple?Array.isArray(o.modelValue)&&o.modelValue.length>0:o.modelValue!==void 0&&o.modelValue!==null&&o.modelValue!=="";return o.clearable&&!F.value&&e.inputHovering&&m}),D=T(()=>o.remote&&o.filterable&&!o.remoteShowSuffix?"":o.suffixIcon),P=T(()=>a.is("reverse",D.value&&e.visible&&o.suffixTransition)),$=T(()=>o.remote?300:0),U=T(()=>o.loading?o.loadingText||t("el.select.loading"):o.remote&&e.query===""&&e.options.size===0?!1:o.filterable&&e.query&&e.options.size>0&&e.filteredOptionsCount===0?o.noMatchText||t("el.select.noMatch"):e.options.size===0?o.noDataText||t("el.select.noData"):null),A=T(()=>{const m=Array.from(e.options.values()),C=[];return g.value.forEach(L=>{const W=m.findIndex(de=>de.currentLabel===L);W>-1&&C.push(m[W])}),C.length?C:m}),q=T(()=>Array.from(e.cachedOptions.values())),ie=T(()=>{const m=A.value.filter(C=>!C.created).some(C=>C.currentLabel===e.query);return o.filterable&&o.allowCreate&&e.query!==""&&!m}),Ce=ro(),ee=T(()=>["small"].includes(Ce.value)?"small":"default"),he=T({get(){return e.visible&&U.value!==!1},set(m){e.visible=m}});G([()=>F.value,()=>Ce.value,()=>v==null?void 0:v.size],()=>{X(()=>{te()})}),G(()=>o.placeholder,m=>{e.cachedPlaceHolder=e.currentPlaceholder=m}),G(()=>o.modelValue,(m,C)=>{o.multiple&&(te(),m&&m.length>0||i.value&&e.query!==""?e.currentPlaceholder="":e.currentPlaceholder=e.cachedPlaceHolder,o.filterable&&!o.reserveKeyword&&(e.query="",xe(e.query))),ae(),o.filterable&&!o.multiple&&(e.inputLength=20),!No(m,C)&&o.validateEvent&&(w==null||w.validate("change").catch(L=>rs()))},{flush:"post",deep:!0}),G(()=>e.visible,m=>{var C,L,W,de,ge;m?((L=(C=l.value)==null?void 0:C.updatePopper)==null||L.call(C),o.filterable&&(e.filteredOptionsCount=e.optionsCount,e.query=o.remote?"":e.selectedLabel,(de=(W=r.value)==null?void 0:W.focus)==null||de.call(W),o.multiple?(ge=i.value)==null||ge.focus():e.selectedLabel&&(e.currentPlaceholder=`${e.selectedLabel}`,e.selectedLabel=""),xe(e.query),!o.multiple&&!o.remote&&(f.value.query="",Qt(f),Qt(y)))):(o.filterable&&(je(o.filterMethod)&&o.filterMethod(""),je(o.remoteMethod)&&o.remoteMethod("")),i.value&&i.value.blur(),e.query="",e.previousQuery=null,e.selectedLabel="",e.inputLength=20,e.menuVisibleOnFocus=!1,ct(),X(()=>{i.value&&i.value.value===""&&e.selected.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}),o.multiple||(e.selected&&(o.filterable&&o.allowCreate&&e.createdSelected&&e.createdLabel?e.selectedLabel=e.createdLabel:e.selectedLabel=e.selected.currentLabel,o.filterable&&(e.query=e.selectedLabel)),o.filterable&&(e.currentPlaceholder=e.cachedPlaceHolder))),s.emit("visible-change",m)}),G(()=>e.options.entries(),()=>{var m,C,L;if(!ot)return;(C=(m=l.value)==null?void 0:m.updatePopper)==null||C.call(m),o.multiple&&te();const W=((L=h.value)==null?void 0:L.querySelectorAll("input"))||[];Array.from(W).includes(document.activeElement)||ae(),o.defaultFirstOption&&(o.filterable||o.remote)&&e.filteredOptionsCount&&V()},{flush:"post"}),G(()=>e.hoverIndex,m=>{Ge(m)&&m>-1?c.value=A.value[m]||{}:c.value={},A.value.forEach(C=>{C.hover=c.value===C})});const te=()=>{X(()=>{var m,C;if(!n.value)return;const L=n.value.$el.querySelector("input");b=b||(L.clientHeight>0?L.clientHeight+2:0);const W=u.value,de=Fl(Ce.value||(v==null?void 0:v.size)),ge=Ce.value||de===b||b<=0?de:b;!(L.offsetParent===null)&&(L.style.height=`${(e.selected.length===0?ge:Math.max(W?W.clientHeight+(W.clientHeight>ge?6:0):0,ge))-2}px`),e.tagInMultiLine=Number.parseFloat(L.style.height)>=ge,e.visible&&U.value!==!1&&((C=(m=l.value)==null?void 0:m.updatePopper)==null||C.call(m))})},xe=async m=>{if(!(e.previousQuery===m||e.isOnComposition)){if(e.previousQuery===null&&(je(o.filterMethod)||je(o.remoteMethod))){e.previousQuery=m;return}e.previousQuery=m,X(()=>{var C,L;e.visible&&((L=(C=l.value)==null?void 0:C.updatePopper)==null||L.call(C))}),e.hoverIndex=-1,o.multiple&&o.filterable&&X(()=>{const C=i.value.value.length*15+20;e.inputLength=o.collapseTags?Math.min(50,C):C,Ie(),te()}),o.remote&&je(o.remoteMethod)?(e.hoverIndex=-1,o.remoteMethod(m)):je(o.filterMethod)?(o.filterMethod(m),Qt(y)):(e.filteredOptionsCount=e.optionsCount,f.value.query=m,Qt(f),Qt(y)),o.defaultFirstOption&&(o.filterable||o.remote)&&e.filteredOptionsCount&&(await X(),V())}},Ie=()=>{e.currentPlaceholder!==""&&(e.currentPlaceholder=i.value.value?"":e.cachedPlaceHolder)},V=()=>{const m=A.value.filter(W=>W.visible&&!W.disabled&&!W.states.groupDisabled),C=m.find(W=>W.created),L=m[0];e.hoverIndex=bt(A.value,C||L)},ae=()=>{var m;if(o.multiple)e.selectedLabel="";else{const L=Be(o.modelValue);(m=L.props)!=null&&m.created?(e.createdLabel=L.props.value,e.createdSelected=!0):e.createdSelected=!1,e.selectedLabel=L.currentLabel,e.selected=L,o.filterable&&(e.query=e.selectedLabel);return}const C=[];Array.isArray(o.modelValue)&&o.modelValue.forEach(L=>{C.push(Be(L))}),e.selected=C,X(()=>{te()})},Be=m=>{let C;const L=Ks(m).toLowerCase()==="object",W=Ks(m).toLowerCase()==="null",de=Ks(m).toLowerCase()==="undefined";for(let at=e.cachedOptions.size-1;at>=0;at--){const Le=q.value[at];if(L?Ue(Le.value,o.valueKey)===Ue(m,o.valueKey):Le.value===m){C={value:m,currentLabel:Le.currentLabel,isDisabled:Le.isDisabled};break}}if(C)return C;const ge=L?m.label:!W&&!de?m:"",nt={value:m,currentLabel:ge};return o.multiple&&(nt.hitState=!1),nt},ct=()=>{setTimeout(()=>{const m=o.valueKey;o.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map(C=>A.value.findIndex(L=>Ue(L,m)===Ue(C,m)))):e.hoverIndex=-1:e.hoverIndex=A.value.findIndex(C=>zt(C)===zt(e.selected))},300)},ht=()=>{var m,C;qt(),(C=(m=l.value)==null?void 0:m.updatePopper)==null||C.call(m),o.multiple&&te()},qt=()=>{var m;e.inputWidth=(m=n.value)==null?void 0:m.$el.offsetWidth},it=()=>{o.filterable&&e.query!==e.selectedLabel&&(e.query=e.selectedLabel,xe(e.query))},ps=Xs(()=>{it()},$.value),Yt=Xs(m=>{xe(m.target.value)},$.value),Pe=m=>{No(o.modelValue,m)||s.emit(lo,m)},Ze=m=>{if(m.code!==Qs.delete){if(m.target.value.length<=0&&!wt()){const C=o.modelValue.slice();C.pop(),s.emit(ve,C),Pe(C)}m.target.value.length===1&&o.modelValue.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}},Dt=(m,C)=>{const L=e.selected.indexOf(C);if(L>-1&&!F.value){const W=o.modelValue.slice();W.splice(L,1),s.emit(ve,W),Pe(W),s.emit("remove-tag",C.value)}m.stopPropagation()},vt=m=>{m.stopPropagation();const C=o.multiple?[]:"";if(!st(C))for(const L of e.selected)L.isDisabled&&C.push(L.value);s.emit(ve,C),Pe(C),e.hoverIndex=-1,e.visible=!1,s.emit("clear")},ft=(m,C)=>{var L;if(o.multiple){const W=(o.modelValue||[]).slice(),de=bt(W,m.value);de>-1?W.splice(de,1):(o.multipleLimit<=0||W.length<o.multipleLimit)&&W.push(m.value),s.emit(ve,W),Pe(W),m.created&&(e.query="",xe(""),e.inputLength=20),o.filterable&&((L=i.value)==null||L.focus())}else s.emit(ve,m.value),Pe(m.value),e.visible=!1;e.isSilentBlur=C,xt(),!e.visible&&X(()=>{We(m)})},bt=(m=[],C)=>{if(!ns(C))return m.indexOf(C);const L=o.valueKey;let W=-1;return m.some((de,ge)=>Ps(Ue(de,L))===Ue(C,L)?(W=ge,!0):!1),W},xt=()=>{e.softFocus=!0;const m=i.value||n.value;m&&(m==null||m.focus())},We=m=>{var C,L,W,de,ge;const nt=Array.isArray(m)?m[0]:m;let at=null;if(nt!=null&&nt.value){const Le=A.value.filter(Ws=>Ws.value===nt.value);Le.length>0&&(at=Le[0].$el)}if(l.value&&at){const Le=(de=(W=(L=(C=l.value)==null?void 0:C.popperRef)==null?void 0:L.contentRef)==null?void 0:W.querySelector)==null?void 0:de.call(W,`.${a.be("dropdown","wrap")}`);Le&&Sl(Le,at)}(ge=d.value)==null||ge.handleScroll()},Gt=m=>{e.optionsCount++,e.filteredOptionsCount++,e.options.set(m.value,m),e.cachedOptions.set(m.value,m)},$t=(m,C)=>{e.options.get(m)===C&&(e.optionsCount--,e.filteredOptionsCount--,e.options.delete(m))},Ht=m=>{m.code!==Qs.backspace&&wt(!1),e.inputLength=i.value.value.length*15+20,te()},wt=m=>{if(!Array.isArray(e.selected))return;const C=e.selected[e.selected.length-1];if(C)return m===!0||m===!1?(C.hitState=m,m):(C.hitState=!C.hitState,C.hitState)},Xt=m=>{const C=m.target.value;if(m.type==="compositionend")e.isOnComposition=!1,X(()=>xe(C));else{const L=C[C.length-1]||"";e.isOnComposition=!Li(L)}},_t=()=>{X(()=>We(e.selected))},It=m=>{e.softFocus?e.softFocus=!1:((o.automaticDropdown||o.filterable)&&(o.filterable&&!e.visible&&(e.menuVisibleOnFocus=!0),e.visible=!0),s.emit("focus",m))},Ke=()=>{var m,C,L;e.visible=!1,(m=n.value)==null||m.blur(),(L=(C=r.value)==null?void 0:C.blur)==null||L.call(C)},B=m=>{X(()=>{e.isSilentBlur?e.isSilentBlur=!1:s.emit("blur",m)}),e.softFocus=!1},Y=m=>{vt(m)},we=()=>{e.visible=!1},pt=m=>{e.visible&&(m.preventDefault(),m.stopPropagation(),e.visible=!1)},Ct=m=>{var C;m&&!e.mouseEnter||F.value||(e.menuVisibleOnFocus?e.menuVisibleOnFocus=!1:(!l.value||!l.value.isFocusInsideContent())&&(e.visible=!e.visible),e.visible&&((C=i.value||n.value)==null||C.focus()))},_s=()=>{e.visible?A.value[e.hoverIndex]&&ft(A.value[e.hoverIndex],void 0):Ct()},zt=m=>ns(m.value)?Ue(m.value,o.valueKey):m.value,zs=T(()=>A.value.filter(m=>m.visible).every(m=>m.disabled)),Vs=T(()=>e.selected.slice(0,o.maxCollapseTags)),Zt=T(()=>e.selected.slice(o.maxCollapseTags)),gs=m=>{if(!e.visible){e.visible=!0;return}if(!(e.options.size===0||e.filteredOptionsCount===0)&&!e.isOnComposition&&!zs.value){m==="next"?(e.hoverIndex++,e.hoverIndex===e.options.size&&(e.hoverIndex=0)):m==="prev"&&(e.hoverIndex--,e.hoverIndex<0&&(e.hoverIndex=e.options.size-1));const C=A.value[e.hoverIndex];(C.disabled===!0||C.states.groupDisabled===!0||!C.visible)&&gs(m),X(()=>We(c.value))}};return{optionList:g,optionsArray:A,selectSize:Ce,handleResize:ht,debouncedOnInputChange:ps,debouncedQueryChange:Yt,deletePrevTag:Ze,deleteTag:Dt,deleteSelected:vt,handleOptionSelect:ft,scrollToOption:We,readonly:M,resetInputHeight:te,showClose:z,iconComponent:D,iconReverse:P,showNewOption:ie,collapseTagSize:ee,setSelected:ae,managePlaceholder:Ie,selectDisabled:F,emptyText:U,toggleLastOptionHitState:wt,resetInputState:Ht,handleComposition:Xt,onOptionCreate:Gt,onOptionDestroy:$t,handleMenuEnter:_t,handleFocus:It,blur:Ke,handleBlur:B,handleClearClick:Y,handleClose:we,handleKeydownEscape:pt,toggleMenu:Ct,selectOption:_s,getValueKey:zt,navigateOptions:gs,dropMenuVisible:he,queryChange:f,groupQueryChange:y,showTagList:Vs,collapseTagList:Zt,reference:n,input:i,iOSInput:r,tooltipRef:l,tags:u,selectWrapper:h,scrollbar:d,handleMouseEnter:()=>{e.mouseEnter=!0},handleMouseLeave:()=>{e.mouseEnter=!1}}};var xu=k({name:"ElOptions",emits:["update-options"],setup(o,{slots:e,emit:s}){let t=[];function a(n,i){if(n.length!==i.length)return!1;for(const[r]of n.entries())if(n[r]!=i[r])return!1;return!0}return()=>{var n,i;const r=(n=e.default)==null?void 0:n.call(e),l=[];function u(h){Array.isArray(h)&&h.forEach(d=>{var c,f,y,g;const b=(c=(d==null?void 0:d.type)||{})==null?void 0:c.name;b==="ElOptionGroup"?u(!st(d.children)&&!Array.isArray(d.children)&&je((f=d.children)==null?void 0:f.default)?(y=d.children)==null?void 0:y.default():d.children):b==="ElOption"?l.push((g=d.props)==null?void 0:g.label):Array.isArray(d.children)&&u(d.children)})}return r.length&&u((i=r[0])==null?void 0:i.children),a(l,t)||(t=l,s("update-options",l)),r}}});const Yo="ElSelect",wu=k({name:Yo,componentName:Yo,components:{ElInput:Ji,ElSelectMenu:mu,ElOption:po,ElOptions:xu,ElTag:la,ElScrollbar:ld,ElTooltip:Hi,ElIcon:qe},directives:{ClickOutside:Di},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:da},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},teleported:ua.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ut,default:Ai},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:Ut,default:$i},tagType:{...ca.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:{type:Boolean,default:!1},suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:ha,default:"bottom-start"}},emits:[ve,lo,"remove-tag","clear","visible-change","focus","blur"],setup(o,e){const s=le("select"),t=le("input"),{t:a}=hs(),n=vu(o),{optionList:i,optionsArray:r,selectSize:l,readonly:u,handleResize:h,collapseTagSize:d,debouncedOnInputChange:c,debouncedQueryChange:f,deletePrevTag:y,deleteTag:g,deleteSelected:b,handleOptionSelect:v,scrollToOption:w,setSelected:M,resetInputHeight:F,managePlaceholder:z,showClose:D,selectDisabled:P,iconComponent:$,iconReverse:U,showNewOption:A,emptyText:q,toggleLastOptionHitState:ie,resetInputState:Ce,handleComposition:ee,onOptionCreate:he,onOptionDestroy:te,handleMenuEnter:xe,handleFocus:Ie,blur:V,handleBlur:ae,handleClearClick:Be,handleClose:ct,handleKeydownEscape:ht,toggleMenu:qt,selectOption:it,getValueKey:ps,navigateOptions:Yt,dropMenuVisible:Pe,reference:Ze,input:Dt,iOSInput:vt,tooltipRef:ft,tags:bt,selectWrapper:xt,scrollbar:We,queryChange:Gt,groupQueryChange:$t,handleMouseEnter:Ht,handleMouseLeave:wt,showTagList:Xt,collapseTagList:_t}=bu(o,n,e),{focus:It}=Dl(Ze),{inputWidth:Ke,selected:B,inputLength:Y,filteredOptionsCount:we,visible:pt,softFocus:Ct,selectedLabel:_s,hoverIndex:zt,query:zs,inputHovering:Vs,currentPlaceholder:Zt,menuVisibleOnFocus:gs,isOnComposition:mo,isSilentBlur:vo,options:m,cachedOptions:C,optionsCount:L,prefixWidth:W,tagInMultiLine:de}=so(n),ge=T(()=>{const Se=[s.b()],Bt=p(l);return Bt&&Se.push(s.m(Bt)),o.disabled&&Se.push(s.m("disabled")),Se}),nt=T(()=>({maxWidth:`${p(Ke)-32}px`,width:"100%"})),at=T(()=>({maxWidth:`${p(Ke)>123?p(Ke)-123:p(Ke)-75}px`}));us(Ds,Rt({props:o,options:m,optionsArray:r,cachedOptions:C,optionsCount:L,filteredOptionsCount:we,hoverIndex:zt,handleOptionSelect:v,onOptionCreate:he,onOptionDestroy:te,selectWrapper:xt,selected:B,setSelected:M,queryChange:Gt,groupQueryChange:$t})),pe(()=>{n.cachedPlaceHolder=Zt.value=o.placeholder||(()=>a("el.select.placeholder")),o.multiple&&Array.isArray(o.modelValue)&&o.modelValue.length>0&&(Zt.value=""),cs(xt,h),o.remote&&o.multiple&&F(),X(()=>{const Se=Ze.value&&Ze.value.$el;if(Se&&(Ke.value=Se.getBoundingClientRect().width,e.slots.prefix)){const Bt=Se.querySelector(`.${t.e("prefix")}`);W.value=Math.max(Bt.getBoundingClientRect().width+5,30)}}),M()}),o.multiple&&!Array.isArray(o.modelValue)&&e.emit(ve,[]),!o.multiple&&Array.isArray(o.modelValue)&&e.emit(ve,"");const Le=T(()=>{var Se,Bt;return(Bt=(Se=ft.value)==null?void 0:Se.popperRef)==null?void 0:Bt.contentRef});return{isIOS:fa,onOptionsRendered:Se=>{i.value=Se},tagInMultiLine:de,prefixWidth:W,selectSize:l,readonly:u,handleResize:h,collapseTagSize:d,debouncedOnInputChange:c,debouncedQueryChange:f,deletePrevTag:y,deleteTag:g,deleteSelected:b,handleOptionSelect:v,scrollToOption:w,inputWidth:Ke,selected:B,inputLength:Y,filteredOptionsCount:we,visible:pt,softFocus:Ct,selectedLabel:_s,hoverIndex:zt,query:zs,inputHovering:Vs,currentPlaceholder:Zt,menuVisibleOnFocus:gs,isOnComposition:mo,isSilentBlur:vo,options:m,resetInputHeight:F,managePlaceholder:z,showClose:D,selectDisabled:P,iconComponent:$,iconReverse:U,showNewOption:A,emptyText:q,toggleLastOptionHitState:ie,resetInputState:Ce,handleComposition:ee,handleMenuEnter:xe,handleFocus:Ie,blur:V,handleBlur:ae,handleClearClick:Be,handleClose:ct,handleKeydownEscape:ht,toggleMenu:qt,selectOption:it,getValueKey:ps,navigateOptions:Yt,dropMenuVisible:Pe,focus:It,reference:Ze,input:Dt,iOSInput:vt,tooltipRef:ft,popperPaneRef:Le,tags:bt,selectWrapper:xt,scrollbar:We,wrapperKls:ge,selectTagsStyle:nt,nsSelect:s,tagTextStyle:at,handleMouseEnter:Ht,handleMouseLeave:wt,showTagList:Xt,collapseTagList:_t}}}),Cu=["disabled","autocomplete"],Bu=["disabled"],Tu={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function Nu(o,e,s,t,a,n){const i=gt("el-tag"),r=gt("el-tooltip"),l=gt("el-icon"),u=gt("el-input"),h=gt("el-option"),d=gt("el-options"),c=gt("el-scrollbar"),f=gt("el-select-menu"),y=Nn("click-outside");return ze((x(),O("div",{ref:"selectWrapper",class:N(o.wrapperKls),onMouseenter:e[21]||(e[21]=(...g)=>o.handleMouseEnter&&o.handleMouseEnter(...g)),onMouseleave:e[22]||(e[22]=(...g)=>o.handleMouseLeave&&o.handleMouseLeave(...g)),onClick:e[23]||(e[23]=et((...g)=>o.toggleMenu&&o.toggleMenu(...g),["stop"]))},[H(r,{ref:"tooltipRef",visible:o.dropMenuVisible,placement:o.placement,teleported:o.teleported,"popper-class":[o.nsSelect.e("popper"),o.popperClass],"popper-options":o.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:o.effect,pure:"",trigger:"click",transition:`${o.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:o.persistent,onShow:o.handleMenuEnter},{default:R(()=>[E("div",{class:"select-trigger",onMouseenter:e[19]||(e[19]=g=>o.inputHovering=!0),onMouseleave:e[20]||(e[20]=g=>o.inputHovering=!1)},[o.multiple?(x(),O("div",{key:0,ref:"tags",class:N([o.nsSelect.e("tags"),o.nsSelect.is("disabled",o.selectDisabled)]),style:ne(o.selectTagsStyle)},[o.collapseTags&&o.selected.length?(x(),K(kt,{key:0,onAfterLeave:o.resetInputHeight},{default:R(()=>[E("span",{class:N([o.nsSelect.b("tags-wrapper"),{"has-prefix":o.prefixWidth&&o.selected.length}])},[(x(!0),O(Ye,null,ss(o.showTagList,g=>(x(),K(i,{key:o.getValueKey(g),closable:!o.selectDisabled&&!g.isDisabled,size:o.collapseTagSize,hit:g.hitState,type:o.tagType,"disable-transitions":"",onClose:b=>o.deleteTag(b,g)},{default:R(()=>[E("span",{class:N(o.nsSelect.e("tags-text")),style:ne(o.tagTextStyle)},fe(g.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),o.selected.length>o.maxCollapseTags?(x(),K(i,{key:0,closable:!1,size:o.collapseTagSize,type:o.tagType,"disable-transitions":""},{default:R(()=>[o.collapseTagsTooltip?(x(),K(r,{key:0,disabled:o.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:o.effect,placement:"bottom",teleported:o.teleported},{default:R(()=>[E("span",{class:N(o.nsSelect.e("tags-text"))},"+ "+fe(o.selected.length-o.maxCollapseTags),3)]),content:R(()=>[E("div",{class:N(o.nsSelect.e("collapse-tags"))},[(x(!0),O(Ye,null,ss(o.collapseTagList,g=>(x(),O("div",{key:o.getValueKey(g),class:N(o.nsSelect.e("collapse-tag"))},[H(i,{class:"in-tooltip",closable:!o.selectDisabled&&!g.isDisabled,size:o.collapseTagSize,hit:g.hitState,type:o.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:b=>o.deleteTag(b,g)},{default:R(()=>[E("span",{class:N(o.nsSelect.e("tags-text")),style:ne({maxWidth:o.inputWidth-75+"px"})},fe(g.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(x(),O("span",{key:1,class:N(o.nsSelect.e("tags-text"))},"+ "+fe(o.selected.length-o.maxCollapseTags),3))]),_:1},8,["size","type"])):_("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):_("v-if",!0),o.collapseTags?_("v-if",!0):(x(),K(kt,{key:1,onAfterLeave:o.resetInputHeight},{default:R(()=>[E("span",{class:N([o.nsSelect.b("tags-wrapper"),{"has-prefix":o.prefixWidth&&o.selected.length}])},[(x(!0),O(Ye,null,ss(o.selected,g=>(x(),K(i,{key:o.getValueKey(g),closable:!o.selectDisabled&&!g.isDisabled,size:o.collapseTagSize,hit:g.hitState,type:o.tagType,"disable-transitions":"",onClose:b=>o.deleteTag(b,g)},{default:R(()=>[E("span",{class:N(o.nsSelect.e("tags-text")),style:ne({maxWidth:o.inputWidth-75+"px"})},fe(g.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],2)]),_:1},8,["onAfterLeave"])),o.filterable?ze((x(),O("input",{key:2,ref:"input","onUpdate:modelValue":e[0]||(e[0]=g=>o.query=g),type:"text",class:N([o.nsSelect.e("input"),o.nsSelect.is(o.selectSize),o.nsSelect.is("disabled",o.selectDisabled)]),disabled:o.selectDisabled,autocomplete:o.autocomplete,style:ne({marginLeft:o.prefixWidth&&!o.selected.length||o.tagInMultiLine?`${o.prefixWidth}px`:"",flexGrow:1,width:`${o.inputLength/(o.inputWidth-32)}%`,maxWidth:`${o.inputWidth-42}px`}),onFocus:e[1]||(e[1]=(...g)=>o.handleFocus&&o.handleFocus(...g)),onBlur:e[2]||(e[2]=(...g)=>o.handleBlur&&o.handleBlur(...g)),onKeyup:e[3]||(e[3]=(...g)=>o.managePlaceholder&&o.managePlaceholder(...g)),onKeydown:[e[4]||(e[4]=(...g)=>o.resetInputState&&o.resetInputState(...g)),e[5]||(e[5]=Fe(et(g=>o.navigateOptions("next"),["prevent"]),["down"])),e[6]||(e[6]=Fe(et(g=>o.navigateOptions("prev"),["prevent"]),["up"])),e[7]||(e[7]=Fe((...g)=>o.handleKeydownEscape&&o.handleKeydownEscape(...g),["esc"])),e[8]||(e[8]=Fe(et((...g)=>o.selectOption&&o.selectOption(...g),["stop","prevent"]),["enter"])),e[9]||(e[9]=Fe((...g)=>o.deletePrevTag&&o.deletePrevTag(...g),["delete"])),e[10]||(e[10]=Fe(g=>o.visible=!1,["tab"]))],onCompositionstart:e[11]||(e[11]=(...g)=>o.handleComposition&&o.handleComposition(...g)),onCompositionupdate:e[12]||(e[12]=(...g)=>o.handleComposition&&o.handleComposition(...g)),onCompositionend:e[13]||(e[13]=(...g)=>o.handleComposition&&o.handleComposition(...g)),onInput:e[14]||(e[14]=(...g)=>o.debouncedQueryChange&&o.debouncedQueryChange(...g))},null,46,Cu)),[[Mn,o.query]]):_("v-if",!0)],6)):_("v-if",!0),_(" fix: https://github.com/element-plus/element-plus/issues/11415 "),o.isIOS&&!o.multiple&&o.filterable&&o.readonly?(x(),O("input",{key:1,ref:"iOSInput",class:N([o.nsSelect.e("input"),o.nsSelect.is(o.selectSize),o.nsSelect.em("input","iOS")]),disabled:o.selectDisabled,type:"text"},null,10,Bu)):_("v-if",!0),H(u,{id:o.id,ref:"reference",modelValue:o.selectedLabel,"onUpdate:modelValue":e[15]||(e[15]=g=>o.selectedLabel=g),type:"text",placeholder:typeof o.currentPlaceholder=="function"?o.currentPlaceholder():o.currentPlaceholder,name:o.name,autocomplete:o.autocomplete,size:o.selectSize,disabled:o.selectDisabled,readonly:o.readonly,"validate-event":!1,class:N([o.nsSelect.is("focus",o.visible)]),tabindex:o.multiple&&o.filterable?-1:void 0,onFocus:o.handleFocus,onBlur:o.handleBlur,onInput:o.debouncedOnInputChange,onPaste:o.debouncedOnInputChange,onCompositionstart:o.handleComposition,onCompositionupdate:o.handleComposition,onCompositionend:o.handleComposition,onKeydown:[e[16]||(e[16]=Fe(et(g=>o.navigateOptions("next"),["stop","prevent"]),["down"])),e[17]||(e[17]=Fe(et(g=>o.navigateOptions("prev"),["stop","prevent"]),["up"])),Fe(et(o.selectOption,["stop","prevent"]),["enter"]),Fe(o.handleKeydownEscape,["esc"]),e[18]||(e[18]=Fe(g=>o.visible=!1,["tab"]))]},vi({suffix:R(()=>[o.iconComponent&&!o.showClose?(x(),K(l,{key:0,class:N([o.nsSelect.e("caret"),o.nsSelect.e("icon"),o.iconReverse])},{default:R(()=>[(x(),K(rt(o.iconComponent)))]),_:1},8,["class"])):_("v-if",!0),o.showClose&&o.clearIcon?(x(),K(l,{key:1,class:N([o.nsSelect.e("caret"),o.nsSelect.e("icon")]),onClick:o.handleClearClick},{default:R(()=>[(x(),K(rt(o.clearIcon)))]),_:1},8,["class","onClick"])):_("v-if",!0)]),_:2},[o.$slots.prefix?{name:"prefix",fn:R(()=>[E("div",Tu,[Q(o.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]),content:R(()=>[H(f,null,{default:R(()=>[ze(H(c,{ref:"scrollbar",tag:"ul","wrap-class":o.nsSelect.be("dropdown","wrap"),"view-class":o.nsSelect.be("dropdown","list"),class:N([o.nsSelect.is("empty",!o.allowCreate&&!!o.query&&o.filteredOptionsCount===0)])},{default:R(()=>[o.showNewOption?(x(),K(h,{key:0,value:o.query,created:!0},null,8,["value"])):_("v-if",!0),H(d,{onUpdateOptions:o.onOptionsRendered},{default:R(()=>[Q(o.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["wrap-class","view-class","class"]),[[ut,o.options.size>0&&!o.loading]]),o.emptyText&&(!o.allowCreate||o.loading||o.allowCreate&&o.options.size===0)?(x(),O(Ye,{key:0},[o.$slots.empty?Q(o.$slots,"empty",{key:0}):(x(),O("p",{key:1,class:N(o.nsSelect.be("dropdown","empty"))},fe(o.emptyText),3))],64)):_("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[y,o.handleClose,o.popperPaneRef]])}var Mu=ce(wu,[["render",Nu],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const Pu=k({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(o){const e=le("select"),s=S(!0),t=dt(),a=S([]);us(nn,Rt({...so(o)}));const n=mt(Ds);pe(()=>{a.value=i(t.subTree)});const i=l=>{const u=[];return Array.isArray(l.children)&&l.children.forEach(h=>{var d;h.type&&h.type.name==="ElOption"&&h.component&&h.component.proxy?u.push(h.component.proxy):(d=h.children)!=null&&d.length&&u.push(...i(h))}),u},{groupQueryChange:r}=Ps(n);return G(r,()=>{s.value=a.value.some(l=>l.visible===!0)},{flush:"post"}),{visible:s,ns:e}}});function Su(o,e,s,t,a,n){return ze((x(),O("ul",{class:N(o.ns.be("group","wrap"))},[E("li",{class:N(o.ns.be("group","title"))},fe(o.label),3),E("li",null,[E("ul",{class:N(o.ns.b("group"))},[Q(o.$slots,"default")],2)])],2)),[[ut,o.visible]])}var an=ce(Pu,[["render",Su],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const Eu=At(Mu,{Option:po,OptionGroup:an}),Fu=_i(po);_i(an);const rn=["success","info","warning","error"],Te=Fi({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:ot?document.body:void 0}),Ou=Ae({customClass:{type:String,default:Te.customClass},center:{type:Boolean,default:Te.center},dangerouslyUseHTMLString:{type:Boolean,default:Te.dangerouslyUseHTMLString},duration:{type:Number,default:Te.duration},icon:{type:Ut,default:Te.icon},id:{type:String,default:Te.id},message:{type:be([String,Object,Function]),default:Te.message},onClose:{type:be(Function),required:!1},showClose:{type:Boolean,default:Te.showClose},type:{type:String,values:rn,default:Te.type},offset:{type:Number,default:Te.offset},zIndex:{type:Number,default:Te.zIndex},grouping:{type:Boolean,default:Te.grouping},repeatNum:{type:Number,default:Te.repeatNum}}),Ru={destroy:()=>!0},Xe=Pn([]),Au=o=>{const e=Xe.findIndex(a=>a.id===o),s=Xe[e];let t;return e>0&&(t=Xe[e-1]),{current:s,prev:t}},Lu=o=>{const{prev:e}=Au(o);return e?e.vm.exposed.bottom.value:0},Du=(o,e)=>Xe.findIndex(t=>t.id===o)>0?20:e,$u=["id"],Hu=["innerHTML"],_u=k({name:"ElMessage"}),zu=k({..._u,props:Ou,emits:Ru,setup(o,{expose:e}){const s=o,{Close:t}=ga,{ns:a,zIndex:n}=pa("message"),{currentZIndex:i,nextZIndex:r}=n,l=S(),u=S(!1),h=S(0);let d;const c=T(()=>s.type?s.type==="error"?"danger":s.type:"info"),f=T(()=>{const P=s.type;return{[a.bm("icon",P)]:P&&Mo[P]}}),y=T(()=>s.icon||Mo[s.type]||""),g=T(()=>Lu(s.id)),b=T(()=>Du(s.id,s.offset)+g.value),v=T(()=>h.value+b.value),w=T(()=>({top:`${b.value}px`,zIndex:i.value}));function M(){s.duration!==0&&({stop:d}=Is(()=>{z()},s.duration))}function F(){d==null||d()}function z(){u.value=!1}function D({code:P}){P===Qs.esc&&z()}return pe(()=>{M(),r(),u.value=!0}),G(()=>s.repeatNum,()=>{F(),M()}),Fs(document,"keydown",D),cs(l,()=>{h.value=l.value.getBoundingClientRect().height}),e({visible:u,bottom:v,close:z}),(P,$)=>(x(),K(kt,{name:p(a).b("fade"),onBeforeLeave:P.onClose,onAfterLeave:$[0]||($[0]=U=>P.$emit("destroy")),persisted:""},{default:R(()=>[ze(E("div",{id:P.id,ref_key:"messageRef",ref:l,class:N([p(a).b(),{[p(a).m(P.type)]:P.type&&!P.icon},p(a).is("center",P.center),p(a).is("closable",P.showClose),P.customClass]),style:ne(p(w)),role:"alert",onMouseenter:F,onMouseleave:M},[P.repeatNum>1?(x(),K(p(pd),{key:0,value:P.repeatNum,type:p(c),class:N(p(a).e("badge"))},null,8,["value","type","class"])):_("v-if",!0),p(y)?(x(),K(p(qe),{key:1,class:N([p(a).e("icon"),p(f)])},{default:R(()=>[(x(),K(rt(p(y))))]),_:1},8,["class"])):_("v-if",!0),Q(P.$slots,"default",{},()=>[P.dangerouslyUseHTMLString?(x(),O(Ye,{key:1},[_(" Caution here, message could've been compromised, never use user's input as message "),E("p",{class:N(p(a).e("content")),innerHTML:P.message},null,10,Hu)],2112)):(x(),O("p",{key:0,class:N(p(a).e("content"))},fe(P.message),3))]),P.showClose?(x(),K(p(qe),{key:2,class:N(p(a).e("closeBtn")),onClick:et(z,["stop"])},{default:R(()=>[H(p(t))]),_:1},8,["class","onClick"])):_("v-if",!0)],46,$u),[[ut,u.value]])]),_:3},8,["name","onBeforeLeave"]))}});var Vu=ce(zu,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let Wu=1;const ln=o=>{const e=!o||st(o)||bi(o)||je(o)?{message:o}:o,s={...Te,...e};if(!s.appendTo)s.appendTo=document.body;else if(st(s.appendTo)){let t=document.querySelector(s.appendTo);ya(t)||(t=document.body),s.appendTo=t}return s},Ku=o=>{const e=Xe.indexOf(o);if(e===-1)return;Xe.splice(e,1);const{handler:s}=o;s.close()},ku=({appendTo:o,...e},s)=>{const t=`message_${Wu++}`,a=e.onClose,n=document.createElement("div"),i={...e,id:t,onClose:()=>{a==null||a(),Ku(h)},onDestroy:()=>{wo(null,n)}},r=H(Vu,i,je(i.message)||bi(i.message)?{default:je(i.message)?i.message:()=>i.message}:null);r.appContext=s||jt._context,wo(r,n),o.appendChild(n.firstElementChild);const l=r.component,h={id:t,vnode:r,vm:l,handler:{close:()=>{l.exposed.visible.value=!1}},props:r.component.props};return h},jt=(o={},e)=>{if(!ot)return{close:()=>{}};if(Ge(eo.max)&&Xe.length>=eo.max)return{close:()=>{}};const s=ln(o);if(s.grouping&&Xe.length){const a=Xe.find(({vnode:n})=>{var i;return((i=n.props)==null?void 0:i.message)===s.message});if(a)return a.props.repeatNum+=1,a.props.type=s.type,a.handler}const t=ku(s,e);return Xe.push(t),t.handler};rn.forEach(o=>{jt[o]=(e={},s)=>{const t=ln(e);return jt({...t,type:o},s)}});function Uu(o){for(const e of Xe)(!o||o===e.props.type)&&e.handler.close()}jt.closeAll=Uu;jt._context=null;const ju=ma(jt,"$message"),qu="L";function Je(){return((1+Math.random())*65536|0).toString(16).substring(1)}function St(){return`${qu}${Je()}${Je()}-${Je()}-${Je()}-${Je()}-${Je()}${Je()}${Je()}`}function Go(o,e=!1){return e?o:`${o}-${Je()}${Je()}`}class Yu extends Lt{constructor(e,s){super(),this.x=0,this.y=0,this.w=20,this.h=14,this.fillStyle="#eeb174",this.strokeStyle="#333",this.ctx=e,this.analysisOptions(s)}analysisOptions(e){e.x&&(this.x=e.x),e.y&&(this.y=e.y),e.w&&(this.w=e.w),e.h&&(this.h=e.h),e.fillStyle&&(this.fillStyle=e.fillStyle),e.strokeStyle&&(this.strokeStyle=e.strokeStyle),e.tiggerFunc&&(this.tiggerFunc=e.tiggerFunc)}draw(){const{ctx:e,x:s,y:t,w:a,h:n,fillStyle:i,strokeStyle:r}=this;e.save(),e.fillStyle=i,e.strokeStyle=r,e.lineWidth=3,e.beginPath(),e.arc(s+a/2,t-3,a/3,0,Math.PI,!0),e.stroke(),e.drawRoundedRect(s,t,a,n,2,2,2,2,!0,!0,!1,!1),e.restore()}containsPoint(e,s=!1){var f;const{x:t,y:a,w:n,h:i}=this,{x:r,y:l}=e,u=this.getImageLines({tl:{x:t,y:a},tr:{x:t+n,y:a},bl:{x:t,y:a+i},br:{x:t+n,y:a+i}}),d=!!(this.findCrossPoints(r,l,u)%2);d&&s&&((f=this.tiggerFunc)==null||f.call(this));const c={type:null,id:null};return d&&(c.type="icon"),c}}const Gu=function(o){return o.length===4&&(o=o.slice(0,2)+o.slice(1,2)+o.slice(2,3)+o.slice(2,3)+o.slice(3,4)+o.slice(3,4)),"rgb("+parseInt("0x"+o.slice(1,3))+","+parseInt("0x"+o.slice(3,5))+","+parseInt("0x"+o.slice(5,7))+")"},Xu=function(o){const s=(o.includes("rgb")?o:Gu(o)).replace(/rgb\(|rgba\(|\)/g,"").split(",");return .213*s[0]+.715*s[1]+.072*s[2]>255/2};class Z extends Lt{constructor(e,s){super(),this.width=100,this.height=100,this.titleHeight=24,this.fontSize=12,this.padding=10,this.attrHeight=14,this.ifSubEntity=!1,this.ifLogic=!1,this.ifOnlyLogic=!1,this.ifOnlyPhy=!1,this.ifAuto=!1,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.bdC="#000000",this.color="#000000",this.bgC="#FFFFFF",this.quotePrimaryKey=!1,this.physicalTables=!1,this.ctx=e,this.updateOptions(s)}analysisOptions(e){if(!e)return;const{x:s,y:t,width:a,height:n,id:i,enName:r,cnName:l,type:u,attributes:h,bgC:d,bdC:c,quotePrimaryKey:f,physicalTables:y,ifLogic:g,ifAuto:b,ifOnlyLogic:v,ifOnlyPhy:w}=e;Nt(g)&&(this.ifLogic=g),(Nt(w)||w)&&(this.ifOnlyPhy=!!+w),(Nt(b)||b)&&(this.ifAuto=!!+b),(Nt(v)||v)&&(this.ifOnlyLogic=!!+v),_e(s)&&(this.x=s),_e(t)&&(this.y=t),i&&(this.id=i),zo(r)&&(this.enName=r),zo(l)&&(this.cnName=l),_e(a)&&(this.width=a),_e(n)&&(this.height=n),u&&(this.type=u,this.ifSubEntity=["exclusive","inclusive"].includes(u)),h&&(this.attributes=h,this.attributesPartition()),d&&(this.bgC=d),c&&(this.bdC=c),Nt(f)&&(this.quotePrimaryKey=f),Nt(y)&&(this.physicalTables=y)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){var F;const{x:s,y:t}=e,{x:a,y:n,width:i,height:r,attrHeight:l,titleHeight:u,padding:h}=this,d={type:null,id:null},c=this.getImageLines({tl:{x:a,y:n},tr:{x:a+i,y:n},bl:{x:a,y:n+r},br:{x:a+i,y:n+r}});if(!!!(this.findCrossPoints(s,t,c)%2))return d;if(t-n<u)return d.type="title",d;const b=[...this.attributesPrimary,{id:"PrimaryKey"},...this.attributesPrimaryNon,{id:"NonPrimaryKey"}],v=t-n-u-h-(this.attributesPrimary.length?0:l),w=Math.min(Math.floor(v/l),b.length-1),M=(F=b[w])==null?void 0:F.id;return M?(d.type="attribute",d.id=M):(d.type="entity",d.id=this.id),d}draw(e){this.updateOptions(e),this.drawContainer(),this.drawTitle(),this.drawBody()}drawContainer(){const{ctx:e,x:s,y:t,width:a,height:n,titleHeight:i,type:r,bgC:l,bdC:u,quotePrimaryKey:h,physicalTables:d,ifSubEntity:c}=this,f=c?t:t+i,y=c?n:n-i;if(e.save(),e.strokeStyle=u,e.fillStyle=l,c)e.beginPath(),e.arc(s+a/2,f+a/2,a/2,0,Math.PI,!0),e.closePath(),e.fill(),e.stroke(),r==="exclusive"&&(e.moveTo(s+12,f+6),e.lineTo(s+a-12,f+y-3),e.moveTo(s+a-12,f+6),e.lineTo(s+12,f+y-3),e.stroke());else{const g=h?4:0;e.drawRoundedRect(s,f,a,y,g,g,g,g,!0,!0,d,!0)}e.restore()}drawDataType(e,s,t){var r;const a=(r=e==null?void 0:e.replace(/[^A-Za-z0-9]/g,""))==null?void 0:r.toLocaleUpperCase();let n;a in zi?n=tt.get("date"):a in Vi?n=tt.get("number"):a in Wi?n=tt.get("string"):a in Ki?n=tt.get("boolean"):a in ki&&(n=tt.get("binary"));const{ctx:i}=this;if(!n)return i.save(),i.fillStyle="#808080",i.fillText("?",s,t,this.fontSize),i.restore(),!1;i.drawImage(n,s,t,this.fontSize,this.fontSize)}drawTitle(){const{ctx:e,color:s,enName:t,cnName:a,ifLogic:n,width:i,x:r,y:l,titleHeight:u,fontSize:h,ifSubEntity:d}=this;e.save(),e.font=`${h}px Arial`,e.fillStyle=s,e.textAlign="left",e.textBaseline="top";const c=(n?a:t)??"",f=d?c:e.fittingString(c,i-14),y=d?r+50:r,g=d?l+2:l+4;e.fillText(f,y,g),e.restore()}drawBody(){const{ctx:e,x:s,y:t,titleHeight:a,bgC:n,fontSize:i,padding:r,attrHeight:l,attributesPrimary:u,attributesPrimaryNon:h}=this;e.save(),e.font=`${i}px Arial`,e.fillStyle=Xu(n)?"#000":"#fff",e.textAlign="left",e.textBaseline="top";const d=r+s;let c=t+r-l+a;for(let f=0;f<u.length;f++){const y=u[f];c=this.drawAttrRow(y,d,c)}c=this.drawSplitLine(c);for(let f=0;f<h.length;f++){const y=h[f];c=this.drawAttrRow(y,d,c)}e.restore()}drawAttrRow(e,s,t){var v,w;const{ctx:a,attrHeight:n,padding:i,fontSize:r,x:l,y:u,width:h,height:d,ifLogic:c}=this;if(t+=n,t+16>d+u)return;this.drawDataType(e.type,s,t);const f=Number(e.ifFk)?"(FK)":"",y=c?e.cnName:e.enName,g=a.fittingString(y+f,h-(s-l)-i-r-4);a.fillStyle=((v=e.css)==null?void 0:v.color)||"#000",a.fillText(g,s+r+4,t);const b=s+a.measureText(g).width+r+4;if(this.drawIcons(e.icons,b,t),(w=e.children)!=null&&w.length){const M=this.expandAttrs.includes(e);this.drawTreeExpandArrow.call(this,{x:s,y:t,size:r,expand:M}),M&&e.children.forEach(F=>{t=this.drawAttrRow(F,s+10,t)})}return t}drawIcons(e=[],s,t){const{fontSize:a,x:n,width:i,padding:r}=this;for(let l=0;l<e.length;l++){const u=e[l],h=s+a*.7+l*(a*1.2);if(h+a/2*3>n+i+r)return;this.drawIcon(u,h,t)}}drawIcon(e,s,t){const{ctx:a,attrHeight:n,fontSize:i}=this;a.save(),a.beginPath(),a.strokeStyle=e.bdC||"#0C64EB",a.fillStyle=e.bgC||"#ECF5FF",a.arc(s,t+Math.floor(n/2)-1,i/2,0,2*Math.PI),a.fill(),a.stroke(),a.fillStyle=e.color||"#0C64EB",a.font=`${Math.ceil(i/1.2)}px Arial`,a.textAlign="center",a.fillText(e.text,s,t+(n-i)/2+1),a.restore()}drawSplitLine(e){const{ctx:s,attributesPrimary:t,attrHeight:a,x:n,y:i,width:r,height:l}=this;e+=(t.length?1:2)*a,s.save();const u=e+a/3;return u<l+i&&(s.beginPath(),s.strokeStyle="#000",s.moveTo(n,u),s.lineTo(n+r,u),s.stroke()),s.restore(),e}drawTreeExpandArrow({x:e,y:s,size:t,expand:a}){const{ctx:n}=this;n.save(),n.beginPath(),n.translate(e-4,s+t/2),a&&n.rotate(90*Math.PI/180),n.moveTo(-2,-4),n.lineTo(-2,4),n.lineTo(2,0),n.fill(),n.restore()}attributesPartition(){this.attributesPrimary=[],this.attributesPrimaryNon=[];const{ifLogic:e,attributes:s,attributesPrimary:t,attributesPrimaryNon:a}=this;for(let n=0;n<s.length;n++){const i=s[n];e&&+i.ifPhy||!e&&+i.ifLogic||(Number(i.ifPk)?t.push(i):a.push(i),i.id||(i.id=St()))}}getAttributeInfo(e){const{attributesPrimary:s,attributesPrimaryNon:t,x:a,y:n,width:i,titleHeight:r,height:l,padding:u,attrHeight:h}=this,d=[...s,{id:"PrimaryKey",ifPk:!0,enName:"",cnName:"",type:null,ifFk:!1,icons:[]},...t,{id:"NonPrimaryKey",ifPk:!1,enName:"",cnName:"",type:null,ifFk:!1,icons:[]}],c=d.findIndex(y=>y.id===e)??d.length-1;return{x:a+u,y:n+u+r+(s.length?c:c+1)*h,width:i-2*u,height:h,info:d[c],padding:u}}calcBoundingBox(){const{x:e,y:s,width:t,height:a}=this;this.boundingBox=[[e,s],[e+t,s],[e,s+a],[e+t,s+a]]}}class lt extends Lt{constructor(e,s){super(),this.width=100,this.height=50,this.borderWidth=2,this.x=0,this.y=0,this.bdC="#000000",this.ctx=e,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{x:s,y:t,width:a,height:n,id:i,bgC:r,bdC:l}=e;_e(s)&&(this.x=s),_e(t)&&(this.y=t),i&&(this.id=i),_e(a)&&(this.width=a),_e(n)&&(this.height=n),r&&(this.bgC=r),l&&(this.bdC=l)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:s,y:t}=e,{x:a,y:n,width:i,height:r}=this,l={type:null,id:this.id},u=this.getImageLines({tl:{x:a,y:n},tr:{x:a+i,y:n},bl:{x:a,y:n+r},br:{x:a+i,y:n+r}});return!(this.findCrossPoints(s,t,u)%2)||(l.type="node-rect"),l}draw(e){this.analysisOptions(e),this.drawRect()}drawRect(){const{ctx:e,x:s,y:t,width:a,height:n,bgC:i,bdC:r,borderWidth:l}=this;e.save(),e.lineWidth=l,e.strokeStyle=r||"#000000",e.fillStyle=i||"#ffffff",e.strokeRect(s,t,a,n),e.restore()}calcBoundingBox(){const{x:e,y:s,width:t,height:a}=this;this.boundingBox=[[e,s],[e+t,s],[e,s+a],[e+t,s+a]]}}class yt extends Lt{constructor(e,s){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.bdC="#0C64EB",this.textColor="#0C64EB",this.bgC="#D0E2FF",this.borderWidth=1,this.ctx=e,this.updateOptions(s)}analysisOptions(e){if(!e)return;const{x:s,y:t,id:a,bdC:n,textColor:i,bgC:r,borderWidth:l,content:u}=e;_e(s)&&(this.x=s),_e(t)&&(this.y=t),a&&(this.id=a),n&&(this.bdC=n),i&&(this.textColor=i),r&&(this.bgC=r),_e(l)&&(this.borderWidth=l),u&&(this.content=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:s,y:t}=e,{x:a,y:n,width:i,height:r}=this,l={type:null,id:this.id};return s>=a&&s<=a+i&&t>=n&&t<=n+r&&(l.type="text-base"),l}draw(e){this.updateOptions(e);const{ctx:s,content:t,x:a,y:n,textColor:i}=this;s.save(),s.textBaseline="top",s.fillStyle=i,s.fillText(t,a,n),s.restore()}calcBoundingBox(){const{x:e,y:s,ctx:t,content:a}=this,n=t.measureText(a),i=this.width=n.width,r=this.height=n.actualBoundingBoxAscent+n.actualBoundingBoxDescent;this.boundingBox=[[e,s],[e+i,s],[e,s+r],[e+i,s+r]]}}const Xo=(o,e,s=0)=>{const{x:t,y:a}=o,n=s||0,i=s||0;for(let r=0;r<e.length-1;r++){const l=e[r],u=e[r+1],h=l.y-u.y,d=u.x-l.x,c=l.x*u.y-u.x*l.y;if(Math.abs(h*t+d*a+c)/Math.sqrt(h*h+d*d)<=n&&t>=Math.min(l.x,u.x)-n&&t<=Math.max(l.x,u.x)+n&&a>=Math.min(l.y,u.y)-i&&a<=Math.max(l.y,u.y)+i)return r}return!1},Iu=(o,e,s=0)=>{const t=[];return o===e||(Math.abs(o.x-(e.x+e.width))<=s&&t.push(["left","right"]),Math.abs(e.x-(o.x+o.width))<=s&&t.push(["right","left"]),Math.abs(o.y-(e.y+e.height))<=s&&t.push(["top","bottom"]),Math.abs(e.y-(o.y+o.height))<=s&&t.push(["bottom","top"]),Math.abs(o.x-e.x)<=s&&t.push(["left","left"]),Math.abs(o.y-e.y)<=s&&t.push(["top","top"]),Math.abs(o.x+o.width-e.x-e.width)<=s&&t.push(["right","right"]),Math.abs(o.y+o.height-e.y-e.height)<=s&&t.push(["bottom","bottom"])),t};class ye extends Lt{constructor(e,s){super(),this.pos=[],this.lineWidth=1,this.ifPure=!1,this.bdC="#000000",this.ctx=e,this.analysisOptions(s),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{pos:s,type:t,from:a,to:n,id:i,lineWidth:r,numLineType:l,bdC:u,remark:h,ifPure:d}=e;i&&(this.id=i),a&&(this.from=a),n&&(this.to=n),s&&(this.pos=s),t&&(this.type=t),l&&(this.numLineType=l),r&&(this.lineWidth=r),u&&(this.bdC=u),Nt(d)&&(this.ifPure=d),va(h)||(this.remark=h)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}draw(e){this.analysisOptions(e),this.drawLine(),this.drawEnds(),this.drawNote()}containsPoint(e){const{pos:s,id:t}=this,a=_e(Xo(e,s,5)),n={type:null,id:null};return a&&(n.type="line",n.id=t),n}getIndexInPos(e){return Xo(e,this.pos,5)}drawLine(){const{ctx:e,bdC:s,lineWidth:t,type:a,pos:n}=this;e.save(),e.strokeStyle=s,e.lineWidth=t,a==="NON_IDENTIFYING"&&e.setLineDash([8,5]),n.forEach((i,r)=>{r===0?(e.beginPath(),e.moveTo(i.x,i.y)):e.lineTo(i.x,i.y)}),e.stroke(),e.restore()}drawEnds(){if(this.ifPure)return!1;const{ctx:e,pos:s,bdC:t,lineWidth:a,numLineType:n}=this,i=15,r=s.length||0;if(!(r<2)){if(e.save(),e.beginPath(),e.setLineDash([0,0]),e.strokeStyle=t,e.lineWidth=a,s[0].x===s[1].x){const l=s[1].y-s[0].y,u=Math.abs(l)<10?l<0?s[0].y-1:s[0].y+1:l<0?s[0].y-10:s[0].y+10;e.moveTo(s[0].x-i/2,u),e.lineTo(s[0].x+i/2,u)}else{const l=s[1].x-s[0].x,u=Math.abs(l)<10?l<0?s[0].x-1:s[0].x+1:l<0?s[0].x-10:s[0].x+10;e.moveTo(u,s[0].y-i/2),e.lineTo(u,s[0].y+i/2)}if(s[r-2].x===s[r-1].x){const l=s[r-1].y-s[r-2].y,u=Math.abs(l)<10?l<0?s[r-1].y+1:s[r-1].y-1:l<0?s[r-1].y+10:s[r-1].y-10;if(e.moveTo(s[r-1].x-i/2,u),e.lineTo(s[r-1].x+i/2,u),e.stroke(),["ONE_MORE","ZEROONE_MORE"].includes(n)&&(e.moveTo(s[r-1].x-i/2,s[r-1].y),e.lineTo(s[r-1].x,u),e.lineTo(s[r-1].x,s[r-1].y),e.moveTo(s[r-1].x,u),e.lineTo(s[r-1].x+i/2,s[r-1].y),e.stroke()),["ZEROONE_MORE","ZEROONE_ONE"].includes(n)){e.beginPath();const h=s[r-1].x,d=l<0?u+i/2:u-i/2;e.arc(h,d,(i-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}else{const l=s[r-1].x-s[r-2].x,u=Math.abs(l)<10?l<0?s[r-1].x+1:s[r-1].x-1:l<0?s[r-1].x+10:s[r-1].x-10;if(e.moveTo(u,s[r-1].y-i/2),e.lineTo(u,s[r-1].y+i/2),e.stroke(),["ONE_MORE","ZEROONE_MORE"].includes(n)&&(e.moveTo(s[r-1].x,s[r-1].y-i/2),e.lineTo(u,s[r-1].y),e.lineTo(s[r-1].x,s[r-1].y),e.moveTo(u,s[r-1].y),e.lineTo(s[r-1].x,s[r-1].y+i/2),e.stroke()),["ZEROONE_MORE","ZEROONE_ONE"].includes(n)){e.beginPath();const h=l<0?u+i/2:u-i/2,d=s[r-1].y;e.arc(h,d,(i-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}e.restore()}}drawNote(){const{ctx:e,pos:s,remark:t}=this;if(!t)return;const a=Math.floor(s.length/2)-1;let n,i,r;if(s[a].y===s[a+1].y?(r=!1,n=Math.abs(s[a+1].x-s[a].x)/2+Math.min(s[a+1].x,s[a].x),i=s[a].y-10):(r=!0,n=s[a].x+10,i=Math.abs(s[a+1].y-s[a].y)/2+Math.min(s[a+1].y,s[a].y)),e.save(),e.textAlign="center",r){e.translate(n,i);const l=90*Math.PI/180;e.rotate(l),e.fillText(t,0,0)}else e.fillText(t,n,i);e.restore()}calcBoundingBox(){const{pos:e}=this,s=[],t=[];for(let a=0;a<e.length;a++){const n=e[a];s.push(n.x),t.push(n.y)}this.boundingBox=[[Math.min(...s),Math.min(...t)],[Math.max(...s),Math.max(...t)]]}}const Zu=(o,e=-1/0,s=1/0)=>Math.max(Math.min(o,s),e),go="Renderer2d",Qu=(...o)=>console.log(`[${go}]: `,...o),Me=(...o)=>console.warn(`[${go}]: `,...o),Io=(...o)=>console.error(`[${go}]: `,...o);class Ju{constructor(e){this.originData={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},this.originDataMap=new Map,this.nodeMap=new Map,this.lineMap=new Map,this.noteMap=new Map,this.markMap=new Map,this.nodeRelatedLineMap=new Map,this.update(e),this.mountAutoUpdate()}update(e){this.analysisOptions(e)}analysisOptions(e){const{data:s,context:t}=e;s&&(this.originData=s),t&&(this.context=t),this.clearMap(),this.initMap()}clearMap(){var e,s,t,a,n,i;(e=this.originDataMap)==null||e.clear(),(s=this.lineMap)==null||s.clear(),(t=this.markMap)==null||t.clear(),(a=this.noteMap)==null||a.clear(),(n=this.nodeMap)==null||n.clear(),(i=this.nodeRelatedLineMap)==null||i.clear()}initMap(){const{originData:{nodeDataArray:e=[],linkDataArray:s=[],markDataArray:t=[],noteDataArray:a=[]},originDataMap:n}=this;n.clear();const i=[...e,...s,...t,...a];for(let r=0;r<i.length;r++){const l=i[r];n.set(l.id,l)}}mountAutoUpdate(){this.mountGraphEvent(),this.mountNodeEvent(),this.mountNodeAttrEvent(),this.mountLineEvent(),this.mountMarkEvent(),this.mountNoteEvent(),this.mountEditorEvent()}mountGraphEvent(){const{context:e}=this;e.on($e.Paste,s=>{s.map(t=>{e.emit(j.New,t)})})}mountNodeEvent(){const{originDataMap:e,context:s}=this;s.on(j.Move,t=>s.emit(j.Change,t)),s.on(j.Resize,t=>s.emit(j.Change,t)),s.on(j.Change,t=>{const a=e.get(t.id);a.enName=t.enName,a.cnName=t.cnName,a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.bdC=t.bdC,a.bgC=t.bgC}),s.on(j.Delete,function(t){const a=this.originData.nodeDataArray.findIndex(n=>n.id===t.id);a!==-1&&(this.originData.nodeDataArray.splice(a,1),e.delete(t.id))}.bind(this)),s.on(j.New,t=>{t.id||(t.id=St()),t.enName||(t.enName=Go("Entity")),t.cnName||(t.cnName=Go("实体")),this.originData.nodeDataArray.push(t),this.originDataMap.set(t.id,t)})}mountNodeAttrEvent(){const{originDataMap:e,context:s}=this;s.on(Re.Drop,(t,a)=>{const{sourceNodeId:n,sourceAttrIds:i,targetNodeId:r,beforeAttrId:l,afterAttrId:u,ifPk:h}=a,d=e.get(n),c=e.get(r),f=[];for(let y=0;y<i.length;y++){const g=i[y],b=d.attributes.findIndex(w=>w.id===g),v=d.attributes.splice(b,1)[0];v.ifPk=h,f.push(v)}if(u){const y=c.attributes.findIndex(g=>g.id===u);c.attributes.splice(y,0,...f)}else c.attributes.push(...f)}),s.on(Re.Change,(t,a,n,i)=>{const l=e.get(t).attributes.find(u=>u.id===a);l[n]=i})}mountLineEvent(){const{originDataMap:e,nodeRelatedLineMap:s,lineMap:t,context:a}=this;a.on(re.Move,n=>a.emit(re.Change,n)),a.on(re.Change,n=>{const i=e.get(n.id);i.pos=n.pos}),a.on(re.Delete,function(n){const i=this.originData.linkDataArray.findIndex(l=>l.id===n.id);if(i===-1)return;const[r]=this.originData.linkDataArray.splice(i,1);s.get(r.from).from.delete(t.get(n.id)),s.get(r.to).to.delete(t.get(n.id)),t.delete(n.id),e.delete(n.id)}.bind(this)),a.on(re.New,n=>{n.id||(n.id=St()),this.originData.linkDataArray.push(n),this.originDataMap.set(n.id,n)})}mountMarkEvent(){const{originDataMap:e,context:s}=this;s.on(me.Move,t=>s.emit(me.Change,t)),s.on(me.Resize,t=>s.emit(me.Change,t)),s.on(me.Change,t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.bdC=t.bdC,a.bgC=t.bgC}),s.on(me.Delete,function(t){const a=this.originData.markDataArray.findIndex(n=>n.id===t.id);a!==-1&&(this.originData.markDataArray.splice(a,1),e.delete(t.id))}.bind(this)),s.on(me.New,t=>{Object.assign(t,{id:St()}),this.originData.markDataArray.push(t),this.originDataMap.set(t.id,t)})}mountNoteEvent(){const{originDataMap:e,context:s}=this;s.on(Oe.Move,t=>s.emit(Oe.Change,t)),s.on(Oe.Change,t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.color=t.color,a.bdC=t.bdC,a.bgC=t.bgC}),s.on(Oe.Delete,function(t){const a=this.originData.noteDataArray.findIndex(n=>n.id===t.id);a!==-1&&(this.originData.noteDataArray.splice(a,1),e.delete(t.id))}.bind(this)),s.on(Oe.New,t=>{Object.assign(t,{id:St(),text:"remark..."}),this.originData.noteDataArray.push(t),this.originDataMap.set(t.id,t)})}mountEditorEvent(){const{nodeMap:e,context:s}=this,t=(n,i)=>{const{entityId:r,key:l}=n,u=e.get(r);if(u[l]===i)return;const c=s.emit(j.BeforeChange,u,l,i);Promise.all(c).then(()=>{u.updateOptions({[l]:i}),s.emit(j.Change,u)}).catch(()=>Me("Change abort in [BeforeChange] hooks.",u))},a=(n,i)=>{const{entityId:r,attrId:l,key:u,originData:h}=n;if(h[u]===i)return;const f=s.emit(Re.BeforeChange,r,l,u,i,h);Promise.all(f).then(()=>{s.emit(Re.Change,r,l,u,i,h)}).catch(()=>Me("Change abort in [BeforeChange] hooks.",h))};s.on(Mt.Blur,(n,i)=>{const{type:r}=n;switch(r){case"node-name":t(n,i);break;case"node-attr":a(n,i);break}})}unmountAutoUpdate(){const{context:e}=this;e.off()}freeVariable(){this.originData=null,this.originDataMap=null}destroy(){this.unmountAutoUpdate(),this.freeVariable()}}class Zo extends Lt{constructor(e,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=1,this.bdC="blue",this.targetWidth=6,this.targetBgColor="#FFFFFF",this.targetBdColor="#B4B4B4",this.ctx=e,this.updateOptions(s)}analysisOptions(e){if(!e)return;const{x:s=0,y:t=0,width:a,height:n,targetBgColor:i,targetBdColor:r,bdC:l,lineWidth:u}=e;s&&(this.x=s),t&&(this.y=t),a&&(this.width=a),n&&(this.height=n),i&&(this.targetBgColor=i),r&&(this.targetBdColor=r),l&&(this.bdC=l),u&&(this.lineWidth=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return{type:null,id:null}}draw(e){this.updateOptions(e),this.drawBorder(),this.drawTargets()}drawBorder(){const{ctx:e,bdC:s,lineWidth:t,x:a,y:n,width:i,height:r}=this;e.save(),e.lineWidth=t,e.strokeStyle=s,e.strokeRect(a,n,i,r),e.restore()}drawTargets(){const{ctx:e,targetBdColor:s,targetBgColor:t,targetWidth:a,x:n,y:i,width:r,height:l}=this,u=a/2,h=n-u,d=i-u;e.save(),e.strokeStyle=s,e.fillStyle=t,e.fillRect(h,d,a,a),e.fillRect(h,d+l/2,a,a),e.fillRect(h,d+l,a,a),e.fillRect(h+r/2,d,a,a),e.fillRect(h+r/2,d+l,a,a),e.fillRect(h+r,d,a,a),e.fillRect(h+r,d+l/2,a,a),e.fillRect(h+r,d+l,a,a),e.strokeRect(h,d,a,a),e.strokeRect(h,d+l/2,a,a),e.strokeRect(h,d+l,a,a),e.strokeRect(h+r/2,d,a,a),e.strokeRect(h+r/2,d+l,a,a),e.strokeRect(h+r,d,a,a),e.strokeRect(h+r,d+l/2,a,a),e.strokeRect(h+r,d+l,a,a),e.restore()}calcBoundingBox(){const{x:e,y:s,width:t,height:a}=this;this.boundingBox=[[e,s],[e+t,s],[e,s+a],[e+t,s+a]]}}class Qo extends Lt{constructor(e,s){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=2,this.bdC="blue",this.ctx=e,this.updateOptions(s)}analysisOptions(e){if(!e)return;const{x:s=0,y:t=0,width:a,height:n,bdC:i,lineWidth:r}=e;s&&(this.x=s),t&&(this.y=t),a&&(this.width=a),n&&(this.height=n),i&&(this.bdC=i),i&&(this.lineWidth=r)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return{type:null,id:null}}draw(e){this.updateOptions(e),this.drawBorder()}drawBorder(){const{ctx:e,bdC:s,lineWidth:t,x:a,y:n,width:i,height:r}=this;e.save(),e.lineWidth=t,e.strokeStyle=s,e.strokeRect(a,n,i,r),e.restore()}calcBoundingBox(){const{x:e,y:s,width:t,height:a}=this;this.boundingBox=[[e,s],[e+t,s],[e,s+a],[e+t,s+a]]}}const to=(o,e)=>{if(!(o instanceof Z||o instanceof lt))return!1;const{x:t,width:a}=o;let{y:n,height:i}=o;o instanceof Z&&!o.ifSubEntity&&(n+=o.titleHeight,i-=o.titleHeight);const r=t+a/2,l=n+i/2,u=t+a,h=n+i,d=5;let c=oe.NONE;return Math.abs(t-e.x)<=d&&Math.abs(n-e.y)<=d?c=oe.LT:Math.abs(r-e.x)<=d&&Math.abs(n-e.y)<=d?c=oe.TM:Math.abs(u-e.x)<=d&&Math.abs(n-e.y)<=d?c=oe.RT:Math.abs(t-e.x)<=d&&Math.abs(l-e.y)<=d?c=oe.LM:Math.abs(u-e.x)<=d&&Math.abs(l-e.y)<=d?c=oe.RM:Math.abs(t-e.x)<=d&&Math.abs(h-e.y)<=d?c=oe.LB:Math.abs(r-e.x)<=d&&Math.abs(h-e.y)<=d?c=oe.BM:Math.abs(u-e.x)<=d&&Math.abs(h-e.y)<=d&&(c=oe.RB),c},dn=({sourceNodeId:o,sourceAttrIds:e,targetNode:s,canvasEv:t})=>{var y;const a=s==null?void 0:s.containsPoint(t),n=s instanceof Z,i=(a==null?void 0:a.type)==="attribute";if(!n||!i)return;const r=a.id,l=!!+s.getAttributeInfo(r).info.ifPk,u=["PrimaryKey","NonPrimaryKey"].includes(r),h=l?s.attributesPrimary:s.attributesPrimaryNon,d=u?h.length-1:h.findIndex(g=>g.id===r)-1,c=((y=h[d])==null?void 0:y.id)??null;return{sourceNodeId:o,sourceAttrIds:e,targetNodeId:s.id,afterAttrId:u?null:r,beforeAttrId:c,ifPk:l}},is=o=>o instanceof Z?j:o instanceof ye?re:o instanceof lt?me:o instanceof yt?Oe:null,un=function(o,e){const s=()=>{const{event:d}=this,c={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},f={x:d.target.x+c.x,y:d.target.y+c.y};this.dataHandler.markMap.get(d.target.id).updateOptions(f),this.emit(me.Move,this.dataHandler.markMap.get(d.target.id)),this.update()},t=()=>{const{event:d}=this,c={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},f={x:d.target.x+c.x,y:d.target.y+c.y};this.dataHandler.noteMap.get(d.target.id).updateOptions(f),this.emit(Oe.Move,d.target),this.update()},a=()=>{const{event:d}=this,{x:c,y:f}=e;d.target.type==="mark"?this.resizeNode(c,f,d,null):this.resizeNode(c,f,d),this.update()},n=(d,c)=>{const{focusTarget:f,event:y,dataHandler:{nodeRelatedLineMap:g}}=this,b={x:e.x-y.targetOffsetX-y.target.x,y:e.y-y.targetOffsetY-y.target.y};f.forEach(v=>{if(!(v instanceof Z))return;const w={x:d??v.x+b.x,y:c??v.y+b.y};g.has(v.id)&&[...g.get(v.id).from,...g.get(v.id).to].forEach(F=>{F.from===F.to?this.moveLineForSameNode(F,{target:v}):this.moveLineForNode(F,{target:v},w)}),this.dataHandler.nodeMap.get(v.id).updateOptions(w),this.emit(j.Move,v)}),this.update()},i=()=>{const{event:d,focusAttrs:c,hoverTarget:f}=this;u();const y=dn({sourceNodeId:d.target.id,sourceAttrIds:[...c],targetNode:f,canvasEv:e});y&&this.emit(Re.Drag,o,y)},r=()=>{const{event:d}=this,c=d.target.getIndexInPos(d.lastEvLoc);d.targetLineStartPointIdx=c,d.lastEvLoc=e,c!==!1&&(this.moveLineForLine(d,e),this.update())},l=()=>{this.canvas.setTranslate(o),this.canvas.clearEventCanvas();const d=this.canvas.getTranslate();this.emit($e.Move,d),this.update()},u=()=>{const{status:d,renderElements:c}=this,y={[ue.AddNode]:J.cell,[ue.AddPrimaryKey]:J.crosshair,[ue.AddForeignKey]:J.crosshair,[ue.AddFiltered]:J.crosshair,[ue.AddMark]:J.cell,[ue.AddNote]:J.cell,[ue.Copy]:J.copy}[d];let g=null,b=J.grab;for(let v=c.length-1;v>=0;v--){const w=c[v],M=to(w,e)||w.containsPoint(e).type;if(M){g=w,b=M===oe.LT?J.nwseResize:M===oe.TM?J.nsResize:M===oe.RT?J.neswResize:M===oe.LM?J.ewResize:M===oe.RM?J.ewResize:M===oe.LB?J.neswResize:M===oe.BM?J.nsResize:M===oe.RB?J.nwseResize:J.move;break}}if(this.hoverTarget!==g){const v=this.hoverTarget instanceof Z?j:this.hoverTarget instanceof ye?re:this.hoverTarget instanceof lt?me:this.hoverTarget instanceof yt?Oe:null,w=g instanceof Z?j:g instanceof ye?re:g instanceof lt?me:g instanceof yt?Oe:null;v&&this.emit(v.Leave,this.hoverTarget),w&&this.emit(w.Enter,g)}this.hoverTarget=g,this.canvas.eventEl.style.cursor=y??b,this.updateEventCanvas()};return{changeMouseCursor:u,moveCanvas:l,moveElement:()=>{const{event:d,focusAttrs:c}=this,f=d.target&&!!c.size,y=!!d.targetDirection,g=d.target instanceof Z,b=d.target instanceof ye,v=d.target instanceof lt,w=d.target instanceof yt;if(f)return i();if(y)return a();if(g)return n();if(b)return r();if(v)return s();if(w)return t()},moveNode:n}};let Qe;const ec=function(o,e){const{x:s,y:t}=e,a=d=>(this.focusTarget.forEach(c=>{c!==d&&(this.emit(is(c).Blur,c),this.focusTarget.delete(c))}),this),n=()=>{const{status:d,defaultWidth:c,defaultHeight:f}=this;if(!d)return!1;switch(d){case ue.Copy:{const y=Js([...this.focusTarget].filter(v=>!(v instanceof ye)));if(!y.length)break;const g={x:s-y[0].x,y:t-y[0].y},b=y.map(v=>(v.x=v.x+g.x,v.y=v.y+g.y,delete v.id,v));this.emit($e.Paste,b),this.status=ue.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}case ue.AddNode:{const y={x:s-c/2,y:t-f/2,width:c,height:f},g=this.emit(j.BeforeCreate,y);Promise.all(g).then(()=>{this.emit(j.New,y),this.update()}).catch(()=>Me("CreateNode abort in [BeforeCreate] hooks.")),this.status=ue.None,this.canvas.eventEl.style.cursor=J.default;break}case ue.AddMark:{const y={id:St(),x:s,y:t,width:c,height:f,type:"mark"};this.emit(me.New,y),this.status=ue.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}case ue.AddNote:{const y={id:St(),x:s,y:t,text:"",type:"note"};this.emit(Oe.New,y),this.status=ue.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}default:this.hoverTarget instanceof Z&&this.chooseTargets.push(this.dataHandler.originDataMap.get(this.hoverTarget.id)),this.chooseTargets.length>1&&(this.status===ue.AddFiltered?this.createBranchLine():this.createLine(this.status),this.status=ue.None,this.chooseTargets=[]);break}},i=async()=>{const{canvas:d,hoverTarget:c,focusTarget:f}=this;if(!(c instanceof Z&&f.has(c)))return!1;const{x:g,y:b}=this.canvas.transMousePositionForCanvas(o);if(!((c==null?void 0:c.containsPoint({x:g,y:b}).type)==="title"))return!1;const w=this.ifLogic?"cnName":"enName",M={type:"node-name",key:w,value:c[w],entityId:c.id,getLocation(){const{x:F,y:z}=d.transCanvasPositionToOrigin({x:c.x,y:c.y+4});return{width:c.width,height:c.attrHeight,x:F,y:z}}};return Qe?(clearTimeout(Qe),Qe=null,Me("dblClick")):Qe=setTimeout(()=>{Qe=null;const F=this.emit(j.BeforeRename,M);Promise.all(F).then(()=>this.emit(j.Rename,M))},250),!0},r=async()=>{const{canvas:d,hoverTarget:c,focusAttrs:f}=this,y=c.containsPoint(e);if(!f.has(y.id))return!1;const b=y.id,v=c.getAttributeInfo(b),w=this.ifLogic?"cnName":"enName",M={type:"node-attr",key:w,value:v.info[w],entityId:c.id,attrId:v.info.id,originData:v.info,getLocation(){const F=c.getAttributeInfo(b),{x:z,y:D}=d.transCanvasPositionToOrigin({x:F.x,y:F.y-1});return{width:c.width-F.padding*2,height:c.attrHeight,x:z,y:D}}};return Qe?(clearTimeout(Qe),Qe=null,Me("dblClick")):Qe=setTimeout(()=>{Qe=null;const F=this.emit(Re.BeforeRename,M);Promise.all(F).then(()=>this.emit(Re.Rename,M))},250),!0},l=()=>{const{hoverTarget:d,focusAttrs:c,focusTarget:f}=this,y=o.metaKey||o.ctrlKey,g=f.has(d),b=to(d,e),v=d.containsPoint(e),w=(v==null?void 0:v.type)==="attribute",M=w&&["PrimaryKey","NonPrimaryKey"].includes(v==null?void 0:v.id),F=w&&d instanceof Z&&g&&!b&&!M;if(y||c.clear(),F)return c.add(v.id),this.emit(Re.Click,v.id),!0},u=()=>{const{hoverTarget:d,event:c,focusTarget:f}=this,y=o.metaKey||o.ctrlKey,g=f.has(d),b=is(d),v=to(d,e),w=g&&o.button===2;if((!(y||w)||b===re)&&a(d),d instanceof ye?c.lastEvLoc=e:(d instanceof Z||d instanceof yt||d instanceof lt)&&(c.targetOffsetX=e.x-d.x,c.targetOffsetY=e.y-d.y,c.targetDirection=v||null),!f.has(d))return this.emit(b.Focus,d),f.add(d),this.updateEventCanvas(),!0};return{execTask:n,setEventTarget:()=>{const{hoverTarget:d,event:c}=this;if(c.target=d,this.canvas.eventEl.style.cursor=J.grabbing,!d)return a().updateEventCanvas();const y=is(d);this.emit(y.MouseDown,d),ba(i,r,l,u)}}},tc=function(o,e){const{event:s,focusAttrs:t,hoverTarget:a}=this;return{resetMouseState:()=>{const{hoverTarget:r}=this,l=r instanceof Z?j:r instanceof ye?re:r instanceof lt?me:r instanceof yt?Oe:null;l&&this.emit(l.MouseUp,r),this.canvas.eventEl.style.cursor=J.default,Object.assign(this.event,{target:null,targetDirection:oe.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}}),this.update()},drop:()=>{const r=!!s.target,l=!!t.size,u=o.metaKey||o.ctrlKey,h=o.button===2;if(!r||!l||u||h)return!1;const c=dn({sourceNodeId:s.target.id,sourceAttrIds:[...t],targetNode:a,canvasEv:e});if(t.size===1&&t.has(c.afterAttrId))return!1;const y=this.emit(Re.BeforeDrop,o,c);Promise.all(y).then(()=>{this.emit(Re.Drop,o,c),t.clear(),this.update()}).catch(g=>Me("AttrDrop abort in BeforeDrop.",g))}}},sc=5,oc="#00BFFF",ic=function(){const{renderElements:o,canvas:{eventCtx:e},event:{target:s}}=this,t=()=>{const i=this.event.target,r=[];if(!(i instanceof Z))return r;for(let l=0;l<o.length;l++){const u=o[l];if(!(u instanceof Z))continue;const h=Iu(i,u,sc);for(let d=0;d<h.length;d++){const c=h[d];r.push({target:u,adjacentSides:c})}}return r.length&&a(r),r},a=i=>{const{moveNode:r}=un.call(this,null,{eventCtx:e});i.map((l,u)=>{const h=l.adjacentSides,{target:d}=l;let c,f;h[0]===h[1]?(c=h[1]==="left"?d.x:h[1]==="right"?d.x+d.width-s.width:s.x,f=h[1]==="top"?d.y:h[1]==="bottom"?d.y+d.height-s.height:s.y):(c=h[0]==="left"?d.x+d.width:h[0]==="right"?d.x-s.width:s.x,f=h[0]==="top"?d.y+d.height:h[0]==="bottom"?d.y-s.height:s.y),r(c,f)})};return{draw:()=>{const i=t();for(let r=0;r<i.length;r++){const{target:l,adjacentSides:u}=i[r],h=u[1],d=h==="left"?l.x:h==="right"?l.x+l.width:s.x,c=h==="top"?l.y:h==="bottom"?l.y+l.height:s.y,f=h==="left"?l.x:h==="right"?l.x+l.width:l.x,y=h==="top"?l.y:h==="bottom"?l.y+l.height:l.y;e.save(),e.beginPath(),e.setLineDash([4,4]),e.strokeStyle=oc,e.moveTo(d,c),e.lineTo(f,y),e.stroke(),e.restore()}}}};function nc(o,e){const s={id:e},t=[s];for(;t.length>0;){const a=t.shift(),n=[];for(const[i,r]of o){const l=o.has(i),u=r.has(a.id);if(l&&u){const h={id:i};n.push(h),t.push(h),o.delete(i)}}a.children=n}return s}const cn=100,$s=100,Ys=12,Jo="sans-serif",ac=14,ei=10,yo=100,Ot=100,rc=24,lc=40,dc=20,Hs=1e3;function ti(o,e,s="sans-serif"){const a=document.createElement("canvas").getContext("2d");return a.font=`${e}px ${s}`,a.measureText(o).width}const uc=o=>{let e,s;if(["inclusive","exclusive"].includes(o.type))e=lc,s=dc;else{e=Math.max(Math.floor(Math.max(...(o.attributes||[]).map(n=>Math.max(ti(n.cnName,Ys,Jo),ti(n.enName,Ys,Jo))))+ei*2+Ys*2),yo);const a=(o.attributes||[]).findIndex(n=>!!+n.ifPk)!==-1?1:2;s=Math.floor(Math.max(((o.attributes||[]).length+a)*ac+ei*2,Ot)+rc)}return{width:e,height:s}},cc=async(o,e)=>{const{nodeDataArray:s,linkDataArray:t,markDataArray:a,noteDataArray:n}=o,i=hc(s,t).sort((r,l)=>l.children.length-r.children.length);return fc(s,i).then(r=>{const l=pc(a,r,-Ot);gc(n,r,l)}),new Promise((r,l)=>{function u(){if(!Ve.getAll().length)return r(o);requestAnimationFrame(u),Ve.update(),e==null||e()}u()})},hc=(o,e)=>{var n;const s=new Map;for(const i of o)s.set(i.id,new Set);for(const i of e){const r=s.get(i.to),l=!!r;!s.get(i.from)||!l||r.add(i.from)}const t=[];let a=!1;for(;!a;){if(!s.size){a=!1;break}let i=null;for(const[l,u]of s){const h=i===null,d=u.size<((n=s.get(i))==null?void 0:n.size),c=i===0;if((h||d)&&(i=l),c)break}s.delete(i);const r=nc(s,i);t.push(r)}return t},fc=async(o,e)=>{const s=new Map;return o.map(t=>s.set(t.id,t)),await Promise.all(hn(o)),Promise.resolve(e.reduce((t,a)=>t=fn(s,[a],t,$s),cn))},hn=o=>o.map(e=>{const s=uc(e);return new Promise(t=>{new Ve.Tween(e).to({width:s.width,height:s.height},Hs/2).easing(Ve.Easing.Quadratic.InOut).start().onComplete(()=>t())})}),fn=(o,e,s,t)=>{var r;const a=Math.max(...e.map(l=>o.get(l.id).height||Ot)),n=t+a+$s;let i=s;for(let l=0;l<e.length;l++){const u=o.get(e[l].id);new Ve.Tween(u).to({x:i,y:t},Hs).easing(Ve.Easing.Quadratic.InOut).start();const h=i;i+=u.width+cn,(r=e[l].children)!=null&&r.length&&(i=Math.max(fn(o,e[l].children,h,n),i))}return i},pc=(o,e,s)=>{let t=s;return o==null||o.map(a=>{t+=$s+Ot,new Ve.Tween(a).to({x:e,y:t,width:yo,height:Ot},Hs).easing(Ve.Easing.Quadratic.InOut).start()}),t},gc=(o,e,s)=>{let t=s;return o==null||o.map(a=>{t+=$s+Ot,new Ve.Tween(a).to({x:e,y:t,width:yo,height:Ot},Hs).easing(Ve.Easing.Quadratic.InOut).start()}),t};class pn extends xa{constructor(e){super(),this.event={target:null,canvasEv:{x:0,y:0},targetDirection:oe.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}},this.plugins=new wa,this.useHistory=!0,this.useThumbnail=!0,this.useEditor=!0,this.useCheatSheet=!0,this.useRightMenu=!0,this.rightMenuConfig=[],this.ifLogic=!1,this.editable=He.Edit,this.defaultWidth=100,this.defaultHeight=100,this.focusTarget=new Set,this.focusAttrs=new Set,this.chooseTargets=[],this.debounceUpdate(),this.updateConfig(e),this.mountDataHandler(e),this.mountCanvas(),this.mountCanvasEvents(),this.mountPlugins(),Ca().then(()=>this.update())}async updateConfig(e){const{el:s,editable:t,fontFamily:a,status:n,rightMenu:i,useRightMenu:r,useThumbnail:l,useHistory:u,useEditor:h,ifLogic:d}=e;s&&(this.el=s),Jt(d)&&(this.ifLogic=d),t&&(this.editable=t),a&&(this.fontFamily=a),i&&(this.rightMenuConfig=i),n&&(this.status=this.editable===He.Disabled?ue.None:n),Jt(r)&&(this.useRightMenu=r),Jt(l)&&(this.useThumbnail=l),Jt(u)&&(this.useHistory=u),Jt(h)&&(this.useEditor=h),this.mountPlugins(),await Po(),this.update()}mountDataHandler(e){this.dataHandler=new Ju({context:this,data:e.data})}destroy(){this.unmountPlugins(),this.unmountCanvasEvents(),this.canvas.destroy(),this.dataHandler.destroy()}mountCanvas(){this.canvas=new Ba({mountEl:this.el,backgroundType:Ta.Checker}),this.cacheCtx=this.canvas.cacheCtx}mountPlugins(){if(this.useHistory?this.plugins.use(Ee.History):this.plugins.off(Ee.History),this.useEditor&&this.canvas){const e=this.plugins.use(Ee.Editor,{containerElement:this.canvas.boxEl}).off().on(Mt.Blur,(...s)=>this.emit(Mt.Blur,...s)).on(Mt.Keydown,(...s)=>this.emit(Mt.Keydown,...s)).on(Mt.Input,(...s)=>this.emit(Mt.Input,...s));this.on(Re.Rename,s=>this.editable===He.Edit&&e.show(s)),this.on(j.Rename,s=>this.editable===He.Edit&&e.show(s)),this.on(Re.Change,()=>this.update()),this.on(j.Change,()=>this.update()),this.on($e.Move,()=>e.update()),this.on(j.Move,()=>e.update()),this.on(j.Resize,()=>e.update()),this.on($e.Zoom,s=>e.update({zoom:s}))}else this.plugins.off(Ee.Editor);this.useThumbnail&&this.canvas?this.plugins.use(Ee.Thumbnail,{mountEl:this.canvas.boxEl,mainCanvas:this.canvas}).on(Vt.MouseDown,(e,s,t)=>{t&&this.update(),this.emit(Vt.MouseDown,e,s)}).on(Vt.Move,(e,s,t)=>{t&&this.update(),this.emit(Vt.Move,e,s)}).on(Vt.MouseUp,(e,s)=>{this.emit(Vt.MouseUp,e,s)}):this.plugins.off(Ee.Thumbnail),this.useRightMenu&&this.canvas?this.plugins.use(Ee.RightMenu,this.canvas.boxEl,this.rightMenuConfig).off(Pt.Click).on(Pt.Click,e=>{this.emit(Pt.Click,{value:e,target:this.hoverTarget})}):this.plugins.off(Ee.RightMenu)}unmountPlugins(){this.plugins.destroy()}mountCanvasEvents(){this._bindEventMousedown=this.onMouseDown.bind(this),this._bindEventMousemove=this.onMouseMove.bind(this),this._bindEventMouseup=this.onMouseUp.bind(this),this._bindEventResize=this.onResize.bind(this),this._bindEventWheel=this.onWheel.bind(this),this._bindEventContextmenu=this.onContextmenu.bind(this),this._bindEventUndo=this.onUndo.bind(this),this._bindEventRedo=this.onRedo.bind(this),this._bindEventKeydown=this.onKeyDown.bind(this),this._bindEventDblclick=this.onDblClick.bind(this),this._bindEventClick=this.onClick.bind(this),this.canvas.on(se.Resize,this._bindEventResize),this.canvas.on(se.Wheel,this._bindEventWheel),this.canvas.on(se.Mouseup,this._bindEventMouseup),this.canvas.on(se.Mousedown,this._bindEventMousedown),this.canvas.on(se.Mousemove,this._bindEventMousemove),this.canvas.on(se.Contextmenu,this._bindEventContextmenu),this.canvas.on(se.Undo,this._bindEventUndo),this.canvas.on(se.Redo,this._bindEventRedo),this.canvas.on(se.Keydown,this._bindEventKeydown),this.canvas.on(se.DblClick,this._bindEventDblclick),this.canvas.on(se.Click,this._bindEventClick)}unmountCanvasEvents(){this.canvas.off(se.Resize,this._bindEventResize),this.canvas.off(se.Wheel,this._bindEventWheel),this.canvas.off(se.Mouseup,this._bindEventMouseup),this.canvas.off(se.Mousedown,this._bindEventMousedown),this.canvas.off(se.Mousemove,this._bindEventMousemove),this.canvas.off(se.Contextmenu,this._bindEventContextmenu),this.canvas.off(se.Undo,this._bindEventUndo),this.canvas.off(se.Redo,this._bindEventRedo),this.canvas.off(se.Keydown,this._bindEventKeydown),this.canvas.off(se.DblClick,this._bindEventDblclick),this.canvas.off(se.Click,this._bindEventClick)}onKeyDown(e){if(this.editable===He.Disabled)return!1;const{keyCode:s}=e,t=s===8||s===46;s===27&&this.updateConfig({status:ue.None}),t&&(this.focusTarget.forEach(n=>{if(n instanceof Z){const l=this.dataHandler.nodeRelatedLineMap.get(n.id);[...l.from,...l.to].map(u=>{const d=this.emit(re.BeforeDelete,u,!0);Promise.all(d).then(()=>{this.emit(re.Delete,u,!0)}).catch(()=>Me("Delete abort in [BeforeDelete] hooks.",u))})}const i=n instanceof Z?j:n instanceof ye?re:n instanceof lt?me:n instanceof yt?Oe:null,r=this.emit(i.BeforeDelete,n);Promise.all(r).then(()=>{this.emit(i.Delete,n)}).catch(()=>Me("Delete abort in [BeforeDelete] hooks.",n))}),this.focusTarget.clear(),this.hoverTarget=null,this.update()),this.emit($e.Keydown,e)}onUndo(){const e=this.plugins.get(Ee.History).undo();e==null||e.reverse(),e||Me("撤无可撤")}onRedo(){const e=this.plugins.get(Ee.History).redo();e==null||e.reverse(),e||Me("恢无可恢")}onClick(e){}onDblClick(e){const s=this.hoverTarget,t=is(s)??$e;this.emit(t.DblClick,s)}onMouseUp(e,s){const{resetMouseState:t,drop:a}=tc.call(this,e,s);a(),t()}onMouseDown(e,s){const{status:t}=this,{execTask:a,setEventTarget:n}=ec.call(this,e,s);if(t)return a();n(e)}onMouseMove(e,s){const{canvas:t,event:a,editable:n}=this,{changeMouseCursor:i,moveCanvas:r,moveElement:l}=un.call(this,e,s);a.canvasEv=s;const u=!t.isMouseDown,h=t.isMouseDown&&!a.target,d=t.isMouseDown&&a.target&&n===He.Edit;if(u)return i();if(h)return r();if(d){if(this.useHistory){const c=[...this.focusTarget];for(let f=0;f<c.length;f++){const y=c[f],g={target:y,originValue:{}};if(y instanceof Z){const b=Vo(y,"x","y","width","height");g.originValue=Js(b);const v=this.dataHandler.nodeRelatedLineMap.get(y.id);c.push(...v.from,...v.to)}if(y instanceof ye){const b=Vo(y,"pos");g.originValue=Js(b)}c[f]=g}this.plugins.get(Ee.History).push(()=>{for(let f=0;f<c.length;f++){const{target:y,originValue:g}=c[f];y.updateOptions(g),y instanceof Z&&this.emit(j.Resize,y),y instanceof ye&&this.emit(re.Move,y)}this.update()})}return l()}}onContextmenu(e){if(!this.useRightMenu)return;const{offsetX:s,offsetY:t}=e,{offsetWidth:a,offsetHeight:n}=e.target;this.emit(Pt.Show,{target:this.hoverTarget}),this.plugins.get(Ee.RightMenu).show({top:t,left:s,innerWidth:a,innerHeight:n,menuConfig:this.rightMenuConfig})}onWheel(e){const{deltaY:s,deltaX:t,ctrlKey:a}=e;if(!(!(Math.abs(s)>2||Math.abs(t)>2)||this.event.target))if(a){const i=this.canvas.zoomRate,r=10,l=Math.floor(Zu(i*100-s/r,10,200));this.zoom(l)}else{const i=this.canvas.getTranslate(),r={x:i.x-t,y:i.y-s};this.canvas.setTranslate(r),this.emit($e.Move,r),this.update()}}onResize(){this.update()}initNodes(){const{dataHandler:{originData:{nodeDataArray:e},nodeMap:s},dataHandler:{nodeRelatedLineMap:t},ifLogic:a}=this;if(e!=null&&e.length)for(let n=0;n<e.length;n++){const i=e[n];let r=s.get(i.id);r||(r=new Z(this.canvas.cacheCtx,{id:i.id,enName:i.enName,cnName:i.cnName,type:i.type,x:i.x,y:i.y,width:i.width,height:i.height,attributes:i.attributes,bdC:i.bdC,bgC:i.bgC,quotePrimaryKey:i.quotePrimaryKey,physicalTables:i.physicalTables,ifLogic:a}),s.set(i.id,r),t.has(i.id)||t.set(i.id,{from:new Set,to:new Set}))}}renderNodes(){const{dataHandler:{originData:e,nodeMap:s},renderElements:t,ifLogic:a}=this,n=e.nodeDataArray;for(let i=0;i<n.length;i++){const r=n[i],l=s.get(r.id);if(l.updateOptions({...r,ifLogic:a}),a){if(+r.ifOnlyPhy)continue}else{const h=["inclusive","exclusive"].includes(r.type),d=+r.ifOnlyLogic;if(h||d)continue}this.canvas.isVisible(l.boundingBox)&&(t.push(l),l.draw())}}renderLines(){var u,h,d,c,f,y;const{renderElements:e,ifLogic:s,dataHandler:{originData:t,lineMap:a,nodeMap:n,originDataMap:i,nodeRelatedLineMap:r}}=this,l=t.linkDataArray;for(let g=0;g<l.length;g++){const b=l[g];let v=a.get(b.id);if(this.checkLinePos(b),v?v.updateOptions(b):(v=new ye(this.canvas.cacheCtx,{pos:b.pos,type:b.type,from:b.from,to:b.to,id:b.id,numLineType:b.numLineType,remark:b.remark,ifPure:b.ifPure}),a.set(b.id,v)),r.has(v.from)||r.set(v.from,{from:new Set,to:new Set}),r.has(v.to)||r.set(v.to,{from:new Set,to:new Set}),r.get(v.from).from.add(v),r.get(v.to).to.add(v),s){const M=+b.ifOnlyPhy,F=(u=n.get(v.from))==null?void 0:u.ifOnlyPhy,z=(h=n.get(v.to))==null?void 0:h.ifOnlyPhy;if(M||F||z)continue}else{const M=["inclusive","exclusive"].includes((d=n.get(v.from))==null?void 0:d.type)||["inclusive","exclusive"].includes((c=n.get(v.to))==null?void 0:c.type),F=+b.ifOnlyLogic,z=(f=n.get(v.from))==null?void 0:f.ifOnlyLogic,D=(y=n.get(v.to))==null?void 0:y.ifOnlyLogic;if(M||F||z||D)continue}this.canvas.isVisible(v.boundingBox)&&(e.push(v),v.draw())}}renderNote(){const{dataHandler:{originData:{noteDataArray:e},noteMap:s},renderElements:t}=this;for(let a=0;a<e.length;a++){const n=e[a];let i=s.get(n.id);i?i.updateOptions(n):(i=new yt(this.canvas.cacheCtx,{id:n.id,content:n.text,textColor:n.color,x:n.x,y:n.y}),s.set(n.id,i)),this.canvas.isVisible(i.boundingBox)&&(t.push(i),i.draw())}}updateLayout(){const e=this.dataHandler.originData,s=this.update.bind(this);cc(e,s).then(t=>{const{dataHandler:{nodeMap:a,lineMap:n,noteMap:i,markMap:r}}=this;a.forEach(l=>this.emit(j.Resize,l)),r.forEach(l=>this.emit(me.Resize,l)),n.forEach(l=>this.emit(re.Move,l)),i.forEach(l=>this.emit(Oe.Move,l))})}autoSize(e){e=e!=null&&e.length?e:[...this.focusTarget].map(n=>n.id);const s=e.filter(n=>!!this.dataHandler.nodeMap.get(n));if(!s.length)return;const t=s.map(n=>this.dataHandler.originDataMap.get(n));hn(t);const a=this.update.bind(this);return new Promise(n=>{function i(){if(!Ve.getAll().length)return n(!0);requestAnimationFrame(i),Ve.update(),a==null||a()}i()}).then(()=>{t.map(n=>{const i=this.dataHandler.nodeMap.get(n.id);this.emit(j.Resize,i)})})}debounceUpdate(){let e=null;const s=this.update;this.update=(...t)=>{if(clearTimeout(e),t.length)return s.apply(this,t);e=setTimeout(()=>{s.apply(this,t)})}}update(e){Qu("update"),this.renderElements=[],e&&(this.dataHandler.update({data:e}),this.focusTarget.clear()),this.updateMainCanvas(),this.updateEventCanvas(),this.updateThumbnail()}updateMainCanvas(){this.updateCacheCanvas(),this.canvas.update()}updateCacheCanvas(){this.canvas.clearCacheCanvas();const e=this.cacheCtx;e.font="15px "+this.fontFamily,e.save(),this.renderMarks(),this.renderLines(),this.initNodes(),this.renderNodes(),this.renderNote(),e.restore()}async updateThumbnail(){const{dataHandler:{originData:{nodeDataArray:e}}}=this,s=this.plugins.get(Ee.Thumbnail);if(!s)return!1;await Po();const{width:t,height:a}=this.canvas.getRenderSize();let n=0,i=0,r=t,l=a;for(let u=0;u<e.length;u++){const h=e[u],{x:d,y:c,width:f,height:y}=h;d<n&&(n=d),c<i&&(i=c),d+f>r&&(r=d+f),c+y>l&&(l=c+y)}s.draw(n,i,r,l,u=>{for(let h=0;h<e.length;h++){const d=e[h],{x:c,y:f,width:y,height:g,bgC:b,bdC:v}=d;u.save(),u.fillStyle=b||"#fff",u.fillRect(c,f,y,g),u.strokeStyle=v||"#000",u.strokeRect(c,f,y,g),u.restore()}})}updateEventCanvas(){this.canvas.clearEventCanvas(),this.emit($e.BeforeUpdate,this.canvas.eventCtx),this.drawFocusElement(),this.drawFocusAttribute(),this.drawHoverElement(),this.drawGuides(),this.drawLockIcon(),this.emit($e.AfterUpdate,this.canvas.eventCtx)}drawGuides(){this.event.target&&ic.call(this).draw()}drawFocusElement(){const{canvas:e,focusTarget:s,dataHandler:{originDataMap:t}}=this;s.forEach(a=>{t.get(a.id)&&(a instanceof ye?new ye(e.eventCtx,{...a,lineWidth:3,bdC:"blue",remark:""}).draw():a instanceof Z?new Zo(e.eventCtx,{x:a.x,y:a.y+(a.ifSubEntity?0:a.titleHeight),width:a.width,height:a.height-(a.ifSubEntity?0:a.titleHeight)}).draw():new Zo(e.eventCtx,{x:a.x,y:a.y,width:a.width,height:a.height}).draw())})}drawFocusAttribute(){const{canvas:{eventCtx:e},event:{canvasEv:s,target:t},focusTarget:a,hoverTarget:n,focusAttrs:i,ifLogic:r}=this;if(!i.size)return;a.forEach(c=>{c instanceof Z&&i.forEach(y=>{var z,D,P,$,U;const g=c.getAttributeInfo(y),b=["PrimaryKey","NonPrimaryKey"].includes(y),v=!g.info;if(b||v)return;e.save(),e.fillStyle="#3498db",e.fillRect(g.x,g.y-1,g.width,g.height),e.font=`${c.fontSize}px Arial`,e.fillStyle="#fff",e.textAlign="left",e.textBaseline="top",this.drawDataType((z=g.info)==null?void 0:z.type,g.x,g.y,e,c.fontSize);const w=Number((D=g.info)==null?void 0:D.ifFk)?"(FK)":"",M=r?g.info.cnName:g.info.enName,F=e.fittingString(M+w,c.width-(g.x-c.x)-g.padding-c.fontSize);if(e.fillText(F,g.x+c.fontSize+4,g.y),($=(P=g.info)==null?void 0:P.icons)!=null&&$.length){const A=g.x+e.measureText(F).width+c.fontSize+4;this.drawIcons((U=g.info)==null?void 0:U.icons,A,g.y,c,e)}e.restore()})});const l=n instanceof Z,u=n==null?void 0:n.containsPoint(s),h=(u==null?void 0:u.type)==="attribute";if(l&&h&&!!t){const c=u.id,f=n.getAttributeInfo(c);e.fillStyle="rgba(0, 0, 255, 0.3)",e.drawRoundedRect(f.x,f.y-3,f.width,2,1,1,1,1,!0,!1,!1,!1)}}drawDataType(e,s,t,a,n){var l;const i=(l=e==null?void 0:e.replace(/[^A-Za-z0-9]/g,""))==null?void 0:l.toLocaleUpperCase();let r;if(i in zi?r=tt.get("dateActive"):i in Vi?r=tt.get("numberActive"):i in Wi?r=tt.get("stringActive"):i in Ki?r=tt.get("booleanActive"):i in ki&&(r=tt.get("binaryActive")),!r)return a.save(),a.fillStyle="#fff",a.fillText("?",s,t,n),a.restore(),!1;a.drawImage(r,s,t-1,n,n)}drawIcons(e=[],s,t,a,n){const{fontSize:i,x:r,width:l,padding:u}=a;for(let h=0;h<e.length;h++){const d=e[h],c=s+i*.7+h*(i*1.2);if(c+i/2*3>r+l+u)return;this.drawIcon(d,c,t,a,n)}}drawIcon(e,s,t,a,n){const{attrHeight:i,fontSize:r}=a;n.save(),n.beginPath(),n.strokeStyle=e.bdC||"#0C64EB",n.fillStyle=e.bgC||"#ECF5FF",n.arc(s,t+Math.floor(i/2)-1,r/2,0,2*Math.PI),n.fill(),n.stroke(),n.fillStyle=e.color||"#0C64EB",n.font=`${Math.ceil(r/1.2)}px Arial`,n.textAlign="center",n.fillText(e.text,s,t+(i-r)/2+1),n.restore()}drawHoverElement(){const{canvas:e,hoverTarget:s,focusTarget:t}=this,a=t.has(s);!s||a||(s instanceof ye?new ye(e.eventCtx,{...s,lineWidth:2,bdC:"blue",remark:""}).draw():s instanceof Z?new Qo(e.eventCtx,{x:s.x,y:s.y+(s.ifSubEntity?0:s.titleHeight),width:s.width,height:s.ifSubEntity?s.height:s.height-s.titleHeight}).draw():new Qo(e.eventCtx,{x:s.x,y:s.y,width:s.width,height:s.height}).draw())}drawLockIcon(){if(this.editable===He.Edit)return;const e=this.canvas.getTranslate(),s=this.canvas.zoomRate;new Yu(this.canvas.eventCtx,{x:(-e.x+this.canvas.width)/s-40,y:-e.y/s+25}).draw()}checkLinePos(e){var u,h,d;const{dataHandler:{originDataMap:s}}=this;if(e.from===e.to?((u=e.pos)==null?void 0:u.length)!==5:((h=e.pos)==null?void 0:h.length)<2||((d=e.pos)==null?void 0:d.length)>4)return this.mergeLines([e]);const n=s.get(e.from),i=s.get(e.to);if(!n||!i)return!1;const r=this.getPointBelongBord(n,e.pos[0]),l=this.getPointBelongBord(i,e.pos[e.pos.length-1]);if(r&&l)return!0;this.mergeLines([e])}renderMarks(){var e,s;(s=(e=this.dataHandler.originData)==null?void 0:e.markDataArray)==null||s.forEach(t=>{const a=t.width,n=t.height,i=Number(t.x),r=Number(t.y),l=t;let u=this.dataHandler.markMap.get(l.id);u?u.updateOptions(l):(u=new lt(this.canvas.cacheCtx,{id:l.id,x:i,y:r,width:a,height:n}),this.dataHandler.markMap.set(l.id,u)),this.canvas.isVisible(u.boundingBox)&&(this.renderElements.push(u),u.draw())})}zoom(e){const s=e/100;this.canvas.zoom(s),this.update(),this.emit($e.Zoom,this.canvas.zoomRate)}getPointBelongBord(e,s){if(s.x===e.x)return"L";if(s.x===e.x+e.width)return"R";if(s.y===e.y)return"T";if(s.y===e.y+e.height)return"B";Me("getPointBelongBord未找到匹配边，detail:",e,JSON.parse(JSON.stringify(e)),JSON.parse(JSON.stringify(s)))}resizeNode(e,s,t,a=80){if(t.target.ifSubEntity)return;const n=t.target instanceof Z,i=[oe.LT,oe.TM,oe.RT].includes(t.targetDirection);n&&i&&(s-=t.target.titleHeight);const r=this,l={x:t.target.x,y:t.target.y,width:t.target.width,height:t.target.height};if(t.targetDirection==="LT"){const h=t.target.width+t.target.x-e,d=t.target.height+t.target.y-s,c=h<a?t.target.x:e,f=d<a?t.target.y:s,y=h<a?t.target.width:h,g=d<a?t.target.height:d;t.target.updateOptions({x:c,y:f,width:y,height:g}),u()}else if(t.targetDirection==="TM"){const h=t.target.height+t.target.y-s;t.target.updateOptions({y:h<a?t.target.y:s,height:h<a?t.target.height:h}),u()}else if(t.targetDirection==="RT"){const h=e-t.target.x,d=t.target.height+t.target.y-s;t.target.updateOptions({y:d<a?t.target.y:s,width:h<a?t.target.width:h,height:d<a?t.target.height:d}),u()}else if(t.targetDirection==="LM"){const h=t.target.width+t.target.x-e;t.target.updateOptions({x:h<a?t.target.x:e,width:h<a?t.target.width:h}),u()}else if(t.targetDirection==="RM"){const h=e-t.target.x;t.target.updateOptions({width:h<a?t.target.width:h}),u()}else if(t.targetDirection==="LB"){const h=t.target.width+t.target.x-e,d=s-t.target.y;t.target.updateOptions({x:h<a?t.target.x:e,width:h<a?t.target.width:h,height:d<a?t.target.height:d}),u()}else if(t.targetDirection==="BM"){const h=s-t.target.y;t.target.updateOptions({height:h<a?t.target.height:h}),u()}else if(t.targetDirection==="RB"){const h=e-t.target.x,d=s-t.target.y;t.target.updateOptions({width:h<a?t.target.width:h,height:d<a?t.target.height:d}),u()}t.target.type==="mark"?this.emit(me.Resize,t.target,!0):this.emit(j.Resize,t.target,!0);function u(){if(!(t.target instanceof Z))return;r.dataHandler.nodeMap.get(t.target.id).updateOptions(t.target);const h=r.dataHandler.nodeRelatedLineMap.get(t.target.id);[...h.from,...h.to].forEach(c=>{const f=c.from!==c.to,y=h.from.has(c)?0:c.pos.length-1;f&&d(c,y),f?r.moveLineForNode(c,t,t.target):r.moveLineForSameNode(c,t)});function d(c,f){c.pos[f].x===l.x?(c.pos[f].x=t.target.x,c.pos[f].y=c.pos[f].y<t.target.y?t.target.y+1:c.pos[f].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[f].y):c.pos[f].x===l.x+l.width?(c.pos[f].x=t.target.x+t.target.width,c.pos[f].y=c.pos[f].y<t.target.y?t.target.y+1:c.pos[f].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[f].y):c.pos[f].y===l.y?(c.pos[f].x=c.pos[f].x<=t.target.x?t.target.x+1:c.pos[f].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[f].x,c.pos[f].y=t.target.y):c.pos[f].y===l.y+l.height&&(c.pos[f].x=c.pos[f].x<=t.target.x?t.target.x+1:c.pos[f].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[f].x,c.pos[f].y=t.target.y+t.target.height)}}}getNodePosFromBorder(e,s){let t={start:{x:null,y:null},end:{x:null,y:null}};switch(s){case"T":t={start:{x:e.x,y:e.y},end:{x:e.x+e.width,y:e.y}};break;case"B":t={start:{x:e.x,y:e.y+e.height},end:{x:e.x+e.width,y:e.y+e.height}};break;case"L":t={start:{x:e.x,y:e.y},end:{x:e.x,y:e.y+e.height}};break;case"R":t={start:{x:e.x+e.width,y:e.y},end:{x:e.x+e.width,y:e.y+e.height}};break}return t}moveLineForNode(e,s,t){const a=e.pos.length-1,n={x:t.x-s.target.x,y:t.y-s.target.y},i=this.dataHandler.nodeMap.get(e.from),r=this.dataHandler.nodeMap.get(e.to);if(!i||!r)return;const l=this.getPointBelongBord(i,e.pos[0]),u=this.getPointBelongBord(r,e.pos[a]);(!l||!u)&&this.mergeLines([e]);const h=s.target.id===i.id;if(h?(e.pos[0].x=t.x+(e.pos[0].x-s.target.x),e.pos[0].y=t.y+(e.pos[0].y-s.target.y)):(e.pos[a].x=t.x+(e.pos[a].x-s.target.x),e.pos[a].y=t.y+(e.pos[a].y-s.target.y)),a===1)e.pos.splice(1,0,{x:e.pos[0].x,y:e.pos[0].y},{x:e.pos[0].x,y:e.pos[0].y});else if(a===2)if(l==="R"&&u==="B"){if(this.getNodePosFromBorder(r,"B").start.y<e.pos[0].y)e.pos[1]={x:e.pos[2].x,y:e.pos[0].y};else{const d=this.getNodePosFromBorder(i,"R").start.x<this.getNodePosFromBorder(r,"L").start.x?this.getNodePosFromBorder(r,"L").start.x:this.getNodePosFromBorder(r,"R").start.x;e.pos[1]={x:d+(h?0:n.x),y:e.pos[0].y+n.y},e.pos.splice(2)}e.pos[2]&&e.pos[2].x<=e.pos[0].x&&(e.pos[0]={x:e.pos[0].x-1,y:i.y+(h?n.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))}else l==="B"&&u==="R"?(i.y+i.height<e.pos[1].y?e.pos[1]={x:e.pos[0].x,y:e.pos[2].y}:["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBorder(i,"B").start.y,this.getNodePosFromBorder(r,"B").start.y)+20},e.pos[2]={x:r.x+Math.floor(r.width/2)+(h?0:n.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBorder(r,"B").start.y+(h?0:n.y)}):(e.pos[0]={x:i.x+(s.target.id===i.id?n.x:0),y:e.pos[1].y},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2)),e.pos[1].x<r.x+r.width&&(e.pos[1].y=r.y+(s.target.id===r.id?n.y:0),e.pos.splice(2))):l==="L"&&u==="B"?(this.getNodePosFromBorder(r,"B").start.y<e.pos[0].y?e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}:(e.pos[1]={x:r.x+r.width+(s.target.id===r.id?n.x:0),y:e.pos[0].y},e.pos.splice(2)),e.pos[1].x>=s.target.x&&this.getNodePosFromBorder(r,"B").start.y<this.getNodePosFromBorder(i,"T").start.y&&(e.pos[0]={x:e.pos[0].x+(h?n.x:0)-1,y:i.y+(h?n.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))):l==="B"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>r.x&&(e.pos[1].y=r.y+(s.target.id===r.id?n.y:0),e.pos.splice(2)),e.pos[1].y<e.pos[0].y&&(["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBorder(i,"B").start.y,this.getNodePosFromBorder(r,"B").start.y)+20},e.pos[2]={x:r.x+Math.floor(r.width/2)+(h?0:n.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBorder(r,"B").start.y+(h?0:n.y)}):(e.pos[1].x=this.getNodePosFromBorder(i,"R").start.x+(s.target.id===i.id?n.x:0),e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(s.target.id===i.id?n.y:0),e.pos.splice(0,1)))):l==="R"&&u==="T"?(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].x<e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(s.target.id===i.id?n.y:0),e.pos.splice(0,1)),e.pos[2]&&e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(r.type)?(e.pos[0]={x:i.x+Math.floor(i.width/2),y:i.y+(h?n.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:r.y+(h?0:n.y)}):(e.pos[1].x=r.x+(h?0:n.x),e.pos[1].y=r.y+(h?0:n.y),e.pos.splice(2)))):l==="T"&&u==="R"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x<e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBorder(r,"B").start.y+(s.target.id===r.id?n.y:0),e.pos.splice(2)),e.pos[0].y<e.pos[1].y&&(e.pos[1].x=i.x+(s.target.id===i.id?n.x:0),e.pos[1].y=i.y+(s.target.id===i.id?n.y:0),e.pos.splice(0,1))):l==="T"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBorder(r,"B").start.y+(s.target.id===r.id?n.y:0),e.pos.splice(2)),e.pos[1].y>e.pos[0].y&&(e.pos[1].x=this.getNodePosFromBorder(i,"R").start.x+(s.target.id===i.id?n.x:0),e.pos.splice(0,1))):l==="L"&&u==="T"&&(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(r.type)?(e.pos[0]={x:i.x+Math.floor(i.width/2),y:i.y+(h?n.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:r.y+(h?0:n.y)}):(e.pos[1].x=this.getNodePosFromBorder(r,"R").start.x+(s.target.id===r.id?n.x:0),e.pos.splice(2))),e.pos[1].x>e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(s.target.id===i.id?n.y:0),e.pos.splice(0,1)));else if(a===3){const d=Math.floor(Math.abs(e.pos[0].x-e.pos[a].x)/2),c=Math.floor(Math.abs(e.pos[0].y-e.pos[a].y)/2);if(l==="B"&&u==="B")if(this.getNodePosFromBorder(i,"T").start.y<this.getNodePosFromBorder(r,"B").start.y)if(this.getNodePosFromBorder(i,"B").start.y<e.pos[1].y){const f=e.pos[2].y-r.y-r.height+e.pos[3].y;e.pos[1]={x:e.pos[0].x,y:f},e.pos[2]={x:e.pos[3].x,y:f}}else{const f=i.x+i.width>e.pos[3].x?i.x:i.x+i.width,y=e.pos[2].y-r.y-r.height+e.pos[3].y;e.pos[0]={x:f+(s.target.id===i.id?n.x:0),y},e.pos[1]={x:e.pos[3].x,y},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y},e.pos.splice(3)}else["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:i.y+i.height+20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+Math.floor((i.y-r.y-r.height)/2)},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+Math.floor((i.y-r.y-r.height)/2)});else if(l==="B"&&u==="T")i.y+i.height<r.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+c},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+c}):i.y+i.height>=r.y&&(["exclusive","inclusive"].includes(r.type)?(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[1]={x:e.pos[0].x,y:r.y+r.height+20},e.pos[2]={x:e.pos[3].x,y:r.y+r.height+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+r.height}));else if(l==="T"&&u==="T")if(["exclusive","inclusive"].includes(i.type)||["exclusive","inclusive"].includes(r.type)){const f=e.pos[1].y+n.y>Math.min(i.y,r.y)-20?Math.min(i.y,r.y)-20:e.pos[1].y+n.y;e.pos[1]={x:e.pos[0].x,y:f},e.pos[2]={x:e.pos[3].x,y:f}}else e.pos[1].y<s.target.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[1].y},e.pos[2]={x:e.pos[3].x,y:e.pos[2].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+i.height},e.pos[1]={x:e.pos[0].x,y:Math.max(i.y+i.height,r.y+r.height)+20},e.pos[2]={x:e.pos[3].x,y:Math.max(i.y+i.height,r.y+r.height)+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+r.height});else l==="T"&&u==="B"?i.y>r.y+r.height?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-c},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y+c}):i.y<=r.y+r.height&&(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+20},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+20}):l==="L"&&u==="L"?(s.target.id===r.id?(e.pos[2]={x:t.x-(r.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>i.x&&e.pos[1].x<i.x+i.width&&(e.pos.splice(0,1),++e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y)+(s.target.id===i.id?n.y:0))):l==="L"&&u==="R"?i.x>r.x+r.width?(e.pos[1]={x:e.pos[0].x-d,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[3].y}):(e.pos[0]={x:e.pos[0].x+i.width,y:e.pos[0].y},e.pos[1]={x:e.pos[0].x+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+20,y:e.pos[3].y}):l==="R"&&u==="L"?i.x+i.width<r.x?(e.pos[1]={x:e.pos[0].x+d,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+d,y:e.pos[3].y}):(e.pos[1]={x:e.pos[0].x+r.width+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+r.width+20,y:e.pos[3].y},e.pos[3]={x:e.pos[3].x+r.width,y:e.pos[3].y}):l==="R"&&u==="R"&&(s.target.id===r.id?(e.pos[2]={x:t.x-(r.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>i.x&&e.pos[1].x<i.x+i.width&&(e.pos.splice(0,1),--e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y)+(s.target.id===i.id?n.y:0)))}this.emit(re.Move,e)}moveLineForSameNode(e,s){const n=e.pos[1].x-e.pos[0].x,i=e.pos[2].y-e.pos[1].y;e.pos[0]={x:s.target.x+s.target.width,y:s.target.y+s.target.height-20},e.pos[4]={x:s.target.x+s.target.width-20,y:s.target.y+s.target.height},e.pos[1]={x:e.pos[0].x+n,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[1].y+i},e.pos[3]={x:e.pos[4].x,y:e.pos[2].y},this.emit(re.Move,e)}moveLineForLine(e,s){var h;const t=e.target.pos,a=t.length-1;let n,i,r=0;if((h=this.dataHandler.originData.nodeDataArray)==null||h.forEach(d=>{d.id===e.target.from&&(n=d,r++),d.id===e.target.to&&(i=d,r++)}),["exclusive","inclusive"].includes(n.type)){if(e.targetLineStartPointIdx===0&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBorder(n,"L").start.x>=s.x||this.getNodePosFromBorder(n,"R").start.x<=s.x)||e.targetLineStartPointIdx===1&&t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y&&this.getNodePosFromBorder(n,"B").start.y>=s.y||e.targetLineStartPointIdx===2&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBorder(i,"L").start.x>=s.x||this.getNodePosFromBorder(i,"R").start.x<=s.x))return}else if(["exclusive","inclusive"].includes(i.type)&&(a===1||a===2&&e.targetLineStartPointIdx===1||a===2&&e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"T").start.y<s.y||a===3&&e.targetLineStartPointIdx===2||a===3&&e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(i,"T").start.y<s.y||a===3&&e.targetLineStartPointIdx===0&&(this.getNodePosFromBorder(n,"L").start.x>=s.x||this.getNodePosFromBorder(n,"R").start.x<=s.x)))return;a===1?t[0].y===t[1].y?(t[0].y=s.y,t[1].y=s.y,(this.getNodePosFromBorder(n,"T").start.y>s.y||this.getNodePosFromBorder(n,"B").start.y<s.y)&&(t[0].x=n.x+n.width/2,t.unshift({x:n.x+n.width/2,y:this.getNodePosFromBorder(n,"T").start.y>s.y?n.y:n.y+n.height})),(this.getNodePosFromBorder(i,"T").start.y>s.y||this.getNodePosFromBorder(i,"B").start.y<s.y)&&(t[t.length-1].x=i.x+i.width/2,t.push({x:i.x+i.width/2,y:this.getNodePosFromBorder(i,"T").start.y>s.y?i.y:i.y+i.height}))):(t[0].x=s.x,t[1].x=s.x,(this.getNodePosFromBorder(n,"L").start.x>s.x||this.getNodePosFromBorder(n,"R").start.x<s.x)&&(t[0].y=n.y+n.height/2,t.unshift({x:this.getNodePosFromBorder(n,"R").start.x<s.x?n.x+n.width:n.x,y:n.y+n.height/2})),(this.getNodePosFromBorder(i,"L").start.x>s.x||this.getNodePosFromBorder(i,"R").start.x<s.x)&&(t[t.length-1].y=i.y+i.height/2,t.push({x:this.getNodePosFromBorder(i,"R").start.x<s.x?i.x+i.width:i.x,y:i.y+i.height/2}))):a===2?t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=s.y,t[e.targetLineStartPointIdx+1].y=s.y,(this.getNodePosFromBorder(n,"B").start.y<s.y||this.getNodePosFromBorder(n,"T").start.y>s.y)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].x=n.x+n.width/2,t.unshift({x:n.x+n.width/2,y:this.getNodePosFromBorder(n,"T").start.y>s.y?n.y:n.y+n.height})),(this.getNodePosFromBorder(i,"B").start.y<s.y||this.getNodePosFromBorder(i,"T").start.y>s.y)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].x=i.x+i.width/2,t.push({x:i.x+i.width/2,y:this.getNodePosFromBorder(i,"T").start.y>s.y?i.y:i.y+i.height})),e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(n,"B").start.y>s.y&&this.getNodePosFromBorder(n,"T").start.y<s.y&&(t.splice(0,1),t[0].x=i.x>n.x?n.x+n.width:n.x),e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"B").start.y>s.y&&this.getNodePosFromBorder(i,"T").start.y<s.y&&(t.splice(t.length-1,1),t[t.length-1].x=n.x>i.x?i.x+i.width:i.x)):(t[e.targetLineStartPointIdx].x=s.x,t[e.targetLineStartPointIdx+1].x=s.x,(this.getNodePosFromBorder(n,"L").start.x>s.x||this.getNodePosFromBorder(n,"R").start.x<s.x)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].y=n.y+n.height/2,t.unshift({x:this.getNodePosFromBorder(n,"L").start.x>s.x?n.x:n.x+n.width,y:n.y+n.height/2})),(this.getNodePosFromBorder(i,"L").start.x>s.x||this.getNodePosFromBorder(i,"R").start.x<s.x)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].y=i.y+i.height/2,t.push({x:this.getNodePosFromBorder(i,"L").start.x>s.x?i.x:i.x+i.width,y:i.y+i.height/2})),e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(n,"L").start.x<s.x&&this.getNodePosFromBorder(n,"R").start.x>s.x&&(t.splice(0,1),t[0].y=i.y>n.y?n.y+n.height:n.y),e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"L").start.x<s.x&&this.getNodePosFromBorder(i,"R").start.x>s.x&&(t.splice(t.length-1,1),t[t.length-1].y=n.y>i.y?i.y+i.height:i.y)):a===3&&(t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=s.y,t[e.targetLineStartPointIdx+1].y=s.y,e.targetLineStartPointIdx===0?l(t)?t[0].y<this.getNodePosFromBorder(n,"T").start.y?(t[0]={x:this.getNodePosFromBorder(n,"T").start.x+n.width/2,y:n.y},t[1]={x:t[0].x,y:s.y},s.y<this.getNodePosFromBorder(i,"T").start.y||s.y>this.getNodePosFromBorder(i,"B").start.y?(t[2]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:s.y},t[3]={x:t[2].x,y:s.y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBorder(i,"R").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:s.y},t.splice(3))):t[0].y>this.getNodePosFromBorder(n,"B").start.y&&(t[0]={x:this.getNodePosFromBorder(n,"T").start.x+n.width/2,y:this.getNodePosFromBorder(n,"B").start.y},t[1]={x:t[0].x,y:s.y},s.y<this.getNodePosFromBorder(i,"T").start.y||s.y>this.getNodePosFromBorder(i,"B").start.y?(t[2]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:s.y},t[3]={x:t[2].x,y:s.y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBorder(i,"R").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:s.y},t.splice(3))):s.y<this.getNodePosFromBorder(n,"T").start.y?(t[0].y=this.getNodePosFromBorder(n,"T").start.y,t[1].y=this.getNodePosFromBorder(n,"T").start.y):s.y>this.getNodePosFromBorder(n,"B").start.y&&(t[0].y=this.getNodePosFromBorder(n,"B").start.y,t[1].y=this.getNodePosFromBorder(n,"B").start.y):e.targetLineStartPointIdx===t.length-2?l(t)?t[3].y<this.getNodePosFromBorder(i,"T").start.y?(t[3]={x:this.getNodePosFromBorder(i,"T").start.x+i.width/2,y:i.y},t[2]={x:t[3].x,y:s.y},s.y<this.getNodePosFromBorder(n,"T").start.y||s.y>this.getNodePosFromBorder(n,"B").start.y?(t[1]={x:this.getNodePosFromBorder(n,"L").start.x+n.width/2,y:s.y},t[0]={x:t[1].x,y:s.y<this.getNodePosFromBorder(n,"T").start.y?this.getNodePosFromBorder(n,"T").start.y:this.getNodePosFromBorder(n,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBorder(n,"R").start.x?this.getNodePosFromBorder(n,"R").start.x:this.getNodePosFromBorder(n,"L").start.x,y:s.y},t.splice(0,1))):t[3].y>this.getNodePosFromBorder(i,"B").start.y&&(t[3]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:this.getNodePosFromBorder(i,"B").start.y},t[2]={x:t[3].x,y:s.y},s.y<this.getNodePosFromBorder(n,"T").start.y||s.y>this.getNodePosFromBorder(n,"B").start.y?(t[1]={x:this.getNodePosFromBorder(n,"L").start.x+n.width/2,y:s.y},t[0]={x:t[1].x,y:s.y<this.getNodePosFromBorder(n,"T").start.y?this.getNodePosFromBorder(n,"T").start.y:this.getNodePosFromBorder(n,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBorder(n,"R").start.x?this.getNodePosFromBorder(n,"R").start.x:this.getNodePosFromBorder(n,"L").start.x,y:s.y},t.splice(0,1))):s.y<this.getNodePosFromBorder(i,"T").start.y?(t[2].y=this.getNodePosFromBorder(i,"T").start.y,t[3].y=this.getNodePosFromBorder(i,"T").start.y):s.y>this.getNodePosFromBorder(i,"B").start.y&&(t[2].y=this.getNodePosFromBorder(i,"B").start.y,t[3].y=this.getNodePosFromBorder(i,"B").start.y):(s.y>this.getNodePosFromBorder(n,"T").start.y&&s.y<this.getNodePosFromBorder(n,"B").start.y&&(t.splice(0,1),t[0].x=t[1].x<this.getNodePosFromBorder(n,"L").start.x?this.getNodePosFromBorder(n,"L").start.x:this.getNodePosFromBorder(n,"R").start.x),s.y>this.getNodePosFromBorder(i,"T").start.y&&s.y<this.getNodePosFromBorder(i,"B").start.y&&(t[t.length-2].x=t[t.length-3].x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,t.splice(t.length-1)))):(t[e.targetLineStartPointIdx].x=s.x,t[e.targetLineStartPointIdx+1].x=s.x,e.targetLineStartPointIdx===0?u(t)?t[0].x<this.getNodePosFromBorder(n,"L").start.x?(t[0]={x:this.getNodePosFromBorder(n,"L").start.x,y:this.getNodePosFromBorder(n,"L").start.y+n.height/2},t[1]={x:s.x,y:t[0].y},s.x<this.getNodePosFromBorder(i,"L").start.x||s.x>this.getNodePosFromBorder(i,"R").start.x?(t[2]={x:s.x,y:this.getNodePosFromBorder(i,"T").start.y+i.height/2},t[3]={x:s.x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:t[2].y}):(t[2]={x:s.x,y:t[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y},t.splice(3))):t[0].x>this.getNodePosFromBorder(n,"R").start.x&&(t[0]={x:this.getNodePosFromBorder(n,"R").start.x,y:this.getNodePosFromBorder(n,"R").start.y+n.height/2},t[1]={x:s.x,y:t[0].y},s.x<this.getNodePosFromBorder(i,"L").start.x||s.x>this.getNodePosFromBorder(i,"R").start.x?(t[2]={x:s.x,y:this.getNodePosFromBorder(i,"T").start.y+i.height/2},t[3]={x:s.x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:t[2].y}):(t[2]={x:s.x,y:t[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y},t.splice(3))):s.x<this.getNodePosFromBorder(n,"L").start.x?(t[0].x=this.getNodePosFromBorder(n,"L").start.x+1,t[1].x=this.getNodePosFromBorder(n,"L").start.x+1):s.x>this.getNodePosFromBorder(n,"R").start.x&&(t[0].x=this.getNodePosFromBorder(n,"R").start.x-1,t[1].x=this.getNodePosFromBorder(n,"R").start.x-1):e.targetLineStartPointIdx===t.length-2?u(t)?t[3].x<this.getNodePosFromBorder(i,"L").start.x?(t[3]={x:this.getNodePosFromBorder(i,"L").start.x,y:this.getNodePosFromBorder(i,"L").start.y+i.height/2},t[2]={x:s.x,y:t[3].y},s.x<this.getNodePosFromBorder(n,"L").start.x||s.x>this.getNodePosFromBorder(n,"R").start.x?(t[1]={x:s.x,y:this.getNodePosFromBorder(n,"T").start.y+n.height/2},t[0]={x:s.x<this.getNodePosFromBorder(n,"L").start.x?this.getNodePosFromBorder(n,"L").start.x:this.getNodePosFromBorder(n,"R").start.x,y:t[1].y}):(t[1]={x:s.x,y:t[2].y>this.getNodePosFromBorder(n,"B").start.y?this.getNodePosFromBorder(n,"B").start.y:this.getNodePosFromBorder(n,"T").start.y},t.splice(0,1))):t[3].x>this.getNodePosFromBorder(i,"R").start.x&&(t[3]={x:this.getNodePosFromBorder(i,"R").start.x,y:this.getNodePosFromBorder(i,"R").start.y+i.height/2},t[2]={x:s.x,y:t[3].y},s.x<this.getNodePosFromBorder(n,"L").start.x||s.x>this.getNodePosFromBorder(n,"R").start.x?(t[1]={x:s.x,y:this.getNodePosFromBorder(n,"T").start.y+n.height/2},t[0]={x:s.x<this.getNodePosFromBorder(n,"L").start.x?this.getNodePosFromBorder(n,"L").start.x:this.getNodePosFromBorder(n,"R").start.x,y:t[1].y}):(t[1]={x:s.x,y:t[2].y>this.getNodePosFromBorder(n,"B").start.y?this.getNodePosFromBorder(n,"B").start.y:this.getNodePosFromBorder(n,"T").start.y},t.splice(0,1))):s.x<this.getNodePosFromBorder(i,"L").start.x?(t[2].x=this.getNodePosFromBorder(i,"L").start.x+1,t[3].x=this.getNodePosFromBorder(i,"L").start.x+1):s.x>this.getNodePosFromBorder(i,"R").start.x&&(t[2].x=this.getNodePosFromBorder(i,"R").start.x-1,t[3].x=this.getNodePosFromBorder(i,"R").start.x-1):(s.x>this.getNodePosFromBorder(n,"L").start.x&&s.x<this.getNodePosFromBorder(n,"R").start.x&&(t.splice(0,1),t[0].y=t[1].y<this.getNodePosFromBorder(n,"T").start.y?this.getNodePosFromBorder(n,"T").start.y:this.getNodePosFromBorder(n,"B").start.y),s.x>this.getNodePosFromBorder(i,"L").start.x&&s.x<this.getNodePosFromBorder(i,"R").start.x&&(t[t.length-2].y=t[t.length-3].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y,t.splice(t.length-1)))),t.length===4&&t[1].x===t[2].x&&t[1].y===t[2].y&&t.splice(1,2));function l(d){let c=0;for(let f=0,y=d.length-1;f<y;f++)c+=Math.abs(d[f].x-d[f+1].x);return c===Math.abs(d[0].x-d[d.length-1].x)}function u(d){let c=0;for(let f=0,y=d.length-1;f<y;f++)c+=Math.abs(d[f].y-d[f+1].y);return c===Math.abs(d[0].y-d[d.length-1].y)}this.emit(re.Move,e.target)}createLineInfo(e,s){const t=this.chooseTargets,a=this.getNodePosFromBorder(t[0],"L"),n=this.getNodePosFromBorder(t[1],"L"),i=[];if(t[0].id===t[1].id)i[0]={x:t[0].x+t[0].width,y:t[0].y+t[0].height-20},i[1]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height-20},i[2]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height+20},i[3]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height+20},i[4]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height};else if(["exclusive","inclusive"].includes(t[0].type))a.end.y<n.start.y?(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:i[0].y+Math.floor((n.start.y-a.end.y)/2)},i[2]={x:n.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:n.start.y}):(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:Math.max(a.end.y,n.start.y)+20},i[2]={x:n.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:n.end.y});else if(["exclusive","inclusive"].includes(t[1].type))a.end.y<n.start.y?(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:i[0].y+Math.floor((n.start.y-a.end.y)/2)},i[2]={x:n.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:n.start.y}):(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:Math.min(a.end.y,n.start.y)-20},i[2]={x:n.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:n.start.y});else if(this.getNodePosFromBorder(t[0],"R").start.x<this.getNodePosFromBorder(t[1],"L").start.x)if((n.start.y-a.end.y)*(n.end.y-a.start.y)<0){const r=Math.max(a.start.y,n.start.y)+Math.abs(Math.floor((Math.min(a.end.y,n.end.y)-Math.max(a.start.y,n.start.y))/2));i[0]={x:this.getNodePosFromBorder(t[0],"R").start.x,y:r},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x,y:r}}else a.start.y>n.end.y?(i[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:n.start.y+Math.floor(t[1].height/2)},i[2]={x:n.start.x,y:i[1].y}):(i[0]={x:this.getNodePosFromBorder(t[0],"R").start.x,y:a.start.y+Math.floor(t[0].height/2)},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x+Math.floor(t[1].width/2),y:i[0].y},i[2]={x:i[1].x,y:this.getNodePosFromBorder(t[1],"L").start.y});else if(this.getNodePosFromBorder(t[0],"L").start.x>this.getNodePosFromBorder(t[1],"R").start.x)if((n.start.y-a.end.y)*(n.end.y-a.start.y)<0){const r=Math.max(a.start.y,n.start.y)+Math.abs(Math.floor((Math.min(a.end.y,n.end.y)-Math.max(a.start.y,n.start.y))/2));i[0]={x:this.getNodePosFromBorder(t[0],"L").start.x,y:r},i[1]={x:this.getNodePosFromBorder(t[1],"R").start.x,y:r}}else a.start.y>n.end.y?(i[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:n.start.y+Math.floor(t[1].height/2)},i[2]={x:this.getNodePosFromBorder(t[1],"R").start.x,y:i[1].y}):(i[0]={x:this.getNodePosFromBorder(t[0],"L").start.x,y:a.start.y+Math.floor(t[0].height/2)},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x+Math.floor(t[1].width/2),y:i[0].y},i[2]={x:i[1].x,y:this.getNodePosFromBorder(t[1],"L").start.y});else if(a.start.y>n.end.y){const r=Math.max(a.start.x,n.start.x),l=Math.min(this.getNodePosFromBorder(t[0],"R").start.x,this.getNodePosFromBorder(t[1],"R").start.x),u=r+Math.floor((l-r)/2);i[0]={x:u,y:a.start.y},i[1]={x:u,y:n.end.y}}else{const r=Math.max(a.start.x,n.start.x),l=Math.min(this.getNodePosFromBorder(t[0],"R").start.x,this.getNodePosFromBorder(t[1],"R").start.x),u=r+Math.floor((l-r)/2);i[0]={x:u,y:a.end.y},i[1]={x:u,y:n.start.y}}if(i.length){const r={};return s?(s.pos=i,Object.assign(r,s)):Object.assign(r,{from:t[0].id,to:t[1].id,pos:i,type:e}),r}else Io("createLine方法错误：未生成对应关键点坐标")}createLine(e,s){const t=this.createLineInfo(e,s),a=this.emit(re.BeforeCreate,t);Promise.all(a).then(()=>this.emit(re.New,t)).catch(()=>Me("CreateLine abort in [BeforeCreate] hooks."))}mergeLine(e,s){const t=this.createLineInfo(e,s);return Object.assign(s,t)}createBranchLine(){const e=[].concat(this.chooseTargets),s=this.getNodePosFromBorder(e[0],"L"),t=this.getNodePosFromBorder(e[1],"L");if(["inclusive","exclusive"].includes(e[1].type))Io("未将对象引用设置到对象的实例。");else if(["inclusive","exclusive"].includes(e[0].type))this.createLine("fromFilterPrimaryKey");else{const a=s.end.y+50<t.start.y?{x:s.start.x+Math.floor(e[0].width/2)-20,y:s.end.y+Math.floor((t.start.y-s.end.y)/2)-10}:{x:t.start.x+Math.floor(e[1].width/2)-20,y:Math.min(s.start.y,t.start.y)-50},n={x:a.x,y:a.y,width:40,height:20,type:"exclusive",fromId:e[0].id,toId:e[1].id},i=this.emit(j.BeforeCreate,n);Promise.all(i).then(()=>{this.once(j.New,r=>{this.chooseTargets=[e[0],r],this.createLine("toFilter"),this.chooseTargets=[r,e[1]],this.createLine("fromFilterPrimaryKey"),this.chooseTargets=[]}),this.emit(j.New,n)}).catch(()=>Me("Filtered abort in BeforeCreate."))}}createLines(e){for(const s of e){const t=this.dataHandler.originDataMap.get(s.from),a=this.dataHandler.originDataMap.get(s.to);t&&a&&(this.chooseTargets=[t,a],this.createLine(s.type,s))}this.chooseTargets=[],this.update()}mergeLines(e){const s=[];for(const t of e){const a=this.dataHandler.originDataMap.get(t.from),n=this.dataHandler.originDataMap.get(t.to);a&&n&&(this.chooseTargets=[a,n],s.push(this.mergeLine(t.type,t)))}return this.chooseTargets=[],s}setColor(e,s){this.focusTarget.forEach(t=>{if(!(t instanceof ye)){const a=is(t),n=this.emit(a.BeforeChange,t,s,e);Promise.all(n).then(()=>{t.updateOptions({[s]:e}),this.emit(a.Change,t)}).catch(()=>Me("Change abort in [BeforeChange] hooks.",t))}}),this.update()}on(e,s){return super.on(e,s),this}}const yc={nodeDataArray:[{id:"Customer",x:100,y:100,width:150,height:120,bgC:"#FDD2BF",bdC:"#D16B54",enName:"客户",quotePrimaryKey:!0,attributes:[{enName:"客户编号",id:"1",ifPk:!0,ifFk:!0,type:"true",icons:[{text:"P",bgC:"#FFCC80",color:"#BF360C"}],css:{color:"red"}},{enName:"客户姓名",id:"2",type:"Numeric",icons:[{text:"N",bdC:"#689F38",color:"#33691E"}]},{enName:"联系电话",id:"3",type:"Binary_string",icons:[{text:"T",bdC:"#689F38",color:"#33691E"}],css:{color:"blue"}},{enName:"职业",id:"4",type:"string"},{enName:"地址",id:"5",type:"date",css:{color:"yellow"}}]},{id:"Account",x:400,y:80,width:120,height:100,bgC:"#E9D7F1",bdC:"#8B5DA4",enName:"账户",physicalTables:!0,attributes:[{enName:"账户号",id:"6",ifPk:!0,type:"VARCHAR(32)",icons:[{text:"P",bgC:"#FFCC80",color:"#BF360C"}]},{enName:"账户余额",id:"7",type:"DECIMAL(12,2)",icons:[{text:"M",bdC:"#689F38",color:"#33691E"}]},{enName:"账户类型",id:"8",type:"VARCHAR(20)"}]},{id:"Transaction",x:250,y:300,width:130,height:100,bgC:"#D9D9D9",enName:"交易",attributes:[{enName:"交易编号",id:"9",ifPk:!0,type:"VARCHAR(32)",icons:[{text:"P",bgC:"#FFCC80",color:"#BF360C"}]},{enName:"交易时间",id:"10",type:"TIMESTAMP",icons:[{text:"D",bdC:"#689F38",color:"#33691E"}]},{enName:"交易金额",id:"11",type:"DECIMAL(12,2)",icons:[{text:"M",bdC:"#689F38",color:"#33691E"}]},{enName:"交易类型",id:"12",type:"VARCHAR(20)"}]},{id:"Bank",x:560,y:300,width:150,height:120,bgC:"#C1E800",bdC:"#1976D2",enName:"银行",attributes:[{enName:"银行名称",id:"13",type:"VARCHAR(50)"},{enName:"地址",id:"14",type:"VARCHAR(100)"},{enName:"联系电话",id:"15",type:"VARCHAR(20)",icons:[{text:"T",bdC:"#689F38",color:"#33691E"}]}]}],linkDataArray:[{id:"l1",from:"Customer",to:"Account",text:"拥有",pos:[{x:175,y:160},{x:415,y:160}]},{id:"l2",from:"Account",to:"Transaction",text:"发生",pos:[{x:470,y:130},{x:290,y:320}]},{id:"l3",from:"Transaction",to:"Account",text:"涉及",pos:[{x:255,y:320},{x:435,y:130}]},{id:"l4",from:"Bank",to:"Account",text:"开户于",pos:[{x:630,y:240},{x:515,y:160}]}],markDataArray:[],noteDataArray:[]},De=""+new URL("symbol-defs-01fb22be.svg",import.meta.url).href,mc={class:"erg"},vc={class:"toolbar"},bc=["xlink:href"],xc=["xlink:href"],wc=["xlink:href"],Cc=["xlink:href"],Bc=["xlink:href"],Tc=["xlink:href"],Nc=["xlink:href"],Mc=["xlink:href"],Pc=["xlink:href"],Sc=["xlink:href"],Ec=["xlink:href"],Fc=["xlink:href"],Oc=["id"],fs=k({__name:"Base",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:He.Edit},elName:{default:"canvas"}},setup(o,{expose:e}){const s=o,t=S(),a=Rt({scale:100,bgC:"",bdC:"",color:"",editable:He.Edit,viewType:So.Detail}),n=()=>{const c="-apple-system, Noto Sans, Helvetica Neue, Helvetica, Nimbus Sans L, Arial, Liberation Sans, PingFang SC, Hiragino Sans GB, Noto Sans CJK SC, Source Han Sans SC, Source Han Sans CN, Microsoft YaHei, Wenquanyi Micro Hei, WenQuanYi Zen Hei, ST Heiti, SimHei, WenQuanYi Zen Hei Sharp, sans-serif";t.value=new pn({el:document.getElementById(s.elName),fontFamily:c,editable:a.lock,useThumbnail:s.useThumbnail,useAttrFocus:s.useAttrFocus,useRightMenu:!1}),t.value.update(yc),t.value.on(j.DblClick,f=>{const y=f.enName;ju.success(`${y} DblClick！`)}),t.value.on(j.BeforeRename,f=>{if(f.entityId==="Transaction")return Promise.reject()}),t.value.on(Re.BeforeRename,f=>{if(f.attrId==="10")return Promise.reject()})},i=c=>{a.scale>20&&(a.scale+=c),t.value.zoom(a.scale)},r=c=>t.value.updateConfig({status:c}),l=c=>{a.editable=c,t.value.updateConfig({editable:c})},u=(c,f)=>t.value.setColor(c,f),h=()=>t.value.updateLayout(),d=()=>t.value.destroy();return pe(n),ds(d),e({graph:t}),(c,f)=>(x(),O("div",mc,[E("div",vc,[H(p(Ne),{size:"small",circle:"",title:"新增实体",onClick:f[0]||(f[0]=y=>r("addNode"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-add`},null,8,bc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"复制",onClick:f[1]||(f[1]=y=>r("copy"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#copy`},null,8,xc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"新增主键",onClick:f[2]||(f[2]=y=>r("IDENTIFYING"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-primary`},null,8,wc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"新增非主键",onClick:f[3]||(f[3]=y=>r("NON_IDENTIFYING"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-foreign`},null,8,Cc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"新增过滤器",onClick:f[4]||(f[4]=y=>r("filtered"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-subtype`},null,8,Bc)]))]),_:1}),H(p(ts),{direction:"vertical"}),H(p(Ne),{size:"small",circle:"",title:"新增框",onClick:f[5]||(f[5]=y=>r("addMark"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-square`},null,8,Tc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"新增备注",onClick:f[6]||(f[6]=y=>r("addNote"))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#icon-tool-text`},null,8,Nc)]))]),_:1}),H(p(ts),{direction:"vertical"}),a.editable===p(He).Edit?(x(),K(p(Ne),{key:0,size:"small",circle:"",title:"只读",onClick:f[7]||(f[7]=y=>l(p(He).Disabled))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#lock`},null,8,Mc)]))]),_:1})):(x(),K(p(Ne),{key:1,size:"small",circle:"",title:"编辑",onClick:f[8]||(f[8]=y=>l(p(He).Edit))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#unlock`},null,8,Pc)]))]),_:1})),H(p(Ne),{size:"small",circle:"",title:"放大",onClick:f[9]||(f[9]=y=>i(20))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#plus-circle`},null,8,Sc)]))]),_:1}),H(p(Ne),{size:"small",circle:"",title:"缩小",onClick:f[10]||(f[10]=y=>i(-20))},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#minus-circle`},null,8,Ec)]))]),_:1}),H(p(ts),{direction:"vertical"}),H(p(qs),{modelValue:a.bgC,"onUpdate:modelValue":f[11]||(f[11]=y=>a.bgC=y),size:"small",onChange:f[12]||(f[12]=y=>u(y,p(ks).BgColor))},null,8,["modelValue"]),H(p(qs),{modelValue:a.bdC,"onUpdate:modelValue":f[13]||(f[13]=y=>a.bdC=y),size:"small",onChange:f[14]||(f[14]=y=>u(y,p(ks).BdColor))},null,8,["modelValue"]),H(p(qs),{modelValue:a.color,"onUpdate:modelValue":f[15]||(f[15]=y=>a.color=y),size:"small",onChange:f[16]||(f[16]=y=>u(y,p(ks).Color))},null,8,["modelValue"]),H(p(ts),{direction:"vertical"}),H(p(Ne),{size:"small",circle:"",title:"自动布局",onClick:f[17]||(f[17]=y=>h())},{icon:R(()=>[(x(),O("svg",null,[E("use",{"xlink:href":`${p(De)}#layout-o`},null,8,Fc)]))]),_:1}),H(p(ts),{direction:"vertical"}),H(p(Eu),{modelValue:a.viewType,"onUpdate:modelValue":f[18]||(f[18]=y=>a.viewType=y),size:"small",placeholder:"选择视图"},{default:R(()=>[(x(!0),O(Ye,null,ss(p(So),(y,g)=>(x(),K(p(Fu),{label:g,value:y},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),E("div",{id:s.elName,class:"canvas"},null,8,Oc)]))}});fs.__docgenInfo={exportName:"default",displayName:"Base",description:"",tags:{},expose:[{name:"graph"}],props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"Editable.Edit"}},{name:"elName",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'canvas'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/Base.vue"]};const Rc=[[{icon:"",value:"copy",label:"复制"},{icon:"",value:"extend-copy",label:"继承复制"},{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"parent",label:"显示父级关联",children:[{icon:"",value:"level-1",label:"显示1级"},{icon:"",value:"level-2",label:"显示2级"},{icon:"",value:"level-all",label:"显示全部"}]}],[{icon:"",value:"auto-size",label:"自适应大小"},{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}],{icon:"",value:"delete",label:"删除"}],si=[[{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}]],Ac={class:"association__content"},Lc=["id"],gn=k({__name:"parent-association",props:{dialogVisible:{type:Boolean,required:!0},useThumbnail:{type:Boolean,required:!0,default:!0},useRightMenu:{type:Boolean,required:!0,default:!0},useAttrFocus:{type:Boolean,required:!0,default:!0},editable:{type:String,required:!0,default:"edit"},elName:{type:String,required:!0,default:"canvas"}},emits:["update:dialogVisible"],setup(o,{emit:e}){const s=o,t=T(l=>s.dialogVisible),a=()=>e("update:dialogVisible",!1);let n;const i=()=>{n=new pn({el:document.getElementById(s.elName),useThumbnail:!0})},r=()=>n.destroy();return pe(()=>X(i)),ds(r),(l,u)=>(x(),K(p(ru),{title:"Preview",modelValue:p(t),"onUpdate:modelValue":u[0]||(u[0]=h=>yi(t)?t.value=h:null),"append-to-body":!0,"close-on-click-modal":!1,"before-close":a,width:"80%",class:"dialog-association"},{default:R(()=>[E("div",Ac,[E("div",{id:s.elName,class:"association"},null,8,Lc)])]),_:1},8,["modelValue"]))}});gn.__docgenInfo={exportName:"default",displayName:"parent-association",description:"",tags:{},props:[{name:"dialogVisible",type:{name:"boolean"},required:!0},{name:"useThumbnail",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"editable",type:{name:"string"},required:!0,defaultValue:{func:!1,value:"'edit'"}},{name:"elName",type:{name:"string"},required:!0,defaultValue:{func:!1,value:"'canvas'"}}],events:[{name:"update:dialogVisible"}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/components/parent-association.vue"]};const Dc={class:"erg-right-menu"},yn=k({__name:"RightMenu",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(o){const e=S(),s=S(!1),t=T(()=>e.value.graph);return pe(()=>{console.log(t.value,"erg"),t.value.updateConfig({useRightMenu:!0}),t.value.on(Pt.Show,n=>{console.log(si),t.value.updateConfig({rightMenu:n.target?Rc:si})}),t.value.on(Pt.Click,n=>{switch(console.log(n.target),n.value){case"level-1":s.value=!0;break;case"level-2":s.value=!0;break;case"level-all":s.value=!0;break}})}),(n,i)=>(x(),O("div",Dc,[H(fs,{ref_key:"erg",ref:e,elName:"canvas-right-menu",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512),s.value?(x(),K(gn,{key:0,id:"11",elName:"canvas-parent-association",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit",dialogVisible:s.value,"onUpdate:dialogVisible":i[0]||(i[0]=r=>s.value=r)},null,8,["dialogVisible"])):_("",!0)]))}});yn.__docgenInfo={exportName:"default",displayName:"RightMenu",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/RightMenu.vue"]};const $c={class:"erg-extra-drawing"},mn=k({__name:"ExtraDrawing",setup(o){const e=S(),s=T(()=>e.value.graph);return pe(()=>{s.value.on($e.BeforeUpdate,a=>{s.value.dataHandler.originData.nodeDataArray.map(({id:n},i)=>{if(i%2)return;const r=s.value.dataHandler.originDataMap.get(n),l=r.y+24,u=r.height-24;r&&(a.save(),a.font="16px",a.fillStyle="#F59A23",a.strokeStyle="#F59A23",a.textAlign="right",a.textBaseline="top",a.fillText("正在编辑",r.x+r.width,l-22),a.lineWidth=2,a.strokeRect(r.x,l,r.width,u),a.restore())})})}),(a,n)=>(x(),O("div",$c,[H(fs,{ref_key:"erg",ref:e,elName:"canvas-extra-drawing",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512)]))}});mn.__docgenInfo={exportName:"default",displayName:"ExtraDrawing",description:"",tags:{},sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/ExtraDrawing.vue"]};const Hc={class:"erg-export-data"},vn=k({__name:"ExportData",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(o){const e=[[{icon:"",value:"export",label:"导出数据"}]],s=S();S(!1);const t=T(()=>s.value.graph);return pe(()=>{t.value.updateConfig({useRightMenu:!0,rightMenu:e}),t.value.on(Pt.Click,n=>{switch(n.value){case"export":t.value.canvas.exportJsonFile(t.value.dataHandler.originData);break}})}),(n,i)=>(x(),O("div",Hc,[H(fs,{ref_key:"erg",ref:s,elName:"canvas-export-data",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512)]))}});vn.__docgenInfo={exportName:"default",displayName:"ExportData",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/ExportData.vue"]};const Vc={title:"Example/Erg",component:fs,argTypes:{useThumbnail:{description:"是否开启缩略图插件"},useRightMenu:{description:"是否开启右键菜单插件"},useAttrFocus:{description:"属性是否可聚焦"},editable:{description:"修改可编辑状态，1为可编辑状态（默认）；2为可拖拉、放大缩小的只读状态；3为禁止任何交互的只读状态",control:"select",options:[1,2,3]},elName:{description:"Erg画布名称，每个实例都不能相同"}},args:{useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit",elName:"canvas"}},ms={args:{elName:"baseCanvas"}},vs=()=>yn,bs=()=>mn,xs=()=>vn;var oi,ii,ni;ms.parameters={...ms.parameters,docs:{...(oi=ms.parameters)==null?void 0:oi.docs,source:{originalSource:`{
  args: {
    elName: 'baseCanvas'
  }
}`,...(ni=(ii=ms.parameters)==null?void 0:ii.docs)==null?void 0:ni.source}}};var ai,ri,li;vs.parameters={...vs.parameters,docs:{...(ai=vs.parameters)==null?void 0:ai.docs,source:{originalSource:"() => RightMenuCom",...(li=(ri=vs.parameters)==null?void 0:ri.docs)==null?void 0:li.source}}};var di,ui,ci;bs.parameters={...bs.parameters,docs:{...(di=bs.parameters)==null?void 0:di.docs,source:{originalSource:"() => ExtraDrawingCom",...(ci=(ui=bs.parameters)==null?void 0:ui.docs)==null?void 0:ci.source}}};var hi,fi,pi;xs.parameters={...xs.parameters,docs:{...(hi=xs.parameters)==null?void 0:hi.docs,source:{originalSource:"() => ExportDataCom",...(pi=(fi=xs.parameters)==null?void 0:fi.docs)==null?void 0:pi.source}}};const Wc=["Base","RightMenu","ExtraDrawing","ExportData"];export{ms as Base,xs as ExportData,bs as ExtraDrawing,vs as RightMenu,Wc as __namedExportsOrder,Vc as default};
//# sourceMappingURL=Erg.stories-2d7612f6.js.map
