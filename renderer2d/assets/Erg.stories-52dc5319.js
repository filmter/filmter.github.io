import{i as ot,a as C,g as Je,o as me,w as jo,b as jt,d as ei,e as Yi,f as X,j as Gi,N as us,k as T,l as nt,m as U,u as Xi,n as ti,s as wt,p as Y,q as Hs,v as We,x as Nt,y as b,z as F,A as _,F as Ve,B,C as p,D as oe,E as S,G as V,H as $,I as rt,J as cs,K as D,L as Xe,M as we,O as ae,P as Xt,Q as dt,T as ys,R as es,r as Mt,S as Qi,U as ro,V as Yt,W as Se,X as ao,h as Zi,Y as si,Z as Ji,t as ms,_ as ks,$ as Kt,a0 as Fs,a1 as st,a2 as Ii,a3 as ji}from"./vue.esm-bundler-5ff29e51.js";import{i as Qt,g as er,e as tr,a as oi,b as sr,c as or,S as vs,d as Us,f as ii,h as ri,o as ir,k as ai,r as rr,j as ni,s as ar,l as nr,U as no,m as qs,n as Ys,p as xs,q as li,t as lr,u as dr,v as ur,w as Gs,x as di,y as cr,z as ui,A as hr,B as pr,C as ut,D as fr,E as gr,F as Ct,G as ci,H as ue,I as lo,J as yr,K as mr,L as vr,M as at,N as xr,O as Ue,P as hi,Q as Ke,R as Zt,T as br,V as ye,W as Xs,X as pi,Y as Qs,Z as fi,_ as wr,$ as Cr,a0 as Br,a1 as hs,a2 as ws,a3 as Jt,a4 as Qe,a5 as gi,a6 as ve,a7 as yi,a8 as At,a9 as Nr,aa as Mr,ab as zs,ac as $t,ad as Zs,ae as ts,af as _s,ag as Me,ah as mi,ai as vi,aj as Tr,ak as xi,al as Pr,am as Sr,an as Er,ao as Fr,ap as uo,aq as Rr,ar as Lr,as as co,at as Vs,au as $r,av as Oe,aw as Dr,ax as ho,ay as po,az as Ar,aA as Or,aB as Hr,aC as zr,aD as _r,aE as Vr,aF as bi,aG as Tt,aH as Re,aI as Rs,aJ as Wr,aK as Ls,aL as Kr,aM as kr,aN as Ce,aO as G,aP as te,aQ as se,aR as he,aS as ce,aT as J,aU as le,aV as ke,aW as Ur,aX as qr,aY as it,aZ as Yr,a_ as fo,a$ as Gr,b0 as Xr,b1 as De,b2 as Lt,b3 as xt,b4 as re,b5 as go,b6 as $s}from"./tween.esm-a7984476.js";const Js=s=>{let e,o;return s.type==="touchend"?(o=s.changedTouches[0].clientY,e=s.changedTouches[0].clientX):s.type.startsWith("touch")?(o=s.touches[0].clientY,e=s.touches[0].clientX):(o=s.clientY,e=s.clientX),{clientX:e,clientY:o}};function Qr(s){return s}var yo=Object.create,Zr=function(){function s(){}return function(e){if(!Qt(e))return{};if(yo)return yo(e);s.prototype=e;var o=new s;return s.prototype=void 0,o}}();const Jr=Zr;function Ir(s,e,o){switch(o.length){case 0:return s.call(e);case 1:return s.call(e,o[0]);case 2:return s.call(e,o[0],o[1]);case 3:return s.call(e,o[0],o[1],o[2])}return s.apply(e,o)}function jr(s,e){var o=-1,t=s.length;for(e||(e=Array(t));++o<t;)e[o]=s[o];return e}var ea=800,ta=16,sa=Date.now;function oa(s){var e=0,o=0;return function(){var t=sa(),a=ta-(t-o);if(o=t,a>0){if(++e>=ea)return arguments[0]}else e=0;return s.apply(void 0,arguments)}}function ia(s){return function(){return s}}var ra=function(){try{var s=er(Object,"defineProperty");return s({},"",{}),s}catch{}}();const bs=ra;var aa=bs?function(s,e){return bs(s,"toString",{configurable:!0,enumerable:!1,value:ia(e),writable:!0})}:Qr;const na=aa;var la=oa(na);const da=la;function ua(s,e){for(var o=-1,t=s==null?0:s.length;++o<t&&e(s[o],o,s)!==!1;);return s}function wi(s,e,o){e=="__proto__"&&bs?bs(s,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):s[e]=o}var ca=Object.prototype,ha=ca.hasOwnProperty;function Is(s,e,o){var t=s[e];(!(ha.call(s,e)&&tr(t,o))||o===void 0&&!(e in s))&&wi(s,e,o)}function Cs(s,e,o,t){var a=!o;o||(o={});for(var r=-1,i=e.length;++r<i;){var n=e[r],l=t?t(o[n],s[n],n,o,s):void 0;l===void 0&&(l=s[n]),a?wi(o,n,l):Is(o,n,l)}return o}var mo=Math.max;function pa(s,e,o){return e=mo(e===void 0?s.length-1:e,0),function(){for(var t=arguments,a=-1,r=mo(t.length-e,0),i=Array(r);++a<r;)i[a]=t[e+a];a=-1;for(var n=Array(e+1);++a<e;)n[a]=t[a];return n[e]=o(i),Ir(s,this,n)}}function fa(s){var e=[];if(s!=null)for(var o in Object(s))e.push(o);return e}var ga=Object.prototype,ya=ga.hasOwnProperty;function ma(s){if(!Qt(s))return fa(s);var e=oi(s),o=[];for(var t in s)t=="constructor"&&(e||!ya.call(s,t))||o.push(t);return o}function js(s){return sr(s)?or(s,!0):ma(s)}var vo=vs?vs.isConcatSpreadable:void 0;function va(s){return Us(s)||ii(s)||!!(vo&&s&&s[vo])}function Ci(s,e,o,t,a){var r=-1,i=s.length;for(o||(o=va),a||(a=[]);++r<i;){var n=s[r];e>0&&o(n)?e>1?Ci(n,e-1,o,t,a):ri(a,n):t||(a[a.length]=n)}return a}function xa(s){var e=s==null?0:s.length;return e?Ci(s,1):[]}function ba(s){return da(pa(s,void 0,xa),s+"")}var wa=ir(Object.getPrototypeOf,Object);const Bi=wa;function Ca(s,e){return s&&Cs(e,ai(e),s)}function Ba(s,e){return s&&Cs(e,js(e),s)}var Ni=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xo=Ni&&typeof module=="object"&&module&&!module.nodeType&&module,Na=xo&&xo.exports===Ni,bo=Na?rr.Buffer:void 0,wo=bo?bo.allocUnsafe:void 0;function Ma(s,e){if(e)return s.slice();var o=s.length,t=wo?wo(o):new s.constructor(o);return s.copy(t),t}function Ta(s,e){return Cs(s,ni(s),e)}var Pa=Object.getOwnPropertySymbols,Sa=Pa?function(s){for(var e=[];s;)ri(e,ni(s)),s=Bi(s);return e}:ar;const Mi=Sa;function Ea(s,e){return Cs(s,Mi(s),e)}function Fa(s){return nr(s,js,Mi)}var Ra=Object.prototype,La=Ra.hasOwnProperty;function $a(s){var e=s.length,o=new s.constructor(e);return e&&typeof s[0]=="string"&&La.call(s,"index")&&(o.index=s.index,o.input=s.input),o}function eo(s){var e=new s.constructor(s.byteLength);return new no(e).set(new no(s)),e}function Da(s,e){var o=e?eo(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.byteLength)}var Aa=/\w*$/;function Oa(s){var e=new s.constructor(s.source,Aa.exec(s));return e.lastIndex=s.lastIndex,e}var Co=vs?vs.prototype:void 0,Bo=Co?Co.valueOf:void 0;function Ha(s){return Bo?Object(Bo.call(s)):{}}function za(s,e){var o=e?eo(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.length)}var _a="[object Boolean]",Va="[object Date]",Wa="[object Map]",Ka="[object Number]",ka="[object RegExp]",Ua="[object Set]",qa="[object String]",Ya="[object Symbol]",Ga="[object ArrayBuffer]",Xa="[object DataView]",Qa="[object Float32Array]",Za="[object Float64Array]",Ja="[object Int8Array]",Ia="[object Int16Array]",ja="[object Int32Array]",en="[object Uint8Array]",tn="[object Uint8ClampedArray]",sn="[object Uint16Array]",on="[object Uint32Array]";function rn(s,e,o){var t=s.constructor;switch(e){case Ga:return eo(s);case _a:case Va:return new t(+s);case Xa:return Da(s,o);case Qa:case Za:case Ja:case Ia:case ja:case en:case tn:case sn:case on:return za(s,o);case Wa:return new t;case Ka:case qa:return new t(s);case ka:return Oa(s);case Ua:return new t;case Ya:return Ha(s)}}function an(s){return typeof s.constructor=="function"&&!oi(s)?Jr(Bi(s)):{}}var nn="[object Map]";function ln(s){return qs(s)&&Ys(s)==nn}var No=xs&&xs.isMap,dn=No?li(No):ln;const un=dn;var cn="[object Set]";function hn(s){return qs(s)&&Ys(s)==cn}var Mo=xs&&xs.isSet,pn=Mo?li(Mo):hn;const fn=pn;var gn=1,yn=2,mn=4,Ti="[object Arguments]",vn="[object Array]",xn="[object Boolean]",bn="[object Date]",wn="[object Error]",Pi="[object Function]",Cn="[object GeneratorFunction]",Bn="[object Map]",Nn="[object Number]",Si="[object Object]",Mn="[object RegExp]",Tn="[object Set]",Pn="[object String]",Sn="[object Symbol]",En="[object WeakMap]",Fn="[object ArrayBuffer]",Rn="[object DataView]",Ln="[object Float32Array]",$n="[object Float64Array]",Dn="[object Int8Array]",An="[object Int16Array]",On="[object Int32Array]",Hn="[object Uint8Array]",zn="[object Uint8ClampedArray]",_n="[object Uint16Array]",Vn="[object Uint32Array]",Z={};Z[Ti]=Z[vn]=Z[Fn]=Z[Rn]=Z[xn]=Z[bn]=Z[Ln]=Z[$n]=Z[Dn]=Z[An]=Z[On]=Z[Bn]=Z[Nn]=Z[Si]=Z[Mn]=Z[Tn]=Z[Pn]=Z[Sn]=Z[Hn]=Z[zn]=Z[_n]=Z[Vn]=!0;Z[wn]=Z[Pi]=Z[En]=!1;function ps(s,e,o,t,a,r){var i,n=e&gn,l=e&yn,u=e&mn;if(o&&(i=a?o(s,t,a,r):o(s)),i!==void 0)return i;if(!Qt(s))return s;var c=Us(s);if(c){if(i=$a(s),!n)return jr(s,i)}else{var d=Ys(s),g=d==Pi||d==Cn;if(lr(s))return Ma(s,n);if(d==Si||d==Ti||g&&!a){if(i=l||g?{}:an(s),!n)return l?Ea(s,Ba(i,s)):Ta(s,Ca(i,s))}else{if(!Z[d])return a?s:{};i=rn(s,d,n)}}r||(r=new dr);var h=r.get(s);if(h)return h;r.set(s,i),fn(s)?s.forEach(function(x){i.add(ps(x,e,o,x,s,r))}):un(s)&&s.forEach(function(x,M){i.set(M,ps(x,e,o,M,s,r))});var m=u?l?Fa:ur:l?js:ai,f=c?void 0:m(s);return ua(f||s,function(x,M){f&&(M=x,x=s[M]),Is(i,M,ps(x,e,o,M,s,r))}),i}var Wn=1,Kn=4;function Ws(s){return ps(s,Wn|Kn)}function kn(s,e){return s!=null&&e in Object(s)}function Un(s,e,o){e=Gs(e,s);for(var t=-1,a=e.length,r=!1;++t<a;){var i=di(e[t]);if(!(r=s!=null&&o(s,i)))break;s=s[i]}return r||++t!=a?r:(a=s==null?0:s.length,!!a&&cr(a)&&ui(i,a)&&(Us(s)||ii(s)))}function qn(s,e){return s!=null&&Un(s,e,kn)}var Yn="[object Boolean]";function qt(s){return s===!0||s===!1||qs(s)&&hr(s)==Yn}function Gn(s,e,o,t){if(!Qt(s))return s;e=Gs(e,s);for(var a=-1,r=e.length,i=r-1,n=s;n!=null&&++a<r;){var l=di(e[a]),u=o;if(l==="__proto__"||l==="constructor"||l==="prototype")return s;if(a!=i){var c=n[l];u=t?t(c,l,n):void 0,u===void 0&&(u=Qt(c)?c:ui(e[a+1])?[]:{})}Is(n,l,u),n=n[l]}return s}function Xn(s,e,o){for(var t=-1,a=e.length,r={};++t<a;){var i=e[t],n=pr(s,i);o(n,i)&&Gn(r,Gs(i,s),n)}return r}function Qn(s,e){return Xn(s,e,function(o,t){return qn(s,t)})}var Zn=ba(function(s,e){return s==null?{}:Qn(s,e)});const To=Zn;let rs;const Jn=s=>{var e;if(!ut)return 0;if(rs!==void 0)return rs;const o=document.createElement("div");o.className=`${s}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const t=o.offsetWidth;o.style.overflow="scroll";const a=document.createElement("div");a.style.width="100%",o.appendChild(a);const r=a.offsetWidth;return(e=o.parentNode)==null||e.removeChild(o),rs=t-r,rs};function In(s,e){if(!ut)return;if(!e){s.scrollTop=0;return}const o=[];let t=e.offsetParent;for(;t!==null&&s!==t&&s.contains(t);)o.push(t),t=t.offsetParent;const a=e.offsetTop+o.reduce((l,u)=>l+u.offsetTop,0),r=a+e.offsetHeight,i=s.scrollTop,n=i+s.clientHeight;a<i?s.scrollTop=a:r>n&&(s.scrollTop=r-s.clientHeight)}const jn=(...s)=>e=>{s.forEach(o=>{ot(o)?o(e):o.value=e})},el=s=>fr[s||"default"];var fs=(s=>(s[s.TEXT=1]="TEXT",s[s.CLASS=2]="CLASS",s[s.STYLE=4]="STYLE",s[s.PROPS=8]="PROPS",s[s.FULL_PROPS=16]="FULL_PROPS",s[s.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",s[s.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",s[s.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",s[s.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",s[s.NEED_PATCH=512]="NEED_PATCH",s[s.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",s[s.HOISTED=-1]="HOISTED",s[s.BAIL=-2]="BAIL",s))(fs||{});const tl=["class","style"],sl=/^on[A-Z]/,ol=(s={})=>{const{excludeListeners:e=!1,excludeKeys:o}=s,t=C(()=>((o==null?void 0:o.value)||[]).concat(tl)),a=Je();return a?C(()=>{var r;return gr(Object.entries((r=a.proxy)==null?void 0:r.$attrs).filter(([i])=>!t.value.includes(i)&&!(e&&sl.test(i))))}):C(()=>({}))},il=(s,e,o)=>{let t={offsetX:0,offsetY:0};const a=n=>{const l=n.clientX,u=n.clientY,{offsetX:c,offsetY:d}=t,g=s.value.getBoundingClientRect(),h=g.left,m=g.top,f=g.width,x=g.height,M=document.documentElement.clientWidth,N=document.documentElement.clientHeight,P=-h+c,q=-m+d,Q=M-h-f+c,A=N-m-x+d,E=k=>{const L=Math.min(Math.max(c+k.clientX-l,P),Q),W=Math.min(Math.max(d+k.clientY-u,q),A);t={offsetX:L,offsetY:W},s.value.style.transform=`translate(${Ct(L)}, ${Ct(W)})`},H=()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",H)},r=()=>{e.value&&s.value&&e.value.addEventListener("mousedown",a)},i=()=>{e.value&&s.value&&e.value.removeEventListener("mousedown",a)};me(()=>{jo(()=>{o.value?r():i()})}),jt(()=>{i()})},rl=s=>({focus:()=>{var e,o;(o=(e=s.value)==null?void 0:e.focus)==null||o.call(e)}}),al=(s,e={})=>{ei(s)||ci("[useLockscreen]","You need to pass a ref param to this function");const o=e.ns||ue("popup"),t=Yi(()=>o.bm("parent","hidden"));if(!ut||lo(document.body,t.value))return;let a=0,r=!1,i="0";const n=()=>{setTimeout(()=>{vr(document==null?void 0:document.body,t.value),r&&document&&(document.body.style.width=i)},200)};X(s,l=>{if(!l){n();return}r=!lo(document.body,t.value),r&&(i=document.body.style.width),a=Jn(o.namespace.value);const u=document.documentElement.clientHeight<document.body.scrollHeight,c=yr(document.body,"overflowY");a>0&&(u||c==="scroll")&&r&&(document.body.style.width=`calc(100% - ${a}px)`),mr(document.body,t.value)}),Gi(()=>n())},Ei=s=>{if(!s)return{onClick:us,onMousedown:us,onMouseup:us};let e=!1,o=!1;return{onClick:i=>{e&&o&&s(i),e=o=!1},onMousedown:i=>{e=i.target===i.currentTarget},onMouseup:i=>{o=i.target===i.currentTarget}}};function nl(s){const e=T();function o(){if(s.value==null)return;const{selectionStart:a,selectionEnd:r,value:i}=s.value;if(a==null||r==null)return;const n=i.slice(0,Math.max(0,a)),l=i.slice(Math.max(0,r));e.value={selectionStart:a,selectionEnd:r,value:i,beforeTxt:n,afterTxt:l}}function t(){if(s.value==null||e.value==null)return;const{value:a}=s.value,{beforeTxt:r,afterTxt:i,selectionStart:n}=e.value;if(r==null||i==null||n==null)return;let l=a.length;if(a.endsWith(i))l=a.length-i.length;else if(a.startsWith(r))l=r.length;else{const u=r[n-1],c=a.indexOf(u,n-1);c!==-1&&(l=c+1)}s.value.setSelectionRange(l,l)}return[o,t]}let Ae;const ll=`
  height:0 !important;
  visibility:hidden !important;
  ${xr()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,dl=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function ul(s){const e=window.getComputedStyle(s),o=e.getPropertyValue("box-sizing"),t=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),a=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:dl.map(i=>`${i}:${e.getPropertyValue(i)}`).join(";"),paddingSize:t,borderSize:a,boxSizing:o}}function Po(s,e=1,o){var t;Ae||(Ae=document.createElement("textarea"),document.body.appendChild(Ae));const{paddingSize:a,borderSize:r,boxSizing:i,contextStyle:n}=ul(s);Ae.setAttribute("style",`${n};${ll}`),Ae.value=s.value||s.placeholder||"";let l=Ae.scrollHeight;const u={};i==="border-box"?l=l+r:i==="content-box"&&(l=l-a),Ae.value="";const c=Ae.scrollHeight-a;if(at(e)){let d=c*e;i==="border-box"&&(d=d+a+r),l=Math.max(d,l),u.minHeight=`${d}px`}if(at(o)){let d=c*o;i==="border-box"&&(d=d+a+r),l=Math.min(d,l)}return u.height=`${l}px`,(t=Ae.parentNode)==null||t.removeChild(Ae),Ae=void 0,u}const cl=Ue({id:{type:String,default:void 0},size:hi,disabled:Boolean,modelValue:{type:Ke([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Ke([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Zt},prefixIcon:{type:Zt},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:Ke([Object,Array,String]),default:()=>br({})}}),hl={[ye]:s=>nt(s),input:s=>nt(s),change:s=>nt(s),focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,clear:()=>!0,mouseleave:s=>s instanceof MouseEvent,mouseenter:s=>s instanceof MouseEvent,keydown:s=>s instanceof Event,compositionstart:s=>s instanceof CompositionEvent,compositionupdate:s=>s instanceof CompositionEvent,compositionend:s=>s instanceof CompositionEvent},pl=["role"],fl=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],gl=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],yl=U({name:"ElInput",inheritAttrs:!1}),ml=U({...yl,props:cl,emits:hl,setup(s,{expose:e,emit:o}){const t=s,a=Xi(),r=ti(),i=C(()=>{const w={};return t.containerRole==="combobox"&&(w["aria-haspopup"]=a["aria-haspopup"],w["aria-owns"]=a["aria-owns"],w["aria-expanded"]=a["aria-expanded"]),w}),n=C(()=>[t.type==="textarea"?x.b():f.b(),f.m(h.value),f.is("disabled",m.value),f.is("exceed",Ne.value),{[f.b("group")]:r.prepend||r.append,[f.bm("group","append")]:r.append,[f.bm("group","prepend")]:r.prepend,[f.m("prefix")]:r.prefix||t.prefixIcon,[f.m("suffix")]:r.suffix||t.suffixIcon||t.clearable||t.showPassword,[f.bm("suffix","password-clear")]:xe.value&&He.value},a.class]),l=C(()=>[f.e("wrapper"),f.is("focus",P.value)]),u=ol({excludeKeys:C(()=>Object.keys(i.value))}),{form:c,formItem:d}=Xs(),{inputId:g}=pi(t,{formItemContext:d}),h=Qs(),m=fi(),f=ue("input"),x=ue("textarea"),M=wt(),N=wt(),P=T(!1),q=T(!1),Q=T(!1),A=T(!1),E=T(),H=wt(t.inputStyle),k=C(()=>M.value||N.value),L=C(()=>{var w;return(w=c==null?void 0:c.statusIcon)!=null?w:!1}),W=C(()=>(d==null?void 0:d.validateState)||""),ee=C(()=>W.value&&wr[W.value]),Be=C(()=>A.value?Cr:Br),I=C(()=>[a.style,t.inputStyle]),pe=C(()=>[t.inputStyle,H.value,{resize:t.resize}]),j=C(()=>hs(t.modelValue)?"":String(t.modelValue)),xe=C(()=>t.clearable&&!m.value&&!t.readonly&&!!j.value&&(P.value||q.value)),He=C(()=>t.showPassword&&!m.value&&!t.readonly&&!!j.value&&(!!j.value||P.value)),O=C(()=>t.showWordLimit&&!!u.value.maxlength&&(t.type==="text"||t.type==="textarea")&&!m.value&&!t.readonly&&!t.showPassword),ie=C(()=>j.value.length),Ne=C(()=>!!O.value&&ie.value>Number(u.value.maxlength)),Ie=C(()=>!!r.suffix||!!t.suffixIcon||xe.value||t.showPassword||O.value||!!W.value&&L.value),[je,Ot]=nl(M);ws(N,w=>{if(Ht(),!O.value||t.resize!=="both")return;const K=w[0],{width:be}=K.contentRect;E.value={right:`calc(100% - ${be+15+6}px)`}});const qe=()=>{const{type:w,autosize:K}=t;if(!(!ut||w!=="textarea"||!N.value))if(K){const be=Xt(K)?K.minRows:void 0,tt=Xt(K)?K.maxRows:void 0,gt=Po(N.value,be,tt);H.value={overflowY:"hidden",...gt},Y(()=>{N.value.offsetHeight,H.value=gt})}else H.value={minHeight:Po(N.value).minHeight}},Ht=(w=>{let K=!1;return()=>{var be;if(K||!t.autosize)return;((be=N.value)==null?void 0:be.offsetParent)===null||(w(),K=!0)}})(qe),Te=()=>{const w=k.value;!w||w.value===j.value||(w.value=j.value)},ze=async w=>{je();let{value:K}=w.target;if(t.formatter&&(K=t.parser?t.parser(K):K,K=t.formatter(K)),!Q.value){if(K===j.value){Te();return}o(ye,K),o("input",K),await Y(),Te(),Ot()}},Pt=w=>{o("change",w.target.value)},ct=w=>{o("compositionstart",w),Q.value=!0},et=w=>{var K;o("compositionupdate",w);const be=(K=w.target)==null?void 0:K.value,tt=be[be.length-1]||"";Q.value=!yi(tt)},ht=w=>{o("compositionend",w),Q.value&&(Q.value=!1,ze(w))},pt=()=>{A.value=!A.value,Le()},Le=async()=>{var w;await Y(),(w=k.value)==null||w.focus()},zt=()=>{var w;return(w=k.value)==null?void 0:w.blur()},St=w=>{P.value=!0,o("focus",w)},Et=w=>{var K;P.value=!1,o("blur",w),t.validateEvent&&((K=d==null?void 0:d.validate)==null||K.call(d,"blur").catch(be=>Jt()))},ft=w=>{q.value=!1,o("mouseleave",w)},_t=w=>{q.value=!0,o("mouseenter",w)},Ft=w=>{o("keydown",w)},Vt=()=>{var w;(w=k.value)==null||w.select()},$e=()=>{o(ye,""),o("change",""),o("clear"),o("input","")};return X(()=>t.modelValue,()=>{var w;Y(()=>qe()),t.validateEvent&&((w=d==null?void 0:d.validate)==null||w.call(d,"change").catch(K=>Jt()))}),X(j,()=>Te()),X(()=>t.type,async()=>{await Y(),Te(),qe()}),me(()=>{!t.formatter&&t.parser,Te(),Y(qe)}),e({input:M,textarea:N,ref:k,textareaStyle:pe,autosize:Hs(t,"autosize"),focus:Le,blur:zt,select:Vt,clear:$e,resizeTextarea:qe}),(w,K)=>We((b(),F("div",cs(p(i),{class:p(n),style:p(I),role:w.containerRole,onMouseenter:_t,onMouseleave:ft}),[_(" input "),w.type!=="textarea"?(b(),F(Ve,{key:0},[_(" prepend slot "),w.$slots.prepend?(b(),F("div",{key:0,class:B(p(f).be("group","prepend"))},[oe(w.$slots,"prepend")],2)):_("v-if",!0),S("div",{class:B(p(l))},[_(" prefix slot "),w.$slots.prefix||w.prefixIcon?(b(),F("span",{key:0,class:B(p(f).e("prefix"))},[S("span",{class:B(p(f).e("prefix-inner")),onClick:Le},[oe(w.$slots,"prefix"),w.prefixIcon?(b(),V(p(Qe),{key:0,class:B(p(f).e("icon"))},{default:$(()=>[(b(),V(rt(w.prefixIcon)))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0),S("input",cs({id:p(g),ref_key:"input",ref:M,class:p(f).e("inner")},p(u),{type:w.showPassword?A.value?"text":"password":w.type,disabled:p(m),formatter:w.formatter,parser:w.parser,readonly:w.readonly,autocomplete:w.autocomplete,tabindex:w.tabindex,"aria-label":w.label,placeholder:w.placeholder,style:w.inputStyle,form:t.form,onCompositionstart:ct,onCompositionupdate:et,onCompositionend:ht,onInput:ze,onFocus:St,onBlur:Et,onChange:Pt,onKeydown:Ft}),null,16,fl),_(" suffix slot "),p(Ie)?(b(),F("span",{key:1,class:B(p(f).e("suffix"))},[S("span",{class:B(p(f).e("suffix-inner")),onClick:Le},[!p(xe)||!p(He)||!p(O)?(b(),F(Ve,{key:0},[oe(w.$slots,"suffix"),w.suffixIcon?(b(),V(p(Qe),{key:0,class:B(p(f).e("icon"))},{default:$(()=>[(b(),V(rt(w.suffixIcon)))]),_:1},8,["class"])):_("v-if",!0)],64)):_("v-if",!0),p(xe)?(b(),V(p(Qe),{key:1,class:B([p(f).e("icon"),p(f).e("clear")]),onMousedown:Xe(p(us),["prevent"]),onClick:$e},{default:$(()=>[D(p(gi))]),_:1},8,["class","onMousedown"])):_("v-if",!0),p(He)?(b(),V(p(Qe),{key:2,class:B([p(f).e("icon"),p(f).e("password")]),onClick:pt},{default:$(()=>[(b(),V(rt(p(Be))))]),_:1},8,["class"])):_("v-if",!0),p(O)?(b(),F("span",{key:3,class:B(p(f).e("count"))},[S("span",{class:B(p(f).e("count-inner"))},we(p(ie))+" / "+we(p(u).maxlength),3)],2)):_("v-if",!0),p(W)&&p(ee)&&p(L)?(b(),V(p(Qe),{key:4,class:B([p(f).e("icon"),p(f).e("validateIcon"),p(f).is("loading",p(W)==="validating")])},{default:$(()=>[(b(),V(rt(p(ee))))]),_:1},8,["class"])):_("v-if",!0)],2)],2)):_("v-if",!0)],2),_(" append slot "),w.$slots.append?(b(),F("div",{key:1,class:B(p(f).be("group","append"))},[oe(w.$slots,"append")],2)):_("v-if",!0)],64)):(b(),F(Ve,{key:1},[_(" textarea "),S("textarea",cs({id:p(g),ref_key:"textarea",ref:N,class:p(x).e("inner")},p(u),{tabindex:w.tabindex,disabled:p(m),readonly:w.readonly,autocomplete:w.autocomplete,style:p(pe),"aria-label":w.label,placeholder:w.placeholder,form:t.form,onCompositionstart:ct,onCompositionupdate:et,onCompositionend:ht,onInput:ze,onFocus:St,onBlur:Et,onChange:Pt,onKeydown:Ft}),null,16,gl),p(O)?(b(),F("span",{key:0,style:ae(E.value),class:B(p(f).e("count"))},we(p(ie))+" / "+we(p(u).maxlength),7)):_("v-if",!0)],64))],16,pl)),[[Nt,w.type!=="hidden"]])}});var vl=ve(ml,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const Fi=At(vl),Ri=Symbol("scrollbarContextKey"),xl=Ue({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),bl="Thumb",wl=U({__name:"thumb",props:xl,setup(s){const e=s,o=dt(Ri),t=ue("scrollbar");o||ci(bl,"can not inject scrollbar context");const a=T(),r=T(),i=T({}),n=T(!1);let l=!1,u=!1,c=ut?document.onselectstart:null;const d=C(()=>Nr[e.vertical?"vertical":"horizontal"]),g=C(()=>Mr({size:e.size,move:e.move,bar:d.value})),h=C(()=>a.value[d.value.offset]**2/o.wrapElement[d.value.scrollSize]/e.ratio/r.value[d.value.offset]),m=A=>{var E;if(A.stopPropagation(),A.ctrlKey||[1,2].includes(A.button))return;(E=window.getSelection())==null||E.removeAllRanges(),x(A);const H=A.currentTarget;H&&(i.value[d.value.axis]=H[d.value.offset]-(A[d.value.client]-H.getBoundingClientRect()[d.value.direction]))},f=A=>{if(!r.value||!a.value||!o.wrapElement)return;const E=Math.abs(A.target.getBoundingClientRect()[d.value.direction]-A[d.value.client]),H=r.value[d.value.offset]/2,k=(E-H)*100*h.value/a.value[d.value.offset];o.wrapElement[d.value.scroll]=k*o.wrapElement[d.value.scrollSize]/100},x=A=>{A.stopImmediatePropagation(),l=!0,document.addEventListener("mousemove",M),document.addEventListener("mouseup",N),c=document.onselectstart,document.onselectstart=()=>!1},M=A=>{if(!a.value||!r.value||l===!1)return;const E=i.value[d.value.axis];if(!E)return;const H=(a.value.getBoundingClientRect()[d.value.direction]-A[d.value.client])*-1,k=r.value[d.value.offset]-E,L=(H-k)*100*h.value/a.value[d.value.offset];o.wrapElement[d.value.scroll]=L*o.wrapElement[d.value.scrollSize]/100},N=()=>{l=!1,i.value[d.value.axis]=0,document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",N),Q(),u&&(n.value=!1)},P=()=>{u=!1,n.value=!!e.size},q=()=>{u=!0,n.value=l};jt(()=>{Q(),document.removeEventListener("mouseup",N)});const Q=()=>{document.onselectstart!==c&&(document.onselectstart=c)};return zs(Hs(o,"scrollbarElement"),"mousemove",P),zs(Hs(o,"scrollbarElement"),"mouseleave",q),(A,E)=>(b(),V(ys,{name:p(t).b("fade"),persisted:""},{default:$(()=>[We(S("div",{ref_key:"instance",ref:a,class:B([p(t).e("bar"),p(t).is(p(d).key)]),onMousedown:f},[S("div",{ref_key:"thumb",ref:r,class:B(p(t).e("thumb")),style:ae(p(g)),onMousedown:m},null,38)],34),[[Nt,A.always||n.value]])]),_:1},8,["name"]))}});var So=ve(wl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const Cl=Ue({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Bl=U({__name:"bar",props:Cl,setup(s,{expose:e}){const o=s,t=T(0),a=T(0);return e({handleScroll:i=>{if(i){const n=i.offsetHeight-$t,l=i.offsetWidth-$t;a.value=i.scrollTop*100/n*o.ratioY,t.value=i.scrollLeft*100/l*o.ratioX}}}),(i,n)=>(b(),F(Ve,null,[D(So,{move:t.value,ratio:i.ratioX,size:i.width,always:i.always},null,8,["move","ratio","size","always"]),D(So,{move:a.value,ratio:i.ratioY,size:i.height,vertical:"",always:i.always},null,8,["move","ratio","size","always"])],64))}});var Nl=ve(Bl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const Ml=Ue({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Ke([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),Tl={scroll:({scrollTop:s,scrollLeft:e})=>[s,e].every(at)},Pl="ElScrollbar",Sl=U({name:Pl}),El=U({...Sl,props:Ml,emits:Tl,setup(s,{expose:e,emit:o}){const t=s,a=ue("scrollbar");let r,i;const n=T(),l=T(),u=T(),c=T("0"),d=T("0"),g=T(),h=T(1),m=T(1),f=C(()=>{const E={};return t.height&&(E.height=Ct(t.height)),t.maxHeight&&(E.maxHeight=Ct(t.maxHeight)),[t.wrapStyle,E]}),x=C(()=>[t.wrapClass,a.e("wrap"),{[a.em("wrap","hidden-default")]:!t.native}]),M=C(()=>[a.e("view"),t.viewClass]),N=()=>{var E;l.value&&((E=g.value)==null||E.handleScroll(l.value),o("scroll",{scrollTop:l.value.scrollTop,scrollLeft:l.value.scrollLeft}))};function P(E,H){Xt(E)?l.value.scrollTo(E):at(E)&&at(H)&&l.value.scrollTo(E,H)}const q=E=>{at(E)&&(l.value.scrollTop=E)},Q=E=>{at(E)&&(l.value.scrollLeft=E)},A=()=>{if(!l.value)return;const E=l.value.offsetHeight-$t,H=l.value.offsetWidth-$t,k=E**2/l.value.scrollHeight,L=H**2/l.value.scrollWidth,W=Math.max(k,t.minSize),ee=Math.max(L,t.minSize);h.value=k/(E-k)/(W/(E-W)),m.value=L/(H-L)/(ee/(H-ee)),d.value=W+$t<E?`${W}px`:"",c.value=ee+$t<H?`${ee}px`:""};return X(()=>t.noresize,E=>{E?(r==null||r(),i==null||i()):({stop:r}=ws(u,A),i=zs("resize",A))},{immediate:!0}),X(()=>[t.maxHeight,t.height],()=>{t.native||Y(()=>{var E;A(),l.value&&((E=g.value)==null||E.handleScroll(l.value))})}),es(Ri,Mt({scrollbarElement:n,wrapElement:l})),me(()=>{t.native||Y(()=>{A()})}),Qi(()=>A()),e({wrapRef:l,update:A,scrollTo:P,setScrollTop:q,setScrollLeft:Q,handleScroll:N}),(E,H)=>(b(),F("div",{ref_key:"scrollbarRef",ref:n,class:B(p(a).b())},[S("div",{ref_key:"wrapRef",ref:l,class:B(p(x)),style:ae(p(f)),onScroll:N},[(b(),V(rt(E.tag),{ref_key:"resizeRef",ref:u,class:B(p(M)),style:ae(E.viewStyle)},{default:$(()=>[oe(E.$slots,"default")]),_:3},8,["class","style"]))],38),E.native?_("v-if",!0):(b(),V(Nl,{key:0,ref_key:"barRef",ref:g,height:d.value,width:c.value,always:E.always,"ratio-x":m.value,"ratio-y":h.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var Fl=ve(El,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const Rl=At(Fl),Ll=Ue({color:{type:Ke(Object),required:!0},vertical:{type:Boolean,default:!1}});let Ds=!1;function It(s,e){if(!ut)return;const o=function(r){var i;(i=e.drag)==null||i.call(e,r)},t=function(r){var i;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",t),document.onselectstart=null,document.ondragstart=null,Ds=!1,(i=e.end)==null||i.call(e,r)},a=function(r){var i;Ds||(r.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",t),document.addEventListener("touchmove",o),document.addEventListener("touchend",t),Ds=!0,(i=e.start)==null||i.call(e,r))};s.addEventListener("mousedown",a),s.addEventListener("touchstart",a)}const $l=s=>{const e=Je(),o=wt(),t=wt();function a(i){i.target!==o.value&&r(i)}function r(i){if(!t.value||!o.value)return;const l=e.vnode.el.getBoundingClientRect(),{clientX:u,clientY:c}=Js(i);if(s.vertical){let d=c-l.top;d=Math.max(o.value.offsetHeight/2,d),d=Math.min(d,l.height-o.value.offsetHeight/2),s.color.set("alpha",Math.round((d-o.value.offsetHeight/2)/(l.height-o.value.offsetHeight)*100))}else{let d=u-l.left;d=Math.max(o.value.offsetWidth/2,d),d=Math.min(d,l.width-o.value.offsetWidth/2),s.color.set("alpha",Math.round((d-o.value.offsetWidth/2)/(l.width-o.value.offsetWidth)*100))}}return{thumb:o,bar:t,handleDrag:r,handleClick:a}},Dl=(s,{bar:e,thumb:o,handleDrag:t})=>{const a=Je(),r=ue("color-alpha-slider"),i=T(0),n=T(0),l=T();function u(){if(!o.value||s.vertical)return 0;const N=a.vnode.el,P=s.color.get("alpha");return N?Math.round(P*(N.offsetWidth-o.value.offsetWidth/2)/100):0}function c(){if(!o.value)return 0;const N=a.vnode.el;if(!s.vertical)return 0;const P=s.color.get("alpha");return N?Math.round(P*(N.offsetHeight-o.value.offsetHeight/2)/100):0}function d(){if(s.color&&s.color.value){const{r:N,g:P,b:q}=s.color.toRgb();return`linear-gradient(to right, rgba(${N}, ${P}, ${q}, 0) 0%, rgba(${N}, ${P}, ${q}, 1) 100%)`}return""}function g(){i.value=u(),n.value=c(),l.value=d()}me(()=>{if(!e.value||!o.value)return;const N={drag:P=>{t(P)},end:P=>{t(P)}};It(e.value,N),It(o.value,N),g()}),X(()=>s.color.get("alpha"),()=>g()),X(()=>s.color.value,()=>g());const h=C(()=>[r.b(),r.is("vertical",s.vertical)]),m=C(()=>r.e("bar")),f=C(()=>r.e("thumb")),x=C(()=>({background:l.value})),M=C(()=>({left:Ct(i.value),top:Ct(n.value)}));return{rootKls:h,barKls:m,barStyle:x,thumbKls:f,thumbStyle:M,update:g}},Al="ElColorAlphaSlider",Ol=U({name:Al}),Hl=U({...Ol,props:Ll,setup(s,{expose:e}){const o=s,{bar:t,thumb:a,handleDrag:r,handleClick:i}=$l(o),{rootKls:n,barKls:l,barStyle:u,thumbKls:c,thumbStyle:d,update:g}=Dl(o,{bar:t,thumb:a,handleDrag:r});return e({update:g,bar:t,thumb:a}),(h,m)=>(b(),F("div",{class:B(p(n))},[S("div",{ref_key:"bar",ref:t,class:B(p(l)),style:ae(p(u)),onClick:m[0]||(m[0]=(...f)=>p(i)&&p(i)(...f))},null,6),S("div",{ref_key:"thumb",ref:a,class:B(p(c)),style:ae(p(d))},null,6)],2))}});var zl=ve(Hl,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const _l=U({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(s){const e=ue("color-hue-slider"),o=Je(),t=T(),a=T(),r=T(0),i=T(0),n=C(()=>s.color.get("hue"));X(()=>n.value,()=>{g()});function l(h){h.target!==t.value&&u(h)}function u(h){if(!a.value||!t.value)return;const f=o.vnode.el.getBoundingClientRect(),{clientX:x,clientY:M}=Js(h);let N;if(s.vertical){let P=M-f.top;P=Math.min(P,f.height-t.value.offsetHeight/2),P=Math.max(t.value.offsetHeight/2,P),N=Math.round((P-t.value.offsetHeight/2)/(f.height-t.value.offsetHeight)*360)}else{let P=x-f.left;P=Math.min(P,f.width-t.value.offsetWidth/2),P=Math.max(t.value.offsetWidth/2,P),N=Math.round((P-t.value.offsetWidth/2)/(f.width-t.value.offsetWidth)*360)}s.color.set("hue",N)}function c(){if(!t.value)return 0;const h=o.vnode.el;if(s.vertical)return 0;const m=s.color.get("hue");return h?Math.round(m*(h.offsetWidth-t.value.offsetWidth/2)/360):0}function d(){if(!t.value)return 0;const h=o.vnode.el;if(!s.vertical)return 0;const m=s.color.get("hue");return h?Math.round(m*(h.offsetHeight-t.value.offsetHeight/2)/360):0}function g(){r.value=c(),i.value=d()}return me(()=>{if(!a.value||!t.value)return;const h={drag:m=>{u(m)},end:m=>{u(m)}};It(a.value,h),It(t.value,h),g()}),{bar:a,thumb:t,thumbLeft:r,thumbTop:i,hueValue:n,handleClick:l,update:g,ns:e}}});function Vl(s,e,o,t,a,r){return b(),F("div",{class:B([s.ns.b(),s.ns.is("vertical",s.vertical)])},[S("div",{ref:"bar",class:B(s.ns.e("bar")),onClick:e[0]||(e[0]=(...i)=>s.handleClick&&s.handleClick(...i))},null,2),S("div",{ref:"thumb",class:B(s.ns.e("thumb")),style:ae({left:s.thumbLeft+"px",top:s.thumbTop+"px"})},null,6)],2)}var Wl=ve(_l,[["render",Vl],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const Kl=Ue({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:hi,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:Ke(Array)},validateEvent:{type:Boolean,default:!0}}),kl={[ye]:s=>nt(s)||hs(s),[Zs]:s=>nt(s)||hs(s),activeChange:s=>nt(s)||hs(s)},Li=Symbol("colorPickerContextKey"),Eo=function(s,e,o){return[s,e*o/((s=(2-e)*o)<1?s:2-s)||0,s/2]},Ul=function(s){return typeof s=="string"&&s.includes(".")&&Number.parseFloat(s)===1},ql=function(s){return typeof s=="string"&&s.includes("%")},Dt=function(s,e){Ul(s)&&(s="100%");const o=ql(s);return s=Math.min(e,Math.max(0,Number.parseFloat(`${s}`))),o&&(s=Number.parseInt(`${s*e}`,10)/100),Math.abs(s-e)<1e-6?1:s%e/Number.parseFloat(e)},Fo={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},gs=s=>{s=Math.min(Math.round(s),255);const e=Math.floor(s/16),o=s%16;return`${Fo[e]||e}${Fo[o]||o}`},Ro=function({r:s,g:e,b:o}){return Number.isNaN(+s)||Number.isNaN(+e)||Number.isNaN(+o)?"":`#${gs(s)}${gs(e)}${gs(o)}`},As={A:10,B:11,C:12,D:13,E:14,F:15},mt=function(s){return s.length===2?(As[s[0].toUpperCase()]||+s[0])*16+(As[s[1].toUpperCase()]||+s[1]):As[s[1].toUpperCase()]||+s[1]},Yl=function(s,e,o){e=e/100,o=o/100;let t=e;const a=Math.max(o,.01);o*=2,e*=o<=1?o:2-o,t*=a<=1?a:2-a;const r=(o+e)/2,i=o===0?2*t/(a+t):2*e/(o+e);return{h:s,s:i*100,v:r*100}},Lo=(s,e,o)=>{s=Dt(s,255),e=Dt(e,255),o=Dt(o,255);const t=Math.max(s,e,o),a=Math.min(s,e,o);let r;const i=t,n=t-a,l=t===0?0:n/t;if(t===a)r=0;else{switch(t){case s:{r=(e-o)/n+(e<o?6:0);break}case e:{r=(o-s)/n+2;break}case o:{r=(s-e)/n+4;break}}r/=6}return{h:r*360,s:l*100,v:i*100}},kt=function(s,e,o){s=Dt(s,360)*6,e=Dt(e,100),o=Dt(o,100);const t=Math.floor(s),a=s-t,r=o*(1-e),i=o*(1-a*e),n=o*(1-(1-a)*e),l=t%6,u=[o,i,r,r,n,o][l],c=[n,o,o,i,r,r][l],d=[r,r,n,o,o,i][l];return{r:Math.round(u*255),g:Math.round(c*255),b:Math.round(d*255)}};class Gt{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in e)ro(e,o)&&(this[o]=e[o]);e.value?this.fromString(e.value):this.doOnChange()}set(e,o){if(arguments.length===1&&typeof e=="object"){for(const t in e)ro(e,t)&&this.set(t,e[t]);return}this[`_${e}`]=o,this.doOnChange()}get(e){return e==="alpha"?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return kt(this._hue,this._saturation,this._value)}fromString(e){if(!e){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(t,a,r)=>{this._hue=Math.max(0,Math.min(360,t)),this._saturation=Math.max(0,Math.min(100,a)),this._value=Math.max(0,Math.min(100,r)),this.doOnChange()};if(e.includes("hsl")){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,r)=>r>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:r,v:i}=Yl(t[0],t[1],t[2]);o(a,r,i)}}else if(e.includes("hsv")){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,r)=>r>2?Number.parseFloat(a):Number.parseInt(a,10));t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3&&o(t[0],t[1],t[2])}else if(e.includes("rgb")){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(a=>a!=="").map((a,r)=>r>2?Number.parseFloat(a):Number.parseInt(a,10));if(t.length===4?this._alpha=Number.parseFloat(t[3])*100:t.length===3&&(this._alpha=100),t.length>=3){const{h:a,s:r,v:i}=Lo(t[0],t[1],t[2]);o(a,r,i)}}else if(e.includes("#")){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return;let a,r,i;t.length===3?(a=mt(t[0]+t[0]),r=mt(t[1]+t[1]),i=mt(t[2]+t[2])):(t.length===6||t.length===8)&&(a=mt(t.slice(0,2)),r=mt(t.slice(2,4)),i=mt(t.slice(4,6))),t.length===8?this._alpha=mt(t.slice(6))/255*100:(t.length===3||t.length===6)&&(this._alpha=100);const{h:n,s:l,v:u}=Lo(a,r,i);o(n,l,u)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:o,_value:t,_alpha:a,format:r}=this;if(this.enableAlpha)switch(r){case"hsl":{const i=Eo(e,o/100,t/100);this.value=`hsla(${e}, ${Math.round(i[1]*100)}%, ${Math.round(i[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${e}, ${Math.round(o)}%, ${Math.round(t)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${Ro(kt(e,o,t))}${gs(a*255/100)}`;break}default:{const{r:i,g:n,b:l}=kt(e,o,t);this.value=`rgba(${i}, ${n}, ${l}, ${this.get("alpha")/100})`}}else switch(r){case"hsl":{const i=Eo(e,o/100,t/100);this.value=`hsl(${e}, ${Math.round(i[1]*100)}%, ${Math.round(i[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${e}, ${Math.round(o)}%, ${Math.round(t)}%)`;break}case"rgb":{const{r:i,g:n,b:l}=kt(e,o,t);this.value=`rgb(${i}, ${n}, ${l})`;break}default:this.value=Ro(kt(e,o,t))}}}const Gl=U({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(s){const e=ue("color-predefine"),{currentColor:o}=dt(Li),t=T(r(s.colors,s.color));X(()=>o.value,i=>{const n=new Gt;n.fromString(i),t.value.forEach(l=>{l.selected=n.compare(l)})}),jo(()=>{t.value=r(s.colors,s.color)});function a(i){s.color.fromString(s.colors[i])}function r(i,n){return i.map(l=>{const u=new Gt;return u.enableAlpha=!0,u.format="rgba",u.fromString(l),u.selected=u.value===n.value,u})}return{rgbaColors:t,handleSelect:a,ns:e}}}),Xl=["onClick"];function Ql(s,e,o,t,a,r){return b(),F("div",{class:B(s.ns.b())},[S("div",{class:B(s.ns.e("colors"))},[(b(!0),F(Ve,null,Yt(s.rgbaColors,(i,n)=>(b(),F("div",{key:s.colors[n],class:B([s.ns.e("color-selector"),s.ns.is("alpha",i._alpha<100),{selected:i.selected}]),onClick:l=>s.handleSelect(n)},[S("div",{style:ae({backgroundColor:i.value})},null,4)],10,Xl))),128))],2)],2)}var Zl=ve(Gl,[["render",Ql],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const Jl=U({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(s){const e=ue("color-svpanel"),o=Je(),t=T(0),a=T(0),r=T("hsl(0, 100%, 50%)"),i=C(()=>{const u=s.color.get("hue"),c=s.color.get("value");return{hue:u,value:c}});function n(){const u=s.color.get("saturation"),c=s.color.get("value"),d=o.vnode.el,{clientWidth:g,clientHeight:h}=d;a.value=u*g/100,t.value=(100-c)*h/100,r.value=`hsl(${s.color.get("hue")}, 100%, 50%)`}function l(u){const d=o.vnode.el.getBoundingClientRect(),{clientX:g,clientY:h}=Js(u);let m=g-d.left,f=h-d.top;m=Math.max(0,m),m=Math.min(m,d.width),f=Math.max(0,f),f=Math.min(f,d.height),a.value=m,t.value=f,s.color.set({saturation:m/d.width*100,value:100-f/d.height*100})}return X(()=>i.value,()=>{n()}),me(()=>{It(o.vnode.el,{drag:u=>{l(u)},end:u=>{l(u)}}),n()}),{cursorTop:t,cursorLeft:a,background:r,colorValue:i,handleDrag:l,update:n,ns:e}}}),Il=S("div",null,null,-1),jl=[Il];function ed(s,e,o,t,a,r){return b(),F("div",{class:B(s.ns.b()),style:ae({backgroundColor:s.background})},[S("div",{class:B(s.ns.e("white"))},null,2),S("div",{class:B(s.ns.e("black"))},null,2),S("div",{class:B(s.ns.e("cursor")),style:ae({top:s.cursorTop+"px",left:s.cursorLeft+"px"})},jl,6)],6)}var td=ve(Jl,[["render",ed],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const sd=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],od=U({name:"ElColorPicker"}),id=U({...od,props:Kl,emits:kl,setup(s,{expose:e,emit:o}){const t=s,{t:a}=ts(),r=ue("color"),{formItem:i}=Xs(),n=Qs(),l=fi(),{inputId:u,isLabeledByFormItem:c}=pi(t,{formItemContext:i}),d=T(),g=T(),h=T(),m=T();let f=!0;const x=Mt(new Gt({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue})),M=T(!1),N=T(!1),P=T(""),q=C(()=>!t.modelValue&&!N.value?"transparent":k(x,t.showAlpha)),Q=C(()=>!t.modelValue&&!N.value?"":x.value),A=C(()=>c.value?void 0:t.label||a("el.colorpicker.defaultLabel")),E=C(()=>c.value?i==null?void 0:i.labelId:void 0),H=C(()=>[r.b("picker"),r.is("disabled",l.value),r.bm("picker",n.value)]);function k(O,ie){if(!(O instanceof Gt))throw new TypeError("color should be instance of _color Class");const{r:Ne,g:Ie,b:je}=O.toRgb();return ie?`rgba(${Ne}, ${Ie}, ${je}, ${O.get("alpha")/100})`:`rgb(${Ne}, ${Ie}, ${je})`}function L(O){M.value=O}const W=_s(L,100);function ee(){l.value||L(!0)}function Be(){W(!1),I()}function I(){Y(()=>{t.modelValue?x.fromString(t.modelValue):(x.value="",Y(()=>{N.value=!1}))})}function pe(){l.value||W(!M.value)}function j(){x.fromString(P.value)}function xe(){const O=x.value;o(ye,O),o("change",O),t.validateEvent&&(i==null||i.validate("change").catch(ie=>Jt())),W(!1),Y(()=>{const ie=new Gt({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue});x.compare(ie)||I()})}function He(){W(!1),o(ye,null),o("change",null),t.modelValue!==null&&t.validateEvent&&(i==null||i.validate("change").catch(O=>Jt())),I()}return me(()=>{t.modelValue&&(P.value=Q.value)}),X(()=>t.modelValue,O=>{O?O&&O!==x.value&&(f=!1,x.fromString(O)):N.value=!1}),X(()=>Q.value,O=>{P.value=O,f&&o("activeChange",O),f=!0}),X(()=>x.value,()=>{!t.modelValue&&!N.value&&(N.value=!0)}),X(()=>M.value,()=>{Y(()=>{var O,ie,Ne;(O=d.value)==null||O.update(),(ie=g.value)==null||ie.update(),(Ne=h.value)==null||Ne.update()})}),es(Li,{currentColor:Q}),e({color:x,show:ee,hide:Be}),(O,ie)=>(b(),V(p(xi),{ref_key:"popper",ref:m,visible:M.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[p(r).be("picker","panel"),p(r).b("dropdown"),O.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${p(r).namespace.value}-zoom-in-top`,persistent:""},{content:$(()=>[We((b(),F("div",null,[S("div",{class:B(p(r).be("dropdown","main-wrapper"))},[D(Wl,{ref_key:"hue",ref:d,class:"hue-slider",color:p(x),vertical:""},null,8,["color"]),D(td,{ref:"svPanel",color:p(x)},null,8,["color"])],2),O.showAlpha?(b(),V(zl,{key:0,ref_key:"alpha",ref:h,color:p(x)},null,8,["color"])):_("v-if",!0),O.predefine?(b(),V(Zl,{key:1,ref:"predefine",color:p(x),colors:O.predefine},null,8,["color","colors"])):_("v-if",!0),S("div",{class:B(p(r).be("dropdown","btns"))},[S("span",{class:B(p(r).be("dropdown","value"))},[D(p(Fi),{modelValue:P.value,"onUpdate:modelValue":ie[0]||(ie[0]=Ne=>P.value=Ne),"validate-event":!1,size:"small",onKeyup:Se(j,["enter"]),onBlur:j},null,8,["modelValue","onKeyup"])],2),D(p(Me),{class:B(p(r).be("dropdown","link-btn")),text:"",size:"small",onClick:He},{default:$(()=>[ao(we(p(a)("el.colorpicker.clear")),1)]),_:1},8,["class"]),D(p(Me),{plain:"",size:"small",class:B(p(r).be("dropdown","btn")),onClick:xe},{default:$(()=>[ao(we(p(a)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[p(mi),Be]])]),default:$(()=>[S("div",{id:p(u),class:B(p(H)),role:"button","aria-label":p(A),"aria-labelledby":p(E),"aria-description":p(a)("el.colorpicker.description",{color:O.modelValue||""}),tabindex:O.tabindex,onKeydown:Se(pe,["enter"])},[p(l)?(b(),F("div",{key:0,class:B(p(r).be("picker","mask"))},null,2)):_("v-if",!0),S("div",{class:B(p(r).be("picker","trigger")),onClick:pe},[S("span",{class:B([p(r).be("picker","color"),p(r).is("alpha",O.showAlpha)])},[S("span",{class:B(p(r).be("picker","color-inner")),style:ae({backgroundColor:p(q)})},[We(D(p(Qe),{class:B([p(r).be("picker","icon"),p(r).is("icon-arrow-down")])},{default:$(()=>[D(p(vi))]),_:1},8,["class"]),[[Nt,O.modelValue||N.value]]),!O.modelValue&&!N.value?(b(),V(p(Qe),{key:0,class:B([p(r).be("picker","empty"),p(r).is("icon-close")])},{default:$(()=>[D(p(Tr))]),_:1},8,["class"])):_("v-if",!0)],6)],2)],2)],42,sd)]),_:1},8,["visible","popper-class","transition"]))}});var rd=ve(id,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const Os=At(rd),ad=Ue({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:Ke([String,Array,Object])},zIndex:{type:Ke([String,Number])}}),nd={click:s=>s instanceof MouseEvent},ld="overlay";var dd=U({name:"ElOverlay",props:ad,emits:nd,setup(s,{slots:e,emit:o}){const t=ue(ld),a=l=>{o("click",l)},{onClick:r,onMousedown:i,onMouseup:n}=Ei(s.customMaskEvent?void 0:a);return()=>s.mask?D("div",{class:[t.b(),s.overlayClass],style:{zIndex:s.zIndex},onClick:r,onMousedown:i,onMouseup:n},[oe(e,"default")],fs.STYLE|fs.CLASS|fs.PROPS,["onClick","onMouseup","onMousedown"]):Zi("div",{class:s.overlayClass,style:{zIndex:s.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[oe(e,"default")])}});const ud=dd,$i=Symbol("dialogInjectionKey"),Di=Ue({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:Zt},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),cd={close:()=>!0},hd=["aria-label"],pd=["id"],fd=U({name:"ElDialogContent"}),gd=U({...fd,props:Di,emits:cd,setup(s){const e=s,{t:o}=ts(),{Close:t}=Sr,{dialogRef:a,headerRef:r,bodyId:i,ns:n,style:l}=dt($i),{focusTrapRef:u}=dt(Pr),c=jn(u,a),d=C(()=>e.draggable);return il(a,r,d),(g,h)=>(b(),F("div",{ref:p(c),class:B([p(n).b(),p(n).is("fullscreen",g.fullscreen),p(n).is("draggable",p(d)),p(n).is("align-center",g.alignCenter),{[p(n).m("center")]:g.center},g.customClass]),style:ae(p(l)),tabindex:"-1"},[S("header",{ref_key:"headerRef",ref:r,class:B(p(n).e("header"))},[oe(g.$slots,"header",{},()=>[S("span",{role:"heading",class:B(p(n).e("title"))},we(g.title),3)]),g.showClose?(b(),F("button",{key:0,"aria-label":p(o)("el.dialog.close"),class:B(p(n).e("headerbtn")),type:"button",onClick:h[0]||(h[0]=m=>g.$emit("close"))},[D(p(Qe),{class:B(p(n).e("close"))},{default:$(()=>[(b(),V(rt(g.closeIcon||p(t))))]),_:1},8,["class"])],10,hd)):_("v-if",!0)],2),S("div",{id:p(i),class:B(p(n).e("body"))},[oe(g.$slots,"default")],10,pd),g.$slots.footer?(b(),F("footer",{key:0,class:B(p(n).e("footer"))},[oe(g.$slots,"footer")],2)):_("v-if",!0)],6))}});var yd=ve(gd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const md=Ue({...Di,appendToBody:{type:Boolean,default:!1},beforeClose:{type:Ke(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),vd={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ye]:s=>Er(s),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},xd=(s,e)=>{const t=Je().emit,{nextZIndex:a}=Fr();let r="";const i=uo(),n=uo(),l=T(!1),u=T(!1),c=T(!1),d=T(s.zIndex||a());let g,h;const m=Rr("namespace",Lr),f=C(()=>{const I={},pe=`--${m.value}-dialog`;return s.fullscreen||(s.top&&(I[`${pe}-margin-top`]=s.top),s.width&&(I[`${pe}-width`]=Ct(s.width))),I}),x=C(()=>s.alignCenter?{display:"flex"}:{});function M(){t("opened")}function N(){t("closed"),t(ye,!1),s.destroyOnClose&&(c.value=!1)}function P(){t("close")}function q(){h==null||h(),g==null||g(),s.openDelay&&s.openDelay>0?{stop:g}=co(()=>H(),s.openDelay):H()}function Q(){g==null||g(),h==null||h(),s.closeDelay&&s.closeDelay>0?{stop:h}=co(()=>k(),s.closeDelay):k()}function A(){function I(pe){pe||(u.value=!0,l.value=!1)}s.beforeClose?s.beforeClose(I):Q()}function E(){s.closeOnClickModal&&A()}function H(){ut&&(l.value=!0)}function k(){l.value=!1}function L(){t("openAutoFocus")}function W(){t("closeAutoFocus")}function ee(I){var pe;((pe=I.detail)==null?void 0:pe.focusReason)==="pointer"&&I.preventDefault()}s.lockScroll&&al(l);function Be(){s.closeOnPressEscape&&A()}return X(()=>s.modelValue,I=>{I?(u.value=!1,q(),c.value=!0,d.value=s.zIndex?d.value++:a(),Y(()=>{t("open"),e.value&&(e.value.scrollTop=0)})):l.value&&Q()}),X(()=>s.fullscreen,I=>{e.value&&(I?(r=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=r)}),me(()=>{s.modelValue&&(l.value=!0,c.value=!0,q())}),{afterEnter:M,afterLeave:N,beforeLeave:P,handleClose:A,onModalClick:E,close:Q,doClose:k,onOpenAutoFocus:L,onCloseAutoFocus:W,onCloseRequested:Be,onFocusoutPrevented:ee,titleId:i,bodyId:n,closed:u,style:f,overlayDialogStyle:x,rendered:c,visible:l,zIndex:d}},bd=["aria-label","aria-labelledby","aria-describedby"],wd=U({name:"ElDialog",inheritAttrs:!1}),Cd=U({...wd,props:md,emits:vd,setup(s,{expose:e}){const o=s,t=ti();Vs({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},C(()=>!!t.title)),Vs({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},C(()=>!!o.customClass));const a=ue("dialog"),r=T(),i=T(),n=T(),{visible:l,titleId:u,bodyId:c,style:d,overlayDialogStyle:g,rendered:h,zIndex:m,afterEnter:f,afterLeave:x,beforeLeave:M,handleClose:N,onModalClick:P,onOpenAutoFocus:q,onCloseAutoFocus:Q,onCloseRequested:A,onFocusoutPrevented:E}=xd(o,r);es($i,{dialogRef:r,headerRef:i,bodyId:c,ns:a,rendered:h,style:d});const H=Ei(P),k=C(()=>o.draggable&&!o.fullscreen);return e({visible:l,dialogContentRef:n}),(L,W)=>(b(),V(Ji,{to:"body",disabled:!L.appendToBody},[D(ys,{name:"dialog-fade",onAfterEnter:p(f),onAfterLeave:p(x),onBeforeLeave:p(M),persisted:""},{default:$(()=>[We(D(p(ud),{"custom-mask-event":"",mask:L.modal,"overlay-class":L.modalClass,"z-index":p(m)},{default:$(()=>[S("div",{role:"dialog","aria-modal":"true","aria-label":L.title||void 0,"aria-labelledby":L.title?void 0:p(u),"aria-describedby":p(c),class:B(`${p(a).namespace.value}-overlay-dialog`),style:ae(p(g)),onClick:W[0]||(W[0]=(...ee)=>p(H).onClick&&p(H).onClick(...ee)),onMousedown:W[1]||(W[1]=(...ee)=>p(H).onMousedown&&p(H).onMousedown(...ee)),onMouseup:W[2]||(W[2]=(...ee)=>p(H).onMouseup&&p(H).onMouseup(...ee))},[D(p($r),{loop:"",trapped:p(l),"focus-start-el":"container",onFocusAfterTrapped:p(q),onFocusAfterReleased:p(Q),onFocusoutPrevented:p(E),onReleaseRequested:p(A)},{default:$(()=>[p(h)?(b(),V(yd,cs({key:0,ref_key:"dialogContentRef",ref:n},L.$attrs,{"custom-class":L.customClass,center:L.center,"align-center":L.alignCenter,"close-icon":L.closeIcon,draggable:p(k),fullscreen:L.fullscreen,"show-close":L.showClose,title:L.title,onClose:p(N)}),si({header:$(()=>[L.$slots.title?oe(L.$slots,"title",{key:1}):oe(L.$slots,"header",{key:0,close:p(N),titleId:p(u),titleClass:p(a).e("title")})]),default:$(()=>[oe(L.$slots,"default")]),_:2},[L.$slots.footer?{name:"footer",fn:$(()=>[oe(L.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):_("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,bd)]),_:3},8,["mask","overlay-class","z-index"]),[[Nt,p(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var Bd=ve(Cd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const Nd=At(Bd),Md=Ue({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Ke(String),default:"solid"}}),Td=U({name:"ElDivider"}),Pd=U({...Td,props:Md,setup(s){const e=s,o=ue("divider"),t=C(()=>o.cssVar({"border-style":e.borderStyle}));return(a,r)=>(b(),F("div",{class:B([p(o).b(),p(o).m(a.direction)]),style:ae(p(t)),role:"separator"},[a.$slots.default&&a.direction!=="vertical"?(b(),F("div",{key:0,class:B([p(o).e("text"),p(o).is(a.contentPosition)])},[oe(a.$slots,"default")],2)):_("v-if",!0)],6))}});var Sd=ve(Pd,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const Ut=At(Sd),Ai=Symbol("ElSelectGroup"),Bs=Symbol("ElSelect");function Ed(s,e){const o=dt(Bs),t=dt(Ai,{disabled:!1}),a=C(()=>Object.prototype.toString.call(s.value).toLowerCase()==="[object object]"),r=C(()=>o.props.multiple?d(o.props.modelValue,s.value):g(s.value,o.props.modelValue)),i=C(()=>{if(o.props.multiple){const f=o.props.modelValue||[];return!r.value&&f.length>=o.props.multipleLimit&&o.props.multipleLimit>0}else return!1}),n=C(()=>s.label||(a.value?"":s.value)),l=C(()=>s.value||s.label||""),u=C(()=>s.disabled||e.groupDisabled||i.value),c=Je(),d=(f=[],x)=>{if(a.value){const M=o.props.valueKey;return f&&f.some(N=>ms(Oe(N,M))===Oe(x,M))}else return f&&f.includes(x)},g=(f,x)=>{if(a.value){const{valueKey:M}=o.props;return Oe(f,M)===Oe(x,M)}else return f===x},h=()=>{!s.disabled&&!t.disabled&&(o.hoverIndex=o.optionsArray.indexOf(c.proxy))};X(()=>n.value,()=>{!s.created&&!o.props.remote&&o.setSelected()}),X(()=>s.value,(f,x)=>{const{remote:M,valueKey:N}=o.props;if(Object.is(f,x)||(o.onOptionDestroy(x,c.proxy),o.onOptionCreate(c.proxy)),!s.created&&!M){if(N&&typeof f=="object"&&typeof x=="object"&&f[N]===x[N])return;o.setSelected()}}),X(()=>t.disabled,()=>{e.groupDisabled=t.disabled},{immediate:!0});const{queryChange:m}=ms(o);return X(m,f=>{const{query:x}=p(f),M=new RegExp(Dr(x),"i");e.visible=M.test(n.value)||s.created,e.visible||o.filteredOptionsCount--},{immediate:!0}),{select:o,currentLabel:n,currentValue:l,itemSelected:r,isDisabled:u,hoverItem:h}}const Fd=U({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(s){const e=ue("select"),o=Mt({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:t,itemSelected:a,isDisabled:r,select:i,hoverItem:n}=Ed(s,o),{visible:l,hover:u}=ks(o),c=Je().proxy;i.onOptionCreate(c),jt(()=>{const g=c.value,{selected:h}=i,f=(i.props.multiple?h:[h]).some(x=>x.value===c.value);Y(()=>{i.cachedOptions.get(g)===c&&!f&&i.cachedOptions.delete(g)}),i.onOptionDestroy(g,c)});function d(){s.disabled!==!0&&o.groupDisabled!==!0&&i.handleOptionSelect(c,!0)}return{ns:e,currentLabel:t,itemSelected:a,isDisabled:r,select:i,hoverItem:n,visible:l,hover:u,selectOptionClick:d,states:o}}});function Rd(s,e,o,t,a,r){return We((b(),F("li",{class:B([s.ns.be("dropdown","item"),s.ns.is("disabled",s.isDisabled),{selected:s.itemSelected,hover:s.hover}]),onMouseenter:e[0]||(e[0]=(...i)=>s.hoverItem&&s.hoverItem(...i)),onClick:e[1]||(e[1]=Xe((...i)=>s.selectOptionClick&&s.selectOptionClick(...i),["stop"]))},[oe(s.$slots,"default",{},()=>[S("span",null,we(s.currentLabel),1)])],34)),[[Nt,s.visible]])}var to=ve(Fd,[["render",Rd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const Ld=U({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const s=dt(Bs),e=ue("select"),o=C(()=>s.props.popperClass),t=C(()=>s.props.multiple),a=C(()=>s.props.fitInputWidth),r=T("");function i(){var n;r.value=`${(n=s.selectWrapper)==null?void 0:n.offsetWidth}px`}return me(()=>{i(),ws(s.selectWrapper,i)}),{ns:e,minWidth:r,popperClass:o,isMultiple:t,isFitInputWidth:a}}});function $d(s,e,o,t,a,r){return b(),F("div",{class:B([s.ns.b("dropdown"),s.ns.is("multiple",s.isMultiple),s.popperClass]),style:ae({[s.isFitInputWidth?"width":"minWidth"]:s.minWidth})},[oe(s.$slots,"default")],6)}var Dd=ve(Ld,[["render",$d],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function Ad(s){const{t:e}=ts();return Mt({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:s.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:e("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1,mouseEnter:!1})}const Od=(s,e,o)=>{const{t}=ts(),a=ue("select");Vs({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},C(()=>s.suffixTransition===!1));const r=T(null),i=T(null),n=T(null),l=T(null),u=T(null),c=T(null),d=T(null),g=T(-1),h=wt({query:""}),m=wt(""),f=T([]);let x=0;const{form:M,formItem:N}=Xs(),P=C(()=>!s.filterable||s.multiple||!e.visible),q=C(()=>s.disabled||(M==null?void 0:M.disabled)),Q=C(()=>{const y=s.multiple?Array.isArray(s.modelValue)&&s.modelValue.length>0:s.modelValue!==void 0&&s.modelValue!==null&&s.modelValue!=="";return s.clearable&&!q.value&&e.inputHovering&&y}),A=C(()=>s.remote&&s.filterable&&!s.remoteShowSuffix?"":s.suffixIcon),E=C(()=>a.is("reverse",A.value&&e.visible&&s.suffixTransition)),H=C(()=>s.remote?300:0),k=C(()=>s.loading?s.loadingText||t("el.select.loading"):s.remote&&e.query===""&&e.options.size===0?!1:s.filterable&&e.query&&e.options.size>0&&e.filteredOptionsCount===0?s.noMatchText||t("el.select.noMatch"):e.options.size===0?s.noDataText||t("el.select.noData"):null),L=C(()=>{const y=Array.from(e.options.values()),v=[];return f.value.forEach(R=>{const z=y.findIndex(ne=>ne.currentLabel===R);z>-1&&v.push(y[z])}),v.length?v:y}),W=C(()=>Array.from(e.cachedOptions.values())),ee=C(()=>{const y=L.value.filter(v=>!v.created).some(v=>v.currentLabel===e.query);return s.filterable&&s.allowCreate&&e.query!==""&&!y}),Be=Qs(),I=C(()=>["small"].includes(Be.value)?"small":"default"),pe=C({get(){return e.visible&&k.value!==!1},set(y){e.visible=y}});X([()=>q.value,()=>Be.value,()=>M==null?void 0:M.size],()=>{Y(()=>{j()})}),X(()=>s.placeholder,y=>{e.cachedPlaceHolder=e.currentPlaceholder=y}),X(()=>s.modelValue,(y,v)=>{s.multiple&&(j(),y&&y.length>0||i.value&&e.query!==""?e.currentPlaceholder="":e.currentPlaceholder=e.cachedPlaceHolder,s.filterable&&!s.reserveKeyword&&(e.query="",xe(e.query))),ie(),s.filterable&&!s.multiple&&(e.inputLength=20),!ho(y,v)&&s.validateEvent&&(N==null||N.validate("change").catch(R=>Jt()))},{flush:"post",deep:!0}),X(()=>e.visible,y=>{var v,R,z,ne,fe;y?((R=(v=l.value)==null?void 0:v.updatePopper)==null||R.call(v),s.filterable&&(e.filteredOptionsCount=e.optionsCount,e.query=s.remote?"":e.selectedLabel,(ne=(z=n.value)==null?void 0:z.focus)==null||ne.call(z),s.multiple?(fe=i.value)==null||fe.focus():e.selectedLabel&&(e.currentPlaceholder=`${e.selectedLabel}`,e.selectedLabel=""),xe(e.query),!s.multiple&&!s.remote&&(h.value.query="",Kt(h),Kt(m)))):(s.filterable&&(ot(s.filterMethod)&&s.filterMethod(""),ot(s.remoteMethod)&&s.remoteMethod("")),i.value&&i.value.blur(),e.query="",e.previousQuery=null,e.selectedLabel="",e.inputLength=20,e.menuVisibleOnFocus=!1,Ie(),Y(()=>{i.value&&i.value.value===""&&e.selected.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}),s.multiple||(e.selected&&(s.filterable&&s.allowCreate&&e.createdSelected&&e.createdLabel?e.selectedLabel=e.createdLabel:e.selectedLabel=e.selected.currentLabel,s.filterable&&(e.query=e.selectedLabel)),s.filterable&&(e.currentPlaceholder=e.cachedPlaceHolder))),o.emit("visible-change",y)}),X(()=>e.options.entries(),()=>{var y,v,R;if(!ut)return;(v=(y=l.value)==null?void 0:y.updatePopper)==null||v.call(y),s.multiple&&j();const z=((R=c.value)==null?void 0:R.querySelectorAll("input"))||[];Array.from(z).includes(document.activeElement)||ie(),s.defaultFirstOption&&(s.filterable||s.remote)&&e.filteredOptionsCount&&O()},{flush:"post"}),X(()=>e.hoverIndex,y=>{at(y)&&y>-1?g.value=L.value[y]||{}:g.value={},L.value.forEach(v=>{v.hover=g.value===v})});const j=()=>{Y(()=>{var y,v;if(!r.value)return;const R=r.value.$el.querySelector("input");x=x||(R.clientHeight>0?R.clientHeight+2:0);const z=u.value,ne=el(Be.value||(M==null?void 0:M.size)),fe=Be.value||ne===x||x<=0?ne:x;!(R.offsetParent===null)&&(R.style.height=`${(e.selected.length===0?fe:Math.max(z?z.clientHeight+(z.clientHeight>fe?6:0):0,fe))-2}px`),e.tagInMultiLine=Number.parseFloat(R.style.height)>=fe,e.visible&&k.value!==!1&&((v=(y=l.value)==null?void 0:y.updatePopper)==null||v.call(y))})},xe=async y=>{if(!(e.previousQuery===y||e.isOnComposition)){if(e.previousQuery===null&&(ot(s.filterMethod)||ot(s.remoteMethod))){e.previousQuery=y;return}e.previousQuery=y,Y(()=>{var v,R;e.visible&&((R=(v=l.value)==null?void 0:v.updatePopper)==null||R.call(v))}),e.hoverIndex=-1,s.multiple&&s.filterable&&Y(()=>{const v=i.value.value.length*15+20;e.inputLength=s.collapseTags?Math.min(50,v):v,He(),j()}),s.remote&&ot(s.remoteMethod)?(e.hoverIndex=-1,s.remoteMethod(y)):ot(s.filterMethod)?(s.filterMethod(y),Kt(m)):(e.filteredOptionsCount=e.optionsCount,h.value.query=y,Kt(h),Kt(m)),s.defaultFirstOption&&(s.filterable||s.remote)&&e.filteredOptionsCount&&(await Y(),O())}},He=()=>{e.currentPlaceholder!==""&&(e.currentPlaceholder=i.value.value?"":e.cachedPlaceHolder)},O=()=>{const y=L.value.filter(z=>z.visible&&!z.disabled&&!z.states.groupDisabled),v=y.find(z=>z.created),R=y[0];e.hoverIndex=ht(L.value,v||R)},ie=()=>{var y;if(s.multiple)e.selectedLabel="";else{const R=Ne(s.modelValue);(y=R.props)!=null&&y.created?(e.createdLabel=R.props.value,e.createdSelected=!0):e.createdSelected=!1,e.selectedLabel=R.currentLabel,e.selected=R,s.filterable&&(e.query=e.selectedLabel);return}const v=[];Array.isArray(s.modelValue)&&s.modelValue.forEach(R=>{v.push(Ne(R))}),e.selected=v,Y(()=>{j()})},Ne=y=>{let v;const R=Fs(y).toLowerCase()==="object",z=Fs(y).toLowerCase()==="null",ne=Fs(y).toLowerCase()==="undefined";for(let Ge=e.cachedOptions.size-1;Ge>=0;Ge--){const Ee=W.value[Ge];if(R?Oe(Ee.value,s.valueKey)===Oe(y,s.valueKey):Ee.value===y){v={value:y,currentLabel:Ee.currentLabel,isDisabled:Ee.isDisabled};break}}if(v)return v;const fe=R?y.label:!z&&!ne?y:"",Ye={value:y,currentLabel:fe};return s.multiple&&(Ye.hitState=!1),Ye},Ie=()=>{setTimeout(()=>{const y=s.valueKey;s.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map(v=>L.value.findIndex(R=>Oe(R,y)===Oe(v,y)))):e.hoverIndex=-1:e.hoverIndex=L.value.findIndex(v=>Rt(v)===Rt(e.selected))},300)},je=()=>{var y,v;Ot(),(v=(y=l.value)==null?void 0:y.updatePopper)==null||v.call(y),s.multiple&&j()},Ot=()=>{var y;e.inputWidth=(y=r.value)==null?void 0:y.$el.offsetWidth},qe=()=>{s.filterable&&e.query!==e.selectedLabel&&(e.query=e.selectedLabel,xe(e.query))},os=_s(()=>{qe()},H.value),Ht=_s(y=>{xe(y.target.value)},H.value),Te=y=>{ho(s.modelValue,y)||o.emit(Zs,y)},ze=y=>{if(y.code!==po.delete){if(y.target.value.length<=0&&!ft()){const v=s.modelValue.slice();v.pop(),o.emit(ye,v),Te(v)}y.target.value.length===1&&s.modelValue.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}},Pt=(y,v)=>{const R=e.selected.indexOf(v);if(R>-1&&!q.value){const z=s.modelValue.slice();z.splice(R,1),o.emit(ye,z),Te(z),o.emit("remove-tag",v.value)}y.stopPropagation()},ct=y=>{y.stopPropagation();const v=s.multiple?[]:"";if(!nt(v))for(const R of e.selected)R.isDisabled&&v.push(R.value);o.emit(ye,v),Te(v),e.hoverIndex=-1,e.visible=!1,o.emit("clear")},et=(y,v)=>{var R;if(s.multiple){const z=(s.modelValue||[]).slice(),ne=ht(z,y.value);ne>-1?z.splice(ne,1):(s.multipleLimit<=0||z.length<s.multipleLimit)&&z.push(y.value),o.emit(ye,z),Te(z),y.created&&(e.query="",xe(""),e.inputLength=20),s.filterable&&((R=i.value)==null||R.focus())}else o.emit(ye,y.value),Te(y.value),e.visible=!1;e.isSilentBlur=v,pt(),!e.visible&&Y(()=>{Le(y)})},ht=(y=[],v)=>{if(!Xt(v))return y.indexOf(v);const R=s.valueKey;let z=-1;return y.some((ne,fe)=>ms(Oe(ne,R))===Oe(v,R)?(z=fe,!0):!1),z},pt=()=>{e.softFocus=!0;const y=i.value||r.value;y&&(y==null||y.focus())},Le=y=>{var v,R,z,ne,fe;const Ye=Array.isArray(y)?y[0]:y;let Ge=null;if(Ye!=null&&Ye.value){const Ee=L.value.filter(Es=>Es.value===Ye.value);Ee.length>0&&(Ge=Ee[0].$el)}if(l.value&&Ge){const Ee=(ne=(z=(R=(v=l.value)==null?void 0:v.popperRef)==null?void 0:R.contentRef)==null?void 0:z.querySelector)==null?void 0:ne.call(z,`.${a.be("dropdown","wrap")}`);Ee&&In(Ee,Ge)}(fe=d.value)==null||fe.handleScroll()},zt=y=>{e.optionsCount++,e.filteredOptionsCount++,e.options.set(y.value,y),e.cachedOptions.set(y.value,y)},St=(y,v)=>{e.options.get(y)===v&&(e.optionsCount--,e.filteredOptionsCount--,e.options.delete(y))},Et=y=>{y.code!==po.backspace&&ft(!1),e.inputLength=i.value.value.length*15+20,j()},ft=y=>{if(!Array.isArray(e.selected))return;const v=e.selected[e.selected.length-1];if(v)return y===!0||y===!1?(v.hitState=y,y):(v.hitState=!v.hitState,v.hitState)},_t=y=>{const v=y.target.value;if(y.type==="compositionend")e.isOnComposition=!1,Y(()=>xe(v));else{const R=v[v.length-1]||"";e.isOnComposition=!yi(R)}},Ft=()=>{Y(()=>Le(e.selected))},Vt=y=>{e.softFocus?e.softFocus=!1:((s.automaticDropdown||s.filterable)&&(s.filterable&&!e.visible&&(e.menuVisibleOnFocus=!0),e.visible=!0),o.emit("focus",y))},$e=()=>{var y,v,R;e.visible=!1,(y=r.value)==null||y.blur(),(R=(v=n.value)==null?void 0:v.blur)==null||R.call(v)},w=y=>{Y(()=>{e.isSilentBlur?e.isSilentBlur=!1:o.emit("blur",y)}),e.softFocus=!1},K=y=>{ct(y)},be=()=>{e.visible=!1},tt=y=>{e.visible&&(y.preventDefault(),y.stopPropagation(),e.visible=!1)},gt=y=>{var v;y&&!e.mouseEnter||q.value||(e.menuVisibleOnFocus?e.menuVisibleOnFocus=!1:(!l.value||!l.value.isFocusInsideContent())&&(e.visible=!e.visible),e.visible&&((v=i.value||r.value)==null||v.focus()))},Ts=()=>{e.visible?L.value[e.hoverIndex]&&et(L.value[e.hoverIndex],void 0):gt()},Rt=y=>Xt(y.value)?Oe(y.value,s.valueKey):y.value,Ps=C(()=>L.value.filter(y=>y.visible).every(y=>y.disabled)),Ss=C(()=>e.selected.slice(0,s.maxCollapseTags)),Wt=C(()=>e.selected.slice(s.maxCollapseTags)),is=y=>{if(!e.visible){e.visible=!0;return}if(!(e.options.size===0||e.filteredOptionsCount===0)&&!e.isOnComposition&&!Ps.value){y==="next"?(e.hoverIndex++,e.hoverIndex===e.options.size&&(e.hoverIndex=0)):y==="prev"&&(e.hoverIndex--,e.hoverIndex<0&&(e.hoverIndex=e.options.size-1));const v=L.value[e.hoverIndex];(v.disabled===!0||v.states.groupDisabled===!0||!v.visible)&&is(y),Y(()=>Le(g.value))}};return{optionList:f,optionsArray:L,selectSize:Be,handleResize:je,debouncedOnInputChange:os,debouncedQueryChange:Ht,deletePrevTag:ze,deleteTag:Pt,deleteSelected:ct,handleOptionSelect:et,scrollToOption:Le,readonly:P,resetInputHeight:j,showClose:Q,iconComponent:A,iconReverse:E,showNewOption:ee,collapseTagSize:I,setSelected:ie,managePlaceholder:He,selectDisabled:q,emptyText:k,toggleLastOptionHitState:ft,resetInputState:Et,handleComposition:_t,onOptionCreate:zt,onOptionDestroy:St,handleMenuEnter:Ft,handleFocus:Vt,blur:$e,handleBlur:w,handleClearClick:K,handleClose:be,handleKeydownEscape:tt,toggleMenu:gt,selectOption:Ts,getValueKey:Rt,navigateOptions:is,dropMenuVisible:pe,queryChange:h,groupQueryChange:m,showTagList:Ss,collapseTagList:Wt,reference:r,input:i,iOSInput:n,tooltipRef:l,tags:u,selectWrapper:c,scrollbar:d,handleMouseEnter:()=>{e.mouseEnter=!0},handleMouseLeave:()=>{e.mouseEnter=!1}}};var Hd=U({name:"ElOptions",emits:["update-options"],setup(s,{slots:e,emit:o}){let t=[];function a(r,i){if(r.length!==i.length)return!1;for(const[n]of r.entries())if(r[n]!=i[n])return!1;return!0}return()=>{var r,i;const n=(r=e.default)==null?void 0:r.call(e),l=[];function u(c){Array.isArray(c)&&c.forEach(d=>{var g,h,m,f;const x=(g=(d==null?void 0:d.type)||{})==null?void 0:g.name;x==="ElOptionGroup"?u(!nt(d.children)&&!Array.isArray(d.children)&&ot((h=d.children)==null?void 0:h.default)?(m=d.children)==null?void 0:m.default():d.children):x==="ElOption"?l.push((f=d.props)==null?void 0:f.label):Array.isArray(d.children)&&u(d.children)})}return n.length&&u((i=n[0])==null?void 0:i.children),a(l,t)||(t=l,o("update-options",l)),n}}});const $o="ElSelect",zd=U({name:$o,componentName:$o,components:{ElInput:Fi,ElSelectMenu:Dd,ElOption:to,ElOptions:Hd,ElTag:Ar,ElScrollbar:Rl,ElTooltip:xi,ElIcon:Qe},directives:{ClickOutside:mi},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:Or},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},teleported:Hr.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Zt,default:gi},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:Zt,default:vi},tagType:{...zr.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:{type:Boolean,default:!1},suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:_r,default:"bottom-start"}},emits:[ye,Zs,"remove-tag","clear","visible-change","focus","blur"],setup(s,e){const o=ue("select"),t=ue("input"),{t:a}=ts(),r=Ad(s),{optionList:i,optionsArray:n,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:g,debouncedQueryChange:h,deletePrevTag:m,deleteTag:f,deleteSelected:x,handleOptionSelect:M,scrollToOption:N,setSelected:P,resetInputHeight:q,managePlaceholder:Q,showClose:A,selectDisabled:E,iconComponent:H,iconReverse:k,showNewOption:L,emptyText:W,toggleLastOptionHitState:ee,resetInputState:Be,handleComposition:I,onOptionCreate:pe,onOptionDestroy:j,handleMenuEnter:xe,handleFocus:He,blur:O,handleBlur:ie,handleClearClick:Ne,handleClose:Ie,handleKeydownEscape:je,toggleMenu:Ot,selectOption:qe,getValueKey:os,navigateOptions:Ht,dropMenuVisible:Te,reference:ze,input:Pt,iOSInput:ct,tooltipRef:et,tags:ht,selectWrapper:pt,scrollbar:Le,queryChange:zt,groupQueryChange:St,handleMouseEnter:Et,handleMouseLeave:ft,showTagList:_t,collapseTagList:Ft}=Od(s,r,e),{focus:Vt}=rl(ze),{inputWidth:$e,selected:w,inputLength:K,filteredOptionsCount:be,visible:tt,softFocus:gt,selectedLabel:Ts,hoverIndex:Rt,query:Ps,inputHovering:Ss,currentPlaceholder:Wt,menuVisibleOnFocus:is,isOnComposition:oo,isSilentBlur:io,options:y,cachedOptions:v,optionsCount:R,prefixWidth:z,tagInMultiLine:ne}=ks(r),fe=C(()=>{const Pe=[o.b()],yt=p(l);return yt&&Pe.push(o.m(yt)),s.disabled&&Pe.push(o.m("disabled")),Pe}),Ye=C(()=>({maxWidth:`${p($e)-32}px`,width:"100%"})),Ge=C(()=>({maxWidth:`${p($e)>123?p($e)-123:p($e)-75}px`}));es(Bs,Mt({props:s,options:y,optionsArray:n,cachedOptions:v,optionsCount:R,filteredOptionsCount:be,hoverIndex:Rt,handleOptionSelect:M,onOptionCreate:pe,onOptionDestroy:j,selectWrapper:pt,selected:w,setSelected:P,queryChange:zt,groupQueryChange:St})),me(()=>{r.cachedPlaceHolder=Wt.value=s.placeholder||(()=>a("el.select.placeholder")),s.multiple&&Array.isArray(s.modelValue)&&s.modelValue.length>0&&(Wt.value=""),ws(pt,c),s.remote&&s.multiple&&q(),Y(()=>{const Pe=ze.value&&ze.value.$el;if(Pe&&($e.value=Pe.getBoundingClientRect().width,e.slots.prefix)){const yt=Pe.querySelector(`.${t.e("prefix")}`);z.value=Math.max(yt.getBoundingClientRect().width+5,30)}}),P()}),s.multiple&&!Array.isArray(s.modelValue)&&e.emit(ye,[]),!s.multiple&&Array.isArray(s.modelValue)&&e.emit(ye,"");const Ee=C(()=>{var Pe,yt;return(yt=(Pe=et.value)==null?void 0:Pe.popperRef)==null?void 0:yt.contentRef});return{isIOS:Vr,onOptionsRendered:Pe=>{i.value=Pe},tagInMultiLine:ne,prefixWidth:z,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:g,debouncedQueryChange:h,deletePrevTag:m,deleteTag:f,deleteSelected:x,handleOptionSelect:M,scrollToOption:N,inputWidth:$e,selected:w,inputLength:K,filteredOptionsCount:be,visible:tt,softFocus:gt,selectedLabel:Ts,hoverIndex:Rt,query:Ps,inputHovering:Ss,currentPlaceholder:Wt,menuVisibleOnFocus:is,isOnComposition:oo,isSilentBlur:io,options:y,resetInputHeight:q,managePlaceholder:Q,showClose:A,selectDisabled:E,iconComponent:H,iconReverse:k,showNewOption:L,emptyText:W,toggleLastOptionHitState:ee,resetInputState:Be,handleComposition:I,handleMenuEnter:xe,handleFocus:He,blur:O,handleBlur:ie,handleClearClick:Ne,handleClose:Ie,handleKeydownEscape:je,toggleMenu:Ot,selectOption:qe,getValueKey:os,navigateOptions:Ht,dropMenuVisible:Te,focus:Vt,reference:ze,input:Pt,iOSInput:ct,tooltipRef:et,popperPaneRef:Ee,tags:ht,selectWrapper:pt,scrollbar:Le,wrapperKls:fe,selectTagsStyle:Ye,nsSelect:o,tagTextStyle:Ge,handleMouseEnter:Et,handleMouseLeave:ft,showTagList:_t,collapseTagList:Ft}}}),_d=["disabled","autocomplete"],Vd=["disabled"],Wd={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function Kd(s,e,o,t,a,r){const i=st("el-tag"),n=st("el-tooltip"),l=st("el-icon"),u=st("el-input"),c=st("el-option"),d=st("el-options"),g=st("el-scrollbar"),h=st("el-select-menu"),m=Ii("click-outside");return We((b(),F("div",{ref:"selectWrapper",class:B(s.wrapperKls),onMouseenter:e[21]||(e[21]=(...f)=>s.handleMouseEnter&&s.handleMouseEnter(...f)),onMouseleave:e[22]||(e[22]=(...f)=>s.handleMouseLeave&&s.handleMouseLeave(...f)),onClick:e[23]||(e[23]=Xe((...f)=>s.toggleMenu&&s.toggleMenu(...f),["stop"]))},[D(n,{ref:"tooltipRef",visible:s.dropMenuVisible,placement:s.placement,teleported:s.teleported,"popper-class":[s.nsSelect.e("popper"),s.popperClass],"popper-options":s.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:s.effect,pure:"",trigger:"click",transition:`${s.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:s.persistent,onShow:s.handleMenuEnter},{default:$(()=>[S("div",{class:"select-trigger",onMouseenter:e[19]||(e[19]=f=>s.inputHovering=!0),onMouseleave:e[20]||(e[20]=f=>s.inputHovering=!1)},[s.multiple?(b(),F("div",{key:0,ref:"tags",class:B([s.nsSelect.e("tags"),s.nsSelect.is("disabled",s.selectDisabled)]),style:ae(s.selectTagsStyle)},[s.collapseTags&&s.selected.length?(b(),V(ys,{key:0,onAfterLeave:s.resetInputHeight},{default:$(()=>[S("span",{class:B([s.nsSelect.b("tags-wrapper"),{"has-prefix":s.prefixWidth&&s.selected.length}])},[(b(!0),F(Ve,null,Yt(s.showTagList,f=>(b(),V(i,{key:s.getValueKey(f),closable:!s.selectDisabled&&!f.isDisabled,size:s.collapseTagSize,hit:f.hitState,type:s.tagType,"disable-transitions":"",onClose:x=>s.deleteTag(x,f)},{default:$(()=>[S("span",{class:B(s.nsSelect.e("tags-text")),style:ae(s.tagTextStyle)},we(f.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),s.selected.length>s.maxCollapseTags?(b(),V(i,{key:0,closable:!1,size:s.collapseTagSize,type:s.tagType,"disable-transitions":""},{default:$(()=>[s.collapseTagsTooltip?(b(),V(n,{key:0,disabled:s.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:s.effect,placement:"bottom",teleported:s.teleported},{default:$(()=>[S("span",{class:B(s.nsSelect.e("tags-text"))},"+ "+we(s.selected.length-s.maxCollapseTags),3)]),content:$(()=>[S("div",{class:B(s.nsSelect.e("collapse-tags"))},[(b(!0),F(Ve,null,Yt(s.collapseTagList,f=>(b(),F("div",{key:s.getValueKey(f),class:B(s.nsSelect.e("collapse-tag"))},[D(i,{class:"in-tooltip",closable:!s.selectDisabled&&!f.isDisabled,size:s.collapseTagSize,hit:f.hitState,type:s.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:x=>s.deleteTag(x,f)},{default:$(()=>[S("span",{class:B(s.nsSelect.e("tags-text")),style:ae({maxWidth:s.inputWidth-75+"px"})},we(f.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(b(),F("span",{key:1,class:B(s.nsSelect.e("tags-text"))},"+ "+we(s.selected.length-s.maxCollapseTags),3))]),_:1},8,["size","type"])):_("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):_("v-if",!0),s.collapseTags?_("v-if",!0):(b(),V(ys,{key:1,onAfterLeave:s.resetInputHeight},{default:$(()=>[S("span",{class:B([s.nsSelect.b("tags-wrapper"),{"has-prefix":s.prefixWidth&&s.selected.length}])},[(b(!0),F(Ve,null,Yt(s.selected,f=>(b(),V(i,{key:s.getValueKey(f),closable:!s.selectDisabled&&!f.isDisabled,size:s.collapseTagSize,hit:f.hitState,type:s.tagType,"disable-transitions":"",onClose:x=>s.deleteTag(x,f)},{default:$(()=>[S("span",{class:B(s.nsSelect.e("tags-text")),style:ae({maxWidth:s.inputWidth-75+"px"})},we(f.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],2)]),_:1},8,["onAfterLeave"])),s.filterable?We((b(),F("input",{key:2,ref:"input","onUpdate:modelValue":e[0]||(e[0]=f=>s.query=f),type:"text",class:B([s.nsSelect.e("input"),s.nsSelect.is(s.selectSize),s.nsSelect.is("disabled",s.selectDisabled)]),disabled:s.selectDisabled,autocomplete:s.autocomplete,style:ae({marginLeft:s.prefixWidth&&!s.selected.length||s.tagInMultiLine?`${s.prefixWidth}px`:"",flexGrow:1,width:`${s.inputLength/(s.inputWidth-32)}%`,maxWidth:`${s.inputWidth-42}px`}),onFocus:e[1]||(e[1]=(...f)=>s.handleFocus&&s.handleFocus(...f)),onBlur:e[2]||(e[2]=(...f)=>s.handleBlur&&s.handleBlur(...f)),onKeyup:e[3]||(e[3]=(...f)=>s.managePlaceholder&&s.managePlaceholder(...f)),onKeydown:[e[4]||(e[4]=(...f)=>s.resetInputState&&s.resetInputState(...f)),e[5]||(e[5]=Se(Xe(f=>s.navigateOptions("next"),["prevent"]),["down"])),e[6]||(e[6]=Se(Xe(f=>s.navigateOptions("prev"),["prevent"]),["up"])),e[7]||(e[7]=Se((...f)=>s.handleKeydownEscape&&s.handleKeydownEscape(...f),["esc"])),e[8]||(e[8]=Se(Xe((...f)=>s.selectOption&&s.selectOption(...f),["stop","prevent"]),["enter"])),e[9]||(e[9]=Se((...f)=>s.deletePrevTag&&s.deletePrevTag(...f),["delete"])),e[10]||(e[10]=Se(f=>s.visible=!1,["tab"]))],onCompositionstart:e[11]||(e[11]=(...f)=>s.handleComposition&&s.handleComposition(...f)),onCompositionupdate:e[12]||(e[12]=(...f)=>s.handleComposition&&s.handleComposition(...f)),onCompositionend:e[13]||(e[13]=(...f)=>s.handleComposition&&s.handleComposition(...f)),onInput:e[14]||(e[14]=(...f)=>s.debouncedQueryChange&&s.debouncedQueryChange(...f))},null,46,_d)),[[ji,s.query]]):_("v-if",!0)],6)):_("v-if",!0),_(" fix: https://github.com/element-plus/element-plus/issues/11415 "),s.isIOS&&!s.multiple&&s.filterable&&s.readonly?(b(),F("input",{key:1,ref:"iOSInput",class:B([s.nsSelect.e("input"),s.nsSelect.is(s.selectSize),s.nsSelect.em("input","iOS")]),disabled:s.selectDisabled,type:"text"},null,10,Vd)):_("v-if",!0),D(u,{id:s.id,ref:"reference",modelValue:s.selectedLabel,"onUpdate:modelValue":e[15]||(e[15]=f=>s.selectedLabel=f),type:"text",placeholder:typeof s.currentPlaceholder=="function"?s.currentPlaceholder():s.currentPlaceholder,name:s.name,autocomplete:s.autocomplete,size:s.selectSize,disabled:s.selectDisabled,readonly:s.readonly,"validate-event":!1,class:B([s.nsSelect.is("focus",s.visible)]),tabindex:s.multiple&&s.filterable?-1:void 0,onFocus:s.handleFocus,onBlur:s.handleBlur,onInput:s.debouncedOnInputChange,onPaste:s.debouncedOnInputChange,onCompositionstart:s.handleComposition,onCompositionupdate:s.handleComposition,onCompositionend:s.handleComposition,onKeydown:[e[16]||(e[16]=Se(Xe(f=>s.navigateOptions("next"),["stop","prevent"]),["down"])),e[17]||(e[17]=Se(Xe(f=>s.navigateOptions("prev"),["stop","prevent"]),["up"])),Se(Xe(s.selectOption,["stop","prevent"]),["enter"]),Se(s.handleKeydownEscape,["esc"]),e[18]||(e[18]=Se(f=>s.visible=!1,["tab"]))]},si({suffix:$(()=>[s.iconComponent&&!s.showClose?(b(),V(l,{key:0,class:B([s.nsSelect.e("caret"),s.nsSelect.e("icon"),s.iconReverse])},{default:$(()=>[(b(),V(rt(s.iconComponent)))]),_:1},8,["class"])):_("v-if",!0),s.showClose&&s.clearIcon?(b(),V(l,{key:1,class:B([s.nsSelect.e("caret"),s.nsSelect.e("icon")]),onClick:s.handleClearClick},{default:$(()=>[(b(),V(rt(s.clearIcon)))]),_:1},8,["class","onClick"])):_("v-if",!0)]),_:2},[s.$slots.prefix?{name:"prefix",fn:$(()=>[S("div",Wd,[oe(s.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]),content:$(()=>[D(h,null,{default:$(()=>[We(D(g,{ref:"scrollbar",tag:"ul","wrap-class":s.nsSelect.be("dropdown","wrap"),"view-class":s.nsSelect.be("dropdown","list"),class:B([s.nsSelect.is("empty",!s.allowCreate&&!!s.query&&s.filteredOptionsCount===0)])},{default:$(()=>[s.showNewOption?(b(),V(c,{key:0,value:s.query,created:!0},null,8,["value"])):_("v-if",!0),D(d,{onUpdateOptions:s.onOptionsRendered},{default:$(()=>[oe(s.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["wrap-class","view-class","class"]),[[Nt,s.options.size>0&&!s.loading]]),s.emptyText&&(!s.allowCreate||s.loading||s.allowCreate&&s.options.size===0)?(b(),F(Ve,{key:0},[s.$slots.empty?oe(s.$slots,"empty",{key:0}):(b(),F("p",{key:1,class:B(s.nsSelect.be("dropdown","empty"))},we(s.emptyText),3))],64)):_("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[m,s.handleClose,s.popperPaneRef]])}var kd=ve(zd,[["render",Kd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const Ud=U({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(s){const e=ue("select"),o=T(!0),t=Je(),a=T([]);es(Ai,Mt({...ks(s)}));const r=dt(Bs);me(()=>{a.value=i(t.subTree)});const i=l=>{const u=[];return Array.isArray(l.children)&&l.children.forEach(c=>{var d;c.type&&c.type.name==="ElOption"&&c.component&&c.component.proxy?u.push(c.component.proxy):(d=c.children)!=null&&d.length&&u.push(...i(c))}),u},{groupQueryChange:n}=ms(r);return X(n,()=>{o.value=a.value.some(l=>l.visible===!0)},{flush:"post"}),{visible:o,ns:e}}});function qd(s,e,o,t,a,r){return We((b(),F("ul",{class:B(s.ns.be("group","wrap"))},[S("li",{class:B(s.ns.be("group","title"))},we(s.label),3),S("li",null,[S("ul",{class:B(s.ns.b("group"))},[oe(s.$slots,"default")],2)])],2)),[[Nt,s.visible]])}var Oi=ve(Ud,[["render",qd],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const Yd=At(kd,{Option:to,OptionGroup:Oi}),Gd=bi(to);bi(Oi);const Xd="L";function _e(){return((1+Math.random())*65536|0).toString(16).substring(1)}function bt(){return`${Xd}${_e()}${_e()}-${_e()}-${_e()}-${_e()}-${_e()}${_e()}${_e()}`}function Qd(s,e=!1){return e?s:`${s}-${_e()}${_e()}`}class Zd extends Tt{constructor(e,o){super(),this.x=0,this.y=0,this.w=20,this.h=14,this.fillStyle="#eeb174",this.strokeStyle="#333",this.ctx=e,this.analysisOptions(o)}analysisOptions(e){e.x&&(this.x=e.x),e.y&&(this.y=e.y),e.w&&(this.w=e.w),e.h&&(this.h=e.h),e.fillStyle&&(this.fillStyle=e.fillStyle),e.strokeStyle&&(this.strokeStyle=e.strokeStyle),e.tiggerFunc&&(this.tiggerFunc=e.tiggerFunc)}draw(){const{ctx:e,x:o,y:t,w:a,h:r,fillStyle:i,strokeStyle:n}=this;e.save(),e.fillStyle=i,e.strokeStyle=n,e.lineWidth=3,e.beginPath(),e.arc(o+a/2,t-3,a/3,0,Math.PI,!0),e.stroke(),e.drawRoundedRect(o,t,a,r,2,2,2,2,!0,!0,!1,!1),e.restore()}containsPoint(e,o=!1){var g;const{x:t,y:a,w:r,h:i}=this,{x:n,y:l}=e,u=this.getImageLines({tl:{x:t,y:a},tr:{x:t+r,y:a},bl:{x:t,y:a+i},br:{x:t+r,y:a+i}}),d=!!(this.findCrossPoints(n,l,u)%2);return d&&o&&((g=this.tiggerFunc)==null||g.call(this)),d}}const Jd=function(s){return s.length===4&&(s=s.slice(0,2)+s.slice(1,2)+s.slice(2,3)+s.slice(2,3)+s.slice(3,4)+s.slice(3,4)),"rgb("+parseInt("0x"+s.slice(1,3))+","+parseInt("0x"+s.slice(3,5))+","+parseInt("0x"+s.slice(5,7))+")"},Id=function(s){const o=(s.includes("rgb")?s:Jd(s)).replace(/rgb\(|rgba\(|\)/g,"").split(",");return .213*o[0]+.715*o[1]+.072*o[2]>255/2};class de extends Tt{constructor(e,o){super(),this.width=100,this.height=50,this.titleHeight=24,this.fontSize=12,this.padding=10,this.attrHeight=14,this.x=0,this.y=0,this.attributes=[],this.attributesPrimary=[],this.attributesPrimaryNon=[],this.expandAttrs=[],this.bdC="#000000",this.color="#000000",this.bgC="#FFFFFF",this.quotePrimaryKey=!1,this.physicalTables=!1,this.manualChange=!1,this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o,y:t,width:a,height:r,id:i,enName:n,cnName:l,type:u,attributes:c,bgC:d,bdC:g,quotePrimaryKey:h,physicalTables:m,manualChange:f}=e;Re(o)&&(this.x=o),Re(t)&&(this.y=t),i&&(this.id=i),n&&(this.enName=n),l&&(this.cnName=l),Re(a)&&(this.width=a),Re(r)&&(this.height=r),u&&(this.type=u),c&&(this.attributes=c,this.attributesPartition()),d&&(this.bgC=d),g&&(this.bdC=g),Rs(h)&&(this.quotePrimaryKey=h),Rs(m)&&(this.physicalTables=m),Rs(f)&&(this.manualChange=f)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){var f;const{x:o,y:t}=e,{x:a,y:r,width:i,height:n,attrHeight:l}=this,u=this.getImageLines({tl:{x:a,y:r},tr:{x:a+i,y:r},bl:{x:a,y:r+n},br:{x:a+i,y:r+n}});if(!!!(this.findCrossPoints(o,t,u)%2))return!1;const g=t-r-this.padding-(this.attributesPrimary.length?0:l),h=Math.floor(g/l);return((f=[...this.attributesPrimary,{},...this.attributesPrimaryNon][h])==null?void 0:f.id)??!0}draw(e){this.updateOptions(e),this.drawContainer(),this.drawTitle(),this.drawbody()}drawContainer(){const{ctx:e,x:o,y:t,width:a,height:r,type:i,bgC:n,bdC:l,quotePrimaryKey:u,physicalTables:c}=this;if(e.save(),e.strokeStyle=l,e.fillStyle=n,["exclusive","inclusive"].includes(i))e.beginPath(),e.arc(o+a/2,t+a/2,a/2,0,Math.PI,!0),e.closePath(),e.fill(),e.stroke(),i==="exclusive"&&(e.moveTo(o+12,t+6),e.lineTo(o+a-12,t+r-3),e.moveTo(o+a-12,t+6),e.lineTo(o+12,t+r-3),e.stroke());else{const d=u?4:0;e.drawRoundedRect(o,t,a,r,d,d,d,d,!0,!0,c,!0)}e.restore()}drawDataType(e,o,t){var n;const a=(n=e==null?void 0:e.replace(/\(.*\)/g,""))==null?void 0:n.toLocaleUpperCase();let r;a in Wr?r=Ls.get("date"):a in Kr?r=Ls.get("number"):a in kr&&(r=Ls.get("string"));const{ctx:i}=this;if(!r)return i.save(),i.fillStyle="#808080",i.fillText("?",o,t,this.fontSize),i.restore(),!1;i.drawImage(r,o,t,this.fontSize,this.fontSize)}drawTitle(){const{ctx:e,color:o,enName:t,width:a,x:r,y:i,titleHeight:n,fontSize:l,type:u}=this;["exclusive","inclusive"].includes(u)||(e.save(),e.font=`${l}px`,e.fillStyle=o,e.textAlign="left",e.textBaseline="top",e.fillText(e.fittingString(t,a-14),r,i-n),e.restore())}drawbody(){const{ctx:e,x:o,y:t,bgC:a,fontSize:r,padding:i,attrHeight:n,attributesPrimary:l,attributesPrimaryNon:u}=this;e.save(),e.font=`${r}px Arial`,e.fillStyle=Id(a)?"#000":"#fff",e.textAlign="left",e.textBaseline="top";const c=i+o;let d=t+i-n;for(let g=0;g<l.length;g++){const h=l[g];d=this.drawAttrRow(h,c,d)}d=this.drawSplitLine(d);for(let g=0;g<u.length;g++){const h=u[g];d=this.drawAttrRow(h,c,d)}e.restore()}drawAttrRow(e,o,t){var x;const{ctx:a,attrHeight:r,padding:i,fontSize:n,x:l,y:u,width:c,height:d}=this;if(t+=r,t+16>d+u)return;this.drawDataType(e.type,o,t);const g=Number(e.ifFk)?"(FK)":"",h=e.enName,m=a.fittingString(h+g,c-(o-l)-i-n);a.fillText(m,o+n,t);const f=o+a.measureText(m).width+n;if(this.drawIcons(e.icons,f,t),(x=e.children)!=null&&x.length){const M=this.expandAttrs.includes(e);this.drawTreeExpandArrow.call(this,{x:o,y:t,size:n,expand:M}),M&&e.children.forEach(N=>{t=this.drawAttrRow(N,o+10,t)})}return t}drawIcons(e=[],o,t){const{fontSize:a,x:r,width:i,padding:n}=this;for(let l=0;l<e.length;l++){const u=e[l],c=o+a*.7+l*(a*1.2);if(c+a/2*3>r+i+n)return;this.drawIcon(u,c,t)}}drawIcon(e,o,t){const{ctx:a,attrHeight:r,fontSize:i}=this;a.save(),a.beginPath(),a.strokeStyle=e.bdC||"#0C64EB",a.fillStyle=e.bgC||"#ECF5FF",a.arc(o,t+Math.floor(r/2)-1,i/2,0,2*Math.PI),a.fill(),a.stroke(),a.fillStyle=e.color||"#0C64EB",a.font=`${Math.ceil(i/1.2)}px Arial`,a.textAlign="center",a.fillText(e.text,o,t+(r-i)/2+1),a.restore()}drawSplitLine(e){const{ctx:o,attributesPrimary:t,attrHeight:a,x:r,y:i,width:n,height:l}=this;return e+=(t.length?1:2)*a,o.save(),e<l+i&&(o.beginPath(),o.strokeStyle="#000",o.moveTo(r+.5,e+a/3+.5),o.lineTo(r+n+.5,e+a/3+.5),o.stroke()),o.restore(),e}drawTreeExpandArrow({x:e,y:o,size:t,expand:a}){const{ctx:r}=this;r.save(),r.beginPath(),r.translate(e-4,o+t/2),a&&r.rotate(90*Math.PI/180),r.moveTo(-2,-4),r.lineTo(-2,4),r.lineTo(2,0),r.fill(),r.restore()}attributesPartition(){this.attributesPrimary=[],this.attributesPrimaryNon=[];const{attributes:e,attributesPrimary:o,attributesPrimaryNon:t}=this;for(let a=0;a<e.length;a++){const r=e[a];Number(r.ifPk)?o.push(r):t.push(r),r.id||(r.id=bt())}}getAttributeInfo(e){const{attributesPrimary:o,attributesPrimaryNon:t,x:a,y:r,width:i,height:n,padding:l,attrHeight:u}=this,c=[...o,{id:null},...t],d=c.findIndex(h=>h.id===e);return{x:a+l,y:r+l+(o.length?d:d+1)*u,width:i-2*l,height:u,info:c[d]}}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}class Ze extends Tt{constructor(e,o){super(),this.width=100,this.height=50,this.borderWidth=2,this.x=0,this.y=0,this.bdC="#000000",this.ctx=e,this.analysisOptions(o),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{x:o,y:t,width:a,height:r,id:i,bgC:n,bdC:l}=e;Re(o)&&(this.x=o),Re(t)&&(this.y=t),i&&(this.id=i),Re(a)&&(this.width=a),Re(r)&&(this.height=r),n&&(this.bgC=n),l&&(this.bdC=l)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:o,y:t}=e,{x:a,y:r,width:i,height:n}=this,l=this.getImageLines({tl:{x:a,y:r},tr:{x:a+i,y:r},bl:{x:a,y:r+n},br:{x:a+i,y:r+n}});return!!(this.findCrossPoints(o,t,l)%2)}draw(e){this.analysisOptions(e),this.drawRect()}drawRect(){const{ctx:e,x:o,y:t,width:a,height:r,bgC:i,bdC:n,borderWidth:l}=this;e.save(),e.lineWidth=l,e.strokeStyle=n||"#000000",e.fillStyle=i||"#ffffff",e.strokeRect(o,t,a,r),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}class lt extends Tt{constructor(e,o){super(),this.x=0,this.y=0,this.width=0,this.height=0,this.bdC="#0C64EB",this.textColor="#0C64EB",this.bgC="#D0E2FF",this.borderWidth=1,this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o,y:t,id:a,bdC:r,textColor:i,bgC:n,borderWidth:l,content:u}=e;Re(o)&&(this.x=o),Re(t)&&(this.y=t),a&&(this.id=a),r&&(this.bdC=r),i&&(this.textColor=i),n&&(this.bgC=n),Re(l)&&(this.borderWidth=l),u&&(this.content=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(e){const{x:o,y:t}=e,{x:a,y:r,width:i,height:n}=this;return o>=a&&o<=a+i&&t>=r&&t<=r+n}draw(e){this.updateOptions(e);const{ctx:o,content:t,x:a,y:r,textColor:i}=this;o.save(),o.textBaseline="top",o.fillStyle=i,o.fillText(t,a,r),o.restore()}calcBoundingBox(){const{x:e,y:o,ctx:t,content:a}=this,r=t.measureText(a),i=this.width=r.width,n=this.height=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent;this.boundingBox=[[e,o],[e+i,o],[e,o+n],[e+i,o+n]]}}const Do=(s,e,o=0)=>{const{x:t,y:a}=s,r=o||0,i=o||0;for(let n=0;n<e.length-1;n++){const l=e[n],u=e[n+1],c=l.y-u.y,d=u.x-l.x,g=l.x*u.y-u.x*l.y;if(Math.abs(c*t+d*a+g)/Math.sqrt(c*c+d*d)<=r&&t>=Math.min(l.x,u.x)-r&&t<=Math.max(l.x,u.x)+r&&a>=Math.min(l.y,u.y)-i&&a<=Math.max(l.y,u.y)+i)return n}return!1},jd=(s,e,o=0)=>{const t=[];return s===e||(Math.abs(s.x-(e.x+e.width))<=o&&t.push(["left","right"]),Math.abs(e.x-(s.x+s.width))<=o&&t.push(["right","left"]),Math.abs(s.y-(e.y+e.height))<=o&&t.push(["top","bottom"]),Math.abs(e.y-(s.y+s.height))<=o&&t.push(["bottom","top"]),Math.abs(s.x-e.x)<=o&&t.push(["left","left"]),Math.abs(s.y-e.y)<=o&&t.push(["top","top"]),Math.abs(s.x+s.width-e.x-e.width)<=o&&t.push(["right","right"]),Math.abs(s.y+s.height-e.y-e.height)<=o&&t.push(["bottom","bottom"])),t};class ge extends Tt{constructor(e,o){super(),this.pos=[],this.lineWidth=1,this.bdC="#000000",this.ctx=e,this.analysisOptions(o),this.calcBoundingBox()}analysisOptions(e){if(!e)return;const{pos:o,type:t,from:a,to:r,id:i,lineWidth:n,numLineType:l,bdC:u,remark:c}=e;i&&(this.id=i),a&&(this.from=a),r&&(this.to=r),o&&(this.pos=o),t&&(this.type=t),l&&(this.numLineType=l),n&&(this.lineWidth=n),u&&(this.bdC=u),c&&(this.remark=c)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}draw(e){this.analysisOptions(e),this.drawLine(),this.drawEnds(),this.drawNote()}containsPoint(e){const{pos:o}=this;return Re(Do(e,o,5))}getIndexInPos(e){return Do(e,this.pos,5)}drawLine(){const{ctx:e,bdC:o,lineWidth:t,type:a,pos:r}=this;e.save(),e.strokeStyle=o,e.lineWidth=t,a==="NON_IDENTIFYING"&&e.setLineDash([8,5]),r.forEach((i,n)=>{n===0?(e.beginPath(),e.moveTo(i.x,i.y)):e.lineTo(i.x,i.y)}),e.stroke(),e.restore()}drawEnds(){const{ctx:e,pos:o,bdC:t,lineWidth:a,numLineType:r}=this,i=15,n=o.length||0;if(!(n<2)){if(e.save(),e.beginPath(),e.setLineDash([0,0]),e.strokeStyle=t,e.lineWidth=a,o[0].x===o[1].x){const l=o[1].y-o[0].y,u=Math.abs(l)<10?l<0?o[0].y-1:o[0].y+1:l<0?o[0].y-10:o[0].y+10;e.moveTo(o[0].x-i/2,u),e.lineTo(o[0].x+i/2,u)}else{const l=o[1].x-o[0].x,u=Math.abs(l)<10?l<0?o[0].x-1:o[0].x+1:l<0?o[0].x-10:o[0].x+10;e.moveTo(u,o[0].y-i/2),e.lineTo(u,o[0].y+i/2)}if(o[n-2].x===o[n-1].x){const l=o[n-1].y-o[n-2].y,u=Math.abs(l)<10?l<0?o[n-1].y+1:o[n-1].y-1:l<0?o[n-1].y+10:o[n-1].y-10;if(e.moveTo(o[n-1].x-i/2,u),e.lineTo(o[n-1].x+i/2,u),e.stroke(),["ONE_MORE","ZEROONE_MORE"].includes(r)&&(e.moveTo(o[n-1].x-i/2,o[n-1].y),e.lineTo(o[n-1].x,u),e.lineTo(o[n-1].x+i/2,o[n-1].y),e.stroke()),["ZEROONE_MORE","ZEROONE_ONE"].includes(r)){e.beginPath();const c=o[n-1].x,d=l<0?u+i/2:u-i/2;e.arc(c,d,(i-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}else{const l=o[n-1].x-o[n-2].x,u=Math.abs(l)<10?l<0?o[n-1].x+1:o[n-1].x-1:l<0?o[n-1].x+10:o[n-1].x-10;if(e.moveTo(u,o[n-1].y-i/2),e.lineTo(u,o[n-1].y+i/2),e.stroke(),["ONE_MORE","ZEROONE_MORE"].includes(r)&&(e.moveTo(o[n-1].x,o[n-1].y-i/2),e.lineTo(u,o[n-1].y),e.lineTo(o[n-1].x,o[n-1].y+i/2),e.stroke()),["ZEROONE_MORE","ZEROONE_ONE"].includes(r)){e.beginPath();const c=l<0?u+i/2:u-i/2,d=o[n-1].y;e.arc(c,d,(i-2)/2,0,360,!1),e.fillStyle="#fff",e.fill(),e.stroke()}}e.restore()}}drawNote(){const{ctx:e,pos:o,remark:t}=this;if(!t)return;const a=Math.floor(o.length/2)-1;let r,i,n;if(o[a].y===o[a+1].y?(n=!1,r=Math.abs(o[a+1].x-o[a].x)/2+Math.min(o[a+1].x,o[a].x),i=o[a].y-10):(n=!0,r=o[a].x+10,i=Math.abs(o[a+1].y-o[a].y)/2+Math.min(o[a+1].y,o[a].y)),e.save(),e.textAlign="center",n){e.translate(r,i);const l=90*Math.PI/180;e.rotate(l),e.fillText(t,0,0)}else e.fillText(t,r,i);e.restore()}calcBoundingBox(){const{pos:e}=this,o=[],t=[];for(let a=0;a<e.length;a++){const r=e[a];o.push(r.x),t.push(r.y)}this.boundingBox=[[Math.min(...o),Math.min(...t)],[Math.max(...o),Math.max(...t)]]}}const eu=(s,e=-1/0,o=1/0)=>Math.max(Math.min(s,o),e);class tu{constructor(e){this.originData={nodeDataArray:[],linkDataArray:[],markDataArray:[],noteDataArray:[]},this.originDataMap=new Map,this.nodeMap=new Map,this.lineMap=new Map,this.noteMap=new Map,this.markMap=new Map,this.nodeRelatedLineMap=new Map,this.update(e),this.mountAutoUpdate()}update(e){this.analysisOptions(e)}analysisOptions(e){const{data:o,context:t}=e;o&&(this.originData=o),t&&(this.context=t),this.clearMap(),this.initMap()}clearMap(){var e,o,t,a,r,i;(e=this.originDataMap)==null||e.clear(),(o=this.lineMap)==null||o.clear(),(t=this.markMap)==null||t.clear(),(a=this.noteMap)==null||a.clear(),(r=this.nodeMap)==null||r.clear(),(i=this.nodeRelatedLineMap)==null||i.clear()}initMap(){const{originData:{nodeDataArray:e=[],linkDataArray:o=[],markDataArray:t=[],noteDataArray:a=[]},originDataMap:r}=this;r.clear();const i=[...e,...o,...t,...a];for(let n=0;n<i.length;n++){const l=i[n];r.set(l.id,l)}}mountAutoUpdate(){this.mountGraphEvent(),this.mountNodeEvent(),this.mountLineEvent(),this.mountMarkEvent(),this.mountNoteEvent()}mountGraphEvent(){const{context:e}=this;e.on(Ce.Paste,o=>{o.map(t=>{e.emit(G.New,t)})})}mountNodeEvent(){const{originDataMap:e,context:o}=this;o.on(G.Move,t=>o.emit(G.Change,t)),o.on(G.Resize,t=>o.emit(G.Change,t)),o.on(G.Change,t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.bdC=t.bdC,a.bgC=t.bgC}),o.on(G.Delete,function(t){const a=this.originData.nodeDataArray.findIndex(r=>r.id===t.id);a!==-1&&(this.originData.nodeDataArray.splice(a,1),e.delete(t.id))}.bind(this)),o.on(G.New,t=>{t.id||(t.id=bt()),t.name||(t.name=Qd("Entity")),this.originData.nodeDataArray.push(t),this.originDataMap.set(t.id,t)})}mountLineEvent(){const{originDataMap:e,nodeRelatedLineMap:o,lineMap:t,context:a}=this;a.on(te.Move,r=>{const i=e.get(r.id);i.pos=r.pos}),a.on(te.Delete,function(r){const i=this.originData.linkDataArray.findIndex(l=>l.id===r.id);if(i===-1)return;const[n]=this.originData.linkDataArray.splice(i,1);o.get(n.from).from.delete(t.get(r.id)),o.get(n.to).to.delete(t.get(r.id)),t.delete(r.id),e.delete(r.id)}.bind(this)),a.on(te.New,r=>{r.id||(r.id=bt()),this.originData.linkDataArray.push(r),this.originDataMap.set(r.id,r)})}mountMarkEvent(){const{originDataMap:e,context:o}=this;o.on(se.Move,t=>o.emit(se.Change,t)),o.on(se.Resize,t=>o.emit(se.Change,t)),o.on(se.Change,t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.bdC=t.bdC,a.bgC=t.bgC}),o.on(se.Delete,function(t){const a=this.originData.markDataArray.findIndex(r=>r.id===t.id);a!==-1&&(this.originData.markDataArray.splice(a,1),e.delete(t.id))}.bind(this)),o.on(se.New,t=>{Object.assign(t,{id:bt()}),this.originData.markDataArray.push(t),this.originDataMap.set(t.id,t)})}mountNoteEvent(){const{originDataMap:e,context:o}=this;o.on(he.Move,t=>o.emit(he.Change,t)),o.on(he.Change,t=>{const a=e.get(t.id);a.x=t.x,a.y=t.y,a.width=t.width,a.height=t.height,a.color=t.color,a.bdC=t.bdC,a.bgC=t.bgC}),o.on(he.Delete,function(t){const a=this.originData.noteDataArray.findIndex(r=>r.id===t.id);a!==-1&&(this.originData.noteDataArray.splice(a,1),e.delete(t.id))}.bind(this)),o.on(he.New,t=>{Object.assign(t,{id:bt(),text:"remark..."}),this.originData.noteDataArray.push(t),this.originDataMap.set(t.id,t)})}unmountAutoUpdate(){const{context:e}=this;e.off()}freeVariable(){this.originData=null,this.originDataMap=null}destroy(){this.unmountAutoUpdate(),this.freeVariable()}}class su extends Tt{constructor(e,o){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=1,this.bdC="blue",this.targetWidth=6,this.targetBgColor="#FFFFFF",this.targetBdColor="#B4B4B4",this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o=0,y:t=0,width:a,height:r,targetBgColor:i,targetBdColor:n,bdC:l,lineWidth:u}=e;o&&(this.x=o),t&&(this.y=t),a&&(this.width=a),r&&(this.height=r),i&&(this.targetBgColor=i),n&&(this.targetBdColor=n),l&&(this.bdC=l),u&&(this.lineWidth=u)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return!1}draw(e){this.updateOptions(e),this.drawBorder(),this.drawTargets()}drawBorder(){const{ctx:e,bdC:o,lineWidth:t,x:a,y:r,width:i,height:n}=this;e.save(),e.lineWidth=t,e.strokeStyle=o,e.strokeRect(a,r,i,n),e.restore()}drawTargets(){const{ctx:e,targetBdColor:o,targetBgColor:t,targetWidth:a,x:r,y:i,width:n,height:l}=this,u=a/2,c=r-u,d=i-u;e.save(),e.strokeStyle=o,e.fillStyle=t,e.fillRect(c,d,a,a),e.fillRect(c,d+l/2,a,a),e.fillRect(c,d+l,a,a),e.fillRect(c+n/2,d,a,a),e.fillRect(c+n/2,d+l,a,a),e.fillRect(c+n,d,a,a),e.fillRect(c+n,d+l/2,a,a),e.fillRect(c+n,d+l,a,a),e.strokeRect(c,d,a,a),e.strokeRect(c,d+l/2,a,a),e.strokeRect(c,d+l,a,a),e.strokeRect(c+n/2,d,a,a),e.strokeRect(c+n/2,d+l,a,a),e.strokeRect(c+n,d,a,a),e.strokeRect(c+n,d+l/2,a,a),e.strokeRect(c+n,d+l,a,a),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}class ou extends Tt{constructor(e,o){super(),this.width=100,this.height=50,this.x=0,this.y=0,this.lineWidth=2,this.bdC="blue",this.ctx=e,this.updateOptions(o)}analysisOptions(e){if(!e)return;const{x:o=0,y:t=0,width:a,height:r,bdC:i,lineWidth:n}=e;o&&(this.x=o),t&&(this.y=t),a&&(this.width=a),r&&(this.height=r),i&&(this.bdC=i),i&&(this.lineWidth=n)}updateOptions(e){this.analysisOptions(e),this.calcBoundingBox()}containsPoint(){return!1}draw(e){this.updateOptions(e),this.drawBorder()}drawBorder(){const{ctx:e,bdC:o,lineWidth:t,x:a,y:r,width:i,height:n}=this;e.save(),e.lineWidth=t,e.strokeStyle=o,e.strokeRect(a,r,i,n),e.restore()}calcBoundingBox(){const{x:e,y:o,width:t,height:a}=this;this.boundingBox=[[e,o],[e+t,o],[e,o+a],[e+t,o+a]]}}const iu=5,ru="#00BFFF",Ao=function(){const{renderElements:s,canvas:{eventCtx:e},eventObj:{target:o}}=this,t=()=>{const r=this.eventObj.target,i=[];if(!(r instanceof de))return i;for(let n=0;n<s.length;n++){const l=s[n];if(!(l instanceof de))continue;const u=jd(r,l,iu);for(let c=0;c<u.length;c++){const d=u[c];i.push({target:l,adjacentSides:d})}}return i};return{draw:()=>{const r=t();for(let i=0;i<r.length;i++){const{target:n,adjacentSides:l}=r[i],u=l[1],c=u==="left"?n.x:u==="right"?n.x+n.width:o.x,d=u==="top"?n.y:u==="bottom"?n.y+n.height:o.y,g=u==="left"?n.x:u==="right"?n.x+n.width:n.x,h=u==="top"?n.y:u==="bottom"?n.y+n.height:n.y;e.save(),e.beginPath(),e.setLineDash([4,4]),e.strokeStyle=ru,e.moveTo(c,d),e.lineTo(g,h),e.stroke(),e.restore()}}}},Hi="Renderer2d",vt=(...s)=>console.warn(`[${Hi}]: `,...s),Oo=(...s)=>console.error(`[${Hi}]: `,...s),zi=(s,e)=>{if(!(s instanceof de||s instanceof Ze))return!1;const{x:t,y:a,width:r,height:i}=s,n=t+r/2,l=a+i/2,u=t+r,c=a+i,d=5;let g=le.NONE;return Math.abs(t-e.x)<=d&&Math.abs(a-e.y)<=d?g=le.LT:Math.abs(n-e.x)<=d&&Math.abs(a-e.y)<=d?g=le.TM:Math.abs(u-e.x)<=d&&Math.abs(a-e.y)<=d?g=le.RT:Math.abs(t-e.x)<=d&&Math.abs(l-e.y)<=d?g=le.LM:Math.abs(u-e.x)<=d&&Math.abs(l-e.y)<=d?g=le.RM:Math.abs(t-e.x)<=d&&Math.abs(c-e.y)<=d?g=le.LB:Math.abs(n-e.x)<=d&&Math.abs(c-e.y)<=d?g=le.BM:Math.abs(u-e.x)<=d&&Math.abs(c-e.y)<=d&&(g=le.RB),g},Ks=s=>s instanceof de?G:s instanceof ge?te:s instanceof Ze?se:s instanceof lt?he:null,au=function(s,e){const o=()=>{const{eventObj:d}=this,g={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},h={x:d.target.x+g.x,y:d.target.y+g.y};this.dataHandler.markMap.get(d.target.id).updateOptions(h),this.emit(se.Move,this.dataHandler.markMap.get(d.target.id)),this.update()},t=()=>{const{eventObj:d}=this,g={x:e.x-d.targetOffsetX-d.target.x,y:e.y-d.targetOffsetY-d.target.y},h={x:d.target.x+g.x,y:d.target.y+g.y};this.dataHandler.noteMap.get(d.target.id).updateOptions(h),this.emit(he.Move,d.target),this.update()},a=()=>{const{eventObj:d}=this,{x:g,y:h}=e;d.target.type==="mark"?this.resizeNode(g,h,d,null):this.resizeNode(g,h,d),this.update(),Ao.call(this).draw()},r=()=>{const{focusTarget:d,eventObj:g,dataHandler:{nodeRelatedLineMap:h}}=this,m={x:e.x-g.targetOffsetX-g.target.x,y:e.y-g.targetOffsetY-g.target.y};d.forEach(f=>{if(!(f instanceof de))return;const x={x:f.x+m.x,y:f.y+m.y};h.has(f.id)&&[...h.get(f.id).from,...h.get(f.id).to].forEach(N=>{N.from===N.to?this.moveLineForSameNode(N,{target:f}):this.moveLineForNode(N,{target:f},x)}),this.dataHandler.nodeMap.get(f.id).updateOptions(x),this.emit(G.Move,f)}),this.update(),Ao.call(this).draw()},i=()=>{const{eventObj:d}=this;d.target,d.targetAttrId,this.updateEventCanvas()},n=()=>{const{eventObj:d}=this,g=d.target.getIndexInPos(d.lastEvLoc);d.targetLineStartPointIdx=g,d.lastEvLoc=e,g!==!1&&(this.moveLineForLine(d,e),this.update())};return{changeMouseCursor:()=>{const{status:d,renderElements:g}=this,m={[ce.AddNode]:J.cell,[ce.AddPrimaryKey]:J.crosshair,[ce.AddForeignKey]:J.crosshair,[ce.AddFiltered]:J.crosshair,[ce.AddMark]:J.cell,[ce.AddNote]:J.cell,[ce.Copy]:J.copy}[d];let f=null,x=J.grab;for(let M=g.length-1;M>=0;M--){const N=g[M],P=N.containsPoint(e)||zi(N,e);if(P){f=N,x=P===le.LT?J.nwseResize:P===le.TM?J.nsResize:P===le.RT?J.neswResize:P===le.LM?J.ewResize:P===le.RM?J.ewResize:P===le.LB?J.neswResize:P===le.BM?J.nsResize:P===le.RB?J.nwseResize:J.move;break}}if(this.hoverTarget!==f){const M=this.hoverTarget instanceof de?G:this.hoverTarget instanceof ge?te:this.hoverTarget instanceof Ze?se:this.hoverTarget instanceof lt?he:null,N=f instanceof de?G:f instanceof ge?te:f instanceof Ze?se:f instanceof lt?he:null;M&&this.emit(M.Leave,this.hoverTarget),N&&this.emit(N.Enter,f)}this.hoverTarget=f,this.canvas.eventEl.style.cursor=m??x,this.updateEventCanvas()},moveCanvas:()=>{this.canvas.setTranslate(s),this.canvas.clearEventCanvas();const d=this.canvas.getTranslate();this.emit(Ce.Move,d),this.update()},moveElement:()=>{const{eventObj:d}=this,g=d.targetAttrId,h=!!d.targetDirection,m=d.target instanceof de,f=d.target instanceof ge,x=d.target instanceof Ze,M=d.target instanceof lt;if(g)return i();if(h)return a();if(m)return r();if(f)return n();if(x)return o();if(M)return t()}}},nu=function(s,e){const{x:o,y:t}=e,a=n=>{this.focusTarget.forEach(l=>{l!==n&&(this.emit(Ks(l).Blur,l),this.focusTarget.delete(l))})};return{execTask:()=>{const{status:n,defaultWidth:l,defaultHeight:u}=this;if(!n)return!1;switch(n){case ce.Copy:{const c=Ws([...this.focusTarget].filter(h=>!(h instanceof ge)));if(!c.length)break;const d={x:o-c[0].x,y:t-c[0].y},g=c.map(h=>(h.x=h.x+d.x,h.y=h.y+d.y,delete h.id,h));this.emit(Ce.Paste,g),this.status=ce.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}case ce.AddNode:{const c={x:o-l/2,y:t-u/2,width:l,height:u},d=this.emit(G.BeforeCreate,c);Promise.all(d).then(()=>{this.emit(G.New,c),this.update()}).catch(()=>vt("CreateNode abort in [BeforeCreate] hooks.")),this.status=ce.None,this.canvas.eventEl.style.cursor=J.default;break}case ce.AddMark:{const c={id:bt(),x:o,y:t,width:l,height:u,type:"mark"};this.emit(se.New,c),this.status=ce.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}case ce.AddNote:{const c={id:bt(),x:o,y:t,text:"",type:"note"};this.emit(he.New,c),this.status=ce.None,this.canvas.eventEl.style.cursor=J.default,this.update();break}default:this.hoverTarget instanceof de&&this.chooseTargets.push(this.dataHandler.originDataMap.get(this.hoverTarget.id)),this.chooseTargets.length>1&&(this.status===ce.AddFiltered?this.createBranchLine():this.createLine(this.status),this.status=ce.None,this.chooseTargets=[]);break}},setEventTarget:n=>{const{metaKey:l,ctrlKey:u}=n,{hoverTarget:c,focusTarget:d,eventObj:g}=this;if(g.target=c,this.canvas.eventEl.style.cursor=J.grabbing,!c){a(),this.updateEventCanvas();return}const h=Ks(c);this.emit(h.MouseDown,c);const m=zi(c,e),f=c.containsPoint(e);if(c instanceof de&&d.has(c)&&!m&&!qt(f))return g.targetAttrId=f;(!u&&!l||h===te)&&a(c),c instanceof ge?g.lastEvLoc=e:(c instanceof de||c instanceof lt||c instanceof Ze)&&(g.targetOffsetX=e.x-c.x,g.targetOffsetY=e.y-c.y,g.targetDirection=m||null),d.has(c)||(this.emit(h.Focus,c),d.add(c),this.updateEventCanvas())}}},lu=function(){return{resetMouseState:()=>{const{hoverTarget:e}=this,o=e instanceof de?G:e instanceof ge?te:e instanceof Ze?se:e instanceof lt?he:null;o&&this.emit(o.MouseUp,e),this.canvas.eventEl.style.cursor=J.default,Object.assign(this.eventObj,{target:null,targetAttrId:null,targetDirection:le.NONE,targetOffsetX:0,targetOffsetY:0,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}}),this.update()}}};function du(s,e){const o={id:e},t=[o];for(;t.length>0;){const a=t.shift(),r=[];for(const[i,n]of s){const l=s.has(i),u=n.has(a.id);if(l&&u){const c={id:i};r.push(c),t.push(c),s.delete(i)}}a.children=r}return o}const _i=100,Ns=100,Ho=12,uu="sans-serif",cu=14,zo=10,so=100,Bt=100,Ms=1e3;function hu(s,e,o="sans-serif"){const a=document.createElement("canvas").getContext("2d");return a.font=`${e}px ${o}`,a.measureText(s).width}const pu=s=>({width:Math.max(Math.floor(Math.max(...(s.attributes||[]).map(e=>hu(e.name,Ho,uu)))+zo*2+Ho*2),so),height:Math.floor(Math.max(((s.attributes||[]).length+1)*cu+zo*2,Bt))}),fu=async(s,e)=>{const{nodeDataArray:o,linkDataArray:t,markDataArray:a,noteDataArray:r}=s,i=gu(o,t).sort((l,u)=>u.children.length-l.children.length);yu(o,i).then(l=>{const u=vu(a,l,-Bt);xu(r,l,u)});function n(){ke.getAll().length&&(requestAnimationFrame(n),ke.update(),e==null||e())}n()},gu=(s,e)=>{var r;const o=new Map;for(const i of s)o.set(i.id,new Set);for(const i of e){const n=o.get(i.to),l=!!n;!o.get(i.from)||!l||n.add(i.from)}const t=[];let a=!1;for(;!a;){if(!o.size){a=!1;break}let i=null;for(const[l,u]of o){const c=i===null,d=u.size<((r=o.get(i))==null?void 0:r.size),g=i===0;if((c||d)&&(i=l),g)break}o.delete(i);const n=du(o,i);t.push(n)}return t},yu=async(s,e)=>{const o=new Map;return s.map(t=>o.set(t.id,t)),await Promise.all(mu(s)),Promise.resolve(e.reduce((t,a)=>t=Vi(o,[a],t,Ns),_i))},mu=s=>s.map(e=>{if(["inclusive","exclusive"].includes(e.type))return;const o=pu(e);return new Promise(t=>{new ke.Tween(e).to({width:o.width,height:o.height},Ms/2).easing(ke.Easing.Quadratic.InOut).start().onComplete(()=>t())})}),Vi=(s,e,o,t)=>{var n;const a=Math.max(...e.map(l=>s.get(l.id).height||Bt)),r=t+a+Ns;let i=o;for(let l=0;l<e.length;l++){const u=s.get(e[l].id);new ke.Tween(u).to({x:i,y:t},Ms).easing(ke.Easing.Quadratic.InOut).start();const c=i;i+=u.width+_i,(n=e[l].children)!=null&&n.length&&(i=Math.max(Vi(s,e[l].children,c,r),i))}return i},vu=(s,e,o)=>{let t=o;return s==null||s.map(a=>{t+=Ns+Bt,new ke.Tween(a).to({x:e,y:t,width:so,height:Bt},Ms).easing(ke.Easing.Quadratic.InOut).start()}),t},xu=(s,e,o)=>{let t=o;return s==null||s.map(a=>{t+=Ns+Bt,new ke.Tween(a).to({x:e,y:t,width:so,height:Bt},Ms).easing(ke.Easing.Quadratic.InOut).start()}),t};class Wi extends Ur{constructor(e){super(),this.eventObj={target:null,canvasEv:{x:0,y:0},targetDirection:le.NONE,targetOffsetX:0,targetOffsetY:0,targetAttrId:null,targetLineStartPointIdx:0,lastEvLoc:{x:0,y:0}},this.plugins=new qr,this.useHistory=!0,this.useThumbnail=!0,this.useCheatSheet=!0,this.useRightMenu=!0,this.rightMenuConfig=[],this.editable=it.Edit,this.defaultWidth=100,this.defaultHeight=50,this.focusTarget=new Set,this.chooseTargets=[],this.debounceUpdate(),this.updateConfig(e),this.mountDataHandler(e),this.mountCanvas(),this.mountCanvasEvents(),this.mountPlugins(),Yr().then(()=>this.update())}async updateConfig(e){const{el:o,editable:t,fontFamily:a,status:r,rightMenu:i,useRightMenu:n,useThumbnail:l,useHistory:u}=e;o&&(this.el=o),t&&(this.editable=t),a&&(this.fontFamily=a),i&&(this.rightMenuConfig=i),r&&(this.status=r),qt(n)&&(this.useRightMenu=n),qt(l)&&(this.useThumbnail=l),qt(u)&&(this.useHistory=u),this.mountPlugins(),await fo(),this.update()}mountDataHandler(e){this.dataHandler=new tu({context:this,data:e.data})}destroy(){this.unmountPlugins(),this.unmountCanvasEvents(),this.canvas.destroy(),this.dataHandler.destroy()}mountCanvas(){this.canvas=new Gr({mountEl:this.el,backgroundType:Xr.Checker}),this.cacheCtx=this.canvas.cacheCtx}mountPlugins(){this.useHistory?this.plugins.use(De.History):this.plugins.off(De.History),this.useThumbnail&&this.canvas?this.plugins.use(De.Thumbnail,{mountEl:this.canvas.boxEl,mainCanvas:this.canvas}).on(Lt.MouseDown,(e,o,t)=>{t&&this.update(),this.emit(Lt.MouseDown,e,o)}).on(Lt.Move,(e,o,t)=>{t&&this.update(),this.emit(Lt.Move,e,o)}).on(Lt.MouseUp,(e,o)=>{this.emit(Lt.MouseUp,e,o)}):this.plugins.off(De.Thumbnail),this.useRightMenu&&this.canvas?this.plugins.use(De.RightMenu,this.canvas.boxEl,this.rightMenuConfig).off(xt.Click).on(xt.Click,e=>{this.emit(xt.Click,{value:e,target:this.hoverTarget})}):this.plugins.off(De.RightMenu)}unmountPlugins(){this.plugins.destroy()}mountCanvasEvents(){this._bindEventMousedown=this.onMouseDown.bind(this),this._bindEventMousemove=this.onMouseMove.bind(this),this._bindEventMouseup=this.onMouseUp.bind(this),this._bindEventResize=this.onResize.bind(this),this._bindEventWheel=this.onWheel.bind(this),this._bindEventContextmenu=this.onContextmenu.bind(this),this._bindEventUndo=this.onUndo.bind(this),this._bindEventRedo=this.onRedo.bind(this),this._bindEventKeydown=this.onKeyDown.bind(this),this._bindEventDblclick=this.onDblClick.bind(this),this.canvas.on(re.Resize,this._bindEventResize),this.canvas.on(re.Wheel,this._bindEventWheel),this.canvas.on(re.Mouseup,this._bindEventMouseup),this.canvas.on(re.Mousedown,this._bindEventMousedown),this.canvas.on(re.Mousemove,this._bindEventMousemove),this.canvas.on(re.Contextmenu,this._bindEventContextmenu),this.canvas.on(re.Undo,this._bindEventUndo),this.canvas.on(re.Redo,this._bindEventRedo),this.canvas.on(re.Keydown,this._bindEventKeydown),this.canvas.on(re.DblClick,this._bindEventDblclick)}unmountCanvasEvents(){this.canvas.off(re.Resize,this._bindEventResize),this.canvas.off(re.Wheel,this._bindEventWheel),this.canvas.off(re.Mouseup,this._bindEventMouseup),this.canvas.off(re.Mousedown,this._bindEventMousedown),this.canvas.off(re.Mousemove,this._bindEventMousemove),this.canvas.off(re.Contextmenu,this._bindEventContextmenu),this.canvas.off(re.Undo,this._bindEventUndo),this.canvas.off(re.Redo,this._bindEventRedo),this.canvas.off(re.Keydown,this._bindEventKeydown),this.canvas.off(re.DblClick,this._bindEventDblclick)}onKeyDown(e){const{keyCode:o}=e,t=o===8||o===46;o===27&&this.updateConfig({status:ce.None}),t&&(this.focusTarget.forEach(r=>{if(r instanceof de){const l=this.dataHandler.nodeRelatedLineMap.get(r.id);[...l.from,...l.to].map(u=>{const c=this.emit(te.BeforeDelete,u);Promise.all(c).then(()=>{this.emit(te.Delete,u)}).catch(()=>vt("Delete abort in [BeforeDelete] hooks.",u))})}const i=r instanceof de?G:r instanceof ge?te:r instanceof Ze?se:r instanceof lt?he:null,n=this.emit(i.BeforeDelete,r);Promise.all(n).then(()=>{this.emit(i.Delete,r)}).catch(()=>vt("Delete abort in [BeforeDelete] hooks.",r))}),this.focusTarget.clear(),this.hoverTarget=null,this.update()),this.emit(Ce.Keydown,e)}onUndo(){const e=this.plugins.get(De.History).undo();e==null||e.reverse(),e||vt("撤无可撤")}onRedo(){const e=this.plugins.get(De.History).redo();e==null||e.reverse(),e||vt("恢无可恢")}onDblClick(e){const o=this.hoverTarget,t=Ks(o)??Ce;this.emit(t.DblClick,o)}onMouseUp(e,o){const{resetMouseState:t}=lu.call(this,e,o);t()}onMouseDown(e,o){const{status:t}=this,{execTask:a,setEventTarget:r}=nu.call(this,e,o);if(t)return a();r(e)}onMouseMove(e,o){const{canvas:t,eventObj:a,editable:r}=this,{changeMouseCursor:i,moveCanvas:n,moveElement:l}=au.call(this,e,o);a.canvasEv=o;const u=!t.isMouseDown,c=t.isMouseDown&&!a.target,d=t.isMouseDown&&a.target&&r===it.Edit;if(u)return i();if(c)return n();if(d){if(this.useHistory){const g=[...this.focusTarget];for(let h=0;h<g.length;h++){const m=g[h],f={target:m,originValue:{}};if(m instanceof de){const x=To(m,"x","y","width","height");f.originValue=Ws(x);const M=this.dataHandler.nodeRelatedLineMap.get(m.id);g.push(...M.from,...M.to)}if(m instanceof ge){const x=To(m,"pos");f.originValue=Ws(x)}g[h]=f}this.plugins.get(De.History).push(()=>{for(let h=0;h<g.length;h++){const{target:m,originValue:f}=g[h];m.updateOptions(f),m instanceof de&&this.emit(G.Resize,m),m instanceof ge&&this.emit(te.Move,m)}this.update()})}return l()}}onContextmenu(e){if(!this.useRightMenu)return;const{offsetX:o,offsetY:t}=e,{offsetWidth:a,offsetHeight:r}=e.target;this.emit(xt.Show,{target:this.hoverTarget}),this.plugins.get(De.RightMenu).show({top:t,left:o,innerWidth:a,innerHeight:r,menuConfig:this.rightMenuConfig})}onWheel(e){const{deltaY:o,deltaX:t,ctrlKey:a}=e;if(!(!(Math.abs(o)>2||Math.abs(t)>2)||this.eventObj.target))if(a){const i=this.canvas.zoomRate,n=Math.floor(eu(i*100+o,10,200));this.zoom(n)}else{const i=this.canvas.getTranslate();this.canvas.setTranslate({x:i.x-t,y:i.y-o}),this.update()}}onResize(){this.update()}initNodes(){const{dataHandler:{originData:{nodeDataArray:e},nodeMap:o},dataHandler:{nodeRelatedLineMap:t}}=this;if(e!=null&&e.length)for(let a=0;a<e.length;a++){const r=e[a];let i=o.get(r.id);i||(i=new de(this.canvas.cacheCtx,{id:r.id,enName:r.enName,cnName:r.cnName,type:r.type,x:r.x,y:r.y,width:r.width,height:r.height,attributes:r.attributes,bdC:r.bdC,bgC:r.bgC,quotePrimaryKey:r.quotePrimaryKey,physicalTables:r.physicalTables}),o.set(r.id,i),t.has(r.id)||t.set(r.id,{from:new Set,to:new Set}))}}renderNodes(){const{dataHandler:{originData:e,nodeMap:o},renderElements:t}=this,a=e.nodeDataArray;for(let r=0;r<a.length;r++){const i=a[r],n=o.get(i.id);n.updateOptions(i),this.canvas.isVisible(n.boundingBox)&&(t.push(n),n.draw())}}renderLines(){const{renderElements:e,dataHandler:{originData:o,lineMap:t,nodeRelatedLineMap:a}}=this,r=o.linkDataArray;for(let i=0;i<r.length;i++){const n=r[i];let l=t.get(n.id);this.checkLinePos(n),l?l.updateOptions(n):(l=new ge(this.canvas.cacheCtx,{pos:n.pos,type:n.type,from:n.from,to:n.to,id:n.id,numLineType:n.numLineType,remark:n.remark}),t.set(n.id,l)),a.has(l.from)||a.set(l.from,{from:new Set,to:new Set}),a.has(l.to)||a.set(l.to,{from:new Set,to:new Set}),a.get(l.from).from.add(l),a.get(l.to).to.add(l),this.canvas.isVisible(l.boundingBox)&&(e.push(l),l.draw())}}renderNote(){const{dataHandler:{originData:{noteDataArray:e},noteMap:o},renderElements:t}=this;for(let a=0;a<e.length;a++){const r=e[a];let i=o.get(r.id);i?i.updateOptions(r):(i=new lt(this.canvas.cacheCtx,{id:r.id,content:r.text,textColor:r.color,x:r.x,y:r.y}),o.set(r.id,i)),this.canvas.isVisible(i.boundingBox)&&(t.push(i),i.draw())}}updateLayout(){const e=this.dataHandler.originData,o=this.update.bind(this);fu(e,o)}debounceUpdate(){let e=null;const o=this.update;this.update=(...t)=>{if(clearTimeout(e),t.length)return o.apply(this,t);e=setTimeout(()=>{o.apply(this,t)})}}update(e){this.renderElements=[],e&&(this.dataHandler.update({data:e}),this.focusTarget.clear()),this.canvas.clearCacheCanvas();const o=this.cacheCtx;o.font="15px "+this.fontFamily,o.save(),this.renderMarks(),this.renderLines(),this.initNodes(),this.renderNodes(),this.renderNote(),o.restore(),this.canvas.update(),this.updateEventCanvas(),this.updateThumbnail()}async updateThumbnail(){const{dataHandler:{originData:{nodeDataArray:e}}}=this,o=this.plugins.get(De.Thumbnail);if(!o)return!1;await fo();const{width:t,height:a}=this.canvas.getRenderSize();let r=0,i=0,n=t,l=a;for(let u=0;u<e.length;u++){const c=e[u],{x:d,y:g,width:h,height:m}=c;d<r&&(r=d),g<i&&(i=g),d+h>n&&(n=d+h),g+m>l&&(l=g+m)}o.draw(r,i,n,l,u=>{for(let c=0;c<e.length;c++){const d=e[c],{x:g,y:h,width:m,height:f,bgC:x,bdC:M}=d;u.save(),u.fillStyle=x||"#fff",u.fillRect(g,h,m,f),u.strokeStyle=M||"#000",u.strokeRect(g,h,m,f),u.restore()}})}updateEventCanvas(){this.canvas.clearEventCanvas(),this.emit(Ce.BeforeUpdate,this.canvas.eventCtx),this.drawFocusElement(),this.drawFocusAttribute(),this.drawHoverElement(),this.drawLockIcon(),this.emit(Ce.AfterUpdate,this.canvas.eventCtx)}drawFocusElement(){const{canvas:e,focusTarget:o}=this;o.forEach(t=>{t instanceof ge?new ge(e.eventCtx,{...t,lineWidth:3,bdC:"blue",remark:""}).draw():new su(e.eventCtx,{x:t.x,y:t.y,width:t.width,height:t.height}).draw()})}drawFocusAttribute(){const{canvas:{eventCtx:e},eventObj:{targetAttrId:o,target:t,canvasEv:a},hoverTarget:r}=this;if(!o)return;const i=t.getAttributeInfo(o),n=r==null?void 0:r.containsPoint(a);if(r instanceof de&&!qt(n)){const l=r.getAttributeInfo(n);e.fillStyle="rgba(0, 0, 255, 0.3)",e.drawRoundedRect(l.x,l.y-3,l.width,2,1,1,1,1,!0,!1,!1,!1)}e.save(),e.fillStyle="#0000ff",e.fillRect(i.x,i.y-1,i.width,i.height),e.font=`${t.fontSize}px Arial`,e.fillStyle="#fff",e.textAlign="left",e.textBaseline="top",e.fillText(i.info.name,i.x,i.y,i.width),e.restore()}drawHoverElement(){const{canvas:e,hoverTarget:o,focusTarget:t}=this,a=t.has(o);!o||a||(o instanceof ge?new ge(e.eventCtx,{...o,lineWidth:2,bdC:"blue",remark:""}).draw():new ou(e.eventCtx,{x:o.x,y:o.y,width:o.width,height:o.height}).draw())}drawLockIcon(){if(this.editable===it.Edit)return;const e=this.canvas.getTranslate(),o=this.canvas.zoomRate;new Zd(this.canvas.eventCtx,{x:(-e.x+this.canvas.width)/o-40,y:-e.y/o+25}).draw()}checkLinePos(e){var l,u;const{dataHandler:{originDataMap:o}}=this;if(((l=e.pos)==null?void 0:l.length)<2||((u=e.pos)==null?void 0:u.length)>4)return this.mergeLines([e]);const a=o.get(e.from),r=o.get(e.to);if(!a||!r)return!1;const i=this.getPointBelongBord(a,e.pos[0]),n=this.getPointBelongBord(r,e.pos[e.pos.length-1]);if(i&&n)return!0;this.mergeLines([e])}renderMarks(){var e,o;(o=(e=this.dataHandler.originData)==null?void 0:e.markDataArray)==null||o.forEach(t=>{const a=t.width,r=t.height,i=Number(t.x),n=Number(t.y),l=t;let u=this.dataHandler.markMap.get(l.id);u?u.updateOptions(l):(u=new Ze(this.canvas.cacheCtx,{id:l.id,x:i,y:n,width:a,height:r}),this.dataHandler.markMap.set(l.id,u)),this.canvas.isVisible(u.boundingBox)&&(this.renderElements.push(u),u.draw())})}zoom(e){const o=e/100;this.canvas.zoom(o),this.update(),this.emit(Ce.Zoom,this.canvas.zoomRate)}getPointBelongBord(e,o){if(o.x===e.x)return"L";if(o.x===e.x+e.width)return"R";if(o.y===e.y)return"T";if(o.y===e.y+e.height)return"B";vt("getPointBelongBord未找到匹配边，detail:",e,JSON.parse(JSON.stringify(e)),JSON.parse(JSON.stringify(o)))}resizeNode(e,o,t,a=50){if(["exclusive","inclusive"].includes(t.target.type))return;const r=this,i={x:t.target.x,y:t.target.y,width:t.target.width,height:t.target.height};if(t.targetDirection==="LT"){const l=t.target.width+t.target.x-e,u=t.target.height+t.target.y-o;t.target.updateOptions({x:l<a?t.target.x:e,y:u<a?t.target.y:o,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="TM"){const l=t.target.height+t.target.y-o;t.target.updateOptions({y:l<a?t.target.y:o,height:l<a?t.target.height:l}),n()}else if(t.targetDirection==="RT"){const l=e-t.target.x,u=t.target.height+t.target.y-o;t.target.updateOptions({y:u<a?t.target.y:o,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="LM"){const l=t.target.width+t.target.x-e;t.target.updateOptions({x:l<a?t.target.x:e,width:l<a?t.target.width:l}),n()}else if(t.targetDirection==="RM"){const l=e-t.target.x;t.target.updateOptions({width:l<a?t.target.width:l}),n()}else if(t.targetDirection==="LB"){const l=t.target.width+t.target.x-e,u=o-t.target.y;t.target.updateOptions({x:l<a?t.target.x:e,width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}else if(t.targetDirection==="BM"){const l=o-t.target.y;t.target.updateOptions({height:l<a?t.target.height:l}),n()}else if(t.targetDirection==="RB"){const l=e-t.target.x,u=o-t.target.y;t.target.updateOptions({width:l<a?t.target.width:l,height:u<a?t.target.height:u}),n()}t.target.type==="mark"?this.emit(se.Resize,t.target):this.emit(G.Resize,t.target);function n(){if(!(t.target instanceof de))return;r.dataHandler.nodeMap.get(t.target.id).updateOptions(t.target);const l=r.dataHandler.nodeRelatedLineMap.get(t.target.id);[...l.from,...l.to].forEach(c=>{const d=c.from!==c.to,g=l.from.has(c)?0:c.pos.length-1;d&&u(c,g),d?r.moveLineForNode(c,t,t.target):r.moveLineForSameNode(c,t)});function u(c,d){c.pos[d].x===i.x?(c.pos[d].x=t.target.x,c.pos[d].y=c.pos[d].y<t.target.y?t.target.y+1:c.pos[d].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[d].y):c.pos[d].x===i.x+i.width?(c.pos[d].x=t.target.x+t.target.width,c.pos[d].y=c.pos[d].y<t.target.y?t.target.y+1:c.pos[d].y>t.target.y+t.target.height?t.target.y+t.target.height-1:c.pos[d].y):c.pos[d].y===i.y?(c.pos[d].x=c.pos[d].x<=t.target.x?t.target.x+1:c.pos[d].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[d].x,c.pos[d].y=t.target.y):c.pos[d].y===i.y+i.height&&(c.pos[d].x=c.pos[d].x<=t.target.x?t.target.x+1:c.pos[d].x>=t.target.x+t.target.width?t.target.x+t.target.width-1:c.pos[d].x,c.pos[d].y=t.target.y+t.target.height)}}}getNodePosFromBorder(e,o){let t={start:{x:null,y:null},end:{x:null,y:null}};switch(o){case"T":t={start:{x:e.x,y:e.y},end:{x:e.x+e.width,y:e.y}};break;case"B":t={start:{x:e.x,y:e.y+e.height},end:{x:e.x+e.width,y:e.y+e.height}};break;case"L":t={start:{x:e.x,y:e.y},end:{x:e.x,y:e.y+e.height}};break;case"R":t={start:{x:e.x+e.width,y:e.y},end:{x:e.x+e.width,y:e.y+e.height}};break}return t}moveLineForNode(e,o,t){const a=e.pos.length-1,r={x:t.x-o.target.x,y:t.y-o.target.y},i=this.dataHandler.nodeMap.get(e.from),n=this.dataHandler.nodeMap.get(e.to);if(!i||!n)return;const l=this.getPointBelongBord(i,e.pos[0]),u=this.getPointBelongBord(n,e.pos[a]);(!l||!u)&&this.mergeLines([e]);const c=o.target.id===i.id;if(c?(e.pos[0].x=t.x+(e.pos[0].x-o.target.x),e.pos[0].y=t.y+(e.pos[0].y-o.target.y)):(e.pos[a].x=t.x+(e.pos[a].x-o.target.x),e.pos[a].y=t.y+(e.pos[a].y-o.target.y)),a===1)e.pos.splice(1,0,{x:e.pos[0].x,y:e.pos[0].y},{x:e.pos[0].x,y:e.pos[0].y});else if(a===2)if(l==="R"&&u==="B"){if(this.getNodePosFromBorder(n,"B").start.y<e.pos[0].y)e.pos[1]={x:e.pos[2].x,y:e.pos[0].y};else{const d=this.getNodePosFromBorder(i,"R").start.x<this.getNodePosFromBorder(n,"L").start.x?this.getNodePosFromBorder(n,"L").start.x:this.getNodePosFromBorder(n,"R").start.x;e.pos[1]={x:d+(c?0:r.x),y:e.pos[0].y+r.y},e.pos.splice(2)}e.pos[2]&&e.pos[2].x<=e.pos[0].x&&(e.pos[0]={x:e.pos[0].x-1,y:i.y+(c?r.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))}else l==="B"&&u==="R"?(i.y+i.height<e.pos[1].y?e.pos[1]={x:e.pos[0].x,y:e.pos[2].y}:["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBorder(i,"B").start.y,this.getNodePosFromBorder(n,"B").start.y)+20},e.pos[2]={x:n.x+Math.floor(n.width/2)+(c?0:r.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBorder(n,"B").start.y+(c?0:r.y)}):(e.pos[0]={x:i.x+(o.target.id===i.id?r.x:0),y:e.pos[1].y},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2)),e.pos[1].x<n.x+n.width&&(e.pos[1].y=n.y+(o.target.id===n.id?r.y:0),e.pos.splice(2))):l==="L"&&u==="B"?(this.getNodePosFromBorder(n,"B").start.y<e.pos[0].y?e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}:(e.pos[1]={x:n.x+n.width+(o.target.id===n.id?r.x:0),y:e.pos[0].y},e.pos.splice(2)),e.pos[1].x>=o.target.x&&this.getNodePosFromBorder(n,"B").start.y<this.getNodePosFromBorder(i,"T").start.y&&(e.pos[0]={x:e.pos[0].x+(c?r.x:0)-1,y:i.y+(c?r.y:0)},e.pos[1]={x:e.pos[2].x,y:e.pos[2].y},e.pos.splice(2))):l==="B"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>n.x&&(e.pos[1].y=n.y+(o.target.id===n.id?r.y:0),e.pos.splice(2)),e.pos[1].y<e.pos[0].y&&(["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:Math.max(this.getNodePosFromBorder(i,"B").start.y,this.getNodePosFromBorder(n,"B").start.y)+20},e.pos[2]={x:n.x+Math.floor(n.width/2)+(c?0:r.x),y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:this.getNodePosFromBorder(n,"B").start.y+(c?0:r.y)}):(e.pos[1].x=this.getNodePosFromBorder(i,"R").start.x+(o.target.id===i.id?r.x:0),e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(o.target.id===i.id?r.y:0),e.pos.splice(0,1)))):l==="R"&&u==="T"?(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].x<e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(o.target.id===i.id?r.y:0),e.pos.splice(0,1)),e.pos[2]&&e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:i.x+Math.floor(i.width/2),y:i.y+(c?r.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:n.y+(c?0:r.y)}):(e.pos[1].x=n.x+(c?0:r.x),e.pos[1].y=n.y+(c?0:r.y),e.pos.splice(2)))):l==="T"&&u==="R"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x<e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBorder(n,"B").start.y+(o.target.id===n.id?r.y:0),e.pos.splice(2)),e.pos[0].y<e.pos[1].y&&(e.pos[1].x=i.x+(o.target.id===i.id?r.x:0),e.pos[1].y=i.y+(o.target.id===i.id?r.y:0),e.pos.splice(0,1))):l==="T"&&u==="L"?(e.pos[1].x=e.pos[0].x,e.pos[1].y=e.pos[2].y,e.pos[1].x>e.pos[2].x&&(e.pos[1].y=this.getNodePosFromBorder(n,"B").start.y+(o.target.id===n.id?r.y:0),e.pos.splice(2)),e.pos[1].y>e.pos[0].y&&(e.pos[1].x=this.getNodePosFromBorder(i,"R").start.x+(o.target.id===i.id?r.x:0),e.pos.splice(0,1))):l==="L"&&u==="T"&&(e.pos[1].x=e.pos[2].x,e.pos[1].y=e.pos[0].y,e.pos[1].y>e.pos[2].y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:i.x+Math.floor(i.width/2),y:i.y+(c?r.y:0)},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[2].x,y:e.pos[1].y},e.pos[3]={x:e.pos[2].x,y:n.y+(c?0:r.y)}):(e.pos[1].x=this.getNodePosFromBorder(n,"R").start.x+(o.target.id===n.id?r.x:0),e.pos.splice(2))),e.pos[1].x>e.pos[0].x&&(e.pos[1].y=this.getNodePosFromBorder(i,"B").start.y+(o.target.id===i.id?r.y:0),e.pos.splice(0,1)));else if(a===3){const d=Math.floor(Math.abs(e.pos[0].x-e.pos[a].x)/2),g=Math.floor(Math.abs(e.pos[0].y-e.pos[a].y)/2);if(l==="B"&&u==="B")if(this.getNodePosFromBorder(i,"T").start.y<this.getNodePosFromBorder(n,"B").start.y)if(this.getNodePosFromBorder(i,"B").start.y<e.pos[1].y){const h=e.pos[2].y-n.y-n.height+e.pos[3].y;e.pos[1]={x:e.pos[0].x,y:h},e.pos[2]={x:e.pos[3].x,y:h}}else{const h=i.x+i.width>e.pos[3].x?i.x:i.x+i.width,m=e.pos[2].y-n.y-n.height+e.pos[3].y;e.pos[0]={x:h+(o.target.id===i.id?r.x:0),y:m},e.pos[1]={x:e.pos[3].x,y:m},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y},e.pos.splice(3)}else["exclusive","inclusive"].includes(i.type)?(e.pos[1]={x:e.pos[0].x,y:i.y+i.height+20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+Math.floor((i.y-n.y-n.height)/2)},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+Math.floor((i.y-n.y-n.height)/2)});else if(l==="B"&&u==="T")i.y+i.height<n.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+g},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+g}):i.y+i.height>=n.y&&(["exclusive","inclusive"].includes(n.type)?(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y-i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-20},e.pos[2]={x:e.pos[3].x,y:e.pos[1].y}):(e.pos[1]={x:e.pos[0].x,y:n.y+n.height+20},e.pos[2]={x:e.pos[3].x,y:n.y+n.height+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+n.height}));else if(l==="T"&&u==="T")if(["exclusive","inclusive"].includes(i.type)||["exclusive","inclusive"].includes(n.type)){const h=e.pos[1].y+r.y>Math.min(i.y,n.y)-20?Math.min(i.y,n.y)-20:e.pos[1].y+r.y;e.pos[1]={x:e.pos[0].x,y:h},e.pos[2]={x:e.pos[3].x,y:h}}else e.pos[1].y<o.target.y?(e.pos[1]={x:e.pos[0].x,y:e.pos[1].y},e.pos[2]={x:e.pos[3].x,y:e.pos[2].y}):(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+i.height},e.pos[1]={x:e.pos[0].x,y:Math.max(i.y+i.height,n.y+n.height)+20},e.pos[2]={x:e.pos[3].x,y:Math.max(i.y+i.height,n.y+n.height)+20},e.pos[3]={x:e.pos[3].x,y:e.pos[3].y+n.height});else l==="T"&&u==="B"?i.y>n.y+n.height?(e.pos[1]={x:e.pos[0].x,y:e.pos[0].y-g},e.pos[2]={x:e.pos[3].x,y:e.pos[3].y+g}):i.y<=n.y+n.height&&(e.pos[0]={x:e.pos[0].x,y:e.pos[0].y+i.height},e.pos[1]={x:e.pos[0].x,y:e.pos[0].y+20},e.pos[2]={x:e.pos[3].x,y:e.pos[0].y+20}):l==="L"&&u==="L"?(o.target.id===n.id?(e.pos[2]={x:t.x-(n.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>i.x&&e.pos[1].x<i.x+i.width&&(e.pos.splice(0,1),++e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y)+(o.target.id===i.id?r.y:0))):l==="L"&&u==="R"?i.x>n.x+n.width?(e.pos[1]={x:e.pos[0].x-d,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[3].y}):(e.pos[0]={x:e.pos[0].x+i.width,y:e.pos[0].y},e.pos[1]={x:e.pos[0].x+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+20,y:e.pos[3].y}):l==="R"&&u==="L"?i.x+i.width<n.x?(e.pos[1]={x:e.pos[0].x+d,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+d,y:e.pos[3].y}):(e.pos[1]={x:e.pos[0].x+n.width+20,y:e.pos[0].y},e.pos[2]={x:e.pos[0].x+n.width+20,y:e.pos[3].y},e.pos[3]={x:e.pos[3].x+n.width,y:e.pos[3].y}):l==="R"&&u==="R"&&(o.target.id===n.id?(e.pos[2]={x:t.x-(n.x-e.pos[2].x),y:e.pos[3].y},e.pos[1]={x:e.pos[2].x,y:e.pos[0].y}):e.pos[1]={x:e.pos[2].x,y:e.pos[0].y},e.pos[1].x>i.x&&e.pos[1].x<i.x+i.width&&(e.pos.splice(0,1),--e.pos[0].x,e.pos[0].y=(e.pos[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y)+(o.target.id===i.id?r.y:0)))}this.emit(te.Move,e)}moveLineForSameNode(e,o){const r=e.pos[1].x-e.pos[0].x,i=e.pos[2].y-e.pos[1].y;e.pos[0]={x:o.target.x+o.target.width,y:o.target.y+o.target.height-20},e.pos[4]={x:o.target.x+o.target.width-20,y:o.target.y+o.target.height},e.pos[1]={x:e.pos[0].x+r,y:e.pos[0].y},e.pos[2]={x:e.pos[1].x,y:e.pos[1].y+i},e.pos[3]={x:e.pos[4].x,y:e.pos[2].y},this.emit(te.Move,e)}moveLineForLine(e,o){var c;const t=e.target.pos,a=t.length-1;let r,i,n=0;if((c=this.dataHandler.originData.nodeDataArray)==null||c.forEach(d=>{d.id===e.target.from&&(r=d,n++),d.id===e.target.to&&(i=d,n++)}),["exclusive","inclusive"].includes(r.type)){if(e.targetLineStartPointIdx===0&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBorder(r,"L").start.x>=o.x||this.getNodePosFromBorder(r,"R").start.x<=o.x)||e.targetLineStartPointIdx===1&&t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y&&this.getNodePosFromBorder(r,"B").start.y>=o.y||e.targetLineStartPointIdx===2&&t[e.targetLineStartPointIdx].x===t[e.targetLineStartPointIdx+1].x&&(this.getNodePosFromBorder(i,"L").start.x>=o.x||this.getNodePosFromBorder(i,"R").start.x<=o.x))return}else if(["exclusive","inclusive"].includes(i.type)&&(a===1||a===2&&e.targetLineStartPointIdx===1||a===2&&e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"T").start.y<o.y||a===3&&e.targetLineStartPointIdx===2||a===3&&e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(i,"T").start.y<o.y||a===3&&e.targetLineStartPointIdx===0&&(this.getNodePosFromBorder(r,"L").start.x>=o.x||this.getNodePosFromBorder(r,"R").start.x<=o.x)))return;a===1?t[0].y===t[1].y?(t[0].y=o.y,t[1].y=o.y,(this.getNodePosFromBorder(r,"T").start.y>o.y||this.getNodePosFromBorder(r,"B").start.y<o.y)&&(t[0].x=r.x+r.width/2,t.unshift({x:r.x+r.width/2,y:this.getNodePosFromBorder(r,"T").start.y>o.y?r.y:r.y+r.height})),(this.getNodePosFromBorder(i,"T").start.y>o.y||this.getNodePosFromBorder(i,"B").start.y<o.y)&&(t[t.length-1].x=i.x+i.width/2,t.push({x:i.x+i.width/2,y:this.getNodePosFromBorder(i,"T").start.y>o.y?i.y:i.y+i.height}))):(t[0].x=o.x,t[1].x=o.x,(this.getNodePosFromBorder(r,"L").start.x>o.x||this.getNodePosFromBorder(r,"R").start.x<o.x)&&(t[0].y=r.y+r.height/2,t.unshift({x:this.getNodePosFromBorder(r,"R").start.x<o.x?r.x+r.width:r.x,y:r.y+r.height/2})),(this.getNodePosFromBorder(i,"L").start.x>o.x||this.getNodePosFromBorder(i,"R").start.x<o.x)&&(t[t.length-1].y=i.y+i.height/2,t.push({x:this.getNodePosFromBorder(i,"R").start.x<o.x?i.x+i.width:i.x,y:i.y+i.height/2}))):a===2?t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=o.y,t[e.targetLineStartPointIdx+1].y=o.y,(this.getNodePosFromBorder(r,"B").start.y<o.y||this.getNodePosFromBorder(r,"T").start.y>o.y)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].x=r.x+r.width/2,t.unshift({x:r.x+r.width/2,y:this.getNodePosFromBorder(r,"T").start.y>o.y?r.y:r.y+r.height})),(this.getNodePosFromBorder(i,"B").start.y<o.y||this.getNodePosFromBorder(i,"T").start.y>o.y)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].x=i.x+i.width/2,t.push({x:i.x+i.width/2,y:this.getNodePosFromBorder(i,"T").start.y>o.y?i.y:i.y+i.height})),e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(r,"B").start.y>o.y&&this.getNodePosFromBorder(r,"T").start.y<o.y&&(t.splice(0,1),t[0].x=i.x>r.x?r.x+r.width:r.x),e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"B").start.y>o.y&&this.getNodePosFromBorder(i,"T").start.y<o.y&&(t.splice(t.length-1,1),t[t.length-1].x=r.x>i.x?i.x+i.width:i.x)):(t[e.targetLineStartPointIdx].x=o.x,t[e.targetLineStartPointIdx+1].x=o.x,(this.getNodePosFromBorder(r,"L").start.x>o.x||this.getNodePosFromBorder(r,"R").start.x<o.x)&&e.targetLineStartPointIdx===0&&(t[e.targetLineStartPointIdx].y=r.y+r.height/2,t.unshift({x:this.getNodePosFromBorder(r,"L").start.x>o.x?r.x:r.x+r.width,y:r.y+r.height/2})),(this.getNodePosFromBorder(i,"L").start.x>o.x||this.getNodePosFromBorder(i,"R").start.x<o.x)&&e.targetLineStartPointIdx===1&&(t[e.targetLineStartPointIdx+1].y=i.y+i.height/2,t.push({x:this.getNodePosFromBorder(i,"L").start.x>o.x?i.x:i.x+i.width,y:i.y+i.height/2})),e.targetLineStartPointIdx===1&&this.getNodePosFromBorder(r,"L").start.x<o.x&&this.getNodePosFromBorder(r,"R").start.x>o.x&&(t.splice(0,1),t[0].y=i.y>r.y?r.y+r.height:r.y),e.targetLineStartPointIdx===0&&this.getNodePosFromBorder(i,"L").start.x<o.x&&this.getNodePosFromBorder(i,"R").start.x>o.x&&(t.splice(t.length-1,1),t[t.length-1].y=r.y>i.y?i.y+i.height:i.y)):a===3&&(t[e.targetLineStartPointIdx].y===t[e.targetLineStartPointIdx+1].y?(t[e.targetLineStartPointIdx].y=o.y,t[e.targetLineStartPointIdx+1].y=o.y,e.targetLineStartPointIdx===0?l(t)?t[0].y<this.getNodePosFromBorder(r,"T").start.y?(t[0]={x:this.getNodePosFromBorder(r,"T").start.x+r.width/2,y:r.y},t[1]={x:t[0].x,y:o.y},o.y<this.getNodePosFromBorder(i,"T").start.y||o.y>this.getNodePosFromBorder(i,"B").start.y?(t[2]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:o.y},t[3]={x:t[2].x,y:o.y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBorder(i,"R").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:o.y},t.splice(3))):t[0].y>this.getNodePosFromBorder(r,"B").start.y&&(t[0]={x:this.getNodePosFromBorder(r,"T").start.x+r.width/2,y:this.getNodePosFromBorder(r,"B").start.y},t[1]={x:t[0].x,y:o.y},o.y<this.getNodePosFromBorder(i,"T").start.y||o.y>this.getNodePosFromBorder(i,"B").start.y?(t[2]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:o.y},t[3]={x:t[2].x,y:o.y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y}):(t[2]={x:t[1].x<this.getNodePosFromBorder(i,"R").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:o.y},t.splice(3))):o.y<this.getNodePosFromBorder(r,"T").start.y?(t[0].y=this.getNodePosFromBorder(r,"T").start.y,t[1].y=this.getNodePosFromBorder(r,"T").start.y):o.y>this.getNodePosFromBorder(r,"B").start.y&&(t[0].y=this.getNodePosFromBorder(r,"B").start.y,t[1].y=this.getNodePosFromBorder(r,"B").start.y):e.targetLineStartPointIdx===t.length-2?l(t)?t[3].y<this.getNodePosFromBorder(i,"T").start.y?(t[3]={x:this.getNodePosFromBorder(i,"T").start.x+i.width/2,y:i.y},t[2]={x:t[3].x,y:o.y},o.y<this.getNodePosFromBorder(r,"T").start.y||o.y>this.getNodePosFromBorder(r,"B").start.y?(t[1]={x:this.getNodePosFromBorder(r,"L").start.x+r.width/2,y:o.y},t[0]={x:t[1].x,y:o.y<this.getNodePosFromBorder(r,"T").start.y?this.getNodePosFromBorder(r,"T").start.y:this.getNodePosFromBorder(r,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBorder(r,"R").start.x?this.getNodePosFromBorder(r,"R").start.x:this.getNodePosFromBorder(r,"L").start.x,y:o.y},t.splice(0,1))):t[3].y>this.getNodePosFromBorder(i,"B").start.y&&(t[3]={x:this.getNodePosFromBorder(i,"L").start.x+i.width/2,y:this.getNodePosFromBorder(i,"B").start.y},t[2]={x:t[3].x,y:o.y},o.y<this.getNodePosFromBorder(r,"T").start.y||o.y>this.getNodePosFromBorder(r,"B").start.y?(t[1]={x:this.getNodePosFromBorder(r,"L").start.x+r.width/2,y:o.y},t[0]={x:t[1].x,y:o.y<this.getNodePosFromBorder(r,"T").start.y?this.getNodePosFromBorder(r,"T").start.y:this.getNodePosFromBorder(r,"B").start.y}):(t[1]={x:t[2].x>this.getNodePosFromBorder(r,"R").start.x?this.getNodePosFromBorder(r,"R").start.x:this.getNodePosFromBorder(r,"L").start.x,y:o.y},t.splice(0,1))):o.y<this.getNodePosFromBorder(i,"T").start.y?(t[2].y=this.getNodePosFromBorder(i,"T").start.y,t[3].y=this.getNodePosFromBorder(i,"T").start.y):o.y>this.getNodePosFromBorder(i,"B").start.y&&(t[2].y=this.getNodePosFromBorder(i,"B").start.y,t[3].y=this.getNodePosFromBorder(i,"B").start.y):(o.y>this.getNodePosFromBorder(r,"T").start.y&&o.y<this.getNodePosFromBorder(r,"B").start.y&&(t.splice(0,1),t[0].x=t[1].x<this.getNodePosFromBorder(r,"L").start.x?this.getNodePosFromBorder(r,"L").start.x:this.getNodePosFromBorder(r,"R").start.x),o.y>this.getNodePosFromBorder(i,"T").start.y&&o.y<this.getNodePosFromBorder(i,"B").start.y&&(t[t.length-2].x=t[t.length-3].x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,t.splice(t.length-1)))):(t[e.targetLineStartPointIdx].x=o.x,t[e.targetLineStartPointIdx+1].x=o.x,e.targetLineStartPointIdx===0?u(t)?t[0].x<this.getNodePosFromBorder(r,"L").start.x?(t[0]={x:this.getNodePosFromBorder(r,"L").start.x,y:this.getNodePosFromBorder(r,"L").start.y+r.height/2},t[1]={x:o.x,y:t[0].y},o.x<this.getNodePosFromBorder(i,"L").start.x||o.x>this.getNodePosFromBorder(i,"R").start.x?(t[2]={x:o.x,y:this.getNodePosFromBorder(i,"T").start.y+i.height/2},t[3]={x:o.x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:t[2].y}):(t[2]={x:o.x,y:t[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y},t.splice(3))):t[0].x>this.getNodePosFromBorder(r,"R").start.x&&(t[0]={x:this.getNodePosFromBorder(r,"R").start.x,y:this.getNodePosFromBorder(r,"R").start.y+r.height/2},t[1]={x:o.x,y:t[0].y},o.x<this.getNodePosFromBorder(i,"L").start.x||o.x>this.getNodePosFromBorder(i,"R").start.x?(t[2]={x:o.x,y:this.getNodePosFromBorder(i,"T").start.y+i.height/2},t[3]={x:o.x<this.getNodePosFromBorder(i,"L").start.x?this.getNodePosFromBorder(i,"L").start.x:this.getNodePosFromBorder(i,"R").start.x,y:t[2].y}):(t[2]={x:o.x,y:t[1].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y},t.splice(3))):o.x<this.getNodePosFromBorder(r,"L").start.x?(t[0].x=this.getNodePosFromBorder(r,"L").start.x+1,t[1].x=this.getNodePosFromBorder(r,"L").start.x+1):o.x>this.getNodePosFromBorder(r,"R").start.x&&(t[0].x=this.getNodePosFromBorder(r,"R").start.x-1,t[1].x=this.getNodePosFromBorder(r,"R").start.x-1):e.targetLineStartPointIdx===t.length-2?u(t)?t[3].x<this.getNodePosFromBorder(i,"L").start.x?(t[3]={x:this.getNodePosFromBorder(i,"L").start.x,y:this.getNodePosFromBorder(i,"L").start.y+i.height/2},t[2]={x:o.x,y:t[3].y},o.x<this.getNodePosFromBorder(r,"L").start.x||o.x>this.getNodePosFromBorder(r,"R").start.x?(t[1]={x:o.x,y:this.getNodePosFromBorder(r,"T").start.y+r.height/2},t[0]={x:o.x<this.getNodePosFromBorder(r,"L").start.x?this.getNodePosFromBorder(r,"L").start.x:this.getNodePosFromBorder(r,"R").start.x,y:t[1].y}):(t[1]={x:o.x,y:t[2].y>this.getNodePosFromBorder(r,"B").start.y?this.getNodePosFromBorder(r,"B").start.y:this.getNodePosFromBorder(r,"T").start.y},t.splice(0,1))):t[3].x>this.getNodePosFromBorder(i,"R").start.x&&(t[3]={x:this.getNodePosFromBorder(i,"R").start.x,y:this.getNodePosFromBorder(i,"R").start.y+i.height/2},t[2]={x:o.x,y:t[3].y},o.x<this.getNodePosFromBorder(r,"L").start.x||o.x>this.getNodePosFromBorder(r,"R").start.x?(t[1]={x:o.x,y:this.getNodePosFromBorder(r,"T").start.y+r.height/2},t[0]={x:o.x<this.getNodePosFromBorder(r,"L").start.x?this.getNodePosFromBorder(r,"L").start.x:this.getNodePosFromBorder(r,"R").start.x,y:t[1].y}):(t[1]={x:o.x,y:t[2].y>this.getNodePosFromBorder(r,"B").start.y?this.getNodePosFromBorder(r,"B").start.y:this.getNodePosFromBorder(r,"T").start.y},t.splice(0,1))):o.x<this.getNodePosFromBorder(i,"L").start.x?(t[2].x=this.getNodePosFromBorder(i,"L").start.x+1,t[3].x=this.getNodePosFromBorder(i,"L").start.x+1):o.x>this.getNodePosFromBorder(i,"R").start.x&&(t[2].x=this.getNodePosFromBorder(i,"R").start.x-1,t[3].x=this.getNodePosFromBorder(i,"R").start.x-1):(o.x>this.getNodePosFromBorder(r,"L").start.x&&o.x<this.getNodePosFromBorder(r,"R").start.x&&(t.splice(0,1),t[0].y=t[1].y<this.getNodePosFromBorder(r,"T").start.y?this.getNodePosFromBorder(r,"T").start.y:this.getNodePosFromBorder(r,"B").start.y),o.x>this.getNodePosFromBorder(i,"L").start.x&&o.x<this.getNodePosFromBorder(i,"R").start.x&&(t[t.length-2].y=t[t.length-3].y<this.getNodePosFromBorder(i,"T").start.y?this.getNodePosFromBorder(i,"T").start.y:this.getNodePosFromBorder(i,"B").start.y,t.splice(t.length-1)))),t.length===4&&t[1].x===t[2].x&&t[1].y===t[2].y&&t.splice(1,2));function l(d){let g=0;for(let h=0,m=d.length-1;h<m;h++)g+=Math.abs(d[h].x-d[h+1].x);return g===Math.abs(d[0].x-d[d.length-1].x)}function u(d){let g=0;for(let h=0,m=d.length-1;h<m;h++)g+=Math.abs(d[h].y-d[h+1].y);return g===Math.abs(d[0].y-d[d.length-1].y)}this.emit(te.Move,e.target)}createLineInfo(e,o){const t=this.chooseTargets,a=this.getNodePosFromBorder(t[0],"L"),r=this.getNodePosFromBorder(t[1],"L"),i=[];if(t[0].id===t[1].id)i[0]={x:t[0].x+t[0].width,y:t[0].y+t[0].height-20},i[1]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height-20},i[2]={x:t[0].x+t[0].width+20,y:t[0].y+t[0].height+20},i[3]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height+20},i[4]={x:t[0].x+t[0].width-20,y:t[0].y+t[0].height};else if(["exclusive","inclusive"].includes(t[0].type))a.end.y<r.start.y?(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:i[0].y+Math.floor((r.start.y-a.end.y)/2)},i[2]={x:r.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:r.start.y}):(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:Math.max(a.end.y,r.start.y)+20},i[2]={x:r.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:r.end.y});else if(["exclusive","inclusive"].includes(t[1].type))a.end.y<r.start.y?(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.end.y},i[1]={x:i[0].x,y:i[0].y+Math.floor((r.start.y-a.end.y)/2)},i[2]={x:r.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:r.start.y}):(i[0]={x:a.end.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:Math.min(a.end.y,r.start.y)-20},i[2]={x:r.start.x+Math.floor(t[1].width/2),y:i[1].y},i[3]={x:i[2].x,y:r.start.y});else if(this.getNodePosFromBorder(t[0],"R").start.x<this.getNodePosFromBorder(t[1],"L").start.x)if((r.start.y-a.end.y)*(r.end.y-a.start.y)<0){const n=Math.max(a.start.y,r.start.y)+Math.abs(Math.floor((Math.min(a.end.y,r.end.y)-Math.max(a.start.y,r.start.y))/2));i[0]={x:this.getNodePosFromBorder(t[0],"R").start.x,y:n},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x,y:n}}else a.start.y>r.end.y?(i[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:r.start.y+Math.floor(t[1].height/2)},i[2]={x:r.start.x,y:i[1].y}):(i[0]={x:this.getNodePosFromBorder(t[0],"R").start.x,y:a.start.y+Math.floor(t[0].height/2)},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x+Math.floor(t[1].width/2),y:i[0].y},i[2]={x:i[1].x,y:this.getNodePosFromBorder(t[1],"L").start.y});else if(this.getNodePosFromBorder(t[0],"L").start.x>this.getNodePosFromBorder(t[1],"R").start.x)if((r.start.y-a.end.y)*(r.end.y-a.start.y)<0){const n=Math.max(a.start.y,r.start.y)+Math.abs(Math.floor((Math.min(a.end.y,r.end.y)-Math.max(a.start.y,r.start.y))/2));i[0]={x:this.getNodePosFromBorder(t[0],"L").start.x,y:n},i[1]={x:this.getNodePosFromBorder(t[1],"R").start.x,y:n}}else a.start.y>r.end.y?(i[0]={x:a.start.x+Math.floor(t[0].width/2),y:a.start.y},i[1]={x:i[0].x,y:r.start.y+Math.floor(t[1].height/2)},i[2]={x:this.getNodePosFromBorder(t[1],"R").start.x,y:i[1].y}):(i[0]={x:this.getNodePosFromBorder(t[0],"L").start.x,y:a.start.y+Math.floor(t[0].height/2)},i[1]={x:this.getNodePosFromBorder(t[1],"L").start.x+Math.floor(t[1].width/2),y:i[0].y},i[2]={x:i[1].x,y:this.getNodePosFromBorder(t[1],"L").start.y});else if(a.start.y>r.end.y){const n=Math.max(a.start.x,r.start.x),l=Math.min(this.getNodePosFromBorder(t[0],"R").start.x,this.getNodePosFromBorder(t[1],"R").start.x),u=n+Math.floor((l-n)/2);i[0]={x:u,y:a.start.y},i[1]={x:u,y:r.end.y}}else{const n=Math.max(a.start.x,r.start.x),l=Math.min(this.getNodePosFromBorder(t[0],"R").start.x,this.getNodePosFromBorder(t[1],"R").start.x),u=n+Math.floor((l-n)/2);i[0]={x:u,y:a.end.y},i[1]={x:u,y:r.start.y}}if(i.length){const n={};return o?(o.pos=i,Object.assign(n,o)):Object.assign(n,{from:t[0].id,to:t[1].id,pos:i,type:e}),n}else Oo("createLine方法错误：未生成对应关键点坐标")}createLine(e,o){const t=this.createLineInfo(e,o),a=this.emit(te.BeforeCreate,t);Promise.all(a).then(()=>this.emit(te.New,t)).catch(()=>vt("CreateLine abort in [BeforeCreate] hooks."))}mergeLine(e,o){const t=this.createLineInfo(e,o);return Object.assign(o,t)}createBranchLine(){const e=[].concat(this.chooseTargets),o=this.getNodePosFromBorder(e[0],"L"),t=this.getNodePosFromBorder(e[1],"L");if(["inclusive","exclusive"].includes(e[1].type))Oo("未将对象引用设置到对象的实例。");else if(["inclusive","exclusive"].includes(e[0].type)){const a=this.createLine("fromFilterPrimaryKey");this.emit(G.New,{fromFilter:a})}else{const a=o.end.y+50<t.start.y?{x:o.start.x+Math.floor(e[0].width/2)-20,y:o.end.y+Math.floor((t.start.y-o.end.y)/2)-10}:{x:t.start.x+Math.floor(e[1].width/2)-20,y:Math.min(o.start.y,t.start.y)-50},r={x:a.x,y:a.y,width:40,height:20,type:"exclusive",fromKey:e[0].id};this.once(G.New,i=>{this.chooseTargets=[e[0],i],this.createLine("toFilter"),this.chooseTargets=[i,e[1]],this.createLine("fromFilterPrimaryKey")}),this.emit(G.New,r)}}createLines(e){for(const o of e){const t=this.dataHandler.originDataMap.get(o.from),a=this.dataHandler.originDataMap.get(o.to);t&&a&&(this.chooseTargets=[t,a],this.createLine(o.type,o))}this.chooseTargets=[],this.update()}mergeLines(e){const o=[];for(const t of e){const a=this.dataHandler.originDataMap.get(t.from),r=this.dataHandler.originDataMap.get(t.to);a&&r&&(this.chooseTargets=[a,r],o.push(this.mergeLine(t.type,t)))}return this.chooseTargets=[],o}setColor(e,o){this.focusTarget.forEach(t=>{t instanceof ge||(t.updateOptions({[o]:e}),this.emit(G.Change,t))}),this.update()}on(e,o){return super.on(e,o),this}}const _o={nodeDataArray:[{id:"Entity1",x:100,y:100,width:100,height:100,bgC:"#FF8080",bdC:"red",enName:"Entity1",physicalTables:!0,quotePrimaryKey:!0,attributes:[{enName:"attr1",id:"1",ifPk:!0,ifFk:!0,type:"INT",icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"L",bdC:"green"}]},{enName:"attr2",id:"2",type:"DATE",ifPk:!0},{enName:"属性名3",id:"3",ifPk:!0,type:"char",children:[{enName:"属性名3-1",id:"3-1",ifPk:!0,ifFk:!0,children:[{enName:"属性名3-1-1",ifPk:!0,ifFk:!0,children:[{enName:"属性名3-1-1-1",ifPk:!0,ifFk:!0}],icons:[{text:"A",bdC:"green"}]}]},{enName:"属性名3-2",ifPk:!0,ifFk:!0},{enName:"属性名3-3",ifPk:!0,ifFk:!0}]},{enName:"attr4",ifPk:!1,ifFk:!0,icons:[{bgC:"#FEFF80",color:"#8080FF",text:"S"},{text:"标"}]},{enName:"attr5",ifPk:!1},{enName:"attr6",ifPk:!1,icons:[{text:"A",bdC:"green"}]}]},{id:"Entity2",x:400,y:100,width:50,height:100,bgC:"#8080FF",enName:"Entity2",quotePrimaryKey:!0,attributes:[{enName:"属性名1",ifPk:!0,ifFk:!1},{enName:"属性名2",ifPk:!0},{enName:"属性名3",ifPk:!0}]},{id:"Entity3",x:100,y:400,width:50,height:100,bgC:"#FFFF80",enName:"Entity3",attributes:[{enName:"属性名1",ifPk:!1,ifFk:!1},{enName:"属性名2",ifPk:!1}]},{id:"Entity4",x:100,y:250,width:40,height:20,type:"inclusive"},{id:"Entity5",x:705,y:92,width:260,height:100,enName:"Entity5",type:"inside"},{id:"Entity6",x:600,y:280,width:260,height:100,enName:"Entity6",type:"explain",attributes:[{label:"说明",content:"表示与银行有利害关系，以及银行希望保留其信息"},{label:"示例",content:"个人 组织 客户"},{label:"所属部门",content:"数据研究院"},{label:"负责人",content:"杨中旭"}]},{id:"Entity7",x:2999,y:2999,width:260,height:100,enName:"Entity7",type:"inside"},{id:"Entity8",x:-2999,y:-2999,width:260,height:100,enName:"Entity8",type:"inside"},{id:"Entity9",x:500,y:500,width:260,height:100,enName:"Entity9",type:"inside"},{id:"Entity10",x:-500,y:-500,width:260,height:100,enName:"Entity10",type:"inside"},{id:"Entity11",x:-300,y:-300,width:260,height:100,enName:"Entity11",type:"inside"},{id:"Entity12",x:-200,y:-200,width:260,height:100,enName:"Entity12",type:"inside"}],linkDataArray:[{id:1,from:"Entity1",to:"Entity2",pos:[{x:200,y:125},{x:400,y:125}],type:"primaryKey",numLineTypes:1,remark:"主键"},{id:3,from:"Entity2",to:"Entity3",pos:[{x:400,y:150},{x:300,y:150},{x:300,y:450},{x:150,y:450}],type:"foreignKey",numLineTypes:1},{id:4,from:"Entity1",to:"Entity4",pos:[{x:120,y:200},{x:120,y:250}],type:"toFilter",numLineTypes:2},{id:5,from:"Entity4",to:"Entity3",pos:[{x:120,y:270},{x:120,y:400}],type:"fromFilter",numLineTypes:4},{id:6,from:"Entity5",to:"Entity6",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:7,from:"Entity9",to:"Entity10",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:8,from:"Entity2",to:"Entity9",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:9,from:"Entity2",to:"Entity1",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:10,from:"Entity9",to:"Entity11",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"},{id:11,from:"Entity2",to:"Entity12",pos:[{x:782,y:192},{x:782,y:280}],type:"arrow",numLineTypes:1,remark:"来自"}],markDataArray:[{id:"Mark1",x:50,y:50,width:500,height:500,enName:"Mark1"}],noteDataArray:[{id:"157837643603536658",x:525,y:408,text:"啦啦啦啦啦111",type:"note",color:"#0000ff"}]},Fe=""+new URL("symbol-defs-01fb22be.svg",import.meta.url).href,bu={class:"erg"},wu={class:"toolbar"},Cu=["xlink:href"],Bu=["xlink:href"],Nu=["xlink:href"],Mu=["xlink:href"],Tu=["xlink:href"],Pu=["xlink:href"],Su=["xlink:href"],Eu=["xlink:href"],Fu=["xlink:href"],Ru=["xlink:href"],Lu=["xlink:href"],$u=["xlink:href"],Du=["id"],ss=U({__name:"Base",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:it.Edit},elName:{default:"canvas"}},setup(s,{expose:e}){const o=s,t=T(),a=Mt({scale:100,bgC:"",bdC:"",color:"",editable:it.Edit,viewType:go.Detail}),r=()=>{const g="-apple-system, Noto Sans, Helvetica Neue, Helvetica, Nimbus Sans L, Arial, Liberation Sans, PingFang SC, Hiragino Sans GB, Noto Sans CJK SC, Source Han Sans SC, Source Han Sans CN, Microsoft YaHei, Wenquanyi Micro Hei, WenQuanYi Zen Hei, ST Heiti, SimHei, WenQuanYi Zen Hei Sharp, sans-serif";t.value=new Wi({el:document.getElementById(o.elName),fontFamily:g,editable:a.lock,useThumbnail:o.useThumbnail,useAttrFocus:o.useAttrFocus,useRightMenu:!1}),console.log("data",_o),t.value.update(_o),t.value.on(Ce.Copy,h=>console.log(Ce.Copy,h)),t.value.on(Ce.Paste,h=>console.log(Ce.Paste,h)),t.value.on(Ce.Keydown,h=>console.log(Ce.Keydown,h)),t.value.on(G.New,h=>console.log(G.New,h)),t.value.on(G.Change,h=>console.log(G.Change,h)),t.value.on(G.Delete,h=>console.log(G.Delete,h)),t.value.on(te.New,h=>console.log(te.New,h)),t.value.on(te.Delete,h=>console.log(te.Delete,h)),t.value.on(se.New,h=>console.log(se.New,h)),t.value.on(se.Delete,h=>console.log(se.Delete,h)),t.value.on(se.Change,h=>console.log(se.Change,h)),t.value.on(he.New,h=>console.log(he.New,h)),t.value.on(he.Delete,h=>console.log(he.Delete,h)),t.value.on(he.Change,h=>console.log(he.Change,h))},i=g=>{a.scale>20&&(a.scale+=g),t.value.zoom(a.scale)},n=g=>t.value.updateConfig({status:g}),l=g=>{a.editable=g,t.value.updateConfig({editable:g})},u=(g,h)=>t.value.setColor(g,h),c=()=>t.value.updateLayout(),d=()=>t.value.destroy();return me(r),jt(d),e({graph:t}),(g,h)=>(b(),F("div",bu,[S("div",wu,[D(p(Me),{size:"small",circle:"",title:"新增实体",onClick:h[0]||(h[0]=m=>n("addNode"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-add`},null,8,Cu)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"复制",onClick:h[1]||(h[1]=m=>n("copy"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#copy`},null,8,Bu)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"新增主键",onClick:h[2]||(h[2]=m=>n("IDENTIFYING"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-primary`},null,8,Nu)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"新增非主键",onClick:h[3]||(h[3]=m=>n("NON_IDENTIFYING"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-foreign`},null,8,Mu)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"新增过滤器",onClick:h[4]||(h[4]=m=>n("filtered"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-subtype`},null,8,Tu)]))]),_:1}),D(p(Ut),{direction:"vertical"}),D(p(Me),{size:"small",circle:"",title:"新增框",onClick:h[5]||(h[5]=m=>n("addMark"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-square`},null,8,Pu)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"新增备注",onClick:h[6]||(h[6]=m=>n("addNote"))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#icon-tool-text`},null,8,Su)]))]),_:1}),D(p(Ut),{direction:"vertical"}),a.editable===p(it).Edit?(b(),V(p(Me),{key:0,size:"small",circle:"",title:"只读",onClick:h[7]||(h[7]=m=>l(p(it).Disabled))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#lock`},null,8,Eu)]))]),_:1})):(b(),V(p(Me),{key:1,size:"small",circle:"",title:"编辑",onClick:h[8]||(h[8]=m=>l(p(it).Edit))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#unlock`},null,8,Fu)]))]),_:1})),D(p(Me),{size:"small",circle:"",title:"放大",onClick:h[9]||(h[9]=m=>i(20))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#plus-circle`},null,8,Ru)]))]),_:1}),D(p(Me),{size:"small",circle:"",title:"缩小",onClick:h[10]||(h[10]=m=>i(-20))},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#minus-circle`},null,8,Lu)]))]),_:1}),D(p(Ut),{direction:"vertical"}),D(p(Os),{modelValue:a.bgC,"onUpdate:modelValue":h[11]||(h[11]=m=>a.bgC=m),size:"small",onChange:h[12]||(h[12]=m=>u(m,p($s).BgColor))},null,8,["modelValue"]),D(p(Os),{modelValue:a.bdC,"onUpdate:modelValue":h[13]||(h[13]=m=>a.bdC=m),size:"small",onChange:h[14]||(h[14]=m=>u(m,p($s).BdColor))},null,8,["modelValue"]),D(p(Os),{modelValue:a.color,"onUpdate:modelValue":h[15]||(h[15]=m=>a.color=m),size:"small",onChange:h[16]||(h[16]=m=>u(m,p($s).Color))},null,8,["modelValue"]),D(p(Ut),{direction:"vertical"}),D(p(Me),{size:"small",circle:"",title:"自动布局",onClick:h[17]||(h[17]=m=>c())},{icon:$(()=>[(b(),F("svg",null,[S("use",{"xlink:href":`${p(Fe)}#layout-o`},null,8,$u)]))]),_:1}),D(p(Ut),{direction:"vertical"}),D(p(Yd),{modelValue:a.viewType,"onUpdate:modelValue":h[18]||(h[18]=m=>a.viewType=m),size:"small",placeholder:"选择视图"},{default:$(()=>[(b(!0),F(Ve,null,Yt(p(go),(m,f)=>(b(),V(p(Gd),{label:f,value:m},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),S("div",{id:o.elName,class:"canvas"},null,8,Du)]))}});ss.__docgenInfo={exportName:"default",displayName:"Base",description:"",tags:{},expose:[{name:"graph"}],props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"Editable.Edit"}},{name:"elName",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'canvas'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/Base.vue"]};const Au=[[{icon:"",value:"copy",label:"复制"},{icon:"",value:"extend-copy",label:"继承复制"},{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"parent",label:"显示父级关联",children:[{icon:"",value:"level-1",label:"显示1级"},{icon:"",value:"level-2",label:"显示2级"},{icon:"",value:"level-all",label:"显示全部"}]}],[{icon:"",value:"auto-size",label:"自适应大小"},{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}],{icon:"",value:"delete",label:"删除"}],Vo=[[{icon:"",value:"parse",label:"粘贴"}],[{icon:"",value:"redo",label:"撤销"}],[{icon:"",value:"auto-layout",label:"自动排布"}],[{icon:"",value:"style",label:"展示风格",children:[{icon:"",value:"brief",label:"概要"},{icon:"",value:"easy",label:"简单"},{icon:"",value:"normal",label:"常规"},{icon:"",value:"detail",label:"详细"}]}]],Ou={class:"association__content"},Hu=["id"],Ki=U({__name:"parent-association",props:{dialogVisible:{type:Boolean,required:!0},useThumbnail:{type:Boolean,required:!0,default:!0},useRightMenu:{type:Boolean,required:!0,default:!0},useAttrFocus:{type:Boolean,required:!0,default:!0},editable:{type:String,required:!0,default:"edit"},elName:{type:String,required:!0,default:"canvas"}},emits:["update:dialogVisible"],setup(s,{emit:e}){const o=s,t=C(l=>o.dialogVisible),a=()=>e("update:dialogVisible",!1);let r;const i=()=>{r=new Wi({el:document.getElementById(o.elName),useThumbnail:!0})},n=()=>r.destroy();return me(()=>Y(i)),jt(n),(l,u)=>(b(),V(p(Nd),{title:"Preview",modelValue:p(t),"onUpdate:modelValue":u[0]||(u[0]=c=>ei(t)?t.value=c:null),"append-to-body":!0,"close-on-click-modal":!1,"before-close":a,width:"80%",class:"dialog-association"},{default:$(()=>[S("div",Ou,[S("div",{id:o.elName,class:"association"},null,8,Hu)])]),_:1},8,["modelValue"]))}});Ki.__docgenInfo={exportName:"default",displayName:"parent-association",description:"",tags:{},props:[{name:"dialogVisible",type:{name:"boolean"},required:!0},{name:"useThumbnail",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"true"}},{name:"editable",type:{name:"string"},required:!0,defaultValue:{func:!1,value:"'edit'"}},{name:"elName",type:{name:"string"},required:!0,defaultValue:{func:!1,value:"'canvas'"}}],events:[{name:"update:dialogVisible"}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/components/parent-association.vue"]};const zu={class:"erg-right-menu"},ki=U({__name:"RightMenu",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(s){const e=T(),o=T(!1),t=C(()=>e.value.graph);return me(()=>{console.log(t.value,"erg"),t.value.updateConfig({useRightMenu:!0}),t.value.on(xt.Show,r=>{console.log(Vo),t.value.updateConfig({rightMenu:r.target?Au:Vo})}),t.value.on(xt.Click,r=>{switch(console.log(r.target),r.value){case"level-1":o.value=!0;break;case"level-2":o.value=!0;break;case"level-all":o.value=!0;break}})}),(r,i)=>(b(),F("div",zu,[D(ss,{ref_key:"erg",ref:e,elName:"canvas-right-menu",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512),o.value?(b(),V(Ki,{key:0,id:"11",elName:"canvas-parent-association",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit",dialogVisible:o.value,"onUpdate:dialogVisible":i[0]||(i[0]=n=>o.value=n)},null,8,["dialogVisible"])):_("",!0)]))}});ki.__docgenInfo={exportName:"default",displayName:"RightMenu",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/RightMenu.vue"]};const _u={class:"erg-extra-drawing"},Ui=U({__name:"ExtraDrawing",setup(s){const e=T(),o=C(()=>e.value.graph);return me(()=>{o.value.on(Ce.BeforeUpdate,a=>{o.value.dataHandler.originData.nodeDataArray.map(({id:r},i)=>{if(i%2)return;const n=o.value.dataHandler.originDataMap.get(r);n&&(a.save(),a.font="16px",a.fillStyle="#F59A23",a.strokeStyle="#F59A23",a.textAlign="right",a.textBaseline="top",a.fillText("正在编辑",n.x+n.width,n.y-22),a.lineWidth=2,a.strokeRect(n.x,n.y,n.width,n.height),a.restore())})})}),(a,r)=>(b(),F("div",_u,[D(ss,{ref_key:"erg",ref:e,elName:"canvas-extra-drawing",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512)]))}});Ui.__docgenInfo={exportName:"default",displayName:"ExtraDrawing",description:"",tags:{},sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/ExtraDrawing.vue"]};const Vu={class:"erg-export-data"},qi=U({__name:"ExportData",props:{useThumbnail:{type:Boolean,default:!0},useRightMenu:{type:Boolean,default:!0},useAttrFocus:{type:Boolean,default:!0},editable:{default:"edit"}},setup(s){const e=[[{icon:"",value:"export",label:"导出数据"}]],o=T();T(!1);const t=C(()=>o.value.graph);return me(()=>{t.value.updateConfig({useRightMenu:!0,rightMenu:e}),t.value.on(xt.Click,r=>{switch(r.value){case"export":t.value.canvas.exportJsonFile(t.value.dataHandler.originData);break}})}),(r,i)=>(b(),F("div",Vu,[D(ss,{ref_key:"erg",ref:o,elName:"canvas-export-data",useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit"},null,512)]))}});qi.__docgenInfo={exportName:"default",displayName:"ExportData",description:"",tags:{},props:[{name:"useThumbnail",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useRightMenu",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"useAttrFocus",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"editable",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'edit'"}}],sourceFiles:["/home/runner/work/renderer2d/renderer2d/stories/erg/ExportData.vue"]};const ku={title:"Example/Erg",component:ss,tags:["autodocs"],argTypes:{useThumbnail:{description:"是否开启缩略图插件"},useRightMenu:{description:"是否开启右键菜单插件"},useAttrFocus:{description:"属性是否可聚焦"},editable:{description:"修改可编辑状态，1为可编辑状态（默认）；2为可拖拉、放大缩小的只读状态；3为禁止任何交互的只读状态",control:"select",options:[1,2,3]},elName:{description:"Erg画布名称，每个实例都不能相同"}},args:{useThumbnail:!0,useRightMenu:!0,useAttrFocus:!0,editable:"edit",elName:"canvas"}},as={args:{elName:"baseCanvas"}},ns=()=>ki,ls=()=>Ui,ds=()=>qi;var Wo,Ko,ko;as.parameters={...as.parameters,docs:{...(Wo=as.parameters)==null?void 0:Wo.docs,source:{originalSource:`{
  args: {
    elName: 'baseCanvas'
  }
}`,...(ko=(Ko=as.parameters)==null?void 0:Ko.docs)==null?void 0:ko.source}}};var Uo,qo,Yo;ns.parameters={...ns.parameters,docs:{...(Uo=ns.parameters)==null?void 0:Uo.docs,source:{originalSource:"() => RightMenuCom",...(Yo=(qo=ns.parameters)==null?void 0:qo.docs)==null?void 0:Yo.source}}};var Go,Xo,Qo;ls.parameters={...ls.parameters,docs:{...(Go=ls.parameters)==null?void 0:Go.docs,source:{originalSource:"() => ExtraDrawingCom",...(Qo=(Xo=ls.parameters)==null?void 0:Xo.docs)==null?void 0:Qo.source}}};var Zo,Jo,Io;ds.parameters={...ds.parameters,docs:{...(Zo=ds.parameters)==null?void 0:Zo.docs,source:{originalSource:"() => ExportDataCom",...(Io=(Jo=ds.parameters)==null?void 0:Jo.docs)==null?void 0:Io.source}}};const Uu=["Base","RightMenu","ExtraDrawing","ExportData"];export{as as Base,ds as ExportData,ls as ExtraDrawing,ns as RightMenu,Uu as __namedExportsOrder,ku as default};
//# sourceMappingURL=Erg.stories-52dc5319.js.map
